var YS=Object.create;var wa=Object.defineProperty;var ZS=Object.getOwnPropertyDescriptor;var XS=Object.getOwnPropertyNames;var ev=Object.getPrototypeOf,tv=Object.prototype.hasOwnProperty;var rv=(t,e,r)=>e in t?wa(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Mu=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),nv=(t,e)=>{for(var r in e)wa(t,r,{get:e[r],enumerable:!0})},iv=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of XS(e))!tv.call(t,o)&&o!==r&&wa(t,o,{get:()=>e[o],enumerable:!(n=ZS(e,o))||n.enumerable});return t};var mo=(t,e,r)=>(r=t!=null?YS(ev(t)):{},iv(e||!t||!t.__esModule?wa(r,"default",{value:t,enumerable:!0}):r,t));var re=(t,e,r)=>rv(t,typeof e!="symbol"?e+"":e,r);var R_=Mu((E_,Ns)=>{(function(t,e){typeof Ns=="object"&&Ns.exports?Ns.exports=e():t.nearley=e()})(E_,function(){function t(p,l,u){return this.id=++t.highestId,this.name=p,this.symbols=l,this.postprocess=u,this}t.highestId=0,t.prototype.toString=function(p){var l=typeof p>"u"?this.symbols.map(c).join(" "):this.symbols.slice(0,p).map(c).join(" ")+" \u25CF "+this.symbols.slice(p).map(c).join(" ");return this.name+" \u2192 "+l};function e(p,l,u,m){this.rule=p,this.dot=l,this.reference=u,this.data=[],this.wantedBy=m,this.isComplete=this.dot===p.symbols.length}e.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},e.prototype.nextState=function(p){var l=new e(this.rule,this.dot+1,this.reference,this.wantedBy);return l.left=this,l.right=p,l.isComplete&&(l.data=l.build(),l.right=void 0),l},e.prototype.build=function(){var p=[],l=this;do p.push(l.right.data),l=l.left;while(l.left);return p.reverse(),p},e.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,a.fail))};function r(p,l){this.grammar=p,this.index=l,this.states=[],this.wants={},this.scannable=[],this.completed={}}r.prototype.process=function(p){for(var l=this.states,u=this.wants,m=this.completed,d=0;d<l.length;d++){var g=l[d];if(g.isComplete){if(g.finish(),g.data!==a.fail){for(var b=g.wantedBy,w=b.length;w--;){var I=b[w];this.complete(I,g)}if(g.reference===this.index){var L=g.rule.name;(this.completed[L]=this.completed[L]||[]).push(g)}}}else{var L=g.rule.symbols[g.dot];if(typeof L!="string"){this.scannable.push(g);continue}if(u[L]){if(u[L].push(g),m.hasOwnProperty(L))for(var H=m[L],w=0;w<H.length;w++){var X=H[w];this.complete(g,X)}}else u[L]=[g],this.predict(L)}}},r.prototype.predict=function(p){for(var l=this.grammar.byName[p]||[],u=0;u<l.length;u++){var m=l[u],d=this.wants[p],g=new e(m,0,this.index,d);this.states.push(g)}},r.prototype.complete=function(p,l){var u=p.nextState(l);this.states.push(u)};function n(p,l){this.rules=p,this.start=l||this.rules[0].name;var u=this.byName={};this.rules.forEach(function(m){u.hasOwnProperty(m.name)||(u[m.name]=[]),u[m.name].push(m)})}n.fromCompiled=function(m,l){var u=m.Lexer;m.ParserStart&&(l=m.ParserStart,m=m.ParserRules);var m=m.map(function(g){return new t(g.name,g.symbols,g.postprocess)}),d=new n(m,l);return d.lexer=u,d};function o(){this.reset("")}o.prototype.reset=function(p,l){this.buffer=p,this.index=0,this.line=l?l.line:1,this.lastLineBreak=l?-l.col:0},o.prototype.next=function(){if(this.index<this.buffer.length){var p=this.buffer[this.index++];return p===`
`&&(this.line+=1,this.lastLineBreak=this.index),{value:p}}},o.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},o.prototype.formatError=function(p,l){var u=this.buffer;if(typeof u=="string"){var m=u.split(`
`).slice(Math.max(0,this.line-5),this.line),d=u.indexOf(`
`,this.index);d===-1&&(d=u.length);var g=this.index-this.lastLineBreak,b=String(this.line).length;return l+=" at line "+this.line+" col "+g+`:

`,l+=m.map(function(I,L){return w(this.line-m.length+L+1,b)+" "+I},this).join(`
`),l+=`
`+w("",b+g)+`^
`,l}else return l+" at index "+(this.index-1);function w(I,L){var H=String(I);return Array(L-H.length+1).join(" ")+H}};function a(p,l,u){if(p instanceof n)var m=p,u=l;else var m=n.fromCompiled(p,l);this.grammar=m,this.options={keepHistory:!1,lexer:m.lexer||new o};for(var d in u||{})this.options[d]=u[d];this.lexer=this.options.lexer,this.lexerState=void 0;var g=new r(m,0),b=this.table=[g];g.wants[m.start]=[],g.predict(m.start),g.process(),this.current=0}a.fail={},a.prototype.feed=function(p){var l=this.lexer;l.reset(p,this.lexerState);for(var u;;){try{if(u=l.next(),!u)break}catch(oe){var b=new r(this.grammar,this.current+1);this.table.push(b);var m=new Error(this.reportLexerError(oe));throw m.offset=this.current,m.token=oe.token,m}var d=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var g=this.current+1,b=new r(this.grammar,g);this.table.push(b);for(var w=u.text!==void 0?u.text:u.value,I=l.constructor===o?u.value:l.transform?.(u)??u,L=d.scannable,H=L.length;H--;){var X=L[H],fe=X.rule.symbols[X.dot];if(fe.test?fe.test(I):fe.type?fe.type===u.type:fe.literal===w){var J=X.nextState({data:I,token:u,isToken:!0,reference:g-1});b.states.push(J)}}if(b.process(),b.states.length===0){var m=new Error(this.reportError(u));throw m.offset=this.current,m.token=u,m}this.options.keepHistory&&(d.lexerState=l.save()),this.current++}return d&&(this.lexerState=l.save()),this.results=this.finish(),this},a.prototype.reportLexerError=function(p){var l,u,m=p.token;return m?(l="input "+JSON.stringify(m.text[0])+" (lexer error)",u=this.lexer.formatError(m,"Syntax error")):(l="input (lexer error)",u=p.message),this.reportErrorCommon(u,l)},a.prototype.reportError=function(p){var l=(p.type?p.type+" token: ":"")+JSON.stringify(p.value!==void 0?p.value:p),u=this.lexer.formatError(p,"Syntax error");return this.reportErrorCommon(u,l)},a.prototype.reportErrorCommon=function(p,l){var u=[];u.push(p);var m=this.table.length-2,d=this.table[m],g=d.states.filter(function(w){var I=w.rule.symbols[w.dot];return I&&typeof I!="string"});if(g.length===0)u.push("Unexpected "+l+`. I did not expect any more input. Here is the state of my parse table:
`),this.displayStateStack(d.states,u);else{u.push("Unexpected "+l+`. Instead, I was expecting to see one of the following:
`);var b=g.map(function(w){return this.buildFirstStateStack(w,[])||[w]},this);b.forEach(function(w){var I=w[0],L=I.rule.symbols[I.dot],H=this.getSymbolDisplay(L);u.push("A "+H+" based on:"),this.displayStateStack(w,u)},this)}return u.push(""),u.join(`
`)},a.prototype.displayStateStack=function(p,l){for(var u,m=0,d=0;d<p.length;d++){var g=p[d],b=g.rule.toString(g.dot);b===u?m++:(m>0&&l.push("    ^ "+m+" more lines identical to this"),m=0,l.push("    "+b)),u=b}},a.prototype.getSymbolDisplay=function(p){return s(p)},a.prototype.buildFirstStateStack=function(p,l){if(l.indexOf(p)!==-1)return null;if(p.wantedBy.length===0)return[p];var u=p.wantedBy[0],m=[p].concat(l),d=this.buildFirstStateStack(u,m);return d===null?null:[p].concat(d)},a.prototype.save=function(){var p=this.table[this.current];return p.lexerState=this.lexerState,p},a.prototype.restore=function(p){var l=p.index;this.current=l,this.table[l]=p,this.table.splice(l+1),this.lexerState=p.lexerState,this.results=this.finish()},a.prototype.rewind=function(p){if(!this.options.keepHistory)throw new Error("set option `keepHistory` to enable rewinding");this.restore(this.table[p])},a.prototype.finish=function(){var p=[],l=this.grammar.start,u=this.table[this.table.length-1];return u.states.forEach(function(m){m.rule.name===l&&m.dot===m.rule.symbols.length&&m.reference===0&&m.data!==a.fail&&p.push(m)}),p.map(function(m){return m.data})};function s(p){var l=typeof p;if(l==="string")return p;if(l==="object"){if(p.literal)return JSON.stringify(p.literal);if(p instanceof RegExp)return"character matching "+p;if(p.type)return p.type+" token";if(p.test)return"token matching "+String(p.test);throw new Error("Unknown symbol type: "+p)}}function c(p){var l=typeof p;if(l==="string")return p;if(l==="object"){if(p.literal)return JSON.stringify(p.literal);if(p instanceof RegExp)return p.toString();if(p.type)return"%"+p.type;if(p.test)return"<"+String(p.test)+">";throw new Error("Unknown symbol type: "+p)}}return{Parser:a,Grammar:n,Rule:t}})});var L_=Mu((D_,Vs)=>{(function(t,e){typeof define=="function"&&define.amd?define([],e):typeof Vs=="object"&&Vs.exports?Vs.exports=e():t.moo=e()})(D_,function(){"use strict";var t=Object.prototype.hasOwnProperty,e=Object.prototype.toString,r=typeof new RegExp().sticky=="boolean";function n(k){return k&&e.call(k)==="[object RegExp]"}function o(k){return k&&typeof k=="object"&&!n(k)&&!Array.isArray(k)}function a(k){return k.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function s(k){var x=new RegExp("|"+k);return x.exec("").length-1}function c(k){return"("+k+")"}function p(k){if(!k.length)return"(?!)";var x=k.map(function(y){return"(?:"+y+")"}).join("|");return"(?:"+x+")"}function l(k){if(typeof k=="string")return"(?:"+a(k)+")";if(n(k)){if(k.ignoreCase)throw new Error("RegExp /i flag not allowed");if(k.global)throw new Error("RegExp /g flag is implied");if(k.sticky)throw new Error("RegExp /y flag is implied");if(k.multiline)throw new Error("RegExp /m flag is implied");return k.source}else throw new Error("Not a pattern: "+k)}function u(k,x){return k.length>x?k:Array(x-k.length+1).join(" ")+k}function m(k,x){for(var y=k.length,A=0;;){var M=k.lastIndexOf(`
`,y-1);if(M===-1||(A++,y=M,A===x)||y===0)break}var T=A<x?0:y+1;return k.substring(T).split(`
`)}function d(k){for(var x=Object.getOwnPropertyNames(k),y=[],A=0;A<x.length;A++){var M=x[A],T=k[M],R=[].concat(T);if(M==="include"){for(var P=0;P<R.length;P++)y.push({include:R[P]});continue}var C=[];R.forEach(function(O){o(O)?(C.length&&y.push(b(M,C)),y.push(b(M,O)),C=[]):C.push(O)}),C.length&&y.push(b(M,C))}return y}function g(k){for(var x=[],y=0;y<k.length;y++){var A=k[y];if(A.include){for(var M=[].concat(A.include),T=0;T<M.length;T++)x.push({include:M[T]});continue}if(!A.type)throw new Error("Rule has no type: "+JSON.stringify(A));x.push(b(A.type,A))}return x}function b(k,x){if(o(x)||(x={match:x}),x.include)throw new Error("Matching rules cannot also include states");var y={defaultType:k,lineBreaks:!!x.error||!!x.fallback,pop:!1,next:null,push:null,error:!1,fallback:!1,value:null,type:null,shouldThrow:!1};for(var A in x)t.call(x,A)&&(y[A]=x[A]);if(typeof y.type=="string"&&k!==y.type)throw new Error("Type transform cannot be a string (type '"+y.type+"' for token '"+k+"')");var M=y.match;return y.match=Array.isArray(M)?M:M?[M]:[],y.match.sort(function(T,R){return n(T)&&n(R)?0:n(R)?-1:n(T)?1:R.length-T.length}),y}function w(k){return Array.isArray(k)?g(k):d(k)}var I=b("error",{lineBreaks:!0,shouldThrow:!0});function L(k,x){for(var y=null,A=Object.create(null),M=!0,T=null,R=[],P=[],C=0;C<k.length;C++)k[C].fallback&&(M=!1);for(var C=0;C<k.length;C++){var O=k[C];if(O.include)throw new Error("Inheritance is not allowed in stateless lexers");if(O.error||O.fallback){if(y)throw!O.fallback==!y.fallback?new Error("Multiple "+(O.fallback?"fallback":"error")+" rules not allowed (for token '"+O.defaultType+"')"):new Error("fallback and error are mutually exclusive (for token '"+O.defaultType+"')");y=O}var U=O.match.slice();if(M)for(;U.length&&typeof U[0]=="string"&&U[0].length===1;){var ee=U.shift();A[ee.charCodeAt(0)]=O}if(O.pop||O.push||O.next){if(!x)throw new Error("State-switching options are not allowed in stateless lexers (for token '"+O.defaultType+"')");if(O.fallback)throw new Error("State-switching options are not allowed on fallback tokens (for token '"+O.defaultType+"')")}if(U.length!==0){M=!1,R.push(O);for(var te=0;te<U.length;te++){var ve=U[te];if(n(ve)){if(T===null)T=ve.unicode;else if(T!==ve.unicode&&O.fallback===!1)throw new Error("If one rule is /u then all must be")}}var ge=p(U.map(l)),Oe=new RegExp(ge);if(Oe.test(""))throw new Error("RegExp matches empty string: "+Oe);var Vt=s(ge);if(Vt>0)throw new Error("RegExp has capture groups: "+Oe+`
Use (?: \u2026 ) instead`);if(!O.lineBreaks&&Oe.test(`
`))throw new Error("Rule should declare lineBreaks: "+Oe);P.push(c(ge))}}var qn=y&&y.fallback,uo=r&&!qn?"ym":"gm",ba=r||qn?"":"|";T===!0&&(uo+="u");var JS=new RegExp(p(P)+ba,uo);return{regexp:JS,groups:R,fast:A,error:y||I}}function H(k){var x=L(w(k));return new oe({start:x},"start")}function X(k,x,y){var A=k&&(k.push||k.next);if(A&&!y[A])throw new Error("Missing state '"+A+"' (in token '"+k.defaultType+"' of state '"+x+"')");if(k&&k.pop&&+k.pop!=1)throw new Error("pop must be 1 (in token '"+k.defaultType+"' of state '"+x+"')")}function fe(k,x){var y=k.$all?w(k.$all):[];delete k.$all;var A=Object.getOwnPropertyNames(k);x||(x=A[0]);for(var M=Object.create(null),T=0;T<A.length;T++){var R=A[T];M[R]=w(k[R]).concat(y)}for(var T=0;T<A.length;T++)for(var R=A[T],P=M[R],C=Object.create(null),O=0;O<P.length;O++){var U=P[O];if(U.include){var ee=[O,1];if(U.include!==R&&!C[U.include]){C[U.include]=!0;var te=M[U.include];if(!te)throw new Error("Cannot include nonexistent state '"+U.include+"' (in state '"+R+"')");for(var ve=0;ve<te.length;ve++){var ge=te[ve];P.indexOf(ge)===-1&&ee.push(ge)}}P.splice.apply(P,ee),O--}}for(var Oe=Object.create(null),T=0;T<A.length;T++){var R=A[T];Oe[R]=L(M[R],!0)}for(var T=0;T<A.length;T++){for(var Vt=A[T],qn=Oe[Vt],uo=qn.groups,O=0;O<uo.length;O++)X(uo[O],Vt,Oe);for(var ba=Object.getOwnPropertyNames(qn.fast),O=0;O<ba.length;O++)X(qn.fast[ba[O]],Vt,Oe)}return new oe(Oe,x)}function J(k){for(var x=typeof Map<"u",y=x?new Map:Object.create(null),A=Object.getOwnPropertyNames(k),M=0;M<A.length;M++){var T=A[M],R=k[T],P=Array.isArray(R)?R:[R];P.forEach(function(C){if(typeof C!="string")throw new Error("keyword must be string (in keyword '"+T+"')");x?y.set(C,T):y[C]=T})}return function(C){return x?y.get(C):y[C]}}var oe=function(k,x){this.startState=x,this.states=k,this.buffer="",this.stack=[],this.reset()};oe.prototype.reset=function(k,x){return this.buffer=k||"",this.index=0,this.line=x?x.line:1,this.col=x?x.col:1,this.queuedToken=x?x.queuedToken:null,this.queuedText=x?x.queuedText:"",this.queuedThrow=x?x.queuedThrow:null,this.setState(x?x.state:this.startState),this.stack=x&&x.stack?x.stack.slice():[],this},oe.prototype.save=function(){return{line:this.line,col:this.col,state:this.state,stack:this.stack.slice(),queuedToken:this.queuedToken,queuedText:this.queuedText,queuedThrow:this.queuedThrow}},oe.prototype.setState=function(k){if(!(!k||this.state===k)){this.state=k;var x=this.states[k];this.groups=x.groups,this.error=x.error,this.re=x.regexp,this.fast=x.fast}},oe.prototype.popState=function(){this.setState(this.stack.pop())},oe.prototype.pushState=function(k){this.stack.push(this.state),this.setState(k)};var rt=r?function(k,x){return k.exec(x)}:function(k,x){var y=k.exec(x);return y[0].length===0?null:y};oe.prototype._getGroup=function(k){for(var x=this.groups.length,y=0;y<x;y++)if(k[y+1]!==void 0)return this.groups[y];throw new Error("Cannot find token type for matched text")};function Ze(){return this.value}if(oe.prototype.next=function(){var k=this.index;if(this.queuedGroup){var x=this._token(this.queuedGroup,this.queuedText,k);return this.queuedGroup=null,this.queuedText="",x}var y=this.buffer;if(k!==y.length){var R=this.fast[y.charCodeAt(k)];if(R)return this._token(R,y.charAt(k),k);var A=this.re;A.lastIndex=k;var M=rt(A,y),T=this.error;if(M==null)return this._token(T,y.slice(k,y.length),k);var R=this._getGroup(M),P=M[0];return T.fallback&&M.index!==k?(this.queuedGroup=R,this.queuedText=P,this._token(T,y.slice(k,M.index),k)):this._token(R,P,k)}},oe.prototype._token=function(k,x,y){var A=0;if(k.lineBreaks){var M=/\n/g,T=1;if(x===`
`)A=1;else for(;M.exec(x);)A++,T=M.lastIndex}var R={type:typeof k.type=="function"&&k.type(x)||k.defaultType,value:typeof k.value=="function"?k.value(x):x,text:x,toString:Ze,offset:y,lineBreaks:A,line:this.line,col:this.col},P=x.length;if(this.index+=P,this.line+=A,A!==0?this.col=P-T+1:this.col+=P,k.shouldThrow){var C=new Error(this.formatError(R,"invalid syntax"));throw C}return k.pop?this.popState():k.push?this.pushState(k.push):k.next&&this.setState(k.next),R},typeof Symbol<"u"&&Symbol.iterator){var Qt=function(k){this.lexer=k};Qt.prototype.next=function(){var k=this.lexer.next();return{value:k,done:!k}},Qt.prototype[Symbol.iterator]=function(){return this},oe.prototype[Symbol.iterator]=function(){return new Qt(this)}}return oe.prototype.formatError=function(k,x){if(k==null)var y=this.buffer.slice(this.index),k={text:y,offset:this.index,lineBreaks:y.indexOf(`
`)===-1?0:1,line:this.line,col:this.col};var A=2,M=Math.max(k.line-A,1),T=k.line+A,R=String(T).length,P=m(this.buffer,this.line-k.line+A+1).slice(0,5),C=[];C.push(x+" at line "+k.line+" col "+k.col+":"),C.push("");for(var O=0;O<P.length;O++){var U=P[O],ee=M+O;C.push(u(String(ee),R)+"  "+U),ee===k.line&&C.push(u("",R+k.col+1)+"^")}return C.join(`
`)},oe.prototype.clone=function(){return new oe(this.states,this.state)},oe.prototype.has=function(k){return!0},{compile:H,states:fe,error:Object.freeze({error:!0}),fallback:Object.freeze({fallback:!0}),keywords:J}})});var hc=Mu((or,kT)=>{"use strict";Object.defineProperty(or,"__esModule",{value:!0});function jt(t){return typeof t=="object"&&!("toString"in t)?Object.prototype.toString.call(t).slice(8,-1):t}var jD=typeof process=="object"&&process.env.NODE_ENV==="production";function Ft(t,e){if(!t)throw jD?new Error("Invariant failed"):new Error(e())}or.invariant=Ft;var sd=Object.prototype.hasOwnProperty,qD=Array.prototype.splice,zD=Object.prototype.toString;function Sn(t){return zD.call(t).slice(8,-1)}var gc=Object.assign||function(t,e){return cd(e).forEach(function(r){sd.call(e,r)&&(t[r]=e[r])}),t},cd=typeof Object.getOwnPropertySymbols=="function"?function(t){return Object.keys(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.keys(t)};function $r(t){return Array.isArray(t)?gc(t.constructor(t.length),t):Sn(t)==="Map"?new Map(t):Sn(t)==="Set"?new Set(t):t&&typeof t=="object"?gc(Object.create(Object.getPrototypeOf(t)),t):t}var ET=function(){function t(){this.commands=gc({},GD),this.update=this.update.bind(this),this.update.extend=this.extend=this.extend.bind(this),this.update.isEquals=function(e,r){return e===r},this.update.newContext=function(){return new t().update}}return Object.defineProperty(t.prototype,"isEquals",{get:function(){return this.update.isEquals},set:function(e){this.update.isEquals=e},enumerable:!0,configurable:!0}),t.prototype.extend=function(e,r){this.commands[e]=r},t.prototype.update=function(e,r){var n=this,o=typeof r=="function"?{$apply:r}:r;Array.isArray(e)&&Array.isArray(o)||Ft(!Array.isArray(o),function(){return"update(): You provided an invalid spec to update(). The spec may not contain an array except as the value of $set, $push, $unshift, $splice or any custom command allowing an array value."}),Ft(typeof o=="object"&&o!==null,function(){return"update(): You provided an invalid spec to update(). The spec and every included key path must be plain objects containing one of the "+("following commands: "+Object.keys(n.commands).join(", ")+".")});var a=e;return cd(o).forEach(function(s){if(sd.call(n.commands,s)){var c=e===a;a=n.commands[s](o[s],a,o,e),c&&n.isEquals(a,e)&&(a=e)}else{var p=Sn(e)==="Map"?n.update(e.get(s),o[s]):n.update(e[s],o[s]),l=Sn(a)==="Map"?a.get(s):a[s];(!n.isEquals(p,l)||typeof p>"u"&&!sd.call(e,s))&&(a===e&&(a=$r(e)),Sn(a)==="Map"?a.set(s,p):a[s]=p)}}),a},t}();or.Context=ET;var GD={$push:function(t,e,r){return bT(e,r,"$push"),t.length?e.concat(t):e},$unshift:function(t,e,r){return bT(e,r,"$unshift"),t.length?t.concat(e):e},$splice:function(t,e,r,n){return KD(e,r),t.forEach(function(o){RT(o),e===n&&o.length&&(e=$r(n)),qD.apply(e,o)}),e},$set:function(t,e,r){return JD(r),t},$toggle:function(t,e){No(t,"$toggle");var r=t.length?$r(e):e;return t.forEach(function(n){r[n]=!e[n]}),r},$unset:function(t,e,r,n){return No(t,"$unset"),t.forEach(function(o){Object.hasOwnProperty.call(e,o)&&(e===n&&(e=$r(n)),delete e[o])}),e},$add:function(t,e,r,n){return wT(e,"$add"),No(t,"$add"),Sn(e)==="Map"?t.forEach(function(o){var a=o[0],s=o[1];e===n&&e.get(a)!==s&&(e=$r(n)),e.set(a,s)}):t.forEach(function(o){e===n&&!e.has(o)&&(e=$r(n)),e.add(o)}),e},$remove:function(t,e,r,n){return wT(e,"$remove"),No(t,"$remove"),t.forEach(function(o){e===n&&e.has(o)&&(e=$r(n)),e.delete(o)}),e},$merge:function(t,e,r,n){return YD(e,t),cd(t).forEach(function(o){t[o]!==e[o]&&(e===n&&(e=$r(n)),e[o]=t[o])}),e},$apply:function(t,e){return QD(t),t(e)}},pd=new ET;or.isEquals=pd.update.isEquals;or.extend=pd.extend;or.default=pd.update;or.default.default=kT.exports=gc(or.default,or);function bT(t,e,r){Ft(Array.isArray(t),function(){return"update(): expected target of "+jt(r)+" to be an array; got "+jt(t)+"."}),No(e[r],r)}function No(t,e){Ft(Array.isArray(t),function(){return"update(): expected spec of "+jt(e)+" to be an array; got "+jt(t)+". Did you forget to wrap your parameter in an array?"})}function KD(t,e){Ft(Array.isArray(t),function(){return"Expected $splice target to be an array; got "+jt(t)}),RT(e.$splice)}function RT(t){Ft(Array.isArray(t),function(){return"update(): expected spec of $splice to be an array of arrays; got "+jt(t)+". Did you forget to wrap your parameters in an array?"})}function QD(t){Ft(typeof t=="function",function(){return"update(): expected spec of $apply to be a function; got "+jt(t)+"."})}function JD(t){Ft(Object.keys(t).length===1,function(){return"Cannot have more than one key in an object with $set"})}function YD(t,e){Ft(e&&typeof e=="object",function(){return"update(): $merge expects a spec of type 'object'; got "+jt(e)}),Ft(t&&typeof t=="object",function(){return"update(): $merge expects a target of type 'object'; got "+jt(t)})}function wT(t,e){var r=Sn(t);Ft(r==="Map"||r==="Set",function(){return"update(): "+jt(e)+" expects a target of type Set or Map; got "+jt(r)})}});var Ea=class{constructor(e){this.baseTitle=e}get title(){return`Cursorless: ${this.baseTitle}`}},Ae=class extends Ea{constructor(){super(...arguments);this.isVisible=!1}},Fe=class extends Ea{constructor(){super(...arguments);this.isVisible=!0}};var LC={"cursorless.toggleDecorations":new Fe("Toggle decorations"),"cursorless.recomputeDecorationStyles":new Fe("Recompute decoration styles"),"cursorless.recordTestCase":new Fe("Record test case"),"cursorless.recordOneTestCaseThenPause":new Fe("Record one test case, then pause"),"cursorless.pauseRecording":new Fe("Pause test case recording"),"cursorless.resumeRecording":new Fe("Resume test case recording"),"cursorless.recordScopeTests.showUnimplementedFacets":new Fe("Bulk record unimplemented scope facets"),"cursorless.recordScopeTests.saveActiveDocument":new Fe("Bulk save scope tests for the active document"),"cursorless.showDocumentation":new Fe("Show documentation"),"cursorless.showInstallationDependencies":new Fe("Show installation dependencies"),"cursorless.showScopeVisualizer":new Fe("Show the scope visualizer"),"cursorless.hideScopeVisualizer":new Fe("Hide the scope visualizer"),"cursorless.analyzeCommandHistory":new Fe("Analyze collected command history"),"cursorless.tutorial.start":new Ae("Start a tutorial"),"cursorless.tutorial.next":new Fe("Tutorial next"),"cursorless.tutorial.previous":new Fe("Tutorial previous"),"cursorless.tutorial.restart":new Fe("Tutorial restart"),"cursorless.tutorial.resume":new Fe("Tutorial resume"),"cursorless.tutorial.list":new Fe("Tutorial list"),"cursorless.documentationOpened":new Ae("Used by talon to notify us that the docs have been opened; for use with tutorial"),"cursorless.command":new Ae("The core cursorless command"),"cursorless.repeatPreviousCommand":new Fe("Repeat the previous Cursorless command"),"cursorless.showQuickPick":new Ae("Pop up a quick pick of all cursorless commands"),"cursorless.showCheatsheet":new Ae("Display the cursorless cheatsheet"),"cursorless.internal.updateCheatsheetDefaults":new Ae("Update the default values of the cheatsheet payload used on the website and for local development. Be sure to run this on stock community and cursorless."),"cursorless.private.logQuickActions":new Ae("Log the quick actions available at the current cursor position"),"cursorless.takeSnapshot":new Ae("Take a snapshot of the current editor state"),"cursorless.keyboard.escape":new Ae("Should be mapped to the escape key when using cursorless keyboard. By default, exits modal keyboard mode, but changes behaviour when Cursorless is expecting a continuation keystroke.  For example, when you type a color and Cursorless is waiting for a character, it cancels the color and switches back to modal mode."),"cursorless.keyboard.targeted.targetHat":new Ae("Sets the keyboard target to the given hat"),"cursorless.keyboard.targeted.targetScope":new Ae("Sets the keyboard target to the scope containing the current target"),"cursorless.keyboard.targeted.targetSelection":new Ae("Sets the keyboard target to the current selection"),"cursorless.keyboard.targeted.clearTarget":new Ae("Clears the current keyboard target"),"cursorless.keyboard.targeted.runActionOnTarget":new Ae("Run the given action on the current keyboard target"),"cursorless.keyboard.modal.modeOn":new Ae("Turn on the cursorless modal mode"),"cursorless.keyboard.modal.modeOff":new Ae("Turn off the cursorless modal mode"),"cursorless.keyboard.modal.modeToggle":new Ae("Toggle the cursorless modal mode"),"cursorless.keyboard.undoTarget":new Ae("Undo keyboard targeting changes"),"cursorless.keyboard.redoTarget":new Ae("Redo keyboard targeting changes"),"cursorless.migrateSnippets":new Ae("Migrate snippets from the old Cursorless format to the new community format")};var Ra=class{constructor(e,r){this.callback=e;this.debounceDelayMs=r;this.timeoutHandle=null;this.run=this.run.bind(this)}run(){this.timeoutHandle!=null&&clearTimeout(this.timeoutHandle),this.timeoutHandle=setTimeout(()=>{this.callback(),this.timeoutHandle=null},this.debounceDelayMs)}dispose(){this.timeoutHandle!=null&&clearTimeout(this.timeoutHandle)}};var ka=class extends Error{constructor(){super("Cursorless Talon version is ahead of Cursorless VSCode extension version. Please update Cursorless VSCode.")}},Ie=class extends Error{constructor(e){super(`Couldn't find containing ${e}.`),this.name="NoContainingScopeError"}};var ov=typeof global=="object"&&global&&global.Object===Object&&global,Aa=ov;var av=typeof self=="object"&&self&&self.Object===Object&&self,sv=Aa||av||Function("return this")(),je=sv;var cv=je.Symbol,nt=cv;var Df=Object.prototype,pv=Df.hasOwnProperty,lv=Df.toString,fo=nt?nt.toStringTag:void 0;function uv(t){var e=pv.call(t,fo),r=t[fo];try{t[fo]=void 0;var n=!0}catch{}var o=lv.call(t);return n&&(e?t[fo]=r:delete t[fo]),o}var Lf=uv;var mv=Object.prototype,dv=mv.toString;function fv(t){return dv.call(t)}var Ff=fv;var gv="[object Null]",hv="[object Undefined]",If=nt?nt.toStringTag:void 0;function yv(t){return t==null?t===void 0?hv:gv:If&&If in Object(t)?Lf(t):Ff(t)}var Bt=yv;function _v(t){return t!=null&&typeof t=="object"}var it=_v;var Tv="[object Symbol]";function xv(t){return typeof t=="symbol"||it(t)&&Bt(t)==Tv}var Tt=xv;function Sv(t,e){for(var r=-1,n=t==null?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}var Rt=Sv;var vv=Array.isArray,_e=vv;var bv=1/0,Cf=nt?nt.prototype:void 0,Of=Cf?Cf.toString:void 0;function Nf(t){if(typeof t=="string")return t;if(_e(t))return Rt(t,Nf)+"";if(Tt(t))return Of?Of.call(t):"";var e=t+"";return e=="0"&&1/t==-bv?"-0":e}var Hf=Nf;var wv=/\s/;function Ev(t){for(var e=t.length;e--&&wv.test(t.charAt(e)););return e}var Uf=Ev;var Rv=/^\s+/;function kv(t){return t&&t.slice(0,Uf(t)+1).replace(Rv,"")}var Vf=kv;function Av(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var xt=Av;var Bf=NaN,Pv=/^[-+]0x[0-9a-f]+$/i,Mv=/^0b[01]+$/i,Dv=/^0o[0-7]+$/i,Lv=parseInt;function Fv(t){if(typeof t=="number")return t;if(Tt(t))return Bf;if(xt(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=xt(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Vf(t);var r=Mv.test(t);return r||Dv.test(t)?Lv(t.slice(2),r?2:8):Pv.test(t)?Bf:+t}var Wf=Fv;var $f=1/0,Iv=17976931348623157e292;function Cv(t){if(!t)return t===0?t:0;if(t=Wf(t),t===$f||t===-$f){var e=t<0?-1:1;return e*Iv}return t===t?t:0}var zn=Cv;function Ov(t){var e=zn(t),r=e%1;return e===e?r?e-r:e:0}var Pa=Ov;function Nv(t){return t}var Jt=Nv;var Hv="[object AsyncFunction]",Uv="[object Function]",Vv="[object GeneratorFunction]",Bv="[object Proxy]";function Wv(t){if(!xt(t))return!1;var e=Bt(t);return e==Uv||e==Vv||e==Hv||e==Bv}var Ma=Wv;var $v=je["__core-js_shared__"],Da=$v;var jf=function(){var t=/[^.]+$/.exec(Da&&Da.keys&&Da.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function jv(t){return!!jf&&jf in t}var qf=jv;var qv=Function.prototype,zv=qv.toString;function Gv(t){if(t!=null){try{return zv.call(t)}catch{}try{return t+""}catch{}}return""}var hr=Gv;var Kv=/[\\^$.*+?()[\]{}|]/g,Qv=/^\[object .+?Constructor\]$/,Jv=Function.prototype,Yv=Object.prototype,Zv=Jv.toString,Xv=Yv.hasOwnProperty,eb=RegExp("^"+Zv.call(Xv).replace(Kv,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function tb(t){if(!xt(t)||qf(t))return!1;var e=Ma(t)?eb:Qv;return e.test(hr(t))}var zf=tb;function rb(t,e){return t?.[e]}var Gf=rb;function nb(t,e){var r=Gf(t,e);return zf(r)?r:void 0}var ct=nb;var ib=ct(je,"WeakMap"),nn=ib;var ob=nn&&new nn,Du=ob;var Kf=Object.create,ab=function(){function t(){}return function(e){if(!xt(e))return{};if(Kf)return Kf(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),La=ab;function sb(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var Qf=sb;function cb(){}var Gn=cb;var pb=4294967295;function Fa(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=pb,this.__views__=[]}Fa.prototype=La(Gn.prototype);Fa.prototype.constructor=Fa;var Kn=Fa;function lb(){}var Ia=lb;var ub=Du?function(t){return Du.get(t)}:Ia,Ca=ub;var mb={},Lu=mb;var db=Object.prototype,fb=db.hasOwnProperty;function gb(t){for(var e=t.name+"",r=Lu[e],n=fb.call(Lu,e)?r.length:0;n--;){var o=r[n],a=o.func;if(a==null||a==t)return o.name}return e}var Qn=gb;function Oa(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}Oa.prototype=La(Gn.prototype);Oa.prototype.constructor=Oa;var Rr=Oa;function hb(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var kr=hb;function yb(t){if(t instanceof Kn)return t.clone();var e=new Rr(t.__wrapped__,t.__chain__);return e.__actions__=kr(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Jf=yb;var _b=Object.prototype,Tb=_b.hasOwnProperty;function Na(t){if(it(t)&&!_e(t)&&!(t instanceof Kn)){if(t instanceof Rr)return t;if(Tb.call(t,"__wrapped__"))return Jf(t)}return new Rr(t)}Na.prototype=Gn.prototype;Na.prototype.constructor=Na;var Yf=Na;function xb(t){var e=Qn(t),r=Yf[e];if(typeof r!="function"||!(e in Kn.prototype))return!1;if(t===r)return!0;var n=Ca(r);return!!n&&t===n[0]}var Fu=xb;var Sb=800,vb=16,bb=Date.now;function wb(t){var e=0,r=0;return function(){var n=bb(),o=vb-(n-r);if(r=n,o>0){if(++e>=Sb)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var Zf=wb;function Eb(t){return function(){return t}}var Xf=Eb;var Rb=function(){try{var t=ct(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Iu=Rb;var kb=Iu?function(t,e){return Iu(t,"toString",{configurable:!0,enumerable:!1,value:Xf(e),writable:!0})}:Jt,eg=kb;var Ab=Zf(eg),Ha=Ab;function Pb(t,e,r,n){for(var o=t.length,a=r+(n?1:-1);n?a--:++a<o;)if(e(t[a],a,t))return a;return-1}var Ua=Pb;function Mb(t){return t!==t}var tg=Mb;function Db(t,e,r){for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1}var rg=Db;function Lb(t,e,r){return e===e?rg(t,e,r):Ua(t,tg,r)}var Va=Lb;function Fb(t,e){var r=t==null?0:t.length;return!!r&&Va(t,e,0)>-1}var ng=Fb;var Ib=9007199254740991,Cb=/^(?:0|[1-9]\d*)$/;function Ob(t,e){var r=typeof t;return e=e??Ib,!!e&&(r=="number"||r!="symbol"&&Cb.test(t))&&t>-1&&t%1==0&&t<e}var Jn=Ob;function Nb(t,e){return t===e||t!==t&&e!==e}var Yn=Nb;var ig=Math.max;function Hb(t,e,r){return e=ig(e===void 0?t.length-1:e,0),function(){for(var n=arguments,o=-1,a=ig(n.length-e,0),s=Array(a);++o<a;)s[o]=n[e+o];o=-1;for(var c=Array(e+1);++o<e;)c[o]=n[o];return c[e]=r(s),Qf(t,this,c)}}var Ba=Hb;function Ub(t,e){return Ha(Ba(t,e,Jt),t+"")}var Zn=Ub;var Vb=9007199254740991;function Bb(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Vb}var Xn=Bb;function Wb(t){return t!=null&&Xn(t.length)&&!Ma(t)}var Yt=Wb;function $b(t,e,r){if(!xt(r))return!1;var n=typeof e;return(n=="number"?Yt(r)&&Jn(e,r.length):n=="string"&&e in r)?Yn(r[e],t):!1}var on=$b;var jb=Object.prototype;function qb(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||jb;return t===r}var og=qb;function zb(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var Wa=zb;var Gb="[object Arguments]";function Kb(t){return it(t)&&Bt(t)==Gb}var Cu=Kb;var ag=Object.prototype,Qb=ag.hasOwnProperty,Jb=ag.propertyIsEnumerable,Yb=Cu(function(){return arguments}())?Cu:function(t){return it(t)&&Qb.call(t,"callee")&&!Jb.call(t,"callee")},ei=Yb;function Zb(){return!1}var sg=Zb;var lg=typeof exports=="object"&&exports&&!exports.nodeType&&exports,cg=lg&&typeof module=="object"&&module&&!module.nodeType&&module,Xb=cg&&cg.exports===lg,pg=Xb?je.Buffer:void 0,ew=pg?pg.isBuffer:void 0,tw=ew||sg,go=tw;var rw="[object Arguments]",nw="[object Array]",iw="[object Boolean]",ow="[object Date]",aw="[object Error]",sw="[object Function]",cw="[object Map]",pw="[object Number]",lw="[object Object]",uw="[object RegExp]",mw="[object Set]",dw="[object String]",fw="[object WeakMap]",gw="[object ArrayBuffer]",hw="[object DataView]",yw="[object Float32Array]",_w="[object Float64Array]",Tw="[object Int8Array]",xw="[object Int16Array]",Sw="[object Int32Array]",vw="[object Uint8Array]",bw="[object Uint8ClampedArray]",ww="[object Uint16Array]",Ew="[object Uint32Array]",xe={};xe[yw]=xe[_w]=xe[Tw]=xe[xw]=xe[Sw]=xe[vw]=xe[bw]=xe[ww]=xe[Ew]=!0;xe[rw]=xe[nw]=xe[gw]=xe[iw]=xe[hw]=xe[ow]=xe[aw]=xe[sw]=xe[cw]=xe[pw]=xe[lw]=xe[uw]=xe[mw]=xe[dw]=xe[fw]=!1;function Rw(t){return it(t)&&Xn(t.length)&&!!xe[Bt(t)]}var ug=Rw;function kw(t){return function(e){return t(e)}}var ti=kw;var mg=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ho=mg&&typeof module=="object"&&module&&!module.nodeType&&module,Aw=ho&&ho.exports===mg,Ou=Aw&&Aa.process,Pw=function(){try{var t=ho&&ho.require&&ho.require("util").types;return t||Ou&&Ou.binding&&Ou.binding("util")}catch{}}(),Nu=Pw;var dg=Nu&&Nu.isTypedArray,Mw=dg?ti(dg):ug,$a=Mw;var Dw=Object.prototype,Lw=Dw.hasOwnProperty;function Fw(t,e){var r=_e(t),n=!r&&ei(t),o=!r&&!n&&go(t),a=!r&&!n&&!o&&$a(t),s=r||n||o||a,c=s?Wa(t.length,String):[],p=c.length;for(var l in t)(e||Lw.call(t,l))&&!(s&&(l=="length"||o&&(l=="offset"||l=="parent")||a&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||Jn(l,p)))&&c.push(l);return c}var fg=Fw;function Iw(t,e){return function(r){return t(e(r))}}var gg=Iw;var Cw=gg(Object.keys,Object),hg=Cw;var Ow=Object.prototype,Nw=Ow.hasOwnProperty;function Hw(t){if(!og(t))return hg(t);var e=[];for(var r in Object(t))Nw.call(t,r)&&r!="constructor"&&e.push(r);return e}var yg=Hw;function Uw(t){return Yt(t)?fg(t):yg(t)}var Ar=Uw;var Vw=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Bw=/^\w*$/;function Ww(t,e){if(_e(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||Tt(t)?!0:Bw.test(t)||!Vw.test(t)||e!=null&&t in Object(e)}var ri=Ww;var $w=ct(Object,"create"),yr=$w;function jw(){this.__data__=yr?yr(null):{},this.size=0}var _g=jw;function qw(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Tg=qw;var zw="__lodash_hash_undefined__",Gw=Object.prototype,Kw=Gw.hasOwnProperty;function Qw(t){var e=this.__data__;if(yr){var r=e[t];return r===zw?void 0:r}return Kw.call(e,t)?e[t]:void 0}var xg=Qw;var Jw=Object.prototype,Yw=Jw.hasOwnProperty;function Zw(t){var e=this.__data__;return yr?e[t]!==void 0:Yw.call(e,t)}var Sg=Zw;var Xw="__lodash_hash_undefined__";function eE(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=yr&&e===void 0?Xw:e,this}var vg=eE;function ni(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ni.prototype.clear=_g;ni.prototype.delete=Tg;ni.prototype.get=xg;ni.prototype.has=Sg;ni.prototype.set=vg;var Hu=ni;function tE(){this.__data__=[],this.size=0}var bg=tE;function rE(t,e){for(var r=t.length;r--;)if(Yn(t[r][0],e))return r;return-1}var Pr=rE;var nE=Array.prototype,iE=nE.splice;function oE(t){var e=this.__data__,r=Pr(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():iE.call(e,r,1),--this.size,!0}var wg=oE;function aE(t){var e=this.__data__,r=Pr(e,t);return r<0?void 0:e[r][1]}var Eg=aE;function sE(t){return Pr(this.__data__,t)>-1}var Rg=sE;function cE(t,e){var r=this.__data__,n=Pr(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}var kg=cE;function ii(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ii.prototype.clear=bg;ii.prototype.delete=wg;ii.prototype.get=Eg;ii.prototype.has=Rg;ii.prototype.set=kg;var Mr=ii;var pE=ct(je,"Map"),Dr=pE;function lE(){this.size=0,this.__data__={hash:new Hu,map:new(Dr||Mr),string:new Hu}}var Ag=lE;function uE(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var Pg=uE;function mE(t,e){var r=t.__data__;return Pg(e)?r[typeof e=="string"?"string":"hash"]:r.map}var Lr=mE;function dE(t){var e=Lr(this,t).delete(t);return this.size-=e?1:0,e}var Mg=dE;function fE(t){return Lr(this,t).get(t)}var Dg=fE;function gE(t){return Lr(this,t).has(t)}var Lg=gE;function hE(t,e){var r=Lr(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}var Fg=hE;function oi(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}oi.prototype.clear=Ag;oi.prototype.delete=Mg;oi.prototype.get=Dg;oi.prototype.has=Lg;oi.prototype.set=Fg;var an=oi;var yE="Expected a function";function Uu(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(yE);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],a=r.cache;if(a.has(o))return a.get(o);var s=t.apply(this,n);return r.cache=a.set(o,s)||a,s};return r.cache=new(Uu.Cache||an),r}Uu.Cache=an;var yo=Uu;var _E=500;function TE(t){var e=yo(t,function(n){return r.size===_E&&r.clear(),n}),r=e.cache;return e}var Ig=TE;var xE=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,SE=/\\(\\)?/g,vE=Ig(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(xE,function(r,n,o,a){e.push(o?a.replace(SE,"$1"):n||r)}),e}),Cg=vE;function bE(t){return t==null?"":Hf(t)}var Wt=bE;function wE(t,e){return _e(t)?t:ri(t,e)?[t]:Cg(Wt(t))}var ja=wE;var EE=1/0;function RE(t){if(typeof t=="string"||Tt(t))return t;var e=t+"";return e=="0"&&1/t==-EE?"-0":e}var Fr=RE;function kE(t,e){e=ja(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[Fr(e[r++])];return r&&r==n?t:void 0}var ai=kE;function AE(t,e,r){var n=t==null?void 0:ai(t,e);return n===void 0?r:n}var _o=AE;function PE(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}var si=PE;var Og=nt?nt.isConcatSpreadable:void 0;function ME(t){return _e(t)||ei(t)||!!(Og&&t&&t[Og])}var Ng=ME;function Hg(t,e,r,n,o){var a=-1,s=t.length;for(r||(r=Ng),o||(o=[]);++a<s;){var c=t[a];e>0&&r(c)?e>1?Hg(c,e-1,r,n,o):si(o,c):n||(o[o.length]=c)}return o}var ci=Hg;function DE(t){var e=t==null?0:t.length;return e?ci(t,1):[]}var Se=DE;function LE(t){return Ha(Ba(t,void 0,Se),t+"")}var Ug=LE;function FE(t){return function(e){return t?.[e]}}var Vg=FE;var IE={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},CE=Vg(IE),Bg=CE;var OE=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,NE="\\u0300-\\u036f",HE="\\ufe20-\\ufe2f",UE="\\u20d0-\\u20ff",VE=NE+HE+UE,BE="["+VE+"]",WE=RegExp(BE,"g");function $E(t){return t=Wt(t),t&&t.replace(OE,Bg).replace(WE,"")}var Vu=$E;function jE(){this.__data__=new Mr,this.size=0}var Wg=jE;function qE(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var $g=qE;function zE(t){return this.__data__.get(t)}var jg=zE;function GE(t){return this.__data__.has(t)}var qg=GE;var KE=200;function QE(t,e){var r=this.__data__;if(r instanceof Mr){var n=r.__data__;if(!Dr||n.length<KE-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new an(n)}return r.set(t,e),this.size=r.size,this}var zg=QE;function pi(t){var e=this.__data__=new Mr(t);this.size=e.size}pi.prototype.clear=Wg;pi.prototype.delete=$g;pi.prototype.get=jg;pi.prototype.has=qg;pi.prototype.set=zg;var li=pi;function JE(t,e){for(var r=-1,n=t==null?0:t.length,o=0,a=[];++r<n;){var s=t[r];e(s,r,t)&&(a[o++]=s)}return a}var qa=JE;function YE(){return[]}var Gg=YE;var ZE=Object.prototype,XE=ZE.propertyIsEnumerable,Kg=Object.getOwnPropertySymbols,eR=Kg?function(t){return t==null?[]:(t=Object(t),qa(Kg(t),function(e){return XE.call(t,e)}))}:Gg,Qg=eR;function tR(t,e,r){var n=e(t);return _e(t)?n:si(n,r(t))}var Jg=tR;function rR(t){return Jg(t,Ar,Qg)}var Bu=rR;var nR=ct(je,"DataView"),za=nR;var iR=ct(je,"Promise"),Ga=iR;var oR=ct(je,"Set"),Ir=oR;var Yg="[object Map]",aR="[object Object]",Zg="[object Promise]",Xg="[object Set]",eh="[object WeakMap]",th="[object DataView]",sR=hr(za),cR=hr(Dr),pR=hr(Ga),lR=hr(Ir),uR=hr(nn),sn=Bt;(za&&sn(new za(new ArrayBuffer(1)))!=th||Dr&&sn(new Dr)!=Yg||Ga&&sn(Ga.resolve())!=Zg||Ir&&sn(new Ir)!=Xg||nn&&sn(new nn)!=eh)&&(sn=function(t){var e=Bt(t),r=e==aR?t.constructor:void 0,n=r?hr(r):"";if(n)switch(n){case sR:return th;case cR:return Yg;case pR:return Zg;case lR:return Xg;case uR:return eh}return e});var Wu=sn;var mR=je.Uint8Array,$u=mR;function dR(){var t=arguments.length;if(!t)return[];for(var e=Array(t-1),r=arguments[0],n=t;n--;)e[n-1]=arguments[n];return si(_e(r)?kr(r):[r],ci(e,1))}var To=dR;var fR="__lodash_hash_undefined__";function gR(t){return this.__data__.set(t,fR),this}var rh=gR;function hR(t){return this.__data__.has(t)}var nh=hR;function Ka(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new an;++e<r;)this.add(t[e])}Ka.prototype.add=Ka.prototype.push=rh;Ka.prototype.has=nh;var Qa=Ka;function yR(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}var ih=yR;function _R(t,e){return t.has(e)}var Ja=_R;var TR=1,xR=2;function SR(t,e,r,n,o,a){var s=r&TR,c=t.length,p=e.length;if(c!=p&&!(s&&p>c))return!1;var l=a.get(t),u=a.get(e);if(l&&u)return l==e&&u==t;var m=-1,d=!0,g=r&xR?new Qa:void 0;for(a.set(t,e),a.set(e,t);++m<c;){var b=t[m],w=e[m];if(n)var I=s?n(w,b,m,e,t,a):n(b,w,m,t,e,a);if(I!==void 0){if(I)continue;d=!1;break}if(g){if(!ih(e,function(L,H){if(!Ja(g,H)&&(b===L||o(b,L,r,n,a)))return g.push(H)})){d=!1;break}}else if(!(b===w||o(b,w,r,n,a))){d=!1;break}}return a.delete(t),a.delete(e),d}var Ya=SR;function vR(t){var e=-1,r=Array(t.size);return t.forEach(function(n,o){r[++e]=[o,n]}),r}var oh=vR;function bR(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var ui=bR;var wR=1,ER=2,RR="[object Boolean]",kR="[object Date]",AR="[object Error]",PR="[object Map]",MR="[object Number]",DR="[object RegExp]",LR="[object Set]",FR="[object String]",IR="[object Symbol]",CR="[object ArrayBuffer]",OR="[object DataView]",ah=nt?nt.prototype:void 0,ju=ah?ah.valueOf:void 0;function NR(t,e,r,n,o,a,s){switch(r){case OR:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case CR:return!(t.byteLength!=e.byteLength||!a(new $u(t),new $u(e)));case RR:case kR:case MR:return Yn(+t,+e);case AR:return t.name==e.name&&t.message==e.message;case DR:case FR:return t==e+"";case PR:var c=oh;case LR:var p=n&wR;if(c||(c=ui),t.size!=e.size&&!p)return!1;var l=s.get(t);if(l)return l==e;n|=ER,s.set(t,e);var u=Ya(c(t),c(e),n,o,a,s);return s.delete(t),u;case IR:if(ju)return ju.call(t)==ju.call(e)}return!1}var sh=NR;var HR=1,UR=Object.prototype,VR=UR.hasOwnProperty;function BR(t,e,r,n,o,a){var s=r&HR,c=Bu(t),p=c.length,l=Bu(e),u=l.length;if(p!=u&&!s)return!1;for(var m=p;m--;){var d=c[m];if(!(s?d in e:VR.call(e,d)))return!1}var g=a.get(t),b=a.get(e);if(g&&b)return g==e&&b==t;var w=!0;a.set(t,e),a.set(e,t);for(var I=s;++m<p;){d=c[m];var L=t[d],H=e[d];if(n)var X=s?n(H,L,d,e,t,a):n(L,H,d,t,e,a);if(!(X===void 0?L===H||o(L,H,r,n,a):X)){w=!1;break}I||(I=d=="constructor")}if(w&&!I){var fe=t.constructor,J=e.constructor;fe!=J&&"constructor"in t&&"constructor"in e&&!(typeof fe=="function"&&fe instanceof fe&&typeof J=="function"&&J instanceof J)&&(w=!1)}return a.delete(t),a.delete(e),w}var ch=BR;var WR=1,ph="[object Arguments]",lh="[object Array]",Za="[object Object]",$R=Object.prototype,uh=$R.hasOwnProperty;function jR(t,e,r,n,o,a){var s=_e(t),c=_e(e),p=s?lh:Wu(t),l=c?lh:Wu(e);p=p==ph?Za:p,l=l==ph?Za:l;var u=p==Za,m=l==Za,d=p==l;if(d&&go(t)){if(!go(e))return!1;s=!0,u=!1}if(d&&!u)return a||(a=new li),s||$a(t)?Ya(t,e,r,n,o,a):sh(t,e,p,r,n,o,a);if(!(r&WR)){var g=u&&uh.call(t,"__wrapped__"),b=m&&uh.call(e,"__wrapped__");if(g||b){var w=g?t.value():t,I=b?e.value():e;return a||(a=new li),o(w,I,r,n,a)}}return d?(a||(a=new li),ch(t,e,r,n,o,a)):!1}var mh=jR;function dh(t,e,r,n,o){return t===e?!0:t==null||e==null||!it(t)&&!it(e)?t!==t&&e!==e:mh(t,e,r,n,dh,o)}var mi=dh;var qR=1,zR=2;function GR(t,e,r,n){var o=r.length,a=o,s=!n;if(t==null)return!a;for(t=Object(t);o--;){var c=r[o];if(s&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++o<a;){c=r[o];var p=c[0],l=t[p],u=c[1];if(s&&c[2]){if(l===void 0&&!(p in t))return!1}else{var m=new li;if(n)var d=n(l,u,p,t,e,m);if(!(d===void 0?mi(u,l,qR|zR,n,m):d))return!1}}return!0}var fh=GR;function KR(t){return t===t&&!xt(t)}var Xa=KR;function QR(t){for(var e=Ar(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,Xa(o)]}return e}var gh=QR;function JR(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var es=JR;function YR(t){var e=gh(t);return e.length==1&&e[0][2]?es(e[0][0],e[0][1]):function(r){return r===t||fh(r,t,e)}}var hh=YR;function ZR(t,e){return t!=null&&e in Object(t)}var yh=ZR;function XR(t,e,r){e=ja(e,t);for(var n=-1,o=e.length,a=!1;++n<o;){var s=Fr(e[n]);if(!(a=t!=null&&r(t,s)))break;t=t[s]}return a||++n!=o?a:(o=t==null?0:t.length,!!o&&Xn(o)&&Jn(s,o)&&(_e(t)||ei(t)))}var _h=XR;function ek(t,e){return t!=null&&_h(t,e,yh)}var Th=ek;var tk=1,rk=2;function nk(t,e){return ri(t)&&Xa(e)?es(Fr(t),e):function(r){var n=_o(r,t);return n===void 0&&n===e?Th(r,t):mi(e,n,tk|rk)}}var xh=nk;function ik(t){return function(e){return e?.[t]}}var ts=ik;function ok(t){return function(e){return ai(e,t)}}var Sh=ok;function ak(t){return ri(t)?ts(Fr(t)):Sh(t)}var vh=ak;function sk(t){return typeof t=="function"?t:t==null?Jt:typeof t=="object"?_e(t)?xh(t[0],t[1]):hh(t):vh(t)}var di=sk;function ck(t){return function(e,r,n){for(var o=-1,a=Object(e),s=n(e),c=s.length;c--;){var p=s[t?c:++o];if(r(a[p],p,a)===!1)break}return e}}var bh=ck;var pk=bh(),wh=pk;function lk(t,e){return t&&wh(t,e,Ar)}var Eh=lk;function uk(t,e){return function(r,n){if(r==null)return r;if(!Yt(r))return t(r,n);for(var o=r.length,a=e?o:-1,s=Object(r);(e?a--:++a<o)&&n(s[a],a,s)!==!1;);return r}}var Rh=uk;var mk=Rh(Eh),kh=mk;function dk(t){return it(t)&&Yt(t)}var Ah=dk;function fk(t,e,r){for(var n=-1,o=t==null?0:t.length;++n<o;)if(r(e,t[n]))return!0;return!1}var Ph=fk;function gk(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var rs=gk;var Mh=/[\\^$.*+?()[\]{}|]/g,hk=RegExp(Mh.source);function yk(t){return t=Wt(t),t&&hk.test(t)?t.replace(Mh,"\\$&"):t}var St=yk;var _k=Math.max,Tk=Math.min;function xk(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var o=n-1;return r!==void 0&&(o=Pa(r),o=r<0?_k(n+o,0):Tk(o,n-1)),Ua(t,di(e,3),o,!0)}var cn=xk;function Sk(t,e){var r=-1,n=Yt(t)?Array(t.length):[];return kh(t,function(o,a,s){n[++r]=e(o,a,s)}),n}var Dh=Sk;var vk="Expected a function",bk=8,wk=32,Ek=128,Rk=256;function kk(t){return Ug(function(e){var r=e.length,n=r,o=Rr.prototype.thru;for(t&&e.reverse();n--;){var a=e[n];if(typeof a!="function")throw new TypeError(vk);if(o&&!s&&Qn(a)=="wrapper")var s=new Rr([],!0)}for(n=s?n:r;++n<r;){a=e[n];var c=Qn(a),p=c=="wrapper"?Ca(a):void 0;p&&Fu(p[0])&&p[1]==(Ek|bk|wk|Rk)&&!p[4].length&&p[9]==1?s=s[Qn(p[0])].apply(s,p[3]):s=a.length==1&&Fu(a)?s[c]():s.thru(a)}return function(){var l=arguments,u=l[0];if(s&&l.length==1&&_e(u))return s.plant(u).value();for(var m=0,d=r?e[m].apply(this,l):u;++m<r;)d=e[m].call(this,d);return d}})}var Lh=kk;var Ak=Lh(),qu=Ak;function Pk(t,e){return Rt(e,function(r){return t[r]})}var Fh=Pk;function Mk(t){return t==null?[]:Fh(t,Ar(t))}var Ih=Mk;function Dk(t,e){return mi(t,e)}var _r=Dk;function Lk(t,e){return t<e}var Ch=Lk;function Fk(t,e,r){for(var n=-1,o=t.length;++n<o;){var a=t[n],s=e(a);if(s!=null&&(c===void 0?s===s&&!Tt(s):r(s,c)))var c=s,p=a}return p}var Oh=Fk;function Ik(t,e){for(var r,n=-1,o=t.length;++n<o;){var a=e(t[n]);a!==void 0&&(r=r===void 0?a:r+a)}return r}var Nh=Ik;function Ck(t){return t&&t.length?Oh(t,Jt,Ch):void 0}var zu=Ck;function Ok(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}var Hh=Ok;function Nk(t,e){if(t!==e){var r=t!==void 0,n=t===null,o=t===t,a=Tt(t),s=e!==void 0,c=e===null,p=e===e,l=Tt(e);if(!c&&!l&&!a&&t>e||a&&s&&p&&!c&&!l||n&&s&&p||!r&&p||!o)return 1;if(!n&&!a&&!l&&t<e||l&&r&&o&&!n&&!a||c&&r&&o||!s&&o||!p)return-1}return 0}var Uh=Nk;function Hk(t,e,r){for(var n=-1,o=t.criteria,a=e.criteria,s=o.length,c=r.length;++n<s;){var p=Uh(o[n],a[n]);if(p){if(n>=c)return p;var l=r[n];return p*(l=="desc"?-1:1)}}return t.index-e.index}var Vh=Hk;function Uk(t,e,r){e.length?e=Rt(e,function(a){return _e(a)?function(s){return ai(s,a.length===1?a[0]:a)}:a}):e=[Jt];var n=-1;e=Rt(e,ti(di));var o=Dh(t,function(a,s,c){var p=Rt(e,function(l){return l(a)});return{criteria:p,index:++n,value:a}});return Hh(o,function(a,s){return Vh(a,s,r)})}var Bh=Uk;var Vk=9007199254740991,Bk=Math.floor;function Wk(t,e){var r="";if(!t||e<1||e>Vk)return r;do e%2&&(r+=t),e=Bk(e/2),e&&(t+=t);while(e);return r}var Wh=Wk;function $k(t,e,r,n){for(var o=r-1,a=t.length;++o<a;)if(n(t[o],e))return o;return-1}var $h=$k;var jk=Array.prototype,jh=jk.splice;function qk(t,e,r,n){var o=n?$h:Va,a=-1,s=e.length,c=t;for(t===e&&(e=kr(e)),r&&(c=Rt(t,ti(r)));++a<s;)for(var p=0,l=e[a],u=r?r(l):l;(p=o(c,u,p,n))>-1;)c!==t&&jh.call(c,p,1),jh.call(t,p,1);return t}var qh=qk;function zk(t,e){return t&&t.length&&e&&e.length?qh(t,e):t}var zh=zk;var Gk=Zn(zh),ot=Gk;var Kk=Math.floor,Qk=Math.random;function Jk(t,e){return t+Kk(Qk()*(e-t+1))}var Gh=Jk;var Yk=Math.ceil,Zk=Math.max;function Xk(t,e,r,n){for(var o=-1,a=Zk(Yk((e-t)/(r||1)),0),s=Array(a);a--;)s[n?a:++o]=t,t+=r;return s}var Kh=Xk;function e0(t){return function(e,r,n){return n&&typeof n!="number"&&on(e,r,n)&&(r=n=void 0),e=zn(e),r===void 0?(r=e,e=0):r=zn(r),n=n===void 0?e<r?1:-1:zn(n),Kh(e,r,n,t)}}var Qh=e0;var t0=Qh(),Gu=t0;function r0(t,e,r){return(r?on(t,e,r):e===void 0)?e=1:e=Pa(e),Wh(Wt(t),e)}var Ku=r0;function n0(t,e){var r=-1,n=t.length,o=n-1;for(e=e===void 0?n:e;++r<e;){var a=Gh(r,o),s=t[a];t[a]=t[r],t[r]=s}return t.length=e,t}var ns=n0;function i0(t){return ns(kr(t))}var Jh=i0;function o0(t){return ns(Ih(t))}var Yh=o0;function a0(t){var e=_e(t)?Jh:Yh;return e(t)}var Qu=a0;var s0=Zn(function(t,e){if(t==null)return[];var r=e.length;return r>1&&on(t,e[0],e[1])?e=[]:r>2&&on(e[0],e[1],e[2])&&(e=[e[0]]),Bh(t,ci(e,1),[])}),Ju=s0;function c0(t,e){return t&&t.length?Nh(t,di(e,2)):0}var is=c0;var p0=1/0,l0=Ir&&1/ui(new Ir([,-0]))[1]==p0?function(t){return new Ir(t)}:Ia,Zh=l0;var u0=200;function m0(t,e,r){var n=-1,o=ng,a=t.length,s=!0,c=[],p=c;if(r)s=!1,o=Ph;else if(a>=u0){var l=e?null:Zh(t);if(l)return ui(l);s=!1,o=Ja,p=new Qa}else p=e?[]:c;e:for(;++n<a;){var u=t[n],m=e?e(u):u;if(u=r||u!==0?u:0,s&&m===m){for(var d=p.length;d--;)if(p[d]===m)continue e;e&&p.push(m),c.push(u)}else o(p,m,r)||(p!==c&&p.push(m),c.push(u))}return c}var os=m0;function d0(t){return t&&t.length?os(t):[]}var pn=d0;function f0(t,e){return e=typeof e=="function"?e:void 0,t&&t.length?os(t,void 0,e):[]}var xo=f0;var g0=Math.max;function h0(t){if(!(t&&t.length))return[];var e=0;return t=qa(t,function(r){if(Ah(r))return e=g0(r.length,e),!0}),Wa(e,function(r){return Rt(t,ts(r))})}var Xh=h0;var y0=Zn(Xh),Be=y0;var Pe=class{constructor(){this.listeners=[];this.notifyListeners=(...e)=>{this.listeners.forEach(r=>r(...e))};this.registerListener=this.registerListener.bind(this)}registerListener(e){return this.listeners.push(e),{dispose:()=>{ot(this.listeners,e)}}}};var Yu={tokenHatSplittingMode:{preserveCase:!1,lettersToPreserve:[],symbolsToPreserve:[]},wordSeparators:["_"],decorationDebounceDelayMs:50,experimental:{snippetsDir:void 0,hatStability:"balanced",keyboardTargetFollowsSelection:!1},commandHistory:!1,debug:!1};var Zu={hideInferenceWarning:!1,tutorialProgress:{}};var pe=class t{constructor(e,r){this.line=e,this.character=r}isEqual(e){return this.line===e.line&&this.character===e.character}isBefore(e){return this.line<e.line?!0:this.line>e.line?!1:this.character<e.character}isAfter(e){return this.line>e.line?!0:this.line<e.line?!1:this.character>e.character}isBeforeOrEqual(e){return this.isEqual(e)||this.isBefore(e)}isAfterOrEqual(e){return this.isEqual(e)||this.isAfter(e)}compareTo(e){return this.isBefore(e)?-1:this.isAfter(e)?1:0}with(e,r){return new t(e??this.line,r??this.character)}translate(e,r){return new t(this.line+(e??0),this.character+(r??0))}toEmptyRange(){return new D(this,this)}concise(){return`${this.line}:${this.character}`}conciseOneBased(){return`${this.line+1}:${this.character+1}`}toString(){return this.concise()}};function ey(t,e,r){return t.positionAt(t.offsetAt(e)+r)}var D=class t{constructor(...e){let[r,n]=e.length===2?e:[new pe(e[0],e[1]),new pe(e[2],e[3])];r.isBefore(n)?(this.start=r,this.end=n):(this.start=n,this.end=r)}get isEmpty(){return this.start.isEqual(this.end)}get isSingleLine(){return this.start.line===this.end.line}isRangeEqual(e){return this.start.isEqual(e.start)&&this.end.isEqual(e.end)}contains(e){let[r,n]=e instanceof pe?[e,e]:[e.start,e.end];return r.isAfterOrEqual(this.start)&&n.isBeforeOrEqual(this.end)}intersection(e){let r=this.start.isAfter(e.start)?this.start:e.start,n=this.end.isBefore(e.end)?this.end:e.end;return r.isBeforeOrEqual(n)?new t(r,n):void 0}union(e){return new t(this.start.isBefore(e.start)?this.start:e.start,this.end.isAfter(e.end)?this.end:e.end)}with(e,r){return new t(e??this.start,r??this.end)}toSelection(e){return e?new Me(this.end,this.start):new Me(this.start,this.end)}concise(){return`${this.start.concise()}-${this.end.concise()}`}conciseOneBased(){return`${this.start.conciseOneBased()}-${this.end.conciseOneBased()}`}toString(){return`${this.start.concise()}-${this.end.concise()}`}};function T0(t){let{source:e,flags:r}=t;return new RegExp(`(${e})$`,r.replace("m",""))}function x0(t){let{source:e,flags:r}=t;return new RegExp(`^(${e})`,r.replace("m",""))}function ty(t){let e=new Map;function r(n){let o=e.get(n);return o==null&&(o=t(n),e.set(n,o)),o}return r}var as=ty(T0),ss=ty(x0);function Xu(t,e){return e.lastIndex=0,t.matchAll(e)}function kt(t,e,r){return Array.from(Xu(t,e),r)}function ln(t,e){return t.lastIndex=0,t.test(e)}function ry(t,e){return t.lastIndex=0,e.match(t)}function So(t,e){return kt(t,e,r=>({index:r.index,text:r[0]}))}function ny(t){return t.match(/^\s+/)?.[0]??""}function iy(t){return t.match(/\s+$/)?.[0]??""}var cs=class{constructor(e,r,n,o){this.lineNumber=e;this.offset=r;this.text=n;this.isEmptyOrWhitespace=/^\s*$/.test(n),this.lengthIncludingEol=n.length+(o?.length??0);let a=new pe(e,0),s=new pe(e,n.length),c=o!=null?new pe(e+1,0):s;this.range=new D(a,s),this.rangeIncludingLineBreak=new D(a,c),this.rangeTrimmed=this.isEmptyOrWhitespace?void 0:new D(a.translate(void 0,ny(n).length),s.translate(void 0,-iy(n).length))}};function ay(t,e){let r=S0(t,e),n=t.getText();for(let o of r){let{text:a,rangeOffset:s,rangeLength:c}=o;n=n.slice(0,s)+a+n.slice(s+c)}return{text:n,changes:r}}function S0(t,e){let r=[],n=e.map((a,s)=>({edit:a,index:s})).sort((a,s)=>a.edit.range.start.isEqual(s.edit.range.start)?s.index-a.index:s.edit.range.start.compareTo(a.edit.range.start)).map(({edit:a})=>a),o=t.eol==="LF"?`
`:`\r
`;for(let a of n){let s=r[r.length-1],c=s?.range.intersection(a.range);if(c!=null&&!c.isEmpty){if(!s.text&&!a.text){r[r.length-1]=oy(t,s.range.union(a.range),"");continue}throw Error("Overlapping ranges are not allowed!")}let p=a.text.replace(/\r?\n/g,o);r.push(oy(t,a.range,p))}return r}function oy(t,e,r){let n=t.offsetAt(e.start),o=t.offsetAt(e.end);return{text:r,range:e,rangeOffset:n,rangeLength:o-n}}var fi=class{constructor(e,r,n){this.uri=e;this.languageId=r;this.filename=e.path.split(/\\|\//g).at(-1)??"",this._text="",this._eol="LF",this._version=-1,this._lines=[],this.setTextInternal(n)}get version(){return this._version}get lineCount(){return this._lines.length}get eol(){return this._eol}get text(){return this._text}get range(){return new D(this._lines[0].range.start,this._lines.at(-1).range.end)}setTextInternal(e){this._text=e,this._eol=e.includes(`\r
`)?"CRLF":"LF",this._version++,this._lines=v0(e)}lineAt(e){let r=typeof e=="number"?e:e.line,n=sy(r,0,this.lineCount-1);return this._lines[n]}offsetAt(e){if(e.line<0)return 0;if(e.line>this._lines.length-1)return this._text.length;let r=this._lines[e.line];return r.offset+sy(e.character,0,r.text.length)}positionAt(e){if(e<=0)return this.range.start;if(e>=this._text.length)return this.range.end;let r=this._lines.find(n=>e<n.offset+n.lengthIncludingEol);if(r==null)throw Error(`Couldn't find line for offset ${e}`);return new pe(r.lineNumber,Math.min(e-r.offset,r.text.length))}getText(e){if(e==null)return this.text;let r=this.offsetAt(e.start),n=this.offsetAt(e.end);return this.text.slice(r,n)}edit(e){let{text:r,changes:n}=ay(this,e);return this.setTextInternal(r),n}};function v0(t){let e=t.split(/(\r?\n)/g),r=[],n=0;for(let o=0;o<e.length;o+=2){let a=new cs(r.length,n,e[o],e[o+1]);r.push(a),n+=a.lengthIncludingEol}return r}function sy(t,e,r){return Math.min(Math.max(t,e),r)}function un(t,e,r,...n){return t.showMessage("warning",e,r,...n)}function De(t,e,r,...n){return t.showMessage("error",e,r,...n)}var G=(n=>(n[n.supported=0]="supported",n[n.unsupported=1]="unsupported",n[n.notApplicable=2]="notApplicable",n))(G||{});var{supported:V,unsupported:w0,notApplicable:F}=G,em={list:V,disqualifyDelimiter:V,switchStatementSubject:V,ifStatement:V,statement:V,"statement.class":V,"statement.iteration.document":V,"statement.iteration.block":V,class:V,"class.iteration.document":V,className:V,"className.iteration.document":V,"collectionItem.unenclosed":V,"collectionItem.unenclosed.iteration":V,namedFunction:V,functionName:V,"functionName.iteration.document":V,"namedFunction.iteration.document":V,functionCall:V,functionCallee:V,"argument.actual":V,"argument.actual.iteration":V,"argument.actual.method":V,"argument.actual.method.iteration":V,"argument.formal":V,"argument.formal.iteration":V,"argumentList.actual.empty":V,"argumentList.actual.singleLine":V,"argumentList.actual.multiLine":V,"argumentList.actual.method.empty":V,"argumentList.actual.method.singleLine":V,"argumentList.actual.method.multiLine":V,"argumentList.formal.empty":V,"argumentList.formal.singleLine":V,"argumentList.formal.multiLine":V,"branch.if":V,"branch.if.iteration":V,"branch.switchCase":V,"branch.switchCase.iteration":V,"branch.ternary":V,"branch.loop":V,"comment.line":V,"comment.block":V,"string.singleLine":V,"textFragment.comment.line":V,"textFragment.comment.block":V,"textFragment.string.singleLine":V,"condition.if":V,"condition.while":V,"condition.doWhile":V,"condition.for":V,"condition.ternary":V,"condition.switchCase":V,"condition.switchCase.iteration":V,"name.assignment":V,"name.variable":V,"name.function":V,"name.class":V,"name.field":V,"name.iteration.block":V,"name.iteration.document":V,"name.argument.formal":V,"name.argument.formal.iteration":V,"value.assignment":V,"value.variable":V,"value.return":V,"type.variable":V,"type.argument.formal":V,"type.argument.formal.iteration":V,"type.field":V,"type.field.iteration":V,"type.enum":V,"type.cast":V,"type.class":V,"type.return":V,"interior.class":V,"interior.function":V,"interior.if":V,"interior.switchCase":V,"interior.ternary":V,"interior.loop":V,fieldAccess:w0,element:F,tags:F,startTag:F,endTag:F,"interior.element":F,"textFragment.element":F,"interior.resource":F,"type.resource":F,"type.resource.iteration":F,"name.resource":F,"name.resource.iteration":F,"value.resource":F,"value.resource.iteration":F,map:F,"key.mapPair":F,"key.mapPair.iteration":F,"value.mapPair":F,"value.mapPair.iteration":F,"name.argument.actual":F,"name.argument.actual.iteration":F,"value.argument.actual":F,"value.argument.actual.iteration":F,"string.multiLine":F,"textFragment.string.multiLine":F,section:F,"section.iteration.document":F,"section.iteration.parent":F,"name.assignment.pattern":F,"name.variable.pattern":F,"value.variable.pattern":F,command:F,"interior.command":F,"type.alias":F,"value.typeAlias":F,notebookCell:F,"interior.cell":F,"class.iteration.block":F,"className.iteration.block":F,"functionName.iteration.block":F,"namedFunction.iteration.block":F,"branch.try":F,"branch.try.iteration":F,"interior.try":F,"key.attribute":F,"type.interface":F,"value.attribute":F,"value.yield":F,"value.field":F,environment:F,pairDelimiter:F,regularExpression:F},E0={...em,attribute:F,"argument.formal.lambda.iteration":F,"argument.formal.lambda":F,"argumentList.formal.lambda.empty":F,"argumentList.formal.lambda.multiLine":F,"argumentList.formal.lambda.singleLine":F,"interior.lambda":F,"value.return.lambda":F,anonymousFunction:F,"argument.actual.constructor.iteration":F,"argument.actual.constructor":F,"argument.formal.constructor.iteration":F,"argument.formal.constructor":F,"argumentList.actual.constructor.empty":F,"argumentList.actual.constructor.multiLine":F,"argumentList.actual.constructor.singleLine":F,"argumentList.formal.constructor.empty":F,"argumentList.formal.constructor.multiLine":F,"argumentList.formal.constructor.singleLine":F,"functionCall.constructor":F,"functionCallee.constructor":F,"functionName.constructor":F,"name.argument.formal.constructor.iteration":F,"name.argument.formal.constructor":F,"name.constructor":F,"namedFunction.constructor":F,"type.argument.formal.constructor.iteration":F,"type.argument.formal.constructor":F,"value.argument.formal.constructor.iteration":F,"value.argument.formal.constructor":F,"argument.formal.method.iteration":F,"argument.formal.method":F,"argumentList.formal.method.empty":F,"argumentList.formal.method.multiLine":F,"argumentList.formal.method.singleLine":F,"functionName.method.iteration.class":F,"functionName.method":F,"name.argument.formal.method.iteration":F,"name.argument.formal.method":F,"name.method":F,"namedFunction.method.iteration.class":F,"namedFunction.method":F,"type.argument.formal.method.iteration":F,"type.argument.formal.method":F,"value.argument.formal.method.iteration":F,"value.argument.formal.method":F,"name.foreach":F,"type.foreach":F,"value.foreach":F,"value.argument.formal":F,"value.argument.formal.iteration":F,"type.typeArgument":F,"type.typeArgument.iteration":F};var{supported:sj,unsupported:cj,notApplicable:pj}=G;var{supported:K}=G,R0={...em,attribute:K,anonymousFunction:K,"branch.try":K,"branch.try.iteration":K,"argument.actual.constructor":K,"argument.actual.constructor.iteration":K,"argument.formal.method":K,"argument.formal.method.iteration":K,"argument.formal.constructor":K,"argument.formal.constructor.iteration":K,"argument.formal.lambda":K,"argument.formal.lambda.iteration":K,"argumentList.actual.constructor.empty":K,"argumentList.actual.constructor.singleLine":K,"argumentList.actual.constructor.multiLine":K,"argumentList.formal.constructor.empty":K,"argumentList.formal.constructor.singleLine":K,"argumentList.formal.constructor.multiLine":K,"argumentList.formal.lambda.empty":K,"argumentList.formal.lambda.singleLine":K,"argumentList.formal.lambda.multiLine":K,"argumentList.formal.method.empty":K,"argumentList.formal.method.singleLine":K,"argumentList.formal.method.multiLine":K,"functionCall.constructor":K,"functionCallee.constructor":K,"functionName.constructor":K,"functionName.method":K,"functionName.method.iteration.class":K,"namedFunction.method":K,"namedFunction.method.iteration.class":K,"namedFunction.constructor":K,"name.argument.formal.method":K,"name.argument.formal.method.iteration":K,"name.argument.formal.constructor":K,"name.argument.formal.constructor.iteration":K,"name.constructor":K,"name.foreach":K,"name.method":K,"value.argument.formal":K,"value.argument.formal.iteration":K,"value.argument.formal.method":K,"value.argument.formal.method.iteration":K,"value.argument.formal.constructor":K,"value.argument.formal.constructor.iteration":K,"value.foreach":K,"value.return.lambda":K,"value.field":K,"type.argument.formal.method":K,"type.argument.formal.method.iteration":K,"type.argument.formal.constructor":K,"type.argument.formal.constructor.iteration":K,"type.foreach":K,"type.typeArgument":K,"type.typeArgument.iteration":K,"interior.lambda":K,"interior.try":K};var{supported:gj,unsupported:hj,notApplicable:yj}=G;var{supported:Re,notApplicable:S}=G,tm={"comment.block":Re,"string.singleLine":Re,disqualifyDelimiter:Re,map:Re,functionCall:Re,functionCallee:Re,"argument.actual":Re,"argument.actual.iteration":Re,"argumentList.actual.empty":Re,"argumentList.actual.singleLine":Re,"argumentList.actual.multiLine":Re,"name.iteration.document":Re,"name.iteration.block":Re,"textFragment.comment.block":Re,"textFragment.string.singleLine":Re,"key.mapPair":Re,"key.mapPair.iteration":Re,"value.mapPair":Re,"value.mapPair.iteration":Re,"collectionItem.unenclosed":Re,"collectionItem.unenclosed.iteration":Re,statement:Re,"statement.iteration.document":Re,anonymousFunction:S,"argument.actual.constructor.iteration":S,"argument.actual.constructor":S,"argument.actual.method.iteration":S,"argument.actual.method":S,"argument.formal.constructor.iteration":S,"argument.formal.constructor":S,"argument.formal.iteration":S,"argument.formal.method.iteration":S,"argument.formal.method":S,"argument.formal":S,"argument.formal.lambda":S,"argument.formal.lambda.iteration":S,"argumentList.actual.method.empty":S,"argumentList.actual.method.singleLine":S,"argumentList.actual.method.multiLine":S,"argumentList.actual.constructor.empty":S,"argumentList.actual.constructor.singleLine":S,"argumentList.actual.constructor.multiLine":S,"argumentList.formal.empty":S,"argumentList.formal.singleLine":S,"argumentList.formal.multiLine":S,"argumentList.formal.lambda.empty":S,"argumentList.formal.lambda.singleLine":S,"argumentList.formal.lambda.multiLine":S,"argumentList.formal.method.empty":S,"argumentList.formal.method.singleLine":S,"argumentList.formal.method.multiLine":S,"argumentList.formal.constructor.empty":S,"argumentList.formal.constructor.singleLine":S,"argumentList.formal.constructor.multiLine":S,attribute:S,"branch.if.iteration":S,"branch.if":S,"branch.loop":S,"branch.switchCase.iteration":S,"branch.switchCase":S,"branch.ternary":S,"branch.try.iteration":S,"branch.try":S,"class.iteration.block":S,"class.iteration.document":S,class:S,"className.iteration.block":S,"className.iteration.document":S,className:S,command:S,"comment.line":S,"condition.doWhile":S,"condition.for":S,"condition.if":S,"condition.switchCase.iteration":S,"condition.switchCase":S,"condition.ternary":S,"condition.while":S,element:S,endTag:S,environment:S,fieldAccess:S,"functionCall.constructor":S,"functionCallee.constructor":S,"functionName.constructor":S,"functionName.iteration.block":S,"functionName.iteration.document":S,"functionName.method.iteration.class":S,"functionName.method":S,functionName:S,ifStatement:S,"interior.cell":S,"interior.class":S,"interior.command":S,"interior.element":S,"interior.function":S,"interior.if":S,"interior.lambda":S,"interior.loop":S,"interior.resource":S,"interior.switchCase":S,"interior.ternary":S,"interior.try":S,"key.attribute":S,list:S,"name.argument.actual.iteration":S,"name.argument.actual":S,"name.argument.formal.constructor.iteration":S,"name.argument.formal.constructor":S,"name.argument.formal.iteration":S,"name.argument.formal.method.iteration":S,"name.argument.formal.method":S,"name.argument.formal":S,"name.assignment.pattern":S,"name.assignment":S,"name.class":S,"name.constructor":S,"name.field":S,"name.foreach":S,"name.function":S,"name.method":S,"name.resource.iteration":S,"name.resource":S,"name.variable.pattern":S,"name.variable":S,"namedFunction.constructor":S,"namedFunction.iteration.block":S,"namedFunction.iteration.document":S,"namedFunction.method.iteration.class":S,"namedFunction.method":S,namedFunction:S,notebookCell:S,pairDelimiter:S,regularExpression:S,"section.iteration.document":S,"section.iteration.parent":S,section:S,startTag:S,"statement.iteration.block":S,"statement.class":S,"string.multiLine":S,switchStatementSubject:S,tags:S,"textFragment.comment.line":S,"textFragment.element":S,"textFragment.string.multiLine":S,"type.alias":S,"type.argument.formal.constructor.iteration":S,"type.argument.formal.constructor":S,"type.argument.formal.iteration":S,"type.argument.formal.method.iteration":S,"type.argument.formal.method":S,"type.argument.formal":S,"type.cast":S,"type.class":S,"type.enum":S,"type.field.iteration":S,"type.field":S,"type.foreach":S,"type.interface":S,"type.resource":S,"type.resource.iteration":S,"type.return":S,"type.typeArgument.iteration":S,"type.typeArgument":S,"type.variable":S,"value.argument.actual.iteration":S,"value.argument.actual":S,"value.argument.formal.constructor.iteration":S,"value.argument.formal.constructor":S,"value.argument.formal.iteration":S,"value.argument.formal.method.iteration":S,"value.argument.formal.method":S,"value.argument.formal":S,"value.assignment":S,"value.attribute":S,"value.field":S,"value.foreach":S,"value.resource.iteration":S,"value.resource":S,"value.return.lambda":S,"value.return":S,"value.typeAlias":S,"value.variable.pattern":S,"value.variable":S,"value.yield":S};var{supported:vj,unsupported:bj,notApplicable:wj}=G;var{supported:kj,unsupported:Aj,notApplicable:Pj}=G;var{supported:Lj,notApplicable:Fj}=G;var{supported:Oj,unsupported:Nj,notApplicable:Hj}=G;var{supported:E,notApplicable:ae}=G,rm={list:E,map:E,regularExpression:E,switchStatementSubject:E,fieldAccess:E,disqualifyDelimiter:E,pairDelimiter:E,"collectionItem.unenclosed":E,"collectionItem.unenclosed.iteration":E,"textFragment.string.singleLine":E,"textFragment.string.multiLine":E,"textFragment.comment.line":E,"textFragment.comment.block":E,ifStatement:E,statement:E,"statement.iteration.document":E,"statement.iteration.block":E,"statement.class":E,class:E,"class.iteration.document":E,className:E,"className.iteration.document":E,anonymousFunction:E,namedFunction:E,"namedFunction.iteration.document":E,"namedFunction.method":E,"namedFunction.method.iteration.class":E,"namedFunction.constructor":E,functionName:E,"functionName.iteration.document":E,"functionName.method":E,"functionName.method.iteration.class":E,"functionName.constructor":E,functionCall:E,"functionCall.constructor":E,functionCallee:E,"functionCallee.constructor":E,"argument.actual":E,"argument.actual.iteration":E,"argument.actual.method":E,"argument.actual.method.iteration":E,"argument.actual.constructor":E,"argument.actual.constructor.iteration":E,"argument.formal":E,"argument.formal.iteration":E,"argument.formal.method":E,"argument.formal.method.iteration":E,"argument.formal.constructor":E,"argument.formal.constructor.iteration":E,"argument.formal.lambda":E,"argument.formal.lambda.iteration":E,"argumentList.actual.empty":E,"argumentList.actual.singleLine":E,"argumentList.actual.multiLine":E,"argumentList.actual.method.empty":E,"argumentList.actual.method.singleLine":E,"argumentList.actual.method.multiLine":E,"argumentList.actual.constructor.empty":E,"argumentList.actual.constructor.singleLine":E,"argumentList.actual.constructor.multiLine":E,"argumentList.formal.empty":E,"argumentList.formal.singleLine":E,"argumentList.formal.multiLine":E,"argumentList.formal.lambda.empty":E,"argumentList.formal.lambda.singleLine":E,"argumentList.formal.lambda.multiLine":E,"argumentList.formal.method.empty":E,"argumentList.formal.method.singleLine":E,"argumentList.formal.method.multiLine":E,"argumentList.formal.constructor.empty":E,"argumentList.formal.constructor.singleLine":E,"argumentList.formal.constructor.multiLine":E,"comment.line":E,"comment.block":E,"string.singleLine":E,"string.multiLine":E,"branch.if":E,"branch.if.iteration":E,"branch.try":E,"branch.try.iteration":E,"branch.switchCase":E,"branch.switchCase.iteration":E,"branch.ternary":E,"branch.loop":E,"condition.if":E,"condition.while":E,"condition.doWhile":E,"condition.for":E,"condition.ternary":E,"condition.switchCase":E,"condition.switchCase.iteration":E,"name.argument.formal":E,"name.argument.formal.iteration":E,"name.argument.formal.method":E,"name.argument.formal.method.iteration":E,"name.argument.formal.constructor":E,"name.argument.formal.constructor.iteration":E,"name.foreach":E,"name.assignment":E,"name.assignment.pattern":E,"name.variable":E,"name.variable.pattern":E,"name.function":E,"name.method":E,"name.constructor":E,"name.class":E,"name.field":E,"name.iteration.document":E,"name.iteration.block":E,"key.mapPair":E,"key.mapPair.iteration":E,"value.argument.formal":E,"value.argument.formal.iteration":E,"value.argument.formal.method":E,"value.argument.formal.method.iteration":E,"value.argument.formal.constructor":E,"value.argument.formal.constructor.iteration":E,"value.mapPair":E,"value.mapPair.iteration":E,"value.assignment":E,"value.variable":E,"value.variable.pattern":E,"value.foreach":E,"value.return":E,"value.return.lambda":E,"value.field":E,"value.yield":E,"type.class":E,"interior.class":E,"interior.function":E,"interior.if":E,"interior.lambda":E,"interior.loop":E,"interior.switchCase":E,"interior.ternary":E,"interior.try":E,"class.iteration.block":ae,"className.iteration.block":ae,section:ae,"section.iteration.document":ae,"section.iteration.parent":ae,command:ae,"interior.command":ae,notebookCell:ae,"interior.cell":ae,"interior.resource":ae,"name.resource.iteration":ae,"name.resource":ae,"type.resource.iteration":ae,"type.resource":ae,"value.resource.iteration":ae,"value.resource":ae,"name.argument.actual.iteration":ae,"name.argument.actual":ae,"value.argument.actual.iteration":ae,"value.argument.actual":ae,"functionName.iteration.block":ae,"namedFunction.iteration.block":ae,environment:ae},nm={element:E,tags:E,startTag:E,endTag:E,attribute:E,"key.attribute":E,"value.attribute":E,"interior.element":E,"textFragment.element":E},im={...rm,...nm,"type.argument.formal":ae,"type.argument.formal.iteration":ae,"type.argument.formal.method":ae,"type.argument.formal.method.iteration":ae,"type.argument.formal.constructor":ae,"type.argument.formal.constructor.iteration":ae,"type.alias":ae,"type.cast":ae,"type.field":ae,"type.field.iteration":ae,"type.foreach":ae,"type.interface":ae,"type.enum":ae,"type.return":ae,"type.variable":ae,"type.typeArgument":ae,"type.typeArgument.iteration":ae,"value.typeAlias":ae};var k0={...im};var{supported:At,notApplicable:_}=G,vo={list:At,map:At,"string.singleLine":At,"key.mapPair.iteration":At,"key.mapPair":At,"value.mapPair.iteration":At,"value.mapPair":At,"comment.block":At,"comment.line":At,"textFragment.comment.block":At,"textFragment.comment.line":At,"textFragment.string.singleLine":At,anonymousFunction:_,"argument.actual":_,"argument.actual.constructor":_,"argument.actual.constructor.iteration":_,"argument.actual.iteration":_,"argument.actual.method":_,"argument.actual.method.iteration":_,"argument.formal":_,"argument.formal.constructor":_,"argument.formal.constructor.iteration":_,"argument.formal.iteration":_,"argument.formal.method":_,"argument.formal.method.iteration":_,"argument.formal.lambda":_,"argument.formal.lambda.iteration":_,"argumentList.actual.empty":_,"argumentList.actual.singleLine":_,"argumentList.actual.multiLine":_,"argumentList.actual.method.empty":_,"argumentList.actual.method.singleLine":_,"argumentList.actual.method.multiLine":_,"argumentList.actual.constructor.empty":_,"argumentList.actual.constructor.singleLine":_,"argumentList.actual.constructor.multiLine":_,"argumentList.formal.empty":_,"argumentList.formal.singleLine":_,"argumentList.formal.multiLine":_,"argumentList.formal.lambda.empty":_,"argumentList.formal.lambda.singleLine":_,"argumentList.formal.lambda.multiLine":_,"argumentList.formal.method.empty":_,"argumentList.formal.method.singleLine":_,"argumentList.formal.method.multiLine":_,"argumentList.formal.constructor.empty":_,"argumentList.formal.constructor.singleLine":_,"argumentList.formal.constructor.multiLine":_,attribute:_,"branch.if":_,"branch.if.iteration":_,"branch.loop":_,"branch.switchCase":_,"branch.switchCase.iteration":_,"branch.ternary":_,"branch.try":_,"branch.try.iteration":_,class:_,"class.iteration.block":_,"class.iteration.document":_,className:_,"className.iteration.block":_,"className.iteration.document":_,"collectionItem.unenclosed":_,"collectionItem.unenclosed.iteration":_,command:_,"condition.doWhile":_,"condition.for":_,"condition.if":_,"condition.switchCase":_,"condition.switchCase.iteration":_,"condition.ternary":_,"condition.while":_,disqualifyDelimiter:_,element:_,endTag:_,environment:_,fieldAccess:_,functionCall:_,"functionCall.constructor":_,functionCallee:_,"functionCallee.constructor":_,functionName:_,"functionName.constructor":_,"functionName.iteration.block":_,"functionName.iteration.document":_,"functionName.method":_,"functionName.method.iteration.class":_,ifStatement:_,"interior.cell":_,"interior.class":_,"interior.command":_,"interior.element":_,"interior.function":_,"interior.if":_,"interior.lambda":_,"interior.loop":_,"interior.resource":_,"interior.switchCase":_,"interior.ternary":_,"interior.try":_,"key.attribute":_,"name.argument.actual":_,"name.argument.actual.iteration":_,"name.argument.formal":_,"name.argument.formal.constructor":_,"name.argument.formal.constructor.iteration":_,"name.argument.formal.iteration":_,"name.argument.formal.method":_,"name.argument.formal.method.iteration":_,"name.assignment":_,"name.assignment.pattern":_,"name.class":_,"name.constructor":_,"name.field":_,"name.foreach":_,"name.function":_,"name.iteration.block":_,"name.iteration.document":_,"name.method":_,"name.resource":_,"name.resource.iteration":_,"name.variable":_,"name.variable.pattern":_,namedFunction:_,"namedFunction.constructor":_,"namedFunction.iteration.block":_,"namedFunction.iteration.document":_,"namedFunction.method":_,"namedFunction.method.iteration.class":_,notebookCell:_,pairDelimiter:_,regularExpression:_,section:_,"section.iteration.document":_,"section.iteration.parent":_,startTag:_,statement:_,"statement.class":_,"statement.iteration.block":_,"statement.iteration.document":_,"string.multiLine":_,switchStatementSubject:_,tags:_,"textFragment.element":_,"textFragment.string.multiLine":_,"type.alias":_,"type.argument.formal":_,"type.argument.formal.constructor":_,"type.argument.formal.constructor.iteration":_,"type.argument.formal.iteration":_,"type.argument.formal.method":_,"type.argument.formal.method.iteration":_,"type.cast":_,"type.class":_,"type.enum":_,"type.field":_,"type.field.iteration":_,"type.foreach":_,"type.interface":_,"type.resource":_,"type.resource.iteration":_,"type.return":_,"type.typeArgument":_,"type.typeArgument.iteration":_,"type.variable":_,"value.argument.actual":_,"value.argument.actual.iteration":_,"value.argument.formal":_,"value.argument.formal.constructor":_,"value.argument.formal.constructor.iteration":_,"value.argument.formal.iteration":_,"value.argument.formal.method":_,"value.argument.formal.method.iteration":_,"value.assignment":_,"value.attribute":_,"value.field":_,"value.foreach":_,"value.resource":_,"value.resource.iteration":_,"value.return":_,"value.return.lambda":_,"value.typeAlias":_,"value.variable":_,"value.variable.pattern":_,"value.yield":_};var{supported:Kj,unsupported:Qj,notApplicable:Jj}=G,A0={...vo};var{supported:eq,unsupported:tq,notApplicable:rq}=G,P0={...vo};var{supported:oq,unsupported:aq,notApplicable:sq}=G;var{supported:lq,notApplicable:uq}=G;var{supported:fq,notApplicable:gq}=G;var{supported:_q,unsupported:Tq,notApplicable:xq}=G;var{supported:bq,notApplicable:wq}=G;var{supported:kq,unsupported:Aq,notApplicable:Pq}=G;var{supported:Lq,unsupported:Fq,notApplicable:Iq}=G;var{supported:Nq,unsupported:Hq,notApplicable:Uq}=G;var{supported:Wq,unsupported:$q,notApplicable:jq}=G;var{supported:Gq,notApplicable:Kq}=G;var{supported:Ne}=G,M0={...tm,"comment.line":Ne,namedFunction:Ne,"namedFunction.iteration.block":Ne,"namedFunction.iteration.document":Ne,functionName:Ne,"functionName.iteration.block":Ne,"functionName.iteration.document":Ne,"name.argument.formal":Ne,"name.argument.formal.iteration":Ne,"name.function":Ne,"value.argument.formal":Ne,"value.argument.formal.iteration":Ne,"value.return":Ne,"textFragment.comment.line":Ne,ifStatement:Ne,"branch.if":Ne,"branch.if.iteration":Ne,"condition.if":Ne,"interior.if":Ne,"interior.function":Ne};var{supported:ez,unsupported:tz,notApplicable:rz}=G;var{supported:qe,notApplicable:Zt}=G,om={...rm,"type.argument.formal":qe,"type.argument.formal.iteration":qe,"type.argument.formal.method":qe,"type.argument.formal.method.iteration":qe,"type.argument.formal.constructor":qe,"type.argument.formal.constructor.iteration":qe,"type.alias":qe,"type.cast":qe,"type.field":qe,"type.field.iteration":qe,"type.interface":qe,"type.enum":qe,"type.return":qe,"type.variable":qe,"type.typeArgument":qe,"type.typeArgument.iteration":qe,"value.typeAlias":qe,element:Zt,tags:Zt,startTag:Zt,endTag:Zt,attribute:Zt,"key.attribute":Zt,"value.attribute":Zt,"interior.element":Zt,"textFragment.element":Zt,"type.foreach":Zt};var D0={...om,...nm};var{supported:uz,notApplicable:mz}=G;var{supported:gz,unsupported:hz,notApplicable:yz}=G;var am=["that","source","instanceReference","keyboard"];var Me=class extends D{get isReversed(){return this.active.isBefore(this.anchor)}constructor(...e){let[r,n]=e.length===2?e:[new pe(e[0],e[1]),new pe(e[2],e[3])];super(r,n),this.anchor=r,this.active=n}isEqual(e){return this.anchor.isEqual(e.anchor)&&this.active.isEqual(e.active)}concise(){return`${this.anchor.concise()}->${this.active.concise()}`}conciseOneBased(){return`${this.start.conciseOneBased()}->${this.end.conciseOneBased()}`}toString(){return this.concise()}};function Pt({start:t,end:e}){return{type:"line",start:t.line,end:e.line}}function at({start:t,end:e}){return{type:"character",start:t,end:e}}function py(t){return{start:cy(t.start),end:cy(t.end)}}function cy({line:t,character:e}){return{line:t,character:e}}function Ey(t){return typeof t>"u"||t===null}function F0(t){return typeof t=="object"&&t!==null}function I0(t){return Array.isArray(t)?t:Ey(t)?[]:[t]}function C0(t,e){var r,n,o,a;if(e)for(a=Object.keys(e),r=0,n=a.length;r<n;r+=1)o=a[r],t[o]=e[o];return t}function O0(t,e){var r="",n;for(n=0;n<e;n+=1)r+=t;return r}function N0(t){return t===0&&Number.NEGATIVE_INFINITY===1/t}var H0=Ey,U0=F0,V0=I0,B0=O0,W0=N0,$0=C0,We={isNothing:H0,isObject:U0,toArray:V0,repeat:B0,isNegativeZero:W0,extend:$0};function Ry(t,e){var r="",n=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(r+='in "'+t.mark.name+'" '),r+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!e&&t.mark.snippet&&(r+=`

`+t.mark.snippet),n+" "+r):n}function wo(t,e){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=e,this.message=Ry(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}wo.prototype=Object.create(Error.prototype);wo.prototype.constructor=wo;wo.prototype.toString=function(e){return this.name+": "+Ry(this,e)};var pt=wo;function sm(t,e,r,n,o){var a="",s="",c=Math.floor(o/2)-1;return n-e>c&&(a=" ... ",e=n-c+a.length),r-n>c&&(s=" ...",r=n+c-s.length),{str:a+t.slice(e,r).replace(/\t/g,"\u2192")+s,pos:n-e+a.length}}function cm(t,e){return We.repeat(" ",e-t.length)+t}function j0(t,e){if(e=Object.create(e||null),!t.buffer)return null;e.maxLength||(e.maxLength=79),typeof e.indent!="number"&&(e.indent=1),typeof e.linesBefore!="number"&&(e.linesBefore=3),typeof e.linesAfter!="number"&&(e.linesAfter=2);for(var r=/\r?\n|\r|\0/g,n=[0],o=[],a,s=-1;a=r.exec(t.buffer);)o.push(a.index),n.push(a.index+a[0].length),t.position<=a.index&&s<0&&(s=n.length-2);s<0&&(s=n.length-1);var c="",p,l,u=Math.min(t.line+e.linesAfter,o.length).toString().length,m=e.maxLength-(e.indent+u+3);for(p=1;p<=e.linesBefore&&!(s-p<0);p++)l=sm(t.buffer,n[s-p],o[s-p],t.position-(n[s]-n[s-p]),m),c=We.repeat(" ",e.indent)+cm((t.line-p+1).toString(),u)+" | "+l.str+`
`+c;for(l=sm(t.buffer,n[s],o[s],t.position,m),c+=We.repeat(" ",e.indent)+cm((t.line+1).toString(),u)+" | "+l.str+`
`,c+=We.repeat("-",e.indent+u+3+l.pos)+`^
`,p=1;p<=e.linesAfter&&!(s+p>=o.length);p++)l=sm(t.buffer,n[s+p],o[s+p],t.position-(n[s]-n[s+p]),m),c+=We.repeat(" ",e.indent)+cm((t.line+p+1).toString(),u)+" | "+l.str+`
`;return c.replace(/\n$/,"")}var q0=j0,z0=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],G0=["scalar","sequence","mapping"];function K0(t){var e={};return t!==null&&Object.keys(t).forEach(function(r){t[r].forEach(function(n){e[String(n)]=r})}),e}function Q0(t,e){if(e=e||{},Object.keys(e).forEach(function(r){if(z0.indexOf(r)===-1)throw new pt('Unknown option "'+r+'" is met in definition of "'+t+'" YAML type.')}),this.options=e,this.tag=t,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(r){return r},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.representName=e.representName||null,this.defaultStyle=e.defaultStyle||null,this.multi=e.multi||!1,this.styleAliases=K0(e.styleAliases||null),G0.indexOf(this.kind)===-1)throw new pt('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')}var ze=Q0;function ly(t,e){var r=[];return t[e].forEach(function(n){var o=r.length;r.forEach(function(a,s){a.tag===n.tag&&a.kind===n.kind&&a.multi===n.multi&&(o=s)}),r[o]=n}),r}function J0(){var t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},e,r;function n(o){o.multi?(t.multi[o.kind].push(o),t.multi.fallback.push(o)):t[o.kind][o.tag]=t.fallback[o.tag]=o}for(e=0,r=arguments.length;e<r;e+=1)arguments[e].forEach(n);return t}function lm(t){return this.extend(t)}lm.prototype.extend=function(e){var r=[],n=[];if(e instanceof ze)n.push(e);else if(Array.isArray(e))n=n.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(r=r.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit));else throw new pt("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(a){if(!(a instanceof ze))throw new pt("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(a.loadKind&&a.loadKind!=="scalar")throw new pt("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(a.multi)throw new pt("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(a){if(!(a instanceof ze))throw new pt("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var o=Object.create(lm.prototype);return o.implicit=(this.implicit||[]).concat(r),o.explicit=(this.explicit||[]).concat(n),o.compiledImplicit=ly(o,"implicit"),o.compiledExplicit=ly(o,"explicit"),o.compiledTypeMap=J0(o.compiledImplicit,o.compiledExplicit),o};var Y0=lm,Z0=new ze("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return t!==null?t:""}}),X0=new ze("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return t!==null?t:[]}}),eA=new ze("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return t!==null?t:{}}}),tA=new Y0({explicit:[Z0,X0,eA]});function rA(t){if(t===null)return!0;var e=t.length;return e===1&&t==="~"||e===4&&(t==="null"||t==="Null"||t==="NULL")}function nA(){return null}function iA(t){return t===null}var oA=new ze("tag:yaml.org,2002:null",{kind:"scalar",resolve:rA,construct:nA,predicate:iA,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function aA(t){if(t===null)return!1;var e=t.length;return e===4&&(t==="true"||t==="True"||t==="TRUE")||e===5&&(t==="false"||t==="False"||t==="FALSE")}function sA(t){return t==="true"||t==="True"||t==="TRUE"}function cA(t){return Object.prototype.toString.call(t)==="[object Boolean]"}var pA=new ze("tag:yaml.org,2002:bool",{kind:"scalar",resolve:aA,construct:sA,predicate:cA,represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function lA(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function uA(t){return 48<=t&&t<=55}function mA(t){return 48<=t&&t<=57}function dA(t){if(t===null)return!1;var e=t.length,r=0,n=!1,o;if(!e)return!1;if(o=t[r],(o==="-"||o==="+")&&(o=t[++r]),o==="0"){if(r+1===e)return!0;if(o=t[++r],o==="b"){for(r++;r<e;r++)if(o=t[r],o!=="_"){if(o!=="0"&&o!=="1")return!1;n=!0}return n&&o!=="_"}if(o==="x"){for(r++;r<e;r++)if(o=t[r],o!=="_"){if(!lA(t.charCodeAt(r)))return!1;n=!0}return n&&o!=="_"}if(o==="o"){for(r++;r<e;r++)if(o=t[r],o!=="_"){if(!uA(t.charCodeAt(r)))return!1;n=!0}return n&&o!=="_"}}if(o==="_")return!1;for(;r<e;r++)if(o=t[r],o!=="_"){if(!mA(t.charCodeAt(r)))return!1;n=!0}return!(!n||o==="_")}function fA(t){var e=t,r=1,n;if(e.indexOf("_")!==-1&&(e=e.replace(/_/g,"")),n=e[0],(n==="-"||n==="+")&&(n==="-"&&(r=-1),e=e.slice(1),n=e[0]),e==="0")return 0;if(n==="0"){if(e[1]==="b")return r*parseInt(e.slice(2),2);if(e[1]==="x")return r*parseInt(e.slice(2),16);if(e[1]==="o")return r*parseInt(e.slice(2),8)}return r*parseInt(e,10)}function gA(t){return Object.prototype.toString.call(t)==="[object Number]"&&t%1===0&&!We.isNegativeZero(t)}var hA=new ze("tag:yaml.org,2002:int",{kind:"scalar",resolve:dA,construct:fA,predicate:gA,represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),yA=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function _A(t){return!(t===null||!yA.test(t)||t[t.length-1]==="_")}function TA(t){var e,r;return e=t.replace(/_/g,"").toLowerCase(),r=e[0]==="-"?-1:1,"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:r*parseFloat(e,10)}var xA=/^[-+]?[0-9]+e/;function SA(t,e){var r;if(isNaN(t))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(We.isNegativeZero(t))return"-0.0";return r=t.toString(10),xA.test(r)?r.replace("e",".e"):r}function vA(t){return Object.prototype.toString.call(t)==="[object Number]"&&(t%1!==0||We.isNegativeZero(t))}var bA=new ze("tag:yaml.org,2002:float",{kind:"scalar",resolve:_A,construct:TA,predicate:vA,represent:SA,defaultStyle:"lowercase"}),wA=tA.extend({implicit:[oA,pA,hA,bA]}),EA=wA,ky=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Ay=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function RA(t){return t===null?!1:ky.exec(t)!==null||Ay.exec(t)!==null}function kA(t){var e,r,n,o,a,s,c,p=0,l=null,u,m,d;if(e=ky.exec(t),e===null&&(e=Ay.exec(t)),e===null)throw new Error("Date resolve error");if(r=+e[1],n=+e[2]-1,o=+e[3],!e[4])return new Date(Date.UTC(r,n,o));if(a=+e[4],s=+e[5],c=+e[6],e[7]){for(p=e[7].slice(0,3);p.length<3;)p+="0";p=+p}return e[9]&&(u=+e[10],m=+(e[11]||0),l=(u*60+m)*6e4,e[9]==="-"&&(l=-l)),d=new Date(Date.UTC(r,n,o,a,s,c,p)),l&&d.setTime(d.getTime()-l),d}function AA(t){return t.toISOString()}var PA=new ze("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:RA,construct:kA,instanceOf:Date,represent:AA});function MA(t){return t==="<<"||t===null}var DA=new ze("tag:yaml.org,2002:merge",{kind:"scalar",resolve:MA}),gm=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function LA(t){if(t===null)return!1;var e,r,n=0,o=t.length,a=gm;for(r=0;r<o;r++)if(e=a.indexOf(t.charAt(r)),!(e>64)){if(e<0)return!1;n+=6}return n%8===0}function FA(t){var e,r,n=t.replace(/[\r\n=]/g,""),o=n.length,a=gm,s=0,c=[];for(e=0;e<o;e++)e%4===0&&e&&(c.push(s>>16&255),c.push(s>>8&255),c.push(s&255)),s=s<<6|a.indexOf(n.charAt(e));return r=o%4*6,r===0?(c.push(s>>16&255),c.push(s>>8&255),c.push(s&255)):r===18?(c.push(s>>10&255),c.push(s>>2&255)):r===12&&c.push(s>>4&255),new Uint8Array(c)}function IA(t){var e="",r=0,n,o,a=t.length,s=gm;for(n=0;n<a;n++)n%3===0&&n&&(e+=s[r>>18&63],e+=s[r>>12&63],e+=s[r>>6&63],e+=s[r&63]),r=(r<<8)+t[n];return o=a%3,o===0?(e+=s[r>>18&63],e+=s[r>>12&63],e+=s[r>>6&63],e+=s[r&63]):o===2?(e+=s[r>>10&63],e+=s[r>>4&63],e+=s[r<<2&63],e+=s[64]):o===1&&(e+=s[r>>2&63],e+=s[r<<4&63],e+=s[64],e+=s[64]),e}function CA(t){return Object.prototype.toString.call(t)==="[object Uint8Array]"}var OA=new ze("tag:yaml.org,2002:binary",{kind:"scalar",resolve:LA,construct:FA,predicate:CA,represent:IA}),NA=Object.prototype.hasOwnProperty,HA=Object.prototype.toString;function UA(t){if(t===null)return!0;var e=[],r,n,o,a,s,c=t;for(r=0,n=c.length;r<n;r+=1){if(o=c[r],s=!1,HA.call(o)!=="[object Object]")return!1;for(a in o)if(NA.call(o,a))if(!s)s=!0;else return!1;if(!s)return!1;if(e.indexOf(a)===-1)e.push(a);else return!1}return!0}function VA(t){return t!==null?t:[]}var BA=new ze("tag:yaml.org,2002:omap",{kind:"sequence",resolve:UA,construct:VA}),WA=Object.prototype.toString;function $A(t){if(t===null)return!0;var e,r,n,o,a,s=t;for(a=new Array(s.length),e=0,r=s.length;e<r;e+=1){if(n=s[e],WA.call(n)!=="[object Object]"||(o=Object.keys(n),o.length!==1))return!1;a[e]=[o[0],n[o[0]]]}return!0}function jA(t){if(t===null)return[];var e,r,n,o,a,s=t;for(a=new Array(s.length),e=0,r=s.length;e<r;e+=1)n=s[e],o=Object.keys(n),a[e]=[o[0],n[o[0]]];return a}var qA=new ze("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:$A,construct:jA}),zA=Object.prototype.hasOwnProperty;function GA(t){if(t===null)return!0;var e,r=t;for(e in r)if(zA.call(r,e)&&r[e]!==null)return!1;return!0}function KA(t){return t!==null?t:{}}var QA=new ze("tag:yaml.org,2002:set",{kind:"mapping",resolve:GA,construct:KA}),hm=EA.extend({implicit:[PA,DA],explicit:[OA,BA,qA,QA]}),Or=Object.prototype.hasOwnProperty,ps=1,Py=2,My=3,ls=4,pm=1,JA=2,uy=3,YA=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,ZA=/[\x85\u2028\u2029]/,XA=/[,\[\]\{\}]/,Dy=/^(?:!|!!|![a-z\-]+!)$/i,Ly=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function my(t){return Object.prototype.toString.call(t)}function Xt(t){return t===10||t===13}function dn(t){return t===9||t===32}function lt(t){return t===9||t===32||t===10||t===13}function hi(t){return t===44||t===91||t===93||t===123||t===125}function eP(t){var e;return 48<=t&&t<=57?t-48:(e=t|32,97<=e&&e<=102?e-97+10:-1)}function tP(t){return t===120?2:t===117?4:t===85?8:0}function rP(t){return 48<=t&&t<=57?t-48:-1}function dy(t){return t===48?"\0":t===97?"\x07":t===98?"\b":t===116||t===9?"	":t===110?`
`:t===118?"\v":t===102?"\f":t===114?"\r":t===101?"\x1B":t===32?" ":t===34?'"':t===47?"/":t===92?"\\":t===78?"\x85":t===95?"\xA0":t===76?"\u2028":t===80?"\u2029":""}function nP(t){return t<=65535?String.fromCharCode(t):String.fromCharCode((t-65536>>10)+55296,(t-65536&1023)+56320)}var Fy=new Array(256),Iy=new Array(256);for(mn=0;mn<256;mn++)Fy[mn]=dy(mn)?1:0,Iy[mn]=dy(mn);var mn;function iP(t,e){this.input=t,this.filename=e.filename||null,this.schema=e.schema||hm,this.onWarning=e.onWarning||null,this.legacy=e.legacy||!1,this.json=e.json||!1,this.listener=e.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function Cy(t,e){var r={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return r.snippet=q0(r),new pt(e,r)}function Q(t,e){throw Cy(t,e)}function us(t,e){t.onWarning&&t.onWarning.call(null,Cy(t,e))}var fy={YAML:function(e,r,n){var o,a,s;e.version!==null&&Q(e,"duplication of %YAML directive"),n.length!==1&&Q(e,"YAML directive accepts exactly one argument"),o=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),o===null&&Q(e,"ill-formed argument of the YAML directive"),a=parseInt(o[1],10),s=parseInt(o[2],10),a!==1&&Q(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=s<2,s!==1&&s!==2&&us(e,"unsupported YAML version of the document")},TAG:function(e,r,n){var o,a;n.length!==2&&Q(e,"TAG directive accepts exactly two arguments"),o=n[0],a=n[1],Dy.test(o)||Q(e,"ill-formed tag handle (first argument) of the TAG directive"),Or.call(e.tagMap,o)&&Q(e,'there is a previously declared suffix for "'+o+'" tag handle'),Ly.test(a)||Q(e,"ill-formed tag prefix (second argument) of the TAG directive");try{a=decodeURIComponent(a)}catch{Q(e,"tag prefix is malformed: "+a)}e.tagMap[o]=a}};function Cr(t,e,r,n){var o,a,s,c;if(e<r){if(c=t.input.slice(e,r),n)for(o=0,a=c.length;o<a;o+=1)s=c.charCodeAt(o),s===9||32<=s&&s<=1114111||Q(t,"expected valid JSON character");else YA.test(c)&&Q(t,"the stream contains non-printable characters");t.result+=c}}function gy(t,e,r,n){var o,a,s,c;for(We.isObject(r)||Q(t,"cannot merge mappings; the provided source object is unacceptable"),o=Object.keys(r),s=0,c=o.length;s<c;s+=1)a=o[s],Or.call(e,a)||(e[a]=r[a],n[a]=!0)}function yi(t,e,r,n,o,a,s,c,p){var l,u;if(Array.isArray(o))for(o=Array.prototype.slice.call(o),l=0,u=o.length;l<u;l+=1)Array.isArray(o[l])&&Q(t,"nested arrays are not supported inside keys"),typeof o=="object"&&my(o[l])==="[object Object]"&&(o[l]="[object Object]");if(typeof o=="object"&&my(o)==="[object Object]"&&(o="[object Object]"),o=String(o),e===null&&(e={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(a))for(l=0,u=a.length;l<u;l+=1)gy(t,e,a[l],r);else gy(t,e,a,r);else!t.json&&!Or.call(r,o)&&Or.call(e,o)&&(t.line=s||t.line,t.lineStart=c||t.lineStart,t.position=p||t.position,Q(t,"duplicated mapping key")),o==="__proto__"?Object.defineProperty(e,o,{configurable:!0,enumerable:!0,writable:!0,value:a}):e[o]=a,delete r[o];return e}function ym(t){var e;e=t.input.charCodeAt(t.position),e===10?t.position++:e===13?(t.position++,t.input.charCodeAt(t.position)===10&&t.position++):Q(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}function He(t,e,r){for(var n=0,o=t.input.charCodeAt(t.position);o!==0;){for(;dn(o);)o===9&&t.firstTabInLine===-1&&(t.firstTabInLine=t.position),o=t.input.charCodeAt(++t.position);if(e&&o===35)do o=t.input.charCodeAt(++t.position);while(o!==10&&o!==13&&o!==0);if(Xt(o))for(ym(t),o=t.input.charCodeAt(t.position),n++,t.lineIndent=0;o===32;)t.lineIndent++,o=t.input.charCodeAt(++t.position);else break}return r!==-1&&n!==0&&t.lineIndent<r&&us(t,"deficient indentation"),n}function gs(t){var e=t.position,r;return r=t.input.charCodeAt(e),!!((r===45||r===46)&&r===t.input.charCodeAt(e+1)&&r===t.input.charCodeAt(e+2)&&(e+=3,r=t.input.charCodeAt(e),r===0||lt(r)))}function _m(t,e){e===1?t.result+=" ":e>1&&(t.result+=We.repeat(`
`,e-1))}function oP(t,e,r){var n,o,a,s,c,p,l,u,m=t.kind,d=t.result,g;if(g=t.input.charCodeAt(t.position),lt(g)||hi(g)||g===35||g===38||g===42||g===33||g===124||g===62||g===39||g===34||g===37||g===64||g===96||(g===63||g===45)&&(o=t.input.charCodeAt(t.position+1),lt(o)||r&&hi(o)))return!1;for(t.kind="scalar",t.result="",a=s=t.position,c=!1;g!==0;){if(g===58){if(o=t.input.charCodeAt(t.position+1),lt(o)||r&&hi(o))break}else if(g===35){if(n=t.input.charCodeAt(t.position-1),lt(n))break}else{if(t.position===t.lineStart&&gs(t)||r&&hi(g))break;if(Xt(g))if(p=t.line,l=t.lineStart,u=t.lineIndent,He(t,!1,-1),t.lineIndent>=e){c=!0,g=t.input.charCodeAt(t.position);continue}else{t.position=s,t.line=p,t.lineStart=l,t.lineIndent=u;break}}c&&(Cr(t,a,s,!1),_m(t,t.line-p),a=s=t.position,c=!1),dn(g)||(s=t.position+1),g=t.input.charCodeAt(++t.position)}return Cr(t,a,s,!1),t.result?!0:(t.kind=m,t.result=d,!1)}function aP(t,e){var r,n,o;if(r=t.input.charCodeAt(t.position),r!==39)return!1;for(t.kind="scalar",t.result="",t.position++,n=o=t.position;(r=t.input.charCodeAt(t.position))!==0;)if(r===39)if(Cr(t,n,t.position,!0),r=t.input.charCodeAt(++t.position),r===39)n=t.position,t.position++,o=t.position;else return!0;else Xt(r)?(Cr(t,n,o,!0),_m(t,He(t,!1,e)),n=o=t.position):t.position===t.lineStart&&gs(t)?Q(t,"unexpected end of the document within a single quoted scalar"):(t.position++,o=t.position);Q(t,"unexpected end of the stream within a single quoted scalar")}function sP(t,e){var r,n,o,a,s,c;if(c=t.input.charCodeAt(t.position),c!==34)return!1;for(t.kind="scalar",t.result="",t.position++,r=n=t.position;(c=t.input.charCodeAt(t.position))!==0;){if(c===34)return Cr(t,r,t.position,!0),t.position++,!0;if(c===92){if(Cr(t,r,t.position,!0),c=t.input.charCodeAt(++t.position),Xt(c))He(t,!1,e);else if(c<256&&Fy[c])t.result+=Iy[c],t.position++;else if((s=tP(c))>0){for(o=s,a=0;o>0;o--)c=t.input.charCodeAt(++t.position),(s=eP(c))>=0?a=(a<<4)+s:Q(t,"expected hexadecimal character");t.result+=nP(a),t.position++}else Q(t,"unknown escape sequence");r=n=t.position}else Xt(c)?(Cr(t,r,n,!0),_m(t,He(t,!1,e)),r=n=t.position):t.position===t.lineStart&&gs(t)?Q(t,"unexpected end of the document within a double quoted scalar"):(t.position++,n=t.position)}Q(t,"unexpected end of the stream within a double quoted scalar")}function cP(t,e){var r=!0,n,o,a,s=t.tag,c,p=t.anchor,l,u,m,d,g,b=Object.create(null),w,I,L,H;if(H=t.input.charCodeAt(t.position),H===91)u=93,g=!1,c=[];else if(H===123)u=125,g=!0,c={};else return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=c),H=t.input.charCodeAt(++t.position);H!==0;){if(He(t,!0,e),H=t.input.charCodeAt(t.position),H===u)return t.position++,t.tag=s,t.anchor=p,t.kind=g?"mapping":"sequence",t.result=c,!0;r?H===44&&Q(t,"expected the node content, but found ','"):Q(t,"missed comma between flow collection entries"),I=w=L=null,m=d=!1,H===63&&(l=t.input.charCodeAt(t.position+1),lt(l)&&(m=d=!0,t.position++,He(t,!0,e))),n=t.line,o=t.lineStart,a=t.position,_i(t,e,ps,!1,!0),I=t.tag,w=t.result,He(t,!0,e),H=t.input.charCodeAt(t.position),(d||t.line===n)&&H===58&&(m=!0,H=t.input.charCodeAt(++t.position),He(t,!0,e),_i(t,e,ps,!1,!0),L=t.result),g?yi(t,c,b,I,w,L,n,o,a):m?c.push(yi(t,null,b,I,w,L,n,o,a)):c.push(w),He(t,!0,e),H=t.input.charCodeAt(t.position),H===44?(r=!0,H=t.input.charCodeAt(++t.position)):r=!1}Q(t,"unexpected end of the stream within a flow collection")}function pP(t,e){var r,n,o=pm,a=!1,s=!1,c=e,p=0,l=!1,u,m;if(m=t.input.charCodeAt(t.position),m===124)n=!1;else if(m===62)n=!0;else return!1;for(t.kind="scalar",t.result="";m!==0;)if(m=t.input.charCodeAt(++t.position),m===43||m===45)pm===o?o=m===43?uy:JA:Q(t,"repeat of a chomping mode identifier");else if((u=rP(m))>=0)u===0?Q(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?Q(t,"repeat of an indentation width identifier"):(c=e+u-1,s=!0);else break;if(dn(m)){do m=t.input.charCodeAt(++t.position);while(dn(m));if(m===35)do m=t.input.charCodeAt(++t.position);while(!Xt(m)&&m!==0)}for(;m!==0;){for(ym(t),t.lineIndent=0,m=t.input.charCodeAt(t.position);(!s||t.lineIndent<c)&&m===32;)t.lineIndent++,m=t.input.charCodeAt(++t.position);if(!s&&t.lineIndent>c&&(c=t.lineIndent),Xt(m)){p++;continue}if(t.lineIndent<c){o===uy?t.result+=We.repeat(`
`,a?1+p:p):o===pm&&a&&(t.result+=`
`);break}for(n?dn(m)?(l=!0,t.result+=We.repeat(`
`,a?1+p:p)):l?(l=!1,t.result+=We.repeat(`
`,p+1)):p===0?a&&(t.result+=" "):t.result+=We.repeat(`
`,p):t.result+=We.repeat(`
`,a?1+p:p),a=!0,s=!0,p=0,r=t.position;!Xt(m)&&m!==0;)m=t.input.charCodeAt(++t.position);Cr(t,r,t.position,!1)}return!0}function hy(t,e){var r,n=t.tag,o=t.anchor,a=[],s,c=!1,p;if(t.firstTabInLine!==-1)return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=a),p=t.input.charCodeAt(t.position);p!==0&&(t.firstTabInLine!==-1&&(t.position=t.firstTabInLine,Q(t,"tab characters must not be used in indentation")),!(p!==45||(s=t.input.charCodeAt(t.position+1),!lt(s))));){if(c=!0,t.position++,He(t,!0,-1)&&t.lineIndent<=e){a.push(null),p=t.input.charCodeAt(t.position);continue}if(r=t.line,_i(t,e,My,!1,!0),a.push(t.result),He(t,!0,-1),p=t.input.charCodeAt(t.position),(t.line===r||t.lineIndent>e)&&p!==0)Q(t,"bad indentation of a sequence entry");else if(t.lineIndent<e)break}return c?(t.tag=n,t.anchor=o,t.kind="sequence",t.result=a,!0):!1}function lP(t,e,r){var n,o,a,s,c,p,l=t.tag,u=t.anchor,m={},d=Object.create(null),g=null,b=null,w=null,I=!1,L=!1,H;if(t.firstTabInLine!==-1)return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=m),H=t.input.charCodeAt(t.position);H!==0;){if(!I&&t.firstTabInLine!==-1&&(t.position=t.firstTabInLine,Q(t,"tab characters must not be used in indentation")),n=t.input.charCodeAt(t.position+1),a=t.line,(H===63||H===58)&&lt(n))H===63?(I&&(yi(t,m,d,g,b,null,s,c,p),g=b=w=null),L=!0,I=!0,o=!0):I?(I=!1,o=!0):Q(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,H=n;else{if(s=t.line,c=t.lineStart,p=t.position,!_i(t,r,Py,!1,!0))break;if(t.line===a){for(H=t.input.charCodeAt(t.position);dn(H);)H=t.input.charCodeAt(++t.position);if(H===58)H=t.input.charCodeAt(++t.position),lt(H)||Q(t,"a whitespace character is expected after the key-value separator within a block mapping"),I&&(yi(t,m,d,g,b,null,s,c,p),g=b=w=null),L=!0,I=!1,o=!1,g=t.tag,b=t.result;else if(L)Q(t,"can not read an implicit mapping pair; a colon is missed");else return t.tag=l,t.anchor=u,!0}else if(L)Q(t,"can not read a block mapping entry; a multiline key may not be an implicit key");else return t.tag=l,t.anchor=u,!0}if((t.line===a||t.lineIndent>e)&&(I&&(s=t.line,c=t.lineStart,p=t.position),_i(t,e,ls,!0,o)&&(I?b=t.result:w=t.result),I||(yi(t,m,d,g,b,w,s,c,p),g=b=w=null),He(t,!0,-1),H=t.input.charCodeAt(t.position)),(t.line===a||t.lineIndent>e)&&H!==0)Q(t,"bad indentation of a mapping entry");else if(t.lineIndent<e)break}return I&&yi(t,m,d,g,b,null,s,c,p),L&&(t.tag=l,t.anchor=u,t.kind="mapping",t.result=m),L}function uP(t){var e,r=!1,n=!1,o,a,s;if(s=t.input.charCodeAt(t.position),s!==33)return!1;if(t.tag!==null&&Q(t,"duplication of a tag property"),s=t.input.charCodeAt(++t.position),s===60?(r=!0,s=t.input.charCodeAt(++t.position)):s===33?(n=!0,o="!!",s=t.input.charCodeAt(++t.position)):o="!",e=t.position,r){do s=t.input.charCodeAt(++t.position);while(s!==0&&s!==62);t.position<t.length?(a=t.input.slice(e,t.position),s=t.input.charCodeAt(++t.position)):Q(t,"unexpected end of the stream within a verbatim tag")}else{for(;s!==0&&!lt(s);)s===33&&(n?Q(t,"tag suffix cannot contain exclamation marks"):(o=t.input.slice(e-1,t.position+1),Dy.test(o)||Q(t,"named tag handle cannot contain such characters"),n=!0,e=t.position+1)),s=t.input.charCodeAt(++t.position);a=t.input.slice(e,t.position),XA.test(a)&&Q(t,"tag suffix cannot contain flow indicator characters")}a&&!Ly.test(a)&&Q(t,"tag name cannot contain such characters: "+a);try{a=decodeURIComponent(a)}catch{Q(t,"tag name is malformed: "+a)}return r?t.tag=a:Or.call(t.tagMap,o)?t.tag=t.tagMap[o]+a:o==="!"?t.tag="!"+a:o==="!!"?t.tag="tag:yaml.org,2002:"+a:Q(t,'undeclared tag handle "'+o+'"'),!0}function mP(t){var e,r;if(r=t.input.charCodeAt(t.position),r!==38)return!1;for(t.anchor!==null&&Q(t,"duplication of an anchor property"),r=t.input.charCodeAt(++t.position),e=t.position;r!==0&&!lt(r)&&!hi(r);)r=t.input.charCodeAt(++t.position);return t.position===e&&Q(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(e,t.position),!0}function dP(t){var e,r,n;if(n=t.input.charCodeAt(t.position),n!==42)return!1;for(n=t.input.charCodeAt(++t.position),e=t.position;n!==0&&!lt(n)&&!hi(n);)n=t.input.charCodeAt(++t.position);return t.position===e&&Q(t,"name of an alias node must contain at least one character"),r=t.input.slice(e,t.position),Or.call(t.anchorMap,r)||Q(t,'unidentified alias "'+r+'"'),t.result=t.anchorMap[r],He(t,!0,-1),!0}function _i(t,e,r,n,o){var a,s,c,p=1,l=!1,u=!1,m,d,g,b,w,I;if(t.listener!==null&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,a=s=c=ls===r||My===r,n&&He(t,!0,-1)&&(l=!0,t.lineIndent>e?p=1:t.lineIndent===e?p=0:t.lineIndent<e&&(p=-1)),p===1)for(;uP(t)||mP(t);)He(t,!0,-1)?(l=!0,c=a,t.lineIndent>e?p=1:t.lineIndent===e?p=0:t.lineIndent<e&&(p=-1)):c=!1;if(c&&(c=l||o),(p===1||ls===r)&&(ps===r||Py===r?w=e:w=e+1,I=t.position-t.lineStart,p===1?c&&(hy(t,I)||lP(t,I,w))||cP(t,w)?u=!0:(s&&pP(t,w)||aP(t,w)||sP(t,w)?u=!0:dP(t)?(u=!0,(t.tag!==null||t.anchor!==null)&&Q(t,"alias node should not have any properties")):oP(t,w,ps===r)&&(u=!0,t.tag===null&&(t.tag="?")),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):p===0&&(u=c&&hy(t,I))),t.tag===null)t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);else if(t.tag==="?"){for(t.result!==null&&t.kind!=="scalar"&&Q(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),m=0,d=t.implicitTypes.length;m<d;m+=1)if(b=t.implicitTypes[m],b.resolve(t.result)){t.result=b.construct(t.result),t.tag=b.tag,t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);break}}else if(t.tag!=="!"){if(Or.call(t.typeMap[t.kind||"fallback"],t.tag))b=t.typeMap[t.kind||"fallback"][t.tag];else for(b=null,g=t.typeMap.multi[t.kind||"fallback"],m=0,d=g.length;m<d;m+=1)if(t.tag.slice(0,g[m].tag.length)===g[m].tag){b=g[m];break}b||Q(t,"unknown tag !<"+t.tag+">"),t.result!==null&&b.kind!==t.kind&&Q(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+b.kind+'", not "'+t.kind+'"'),b.resolve(t.result,t.tag)?(t.result=b.construct(t.result,t.tag),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):Q(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return t.listener!==null&&t.listener("close",t),t.tag!==null||t.anchor!==null||u}function fP(t){var e=t.position,r,n,o,a=!1,s;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);(s=t.input.charCodeAt(t.position))!==0&&(He(t,!0,-1),s=t.input.charCodeAt(t.position),!(t.lineIndent>0||s!==37));){for(a=!0,s=t.input.charCodeAt(++t.position),r=t.position;s!==0&&!lt(s);)s=t.input.charCodeAt(++t.position);for(n=t.input.slice(r,t.position),o=[],n.length<1&&Q(t,"directive name must not be less than one character in length");s!==0;){for(;dn(s);)s=t.input.charCodeAt(++t.position);if(s===35){do s=t.input.charCodeAt(++t.position);while(s!==0&&!Xt(s));break}if(Xt(s))break;for(r=t.position;s!==0&&!lt(s);)s=t.input.charCodeAt(++t.position);o.push(t.input.slice(r,t.position))}s!==0&&ym(t),Or.call(fy,n)?fy[n](t,n,o):us(t,'unknown document directive "'+n+'"')}if(He(t,!0,-1),t.lineIndent===0&&t.input.charCodeAt(t.position)===45&&t.input.charCodeAt(t.position+1)===45&&t.input.charCodeAt(t.position+2)===45?(t.position+=3,He(t,!0,-1)):a&&Q(t,"directives end mark is expected"),_i(t,t.lineIndent-1,ls,!1,!0),He(t,!0,-1),t.checkLineBreaks&&ZA.test(t.input.slice(e,t.position))&&us(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&gs(t)){t.input.charCodeAt(t.position)===46&&(t.position+=3,He(t,!0,-1));return}if(t.position<t.length-1)Q(t,"end of the stream or a document separator is expected");else return}function Oy(t,e){t=String(t),e=e||{},t.length!==0&&(t.charCodeAt(t.length-1)!==10&&t.charCodeAt(t.length-1)!==13&&(t+=`
`),t.charCodeAt(0)===65279&&(t=t.slice(1)));var r=new iP(t,e),n=t.indexOf("\0");for(n!==-1&&(r.position=n,Q(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)fP(r);return r.documents}function gP(t,e,r){e!==null&&typeof e=="object"&&typeof r>"u"&&(r=e,e=null);var n=Oy(t,r);if(typeof e!="function")return n;for(var o=0,a=n.length;o<a;o+=1)e(n[o])}function hP(t,e){var r=Oy(t,e);if(r.length!==0){if(r.length===1)return r[0];throw new pt("expected a single document in the stream, but found more")}}var yP=gP,_P=hP,Ny={loadAll:yP,load:_P},Hy=Object.prototype.toString,Uy=Object.prototype.hasOwnProperty,Tm=65279,TP=9,Eo=10,xP=13,SP=32,vP=33,bP=34,um=35,wP=37,EP=38,RP=39,kP=42,Vy=44,AP=45,ms=58,PP=61,MP=62,DP=63,LP=64,By=91,Wy=93,FP=96,$y=123,IP=124,jy=125,Xe={};Xe[0]="\\0";Xe[7]="\\a";Xe[8]="\\b";Xe[9]="\\t";Xe[10]="\\n";Xe[11]="\\v";Xe[12]="\\f";Xe[13]="\\r";Xe[27]="\\e";Xe[34]='\\"';Xe[92]="\\\\";Xe[133]="\\N";Xe[160]="\\_";Xe[8232]="\\L";Xe[8233]="\\P";var CP=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],OP=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function NP(t,e){var r,n,o,a,s,c,p;if(e===null)return{};for(r={},n=Object.keys(e),o=0,a=n.length;o<a;o+=1)s=n[o],c=String(e[s]),s.slice(0,2)==="!!"&&(s="tag:yaml.org,2002:"+s.slice(2)),p=t.compiledTypeMap.fallback[s],p&&Uy.call(p.styleAliases,c)&&(c=p.styleAliases[c]),r[s]=c;return r}function HP(t){var e,r,n;if(e=t.toString(16).toUpperCase(),t<=255)r="x",n=2;else if(t<=65535)r="u",n=4;else if(t<=4294967295)r="U",n=8;else throw new pt("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+We.repeat("0",n-e.length)+e}var UP=1,Ro=2;function VP(t){this.schema=t.schema||hm,this.indent=Math.max(1,t.indent||2),this.noArrayIndent=t.noArrayIndent||!1,this.skipInvalid=t.skipInvalid||!1,this.flowLevel=We.isNothing(t.flowLevel)?-1:t.flowLevel,this.styleMap=NP(this.schema,t.styles||null),this.sortKeys=t.sortKeys||!1,this.lineWidth=t.lineWidth||80,this.noRefs=t.noRefs||!1,this.noCompatMode=t.noCompatMode||!1,this.condenseFlow=t.condenseFlow||!1,this.quotingType=t.quotingType==='"'?Ro:UP,this.forceQuotes=t.forceQuotes||!1,this.replacer=typeof t.replacer=="function"?t.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function yy(t,e){for(var r=We.repeat(" ",e),n=0,o=-1,a="",s,c=t.length;n<c;)o=t.indexOf(`
`,n),o===-1?(s=t.slice(n),n=c):(s=t.slice(n,o+1),n=o+1),s.length&&s!==`
`&&(a+=r),a+=s;return a}function mm(t,e){return`
`+We.repeat(" ",t.indent*e)}function BP(t,e){var r,n,o;for(r=0,n=t.implicitTypes.length;r<n;r+=1)if(o=t.implicitTypes[r],o.resolve(e))return!0;return!1}function ds(t){return t===SP||t===TP}function ko(t){return 32<=t&&t<=126||161<=t&&t<=55295&&t!==8232&&t!==8233||57344<=t&&t<=65533&&t!==Tm||65536<=t&&t<=1114111}function _y(t){return ko(t)&&t!==Tm&&t!==xP&&t!==Eo}function Ty(t,e,r){var n=_y(t),o=n&&!ds(t);return(r?n:n&&t!==Vy&&t!==By&&t!==Wy&&t!==$y&&t!==jy)&&t!==um&&!(e===ms&&!o)||_y(e)&&!ds(e)&&t===um||e===ms&&o}function WP(t){return ko(t)&&t!==Tm&&!ds(t)&&t!==AP&&t!==DP&&t!==ms&&t!==Vy&&t!==By&&t!==Wy&&t!==$y&&t!==jy&&t!==um&&t!==EP&&t!==kP&&t!==vP&&t!==IP&&t!==PP&&t!==MP&&t!==RP&&t!==bP&&t!==wP&&t!==LP&&t!==FP}function $P(t){return!ds(t)&&t!==ms}function bo(t,e){var r=t.charCodeAt(e),n;return r>=55296&&r<=56319&&e+1<t.length&&(n=t.charCodeAt(e+1),n>=56320&&n<=57343)?(r-55296)*1024+n-56320+65536:r}function qy(t){var e=/^\n* /;return e.test(t)}var zy=1,dm=2,Gy=3,Ky=4,gi=5;function jP(t,e,r,n,o,a,s,c){var p,l=0,u=null,m=!1,d=!1,g=n!==-1,b=-1,w=WP(bo(t,0))&&$P(bo(t,t.length-1));if(e||s)for(p=0;p<t.length;l>=65536?p+=2:p++){if(l=bo(t,p),!ko(l))return gi;w=w&&Ty(l,u,c),u=l}else{for(p=0;p<t.length;l>=65536?p+=2:p++){if(l=bo(t,p),l===Eo)m=!0,g&&(d=d||p-b-1>n&&t[b+1]!==" ",b=p);else if(!ko(l))return gi;w=w&&Ty(l,u,c),u=l}d=d||g&&p-b-1>n&&t[b+1]!==" "}return!m&&!d?w&&!s&&!o(t)?zy:a===Ro?gi:dm:r>9&&qy(t)?gi:s?a===Ro?gi:dm:d?Ky:Gy}function qP(t,e,r,n,o){t.dump=function(){if(e.length===0)return t.quotingType===Ro?'""':"''";if(!t.noCompatMode&&(CP.indexOf(e)!==-1||OP.test(e)))return t.quotingType===Ro?'"'+e+'"':"'"+e+"'";var a=t.indent*Math.max(1,r),s=t.lineWidth===-1?-1:Math.max(Math.min(t.lineWidth,40),t.lineWidth-a),c=n||t.flowLevel>-1&&r>=t.flowLevel;function p(l){return BP(t,l)}switch(jP(e,c,t.indent,s,p,t.quotingType,t.forceQuotes&&!n,o)){case zy:return e;case dm:return"'"+e.replace(/'/g,"''")+"'";case Gy:return"|"+xy(e,t.indent)+Sy(yy(e,a));case Ky:return">"+xy(e,t.indent)+Sy(yy(zP(e,s),a));case gi:return'"'+GP(e)+'"';default:throw new pt("impossible error: invalid scalar style")}}()}function xy(t,e){var r=qy(t)?String(e):"",n=t[t.length-1]===`
`,o=n&&(t[t.length-2]===`
`||t===`
`),a=o?"+":n?"":"-";return r+a+`
`}function Sy(t){return t[t.length-1]===`
`?t.slice(0,-1):t}function zP(t,e){for(var r=/(\n+)([^\n]*)/g,n=function(){var l=t.indexOf(`
`);return l=l!==-1?l:t.length,r.lastIndex=l,vy(t.slice(0,l),e)}(),o=t[0]===`
`||t[0]===" ",a,s;s=r.exec(t);){var c=s[1],p=s[2];a=p[0]===" ",n+=c+(!o&&!a&&p!==""?`
`:"")+vy(p,e),o=a}return n}function vy(t,e){if(t===""||t[0]===" ")return t;for(var r=/ [^ ]/g,n,o=0,a,s=0,c=0,p="";n=r.exec(t);)c=n.index,c-o>e&&(a=s>o?s:c,p+=`
`+t.slice(o,a),o=a+1),s=c;return p+=`
`,t.length-o>e&&s>o?p+=t.slice(o,s)+`
`+t.slice(s+1):p+=t.slice(o),p.slice(1)}function GP(t){for(var e="",r=0,n,o=0;o<t.length;r>=65536?o+=2:o++)r=bo(t,o),n=Xe[r],!n&&ko(r)?(e+=t[o],r>=65536&&(e+=t[o+1])):e+=n||HP(r);return e}function KP(t,e,r){var n="",o=t.tag,a,s,c;for(a=0,s=r.length;a<s;a+=1)c=r[a],t.replacer&&(c=t.replacer.call(r,String(a),c)),(Tr(t,e,c,!1,!1)||typeof c>"u"&&Tr(t,e,null,!1,!1))&&(n!==""&&(n+=","+(t.condenseFlow?"":" ")),n+=t.dump);t.tag=o,t.dump="["+n+"]"}function by(t,e,r,n){var o="",a=t.tag,s,c,p;for(s=0,c=r.length;s<c;s+=1)p=r[s],t.replacer&&(p=t.replacer.call(r,String(s),p)),(Tr(t,e+1,p,!0,!0,!1,!0)||typeof p>"u"&&Tr(t,e+1,null,!0,!0,!1,!0))&&((!n||o!=="")&&(o+=mm(t,e)),t.dump&&Eo===t.dump.charCodeAt(0)?o+="-":o+="- ",o+=t.dump);t.tag=a,t.dump=o||"[]"}function QP(t,e,r){var n="",o=t.tag,a=Object.keys(r),s,c,p,l,u;for(s=0,c=a.length;s<c;s+=1)u="",n!==""&&(u+=", "),t.condenseFlow&&(u+='"'),p=a[s],l=r[p],t.replacer&&(l=t.replacer.call(r,p,l)),Tr(t,e,p,!1,!1)&&(t.dump.length>1024&&(u+="? "),u+=t.dump+(t.condenseFlow?'"':"")+":"+(t.condenseFlow?"":" "),Tr(t,e,l,!1,!1)&&(u+=t.dump,n+=u));t.tag=o,t.dump="{"+n+"}"}function JP(t,e,r,n){var o="",a=t.tag,s=Object.keys(r),c,p,l,u,m,d;if(t.sortKeys===!0)s.sort();else if(typeof t.sortKeys=="function")s.sort(t.sortKeys);else if(t.sortKeys)throw new pt("sortKeys must be a boolean or a function");for(c=0,p=s.length;c<p;c+=1)d="",(!n||o!=="")&&(d+=mm(t,e)),l=s[c],u=r[l],t.replacer&&(u=t.replacer.call(r,l,u)),Tr(t,e+1,l,!0,!0,!0)&&(m=t.tag!==null&&t.tag!=="?"||t.dump&&t.dump.length>1024,m&&(t.dump&&Eo===t.dump.charCodeAt(0)?d+="?":d+="? "),d+=t.dump,m&&(d+=mm(t,e)),Tr(t,e+1,u,!0,m)&&(t.dump&&Eo===t.dump.charCodeAt(0)?d+=":":d+=": ",d+=t.dump,o+=d));t.tag=a,t.dump=o||"{}"}function wy(t,e,r){var n,o,a,s,c,p;for(o=r?t.explicitTypes:t.implicitTypes,a=0,s=o.length;a<s;a+=1)if(c=o[a],(c.instanceOf||c.predicate)&&(!c.instanceOf||typeof e=="object"&&e instanceof c.instanceOf)&&(!c.predicate||c.predicate(e))){if(r?c.multi&&c.representName?t.tag=c.representName(e):t.tag=c.tag:t.tag="?",c.represent){if(p=t.styleMap[c.tag]||c.defaultStyle,Hy.call(c.represent)==="[object Function]")n=c.represent(e,p);else if(Uy.call(c.represent,p))n=c.represent[p](e,p);else throw new pt("!<"+c.tag+'> tag resolver accepts not "'+p+'" style');t.dump=n}return!0}return!1}function Tr(t,e,r,n,o,a,s){t.tag=null,t.dump=r,wy(t,r,!1)||wy(t,r,!0);var c=Hy.call(t.dump),p=n,l;n&&(n=t.flowLevel<0||t.flowLevel>e);var u=c==="[object Object]"||c==="[object Array]",m,d;if(u&&(m=t.duplicates.indexOf(r),d=m!==-1),(t.tag!==null&&t.tag!=="?"||d||t.indent!==2&&e>0)&&(o=!1),d&&t.usedDuplicates[m])t.dump="*ref_"+m;else{if(u&&d&&!t.usedDuplicates[m]&&(t.usedDuplicates[m]=!0),c==="[object Object]")n&&Object.keys(t.dump).length!==0?(JP(t,e,t.dump,o),d&&(t.dump="&ref_"+m+t.dump)):(QP(t,e,t.dump),d&&(t.dump="&ref_"+m+" "+t.dump));else if(c==="[object Array]")n&&t.dump.length!==0?(t.noArrayIndent&&!s&&e>0?by(t,e-1,t.dump,o):by(t,e,t.dump,o),d&&(t.dump="&ref_"+m+t.dump)):(KP(t,e,t.dump),d&&(t.dump="&ref_"+m+" "+t.dump));else if(c==="[object String]")t.tag!=="?"&&qP(t,t.dump,e,a,p);else{if(c==="[object Undefined]")return!1;if(t.skipInvalid)return!1;throw new pt("unacceptable kind of an object to dump "+c)}t.tag!==null&&t.tag!=="?"&&(l=encodeURI(t.tag[0]==="!"?t.tag.slice(1):t.tag).replace(/!/g,"%21"),t.tag[0]==="!"?l="!"+l:l.slice(0,18)==="tag:yaml.org,2002:"?l="!!"+l.slice(18):l="!<"+l+">",t.dump=l+" "+t.dump)}return!0}function YP(t,e){var r=[],n=[],o,a;for(fm(t,r,n),o=0,a=n.length;o<a;o+=1)e.duplicates.push(r[n[o]]);e.usedDuplicates=new Array(a)}function fm(t,e,r){var n,o,a;if(t!==null&&typeof t=="object")if(o=e.indexOf(t),o!==-1)r.indexOf(o)===-1&&r.push(o);else if(e.push(t),Array.isArray(t))for(o=0,a=t.length;o<a;o+=1)fm(t[o],e,r);else for(n=Object.keys(t),o=0,a=n.length;o<a;o+=1)fm(t[n[o]],e,r)}function ZP(t,e){e=e||{};var r=new VP(e);r.noRefs||YP(t,r);var n=t;return r.replacer&&(n=r.replacer.call({"":n},"",n)),Tr(r,0,n,!0,!0)?r.dump+`
`:""}var XP=ZP,eM={dump:XP};function xm(t,e){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+e+" instead, which is now safe by default.")}}var Qy=ze;var Jy=hm,N4=Ny.load,H4=Ny.loadAll,Yy=eM.dump;var U4=xm("safeLoad","load"),V4=xm("safeLoadAll","loadAll"),B4=xm("safeDump","dump");var hs=class{constructor(e,r){this.data=e;this.opts=r}represent(){let e=Yy(this.data,Object.assign({replacer:oM,schema:nM},this.opts));return e=e.trim(),e.includes(`
`)&&(e=`
`+e),e}},rM=new Qy("!format",{kind:"scalar",resolve:()=>!1,instanceOf:hs,represent:t=>t.represent()}),nM=Jy.extend({implicit:[rM]}),Sm=t=>typeof t=="object"&&t!=null;function iM(t){if(Sm(t))return Object.values(t).every(e=>!Sm(e)&&!Array.isArray(e));if(Array.isArray(t))return t.every(e=>!Sm(e)&&!Array.isArray(e))}function oM(t,e){return t===""?e:iM(e)?new hs(e,{flowLevel:0}):e}var vm=["addSelection","addSelectionAfter","addSelectionBefore","breakLine","clearAndSetSelection","copyToClipboard","cutToClipboard","decrement","deselect","editNewLineAfter","editNewLineBefore","experimental.setInstanceReference","extractVariable","findInDocument","findInWorkspace","flashTargets","foldRegion","followLink","followLinkAside","gitAccept","gitRevert","gitStage","gitUnstage","increment","indentLine","insertCopyAfter","insertCopyBefore","insertEmptyLineAfter","insertEmptyLineBefore","insertEmptyLinesAround","joinLines","outdentLine","randomizeTargets","remove","rename","revealDefinition","revealTypeDefinition","reverseTargets","scrollToBottom","scrollToCenter","scrollToTop","setSelection","setSelectionAfter","setSelectionBefore","showDebugHover","showHover","showQuickFix","showReferences","sortTargets","toggleLineBreakpoint","toggleLineComment","unfoldRegion","private.getTargets","private.setKeyboardTarget","private.showParseTree"],aM=["callAsFunction","editNew","executeCommand","generateSnippet","getText","highlight","insertSnippet","moveToTarget","pasteFromClipboard","replace","replaceWithTarget","rewrapWithPairedDelimiter","swapTargets","wrapWithPairedDelimiter","wrapWithSnippet","parsed"],Zy=[...vm,...aM];var sM=["angleBrackets","backtickQuotes","curlyBrackets","doubleQuotes","escapedDoubleQuotes","escapedParentheses","escapedSingleQuotes","escapedSquareBrackets","parentheses","singleQuotes","squareBrackets","tripleBacktickQuotes","tripleDoubleQuotes","tripleSingleQuotes"],cM=["string","any","collectionBoundary"],ys=[...sM,...cM],fn=["argumentOrParameter","argumentList","anonymousFunction","attribute","branch","class","className","collectionItem","collectionKey","comment","private.fieldAccess","functionCall","functionCallee","functionName","ifStatement","instance","list","map","name","namedFunction","regularExpression","statement","string","type","value","condition","section","sectionLevelOne","sectionLevelTwo","sectionLevelThree","sectionLevelFour","sectionLevelFive","sectionLevelSix","selector","private.switchStatementSubject","unit","xmlBothTags","xmlElement","xmlEndTag","xmlStartTag","part","chapter","subSection","subSubSection","namedParagraph","subParagraph","environment","character","word","token","identifier","line","sentence","paragraph","boundedParagraph","document","nonWhitespaceSequence","boundedNonWhitespaceSequence","url","notebookCell","command","textFragment","disqualifyDelimiter","pairDelimiter"];function Xy(t){return fn.includes(t.type)}var e_=["simpleScopeTypeType","complexScopeTypeType","customRegex","pairedDelimiter","action","customAction","grapheme"],_s=class extends Error{constructor(e){super(e),this.name="NeedsInitialTalonUpdateError"}},Ti=class extends Error{constructor(){super("Custom spoken forms are not currently supported in this ide"),this.name="DisabledCustomSpokenFormsError"}};function Ao(t){return t.replace(/([A-Z])/g," $1").split(" ").map(e=>e.toLowerCase()).join(" ")}function Ts(t){return t.version>=7}var Nr=class{constructor(e){this.hashFunction=e;this.map={}}hash(e){return this.hashFunction(e).join("\0")}set(e,r){return this.map[this.hash(e)]=r,this}has(e){return this.hash(e)in this.map}get(e){return this.map[this.hash(e)]}delete(e){return delete this.map[this.hash(e)],this}clear(){return this.map={},this}};var xi=class extends Map{constructor(r){super();this.getDefaultValue=r}get(r){let n=super.get(r);if(n!=null)return n;let o=this.getDefaultValue(r);return this.set(r,o),o}};function t_(...t){return{dispose(){t.forEach(({dispose:e})=>{try{e()}catch(r){console.error(r)}})}}}function Po(t){return typeof t=="string"||t instanceof String}function r_(t){let[e,...r]=t;return pM(e,r)}function pM(t,e){let r;if(Po(t)){let n=t,[o,a,...s]=e;r={version:0,spokenForm:n,action:o,targets:a,extraArgs:s,usePrePhraseSnapshot:!1}}else r=t;return r}function xs(t,e){let r=new Map;return t.forEach(n=>{let o=e(n),a;r.has(o)?a=r.get(o):(a=[],r.set(o,a)),a.push(n)}),r}function n_(t){for(let e of t)return!1;return!0}function Ss(t){return Object.keys(t)}function i_(t,e){return t.length===e.length&&t.every((r,n)=>r.isEqual(e[n]))}function vs(t,e){return`${t}.${e}`}function o_(t,e,r){if(t.length<2)return[...t];if(t.length===2)return e(t[0],t[1])?[t[0]]:[...t];let n=[],o=t.reduce((a,s)=>{let c=r(s),p=a.get(c);return p==null?(a.set(c,[s]),a):(a.get(c).push(s),p.length===2&&n.push(c),a)},new Map);return n.length===0?[...t]:(n.forEach(a=>{o.set(a,xo(o.get(a),e))}),t.flatMap(a=>{let s=r(a),c=o.get(s);if(c==null||c.length===0)return[];let p=c[0];return e(p,a)?(c.shift(),p):[]}))}function gn(t,e){if(t.length!==e.length)throw new Error("Lists must have the same length");return t.map((r,n)=>[r,e[n]])}var bs=class{constructor(e){this.isEnabledNotifier=new Pe;this.hatStyleChangedNotifier=new Pe;this.hatRanges=[];this.enabledHatShapes=["default"];this.hatShapePenalties=new Map([["default",0]]);this.enabledHatColors=["default"];this.hatColorPenalties=new Map([["default",0]]);this.isEnabled=!0;this.client=e,this.enabledHatStyles=this.generateHatStyles()}setHatRanges(e){this.hatRanges=e;let r=this.toJetbransHatRanges(e),n=JSON.stringify(r);return this.client.hatsUpdated(n),Promise.resolve()}setEnabledHatShapes(e){this.enabledHatShapes=e,this.enabledHatStyles=this.generateHatStyles(),this.hatStyleChangedNotifier.notifyListeners(this.enabledHatStyles)}setHatShapePenalties(e){this.hatShapePenalties=new Map(Object.entries(e)),this.enabledHatStyles=this.generateHatStyles(),this.hatStyleChangedNotifier.notifyListeners(this.enabledHatStyles)}setEnabledHatColors(e){this.enabledHatColors=e,this.enabledHatStyles=this.generateHatStyles(),this.hatStyleChangedNotifier.notifyListeners(this.enabledHatStyles)}setHatColorPenalties(e){this.hatColorPenalties=new Map(Object.entries(e)),this.enabledHatStyles=this.generateHatStyles(),this.hatStyleChangedNotifier.notifyListeners(this.enabledHatStyles)}toJetbransHatRanges(e){return e.map(r=>({styleName:r.styleName,editorId:r.editor.id,range:r.range}))}generateHatStyles(){let e=new Map;for(let r of this.enabledHatColors){let n=this.getColorPenalty(r);for(let o of this.enabledHatShapes){let a=this.getShapePenalty(o),s;o==="default"?s=r:s=`${r}-${o}`,e.set(s,{penalty:n+a})}}return Object.fromEntries(e)}getShapePenalty(e){let r=this.hatShapePenalties.get(e);return r==null?r=e==="default"?0:2:r=e==="default"?r:r+1,r}getColorPenalty(e){let r=this.hatColorPenalties.get(e);return r==null&&(r=e==="default"?0:1),r}onDidChangeEnabledHatStyles(e){return this.hatStyleChangedNotifier.registerListener(e)}onDidChangeIsEnabled(e){return this.isEnabledNotifier.registerListener(e)}toggle(e){this.isEnabled=e??!this.isEnabled,this.isEnabledNotifier.notifyListeners(this.isEnabled)}};var bm=class{constructor(e,r,n){this.client=e;this.ide=r;this.hats=n}};function z9(t,e){let r=new bs(t);return new bm(t,e,r)}var wm=class{constructor(e){this.notifier=new Pe;this.configuration=Yu;this.onDidChangeConfiguration=this.notifier.registerListener;this.configuration=e}getOwnConfiguration(e,r){return _o(this.configuration,e)}updateConfiguration(e){this.configuration=e,this.notifier.notifyListeners()}};function Y9(t){return new wm(t)}var uM={clipboardCopy:{acceptsLocation:!0},clipboardPaste:!0,toggleLineComment:{acceptsLocation:!0},indentLine:{acceptsLocation:!0},outdentLine:{acceptsLocation:!0},rename:{acceptsLocation:!0},quickFix:{acceptsLocation:!0},revealDefinition:{acceptsLocation:!0},revealTypeDefinition:{acceptsLocation:!0},showHover:void 0,showDebugHover:void 0,extractVariable:{acceptsLocation:!0},fold:{acceptsLocation:!0},highlight:{acceptsLocation:!0},unfold:{acceptsLocation:!0},showReferences:{acceptsLocation:!0},insertLineAfter:{acceptsLocation:!0},gitAccept:{acceptsLocation:!1},gitRevert:{acceptsLocation:!1},gitStage:{acceptsLocation:!1},gitUnstage:{acceptsLocation:!1}},ws=class{constructor(){this.commands=uM}};function a_(t,e,r,n){let o=[],a=n.join(`
`),s=new D(new pe(e,0),new pe(r-1,t.lineAt(r-1).text.length)),c=t.offsetAt(s.start),p=t.offsetAt(s.end)-c;return o.push({range:s,rangeOffset:c,rangeLength:p,text:a}),o}var Es=class{constructor(e){this.client=e}async readText(){return""}async writeText(e){}async copy(e,r){let n=JSON.stringify(r);this.client.clipboardCopy(e,n)}async paste(e){this.client.clipboardPaste(e)}};var Rs=class{async showMessage(e,r,n,...o){}};var ks=class{constructor(){this.data={...Zu}}get(e){return this.data[e]}set(e,r){return this.data[e]=r,Promise.resolve()}};var s_;(()=>{"use strict";var t={975:x=>{function y(T){if(typeof T!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(T))}function A(T,R){for(var P,C="",O=0,U=-1,ee=0,te=0;te<=T.length;++te){if(te<T.length)P=T.charCodeAt(te);else{if(P===47)break;P=47}if(P===47){if(!(U===te-1||ee===1))if(U!==te-1&&ee===2){if(C.length<2||O!==2||C.charCodeAt(C.length-1)!==46||C.charCodeAt(C.length-2)!==46){if(C.length>2){var ve=C.lastIndexOf("/");if(ve!==C.length-1){ve===-1?(C="",O=0):O=(C=C.slice(0,ve)).length-1-C.lastIndexOf("/"),U=te,ee=0;continue}}else if(C.length===2||C.length===1){C="",O=0,U=te,ee=0;continue}}R&&(C.length>0?C+="/..":C="..",O=2)}else C.length>0?C+="/"+T.slice(U+1,te):C=T.slice(U+1,te),O=te-U-1;U=te,ee=0}else P===46&&ee!==-1?++ee:ee=-1}return C}var M={resolve:function(){for(var T,R="",P=!1,C=arguments.length-1;C>=-1&&!P;C--){var O;C>=0?O=arguments[C]:(T===void 0&&(T=process.cwd()),O=T),y(O),O.length!==0&&(R=O+"/"+R,P=O.charCodeAt(0)===47)}return R=A(R,!P),P?R.length>0?"/"+R:"/":R.length>0?R:"."},normalize:function(T){if(y(T),T.length===0)return".";var R=T.charCodeAt(0)===47,P=T.charCodeAt(T.length-1)===47;return(T=A(T,!R)).length!==0||R||(T="."),T.length>0&&P&&(T+="/"),R?"/"+T:T},isAbsolute:function(T){return y(T),T.length>0&&T.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var T,R=0;R<arguments.length;++R){var P=arguments[R];y(P),P.length>0&&(T===void 0?T=P:T+="/"+P)}return T===void 0?".":M.normalize(T)},relative:function(T,R){if(y(T),y(R),T===R||(T=M.resolve(T))===(R=M.resolve(R)))return"";for(var P=1;P<T.length&&T.charCodeAt(P)===47;++P);for(var C=T.length,O=C-P,U=1;U<R.length&&R.charCodeAt(U)===47;++U);for(var ee=R.length-U,te=O<ee?O:ee,ve=-1,ge=0;ge<=te;++ge){if(ge===te){if(ee>te){if(R.charCodeAt(U+ge)===47)return R.slice(U+ge+1);if(ge===0)return R.slice(U+ge)}else O>te&&(T.charCodeAt(P+ge)===47?ve=ge:ge===0&&(ve=0));break}var Oe=T.charCodeAt(P+ge);if(Oe!==R.charCodeAt(U+ge))break;Oe===47&&(ve=ge)}var Vt="";for(ge=P+ve+1;ge<=C;++ge)ge!==C&&T.charCodeAt(ge)!==47||(Vt.length===0?Vt+="..":Vt+="/..");return Vt.length>0?Vt+R.slice(U+ve):(U+=ve,R.charCodeAt(U)===47&&++U,R.slice(U))},_makeLong:function(T){return T},dirname:function(T){if(y(T),T.length===0)return".";for(var R=T.charCodeAt(0),P=R===47,C=-1,O=!0,U=T.length-1;U>=1;--U)if((R=T.charCodeAt(U))===47){if(!O){C=U;break}}else O=!1;return C===-1?P?"/":".":P&&C===1?"//":T.slice(0,C)},basename:function(T,R){if(R!==void 0&&typeof R!="string")throw new TypeError('"ext" argument must be a string');y(T);var P,C=0,O=-1,U=!0;if(R!==void 0&&R.length>0&&R.length<=T.length){if(R.length===T.length&&R===T)return"";var ee=R.length-1,te=-1;for(P=T.length-1;P>=0;--P){var ve=T.charCodeAt(P);if(ve===47){if(!U){C=P+1;break}}else te===-1&&(U=!1,te=P+1),ee>=0&&(ve===R.charCodeAt(ee)?--ee==-1&&(O=P):(ee=-1,O=te))}return C===O?O=te:O===-1&&(O=T.length),T.slice(C,O)}for(P=T.length-1;P>=0;--P)if(T.charCodeAt(P)===47){if(!U){C=P+1;break}}else O===-1&&(U=!1,O=P+1);return O===-1?"":T.slice(C,O)},extname:function(T){y(T);for(var R=-1,P=0,C=-1,O=!0,U=0,ee=T.length-1;ee>=0;--ee){var te=T.charCodeAt(ee);if(te!==47)C===-1&&(O=!1,C=ee+1),te===46?R===-1?R=ee:U!==1&&(U=1):R!==-1&&(U=-1);else if(!O){P=ee+1;break}}return R===-1||C===-1||U===0||U===1&&R===C-1&&R===P+1?"":T.slice(R,C)},format:function(T){if(T===null||typeof T!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof T);return function(R,P){var C=P.dir||P.root,O=P.base||(P.name||"")+(P.ext||"");return C?C===P.root?C+O:C+"/"+O:O}(0,T)},parse:function(T){y(T);var R={root:"",dir:"",base:"",ext:"",name:""};if(T.length===0)return R;var P,C=T.charCodeAt(0),O=C===47;O?(R.root="/",P=1):P=0;for(var U=-1,ee=0,te=-1,ve=!0,ge=T.length-1,Oe=0;ge>=P;--ge)if((C=T.charCodeAt(ge))!==47)te===-1&&(ve=!1,te=ge+1),C===46?U===-1?U=ge:Oe!==1&&(Oe=1):U!==-1&&(Oe=-1);else if(!ve){ee=ge+1;break}return U===-1||te===-1||Oe===0||Oe===1&&U===te-1&&U===ee+1?te!==-1&&(R.base=R.name=ee===0&&O?T.slice(1,te):T.slice(ee,te)):(ee===0&&O?(R.name=T.slice(1,U),R.base=T.slice(1,te)):(R.name=T.slice(ee,U),R.base=T.slice(ee,te)),R.ext=T.slice(U,te)),ee>0?R.dir=T.slice(0,ee-1):O&&(R.dir="/"),R},sep:"/",delimiter:":",win32:null,posix:null};M.posix=M,x.exports=M}},e={};function r(x){var y=e[x];if(y!==void 0)return y.exports;var A=e[x]={exports:{}};return t[x](A,A.exports,r),A.exports}r.d=(x,y)=>{for(var A in y)r.o(y,A)&&!r.o(x,A)&&Object.defineProperty(x,A,{enumerable:!0,get:y[A]})},r.o=(x,y)=>Object.prototype.hasOwnProperty.call(x,y),r.r=x=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(x,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(x,"__esModule",{value:!0})};var n={};let o;r.r(n),r.d(n,{URI:()=>d,Utils:()=>k}),typeof process=="object"?o=process.platform==="win32":typeof navigator=="object"&&(o=navigator.userAgent.indexOf("Windows")>=0);let a=/^\w[\w\d+.-]*$/,s=/^\//,c=/^\/\//;function p(x,y){if(!x.scheme&&y)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${x.authority}", path: "${x.path}", query: "${x.query}", fragment: "${x.fragment}"}`);if(x.scheme&&!a.test(x.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(x.path){if(x.authority){if(!s.test(x.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(c.test(x.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}let l="",u="/",m=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class d{constructor(y,A,M,T,R,P=!1){re(this,"scheme");re(this,"authority");re(this,"path");re(this,"query");re(this,"fragment");typeof y=="object"?(this.scheme=y.scheme||l,this.authority=y.authority||l,this.path=y.path||l,this.query=y.query||l,this.fragment=y.fragment||l):(this.scheme=function(C,O){return C||O?C:"file"}(y,P),this.authority=A||l,this.path=function(C,O){switch(C){case"https":case"http":case"file":O?O[0]!==u&&(O=u+O):O=u}return O}(this.scheme,M||l),this.query=T||l,this.fragment=R||l,p(this,P))}static isUri(y){return y instanceof d||!!y&&typeof y.authority=="string"&&typeof y.fragment=="string"&&typeof y.path=="string"&&typeof y.query=="string"&&typeof y.scheme=="string"&&typeof y.fsPath=="string"&&typeof y.with=="function"&&typeof y.toString=="function"}get fsPath(){return H(this,!1)}with(y){if(!y)return this;let{scheme:A,authority:M,path:T,query:R,fragment:P}=y;return A===void 0?A=this.scheme:A===null&&(A=l),M===void 0?M=this.authority:M===null&&(M=l),T===void 0?T=this.path:T===null&&(T=l),R===void 0?R=this.query:R===null&&(R=l),P===void 0?P=this.fragment:P===null&&(P=l),A===this.scheme&&M===this.authority&&T===this.path&&R===this.query&&P===this.fragment?this:new b(A,M,T,R,P)}static parse(y,A=!1){let M=m.exec(y);return M?new b(M[2]||l,oe(M[4]||l),oe(M[5]||l),oe(M[7]||l),oe(M[9]||l),A):new b(l,l,l,l,l)}static file(y){let A=l;if(o&&(y=y.replace(/\\/g,u)),y[0]===u&&y[1]===u){let M=y.indexOf(u,2);M===-1?(A=y.substring(2),y=u):(A=y.substring(2,M),y=y.substring(M)||u)}return new b("file",A,y,l,l)}static from(y){let A=new b(y.scheme,y.authority,y.path,y.query,y.fragment);return p(A,!0),A}toString(y=!1){return X(this,y)}toJSON(){return this}static revive(y){if(y){if(y instanceof d)return y;{let A=new b(y);return A._formatted=y.external,A._fsPath=y._sep===g?y.fsPath:null,A}}return y}}let g=o?1:void 0;class b extends d{constructor(){super(...arguments);re(this,"_formatted",null);re(this,"_fsPath",null)}get fsPath(){return this._fsPath||(this._fsPath=H(this,!1)),this._fsPath}toString(A=!1){return A?X(this,!0):(this._formatted||(this._formatted=X(this,!1)),this._formatted)}toJSON(){let A={$mid:1};return this._fsPath&&(A.fsPath=this._fsPath,A._sep=g),this._formatted&&(A.external=this._formatted),this.path&&(A.path=this.path),this.scheme&&(A.scheme=this.scheme),this.authority&&(A.authority=this.authority),this.query&&(A.query=this.query),this.fragment&&(A.fragment=this.fragment),A}}let w={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function I(x,y,A){let M,T=-1;for(let R=0;R<x.length;R++){let P=x.charCodeAt(R);if(P>=97&&P<=122||P>=65&&P<=90||P>=48&&P<=57||P===45||P===46||P===95||P===126||y&&P===47||A&&P===91||A&&P===93||A&&P===58)T!==-1&&(M+=encodeURIComponent(x.substring(T,R)),T=-1),M!==void 0&&(M+=x.charAt(R));else{M===void 0&&(M=x.substr(0,R));let C=w[P];C!==void 0?(T!==-1&&(M+=encodeURIComponent(x.substring(T,R)),T=-1),M+=C):T===-1&&(T=R)}}return T!==-1&&(M+=encodeURIComponent(x.substring(T))),M!==void 0?M:x}function L(x){let y;for(let A=0;A<x.length;A++){let M=x.charCodeAt(A);M===35||M===63?(y===void 0&&(y=x.substr(0,A)),y+=w[M]):y!==void 0&&(y+=x[A])}return y!==void 0?y:x}function H(x,y){let A;return A=x.authority&&x.path.length>1&&x.scheme==="file"?`//${x.authority}${x.path}`:x.path.charCodeAt(0)===47&&(x.path.charCodeAt(1)>=65&&x.path.charCodeAt(1)<=90||x.path.charCodeAt(1)>=97&&x.path.charCodeAt(1)<=122)&&x.path.charCodeAt(2)===58?y?x.path.substr(1):x.path[1].toLowerCase()+x.path.substr(2):x.path,o&&(A=A.replace(/\//g,"\\")),A}function X(x,y){let A=y?L:I,M="",{scheme:T,authority:R,path:P,query:C,fragment:O}=x;if(T&&(M+=T,M+=":"),(R||T==="file")&&(M+=u,M+=u),R){let U=R.indexOf("@");if(U!==-1){let ee=R.substr(0,U);R=R.substr(U+1),U=ee.lastIndexOf(":"),U===-1?M+=A(ee,!1,!1):(M+=A(ee.substr(0,U),!1,!1),M+=":",M+=A(ee.substr(U+1),!1,!0)),M+="@"}R=R.toLowerCase(),U=R.lastIndexOf(":"),U===-1?M+=A(R,!1,!0):(M+=A(R.substr(0,U),!1,!0),M+=R.substr(U))}if(P){if(P.length>=3&&P.charCodeAt(0)===47&&P.charCodeAt(2)===58){let U=P.charCodeAt(1);U>=65&&U<=90&&(P=`/${String.fromCharCode(U+32)}:${P.substr(3)}`)}else if(P.length>=2&&P.charCodeAt(1)===58){let U=P.charCodeAt(0);U>=65&&U<=90&&(P=`${String.fromCharCode(U+32)}:${P.substr(2)}`)}M+=A(P,!0,!1)}return C&&(M+="?",M+=A(C,!1,!1)),O&&(M+="#",M+=y?O:I(O,!1,!1)),M}function fe(x){try{return decodeURIComponent(x)}catch{return x.length>3?x.substr(0,3)+fe(x.substr(3)):x}}let J=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function oe(x){return x.match(J)?x.replace(J,y=>fe(y)):x}var rt=r(975);let Ze=rt.posix||rt,Qt="/";var k;(function(x){x.joinPath=function(y,...A){return y.with({path:Ze.join(y.path,...A)})},x.resolvePath=function(y,...A){let M=y.path,T=!1;M[0]!==Qt&&(M=Qt+M,T=!0);let R=Ze.resolve(M,...A);return T&&R[0]===Qt&&!y.authority&&(R=R.substring(1)),y.with({path:R})},x.dirname=function(y){if(y.path.length===0||y.path===Qt)return y;let A=Ze.dirname(y.path);return A.length===1&&A.charCodeAt(0)===46&&(A=""),y.with({path:A})},x.basename=function(y){return Ze.basename(y.path)},x.extname=function(y){return Ze.extname(y.path)}})(k||(k={})),s_=n})();var{URI:c_,Utils:aK}=s_;function p_(t,e,r,n){let o=JSON.stringify(n);return t.setSelection(r,o),Promise.resolve()}function l_(t,e,r,n,o){let a=r.edit(o),s={text:r.text,changes:a.map(c=>({rangeOffset:c.rangeOffset,rangeLength:c.rangeLength,text:c.text}))};t.documentUpdated(n,JSON.stringify(s)),e.emitDidChangeTextDocument({document:r,contentChanges:a})}var st=class{constructor(e,r,n,o){this.ranges=e;this.singleRange=r;this.restoreSelection=n;this.ideCommand=o}};var Si=class{constructor(e,r,n,o,a,s){this.client=e;this.ide=r;this.id=n;this.document=o;this.visibleRanges=a;this.selections=s;this.options={tabSize:4,insertSpaces:!0};this.isActive=!0;this.isVisible=!0;this.isEditable=!0;this.isWritable=!0}isEqual(e){return this.id===e.id}async setSelections(e,r){i_(this.selections,e)||(await p_(this.client,this.document,this.id,e),this.selections=e)}edit(e){return this.isWritable?(l_(this.client,this.ide,this.document,this.id,e),Promise.resolve(!0)):Promise.resolve(!1)}async clipboardCopy(e){await this.ide.clipboard.copy(this.id,e)}async clipboardPaste(){await this.ide.clipboard.paste(this.id)}async indentLine(e){let r=new st(e||[],!0,!0,"EditorIndentSelection");await this.client.executeRangeCommand(this.id,JSON.stringify(r))}async outdentLine(e){let r=new st(e||[],!0,!0,"EditorUnindentSelection");await this.client.executeRangeCommand(this.id,JSON.stringify(r))}async insertLineAfter(e){await this.client.insertLineAfter(this.id,JSON.stringify(e))}focus(){throw new Error("focus not implemented.")}revealRange(e){return Promise.resolve()}async revealLine(e,r){await this.client.revealLine(this.id,e,r)}async openLink(e,r){let n=new st([e],!0,!1,"GotoDeclaration");await this.client.executeRangeCommand(this.id,JSON.stringify(n))}async fold(e){let r=new st(e||[],!0,!1,"CollapseRegion");await this.client.executeRangeCommand(this.id,JSON.stringify(r))}async unfold(e){let r=new st(e||[],!0,!1,"ExpandRegion");await this.client.executeRangeCommand(this.id,JSON.stringify(r))}async toggleBreakpoint(e){throw new Error("toggleBreakpoint not implemented.")}async toggleLineComment(e){let r=new st(e||[],!0,!1,"CommentByLineComment");await this.client.executeRangeCommand(this.id,JSON.stringify(r))}insertSnippet(e,r){throw new Error("insertSnippet not implemented.")}async rename(e){let r=new st(e?[e]:[],!0,!1,"RenameElement");await this.client.executeRangeCommand(this.id,JSON.stringify(r))}async showReferences(e){let r=new st(e?[e]:[],!0,!1,"FindUsages");await this.client.executeRangeCommand(this.id,JSON.stringify(r))}async quickFix(e){let r=new st(e?[e]:[],!0,!1,"ShowIntentionActions");await this.client.executeRangeCommand(this.id,JSON.stringify(r))}async revealDefinition(e){let r=new st(e?[e]:[],!0,!1,"GotoDeclaration");await this.client.executeRangeCommand(this.id,JSON.stringify(r))}async revealTypeDefinition(e){let r=new st(e?[e]:[],!0,!1,"QuickImplementations");await this.client.executeRangeCommand(this.id,JSON.stringify(r))}showHover(e){throw new Error("showHover not implemented.")}showDebugHover(e){throw new Error("showDebugHover not implemented.")}async extractVariable(e){let r=new st(e?[e]:[],!0,!1,"IntroduceVariable");await this.client.executeRangeCommand(this.id,JSON.stringify(r))}editNewNotebookCellAbove(){throw new Error("editNewNotebookCellAbove not implemented.")}editNewNotebookCellBelow(){throw new Error("editNewNotebookCellBelow not implemented.")}async gitAccept(e){throw new Error("gitAccept not implemented.")}async gitRevert(e){throw new Error("gitRevert not implemented.")}async gitStage(e){throw new Error("gitStage not implemented.")}async gitUnstage(e){throw new Error("gitUnstage not implemented.")}};function m_(t,e,r){let n=r.id,o=c_.parse(`talon-jetbrains://${n}`),a=r.languageId??"plaintext",s=new fi(o,a,r.text),c=[new D(r.firstVisibleLine,0,r.lastVisibleLine,0)],p=r.selections.map(u=>Em(s,u)),l=new Si(t,e,n,s,c,p);return l.isActive=r.active,l.isVisible=r.visible,l.isEditable=r.editable,l.isWritable=r.writable,l}function Em(t,e){return new Me(u_(e.anchor),u_(e.active))}function u_(t){return new pe(t.line,t.column)}var Rm=class{constructor(e,r){this.client=e;this.runMode="production";this.visibleNotebookEditors=[];this.disposables=[];this.quickPickReturnValue=void 0;this.editors=new Map;this.onDidChangeTextDocumentNotifier=new Pe;this.onDidOpenTextDocumentNotifier=new Pe;this.onDidChangeTextDocumentContentNotifier=new Pe;this.onDidCloseTextDocument=Mo;this.onDidChangeActiveTextEditor=Mo;this.onDidChangeVisibleTextEditors=Mo;this.onDidChangeTextEditorSelection=Mo;this.onDidChangeTextEditorVisibleRanges=Mo;this.configuration=r,this.keyValueStore=new ks,this.messages=new Rs,this.clipboard=new Es(this.client),this.capabilities=new ws,this.activeProject=void 0,this.activeEditor=void 0}async init(){}async showQuickPick(e,r){throw Error("showQuickPick Not implemented")}async setHighlightRanges(e,r,n){let o=r.id,a=JSON.stringify(n);this.client.setHighlightRanges(e,o,a)}async flashRanges(e){console.log("flashRangeses");let r=e.map(n=>({editorId:n.editor.id,range:n.range,style:n.style}));this.client.flashRanges(JSON.stringify(r))}get assetsRoot(){throw console.log("get assetsRoot"),new Error("assetsRoot not implemented.")}get cursorlessVersion(){throw console.log("get cursorlessVersion"),new Error("cursorlessVersion not implemented.")}get workspaceFolders(){throw console.log("get workspaceFolders"),new Error("workspaceFolders not get implemented.")}get activeTextEditor(){return this.activeEditor}get activeEditableTextEditor(){return this.activeEditor?.isEditable?this.activeEditor:void 0}get visibleTextEditors(){return[...this.editors.values()].filter(e=>e.isVisible)}getEditableTextEditor(e){if(e instanceof Si){if(e.isEditable)return e;throw Error(`Editor is not editable: ${e}`)}throw Error(`Unsupported text editor type: ${e}`)}async findInDocument(e,r){throw Error("findInDocument Not implemented")}async findInWorkspace(e){throw Error("findInWorkspace Not implemented")}async openTextDocument(e){throw Error("openTextDocument Not implemented")}async openUntitledTextDocument(e){throw Error("openUntitledTextDocument Not implemented")}async showInputBox(e){throw Error("showInputBox Not implemented")}async executeCommand(e,...r){throw new Error("executeCommand Method not implemented.")}onDidChangeTextDocument(e){return this.onDidChangeTextDocumentNotifier.registerListener(e)}onDidOpenTextDocument(e,r,n){return this.onDidOpenTextDocumentNotifier.registerListener(e)}handleCommandError(e){}disposeOnExit(...e){return this.disposables.push(...e),()=>ot(this.disposables,...e)}documentClosed(e){this.editors.delete(e)}documentCreated(e){this.documentChanged(e);let r=e,n=this.editors.get(r.id);n&&this.onDidOpenTextDocumentNotifier.notifyListeners(n.document)}documentChanged(e){let r=e,n=this.updateTextEditors(r),o=dM(r.text,r.firstVisibleLine,r.lastVisibleLine),a=a_(n.document,r.firstVisibleLine,r.lastVisibleLine,o),s={document:n.document,contentChanges:a};this.emitDidChangeTextDocument(s)}emitDidChangeTextDocument(e){this.onDidChangeTextDocumentNotifier.notifyListeners(e)}updateTextEditors(e){let r=this.editors.get(e.id);return r?mM(r,e):(r=m_(this.client,this,e),this.editors.set(e.id,r)),e.active&&(this.activeEditor=r),r}readQuery(e){return this.client.readQuery(e)}};function mM(t,e){let r=t.document;t.document=new fi(r.uri,r.languageId,e.text),t.visibleRanges=[new D(e.firstVisibleLine,0,e.lastVisibleLine+1,0)],t.selections=e.selections.map(n=>Em(t.document,n)),t.isActive=e.active,t.isVisible=e.visible,t.isEditable=e.editable,t.isWritable=e.writable}function dM(t,e,r){return t.split(`
`).slice(e,r)}function Mo(){return{dispose(){}}}function MK(t,e){return new Rm(t,e)}var __=Symbol.for("immer-nothing"),d_=Symbol.for("immer-draftable"),vt=Symbol.for("immer-state"),fM=process.env.NODE_ENV!=="production"?[function(t){return`The plugin for '${t}' has not been loaded into Immer. To enable the plugin, import and call \`enable${t}()\` when initializing your application.`},function(t){return`produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${t}'`},"This object has been frozen and should not be mutated",function(t){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+t},"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.","Immer forbids circular references","The first or second argument to `produce` must be a function","The third argument to `produce` must be a function or undefined","First argument to `createDraft` must be a plain object, an array, or an immerable object","First argument to `finishDraft` must be a draft returned by `createDraft`",function(t){return`'current' expects a draft, got: ${t}`},"Object.defineProperty() cannot be used on an Immer draft","Object.setPrototypeOf() cannot be used on an Immer draft","Immer only supports deleting array indices","Immer only supports setting array indices and the 'length' property",function(t){return`'original' expects a draft, got: ${t}`}]:[];function ut(t,...e){if(process.env.NODE_ENV!=="production"){let r=fM[t],n=typeof r=="function"?r.apply(null,e):r;throw new Error(`[Immer] ${n}`)}throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var vi=Object.getPrototypeOf;function bi(t){return!!t&&!!t[vt]}function yn(t){return t?T_(t)||Array.isArray(t)||!!t[d_]||!!t.constructor?.[d_]||Ls(t)||Fs(t):!1}var gM=Object.prototype.constructor.toString();function T_(t){if(!t||typeof t!="object")return!1;let e=vi(t);if(e===null)return!0;let r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===gM}function As(t,e){Ds(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function Ds(t){let e=t[vt];return e?e.type_:Array.isArray(t)?1:Ls(t)?2:Fs(t)?3:0}function Pm(t,e){return Ds(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function x_(t,e,r){let n=Ds(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function hM(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Ls(t){return t instanceof Map}function Fs(t){return t instanceof Set}function hn(t){return t.copy_||t.base_}function Mm(t,e){if(Ls(t))return new Map(t);if(Fs(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);let r=T_(t);if(e===!0||e==="class_only"&&!r){let n=Object.getOwnPropertyDescriptors(t);delete n[vt];let o=Reflect.ownKeys(n);for(let a=0;a<o.length;a++){let s=o[a],c=n[s];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(n[s]={configurable:!0,writable:!0,enumerable:c.enumerable,value:t[s]})}return Object.create(vi(t),n)}else{let n=vi(t);if(n!==null&&r)return{...t};let o=Object.create(n);return Object.assign(o,t)}}function Cm(t,e=!1){return Is(t)||bi(t)||!yn(t)||(Ds(t)>1&&(t.set=t.add=t.clear=t.delete=yM),Object.freeze(t),e&&Object.entries(t).forEach(([r,n])=>Cm(n,!0))),t}function yM(){ut(2)}function Is(t){return Object.isFrozen(t)}var _M={};function _n(t){let e=_M[t];return e||ut(0,t),e}var Do;function S_(){return Do}function TM(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function f_(t,e){e&&(_n("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Dm(t){Lm(t),t.drafts_.forEach(xM),t.drafts_=null}function Lm(t){t===Do&&(Do=t.parent_)}function g_(t){return Do=TM(Do,t)}function xM(t){let e=t[vt];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function h_(t,e){e.unfinalizedDrafts_=e.drafts_.length;let r=e.drafts_[0];return t!==void 0&&t!==r?(r[vt].modified_&&(Dm(e),ut(4)),yn(t)&&(t=Ps(e,t),e.parent_||Ms(e,t)),e.patches_&&_n("Patches").generateReplacementPatches_(r[vt].base_,t,e.patches_,e.inversePatches_)):t=Ps(e,r,[]),Dm(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==__?t:void 0}function Ps(t,e,r){if(Is(e))return e;let n=e[vt];if(!n)return As(e,(o,a)=>y_(t,n,e,o,a,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return Ms(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let o=n.copy_,a=o,s=!1;n.type_===3&&(a=new Set(o),o.clear(),s=!0),As(a,(c,p)=>y_(t,n,o,c,p,r,s)),Ms(t,o,!1),r&&t.patches_&&_n("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function y_(t,e,r,n,o,a,s){if(process.env.NODE_ENV!=="production"&&o===r&&ut(5),bi(o)){let c=a&&e&&e.type_!==3&&!Pm(e.assigned_,n)?a.concat(n):void 0,p=Ps(t,o,c);if(x_(r,n,p),bi(p))t.canAutoFreeze_=!1;else return}else s&&r.add(o);if(yn(o)&&!Is(o)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;Ps(t,o),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&Ms(t,o)}}function Ms(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Cm(e,r)}function SM(t,e){let r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:S_(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1},o=n,a=Om;r&&(o=[n],a=Lo);let{revoke:s,proxy:c}=Proxy.revocable(o,a);return n.draft_=c,n.revoke_=s,c}var Om={get(t,e){if(e===vt)return t;let r=hn(t);if(!Pm(r,e))return vM(t,r,e);let n=r[e];return t.finalized_||!yn(n)?n:n===km(t.base_,e)?(Am(t),t.copy_[e]=Im(n,t)):n},has(t,e){return e in hn(t)},ownKeys(t){return Reflect.ownKeys(hn(t))},set(t,e,r){let n=v_(hn(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){let o=km(hn(t),e),a=o?.[vt];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(hM(r,o)&&(r!==void 0||Pm(t.base_,e)))return!0;Am(t),Fm(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return km(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Am(t),Fm(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){let r=hn(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){ut(11)},getPrototypeOf(t){return vi(t.base_)},setPrototypeOf(){ut(12)}},Lo={};As(Om,(t,e)=>{Lo[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Lo.deleteProperty=function(t,e){return process.env.NODE_ENV!=="production"&&isNaN(parseInt(e))&&ut(13),Lo.set.call(this,t,e,void 0)};Lo.set=function(t,e,r){return process.env.NODE_ENV!=="production"&&e!=="length"&&isNaN(parseInt(e))&&ut(14),Om.set.call(this,t[0],e,r,t[0])};function km(t,e){let r=t[vt];return(r?hn(r):t)[e]}function vM(t,e,r){let n=v_(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function v_(t,e){if(!(e in t))return;let r=vi(t);for(;r;){let n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=vi(r)}}function Fm(t){t.modified_||(t.modified_=!0,t.parent_&&Fm(t.parent_))}function Am(t){t.copy_||(t.copy_=Mm(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var bM=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){let a=r;r=e;let s=this;return function(p=a,...l){return s.produce(p,u=>r.call(this,u,...l))}}typeof r!="function"&&ut(6),n!==void 0&&typeof n!="function"&&ut(7);let o;if(yn(e)){let a=g_(this),s=Im(e,void 0),c=!0;try{o=r(s),c=!1}finally{c?Dm(a):Lm(a)}return f_(a,n),h_(o,a)}else if(!e||typeof e!="object"){if(o=r(e),o===void 0&&(o=e),o===__&&(o=void 0),this.autoFreeze_&&Cm(o,!0),n){let a=[],s=[];_n("Patches").generateReplacementPatches_(e,o,a,s),n(a,s)}return o}else ut(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(s,...c)=>this.produceWithPatches(s,p=>e(p,...c));let n,o;return[this.produce(e,r,(s,c)=>{n=s,o=c}),n,o]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){yn(t)||ut(8),bi(t)&&(t=wM(t));let e=g_(this),r=Im(t,void 0);return r[vt].isManual_=!0,Lm(e),r}finishDraft(t,e){let r=t&&t[vt];(!r||!r.isManual_)&&ut(9);let{scope_:n}=r;return f_(n,e),h_(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){let o=e[r];if(o.path.length===0&&o.op==="replace"){t=o.value;break}}r>-1&&(e=e.slice(r+1));let n=_n("Patches").applyPatches_;return bi(t)?n(t,e):this.produce(t,o=>n(o,e))}};function Im(t,e){let r=Ls(t)?_n("MapSet").proxyMap_(t,e):Fs(t)?_n("MapSet").proxySet_(t,e):SM(t,e);return(e?e.scope_:S_()).drafts_.push(r),r}function wM(t){return bi(t)||ut(10,t),b_(t)}function b_(t){if(!yn(t)||Is(t))return t;let e=t[vt],r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Mm(t,e.scope_.immer_.useStrictShallowCopy_)}else r=Mm(t,!0);return As(r,(n,o)=>{x_(r,n,b_(o))}),e&&(e.finalized_=!1),r}var bt=new bM,Cs=bt.produce,LK=bt.produceWithPatches.bind(bt),FK=bt.setAutoFreeze.bind(bt),IK=bt.setUseStrictShallowCopy.bind(bt),CK=bt.applyPatches.bind(bt),OK=bt.createDraft.bind(bt),NK=bt.finishDraft.bind(bt);function w_(t,e,r){if(e>=t.length)throw Error(`Expected at least ${e+1} ${r} but received only ${t.length}`);return t[e]}function Os(t,e){if(Array.isArray(t))return t.map(r=>Os(r,e));if(typeof t=="object"&&t!=null){if(EM(t))return w_(e,t.index,"placeholder value");let r={};for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=Os(t[n],e));return r}return t}function EM(t){return typeof t=="object"&&t!=null&&"type"in t&&t.type==="placeholder"}var $s=mo(R_(),1);var RM={blue:"blue",green:"green",red:"red",pink:"pink",yellow:"yellow",userColor1:"navy",userColor2:"apricot",default:null},kM={ex:"ex",fox:"fox",wing:"wing",hole:"hole",frame:"frame",curve:"curve",eye:"eye",play:"play",crosshairs:"cross",bolt:"bolt",default:null},Hs={cursor:"this",that:"that",source:"source",nothing:"nothing",keyboard:null,explicit:null,decoratedSymbol:null,lineNumber:null,range:null,target:null},Us={modulo100:"row",relativeUp:"up",relativeDown:"down"};function k_(t){let e=RM[t];if(e==null)throw Error(`Unknown hat color '${t}'`);return e}function A_(t){let e=kM[t];if(e==null)throw Error(`Unknown hat shape '${t}'`);return e}function Nm(t,e){return Object.fromEntries(Object.entries(t).map(([r,n])=>[r,Object.fromEntries(Object.entries(n).map(([o,a])=>[o,e(a,r,o)]))]))}var AM=Object.fromEntries("air bat cap drum each fine gust harp sit jury crunch look made near odd pit quench red sun trap urge vest whale plex yank zip".split(" ").map((t,e)=>[String.fromCharCode(97+e),t])),PM=Object.fromEntries("zero one two three four five six seven eight nine".split(" ").map((t,e)=>[e.toString(),t])),MM={".":"dot",",":"comma",";":"semicolon",":":"colon","!":"bang","*":"asterisk","@":"at sign","&":"ampersand","?":"question","/":"slash","\\":"backslash","-":"dash","=":"equals","+":"plus","~":"tilde",_:"underscore","#":"hash","%":"percent","^":"caret","|":"pipe",$:"dollar","\xA3":"pound","'":"quote",'"':"double quote","`":"back tick","(":"paren",")":"right paren","{":"brace","}":"right brace","[":"square","]":"right square","<":"angle",">":"right angle","\uFFFD":"special"},P_={...AM,...PM,...MM};function Hr(...t){return{defaultSpokenForms:t,isDisabledByDefault:!0,isPrivate:!1}}function $e(...t){return{defaultSpokenForms:t,isDisabledByDefault:!0,isPrivate:!0}}var M_={pairedDelimiter:{curlyBrackets:"curly",angleBrackets:"diamond",escapedDoubleQuotes:"escaped quad",escapedSingleQuotes:"escaped twin",escapedParentheses:"escaped round",escapedSquareBrackets:"escaped box",doubleQuotes:"quad",parentheses:"round",backtickQuotes:"skis",squareBrackets:"box",singleQuotes:"twin",tripleDoubleQuotes:$e("triple quad"),tripleSingleQuotes:$e("triple twin"),tripleBacktickQuotes:$e("triple skis"),any:"pair",string:"string",whitespace:"void",collectionBoundary:$e("collection boundary")},simpleScopeTypeType:{argumentOrParameter:"arg",argumentList:"arg list",attribute:"attribute",functionCall:"call",functionCallee:"callee",className:"class name",class:"class",comment:"comment",functionName:"funk name",namedFunction:"funk",ifStatement:"if state",instance:"instance",collectionItem:"item",collectionKey:"key",anonymousFunction:"lambda",list:"list",map:"map",name:"name",regularExpression:"regex",section:"section",sectionLevelOne:Hr("one section"),sectionLevelTwo:Hr("two section"),sectionLevelThree:Hr("three section"),sectionLevelFour:Hr("four section"),sectionLevelFive:Hr("five section"),sectionLevelSix:Hr("six section"),selector:"selector",statement:"state",branch:"branch",type:"type",value:"value",condition:"condition",unit:"unit",xmlElement:"element",xmlBothTags:"tags",xmlStartTag:"start tag",xmlEndTag:"end tag",part:"part",chapter:"chapter",subSection:"subsection",subSubSection:"subsubsection",namedParagraph:"paragraph",subParagraph:"subparagraph",environment:"environment",command:"command",character:"char",word:"sub",token:"token",identifier:"identifier",line:"line",sentence:"sentence",paragraph:"block",boundedParagraph:"short block",document:"file",nonWhitespaceSequence:"paint",boundedNonWhitespaceSequence:"short paint",url:"link",notebookCell:"cell",string:$e("parse tree string"),textFragment:$e("text fragment"),disqualifyDelimiter:$e("disqualify delimiter"),pairDelimiter:$e("pair delimiter"),"private.fieldAccess":$e("access"),"private.switchStatementSubject":$e("subject")},complexScopeTypeType:{glyph:"glyph"},surroundingPairForceDirection:{left:"left",right:"right"},simpleModifier:{excludeInterior:"bounds",toRawSelection:"just",leading:"leading",trailing:"trailing",keepContentFilter:"content",keepEmptyFilter:"empty",inferPreviousMark:"its",startOf:"start of",endOf:"end of",interiorOnly:"inside",visible:"visible",extendThroughStartOf:"head",extendThroughEndOf:"tail",everyScope:"every"},modifierExtra:{first:"first",last:"last",previous:"previous",next:"next",forward:"forward",backward:"backward",ancestor:"grand"},customRegex:{},action:{addSelection:"append",addSelectionAfter:"append post",addSelectionBefore:"append pre",breakLine:"break",scrollToBottom:"bottom",toggleLineBreakpoint:"break point",cutToClipboard:"carve",scrollToCenter:"center",clearAndSetSelection:"change",remove:"chuck",insertCopyBefore:"clone up",insertCopyAfter:"clone",toggleLineComment:"comment",copyToClipboard:"copy",scrollToTop:"crown",outdentLine:"dedent",revealDefinition:"define",editNewLineBefore:"drink",insertEmptyLineBefore:"drop",extractVariable:"extract",insertEmptyLineAfter:"float",foldRegion:"fold",followLink:"follow",followLinkAside:"follow split",flashTargets:"flash",deselect:"give",highlight:"highlight",showHover:"hover",increment:"increment",decrement:"decrement",indentLine:"indent",showDebugHover:"inspect",setSelectionAfter:"post",editNewLineAfter:"pour",setSelectionBefore:"pre",insertEmptyLinesAround:"puff",showQuickFix:"quick fix",showReferences:"reference",rename:"rename",reverseTargets:"reverse",findInDocument:"scout",findInWorkspace:"scout all",randomizeTargets:"shuffle",generateSnippet:"snippet make",sortTargets:"sort",setSelection:"take",revealTypeDefinition:"type deaf",unfoldRegion:"unfold",callAsFunction:"call",swapTargets:"swap",replaceWithTarget:"bring",moveToTarget:"move",wrapWithPairedDelimiter:"wrap",wrapWithSnippet:"wrap",rewrapWithPairedDelimiter:"repack",insertSnippet:"snippet",pasteFromClipboard:"paste",joinLines:"join",gitAccept:"git accept",gitRevert:"git revert",gitStage:"git stage",gitUnstage:"git unstage","private.showParseTree":$e("parse tree"),"experimental.setInstanceReference":Hr("from"),editNew:$e("edit new"),executeCommand:$e("execute command"),parsed:$e("parsed"),getText:$e("get text"),replace:$e("replace"),"private.getTargets":$e("get targets"),"private.setKeyboardTarget":$e("set keyboard target")},customAction:{},grapheme:P_};var Hm=Nm(M_,t=>typeof t=="string"?{defaultSpokenForms:[t],isDisabledByDefault:!1,isPrivate:!1}:t),er=Nm(Hm,({defaultSpokenForms:t,isDisabledByDefault:e,isPrivate:r})=>({spokenForms:e?[]:t,isCustom:!1,defaultSpokenForms:t,requiresTalonUpdate:!1,isPrivate:r}));var Ce={rangeExclusive:"between",rangeInclusive:"past",rangeExcludingStart:null,rangeExcludingEnd:"until",listConnective:"and",swapConnective:"with",sourceDestinationConnective:"to",before:"before",after:"after",verticalRange:"slice",previous:"previous",next:"next",forward:"forward",backward:"backward"};var F_=mo(L_(),1),Bs=class{constructor(e){this.mooLexer=F_.default.compile(e)}reset(e,r){let{mooState:n}=r??{};return this.mooLexer.reset(e,n),this}formatError(e,r){return this.mooLexer.formatError(e,r)}has(e){return this.mooLexer.has(e)}save(){return{mooState:this.mooLexer.save()}}next(){let e=this.mooLexer.next();return this.skipToken(e)?this.next():e}transform({value:e}){return e}skipToken(e){return e?.type==="ws"}};var $t={};for(let t of vm){let{spokenForms:e}=er.action[t];for(let r of e)$t[r]={type:"simpleActionName",value:t}}var DM=["replaceWithTarget","moveToTarget"];for(let t of DM){let{spokenForms:e}=er.action[t];for(let r of e)$t[r]={type:"bringMove",value:t}}var LM=["before","after","to"];for(let t of LM){let e=Ce[t==="to"?"sourceDestinationConnective":t];$t[e]={type:"insertionMode",value:t}}for(let t of fn){let{spokenForms:e}=er.simpleScopeTypeType[t];for(let r of e)$t[r]={type:"simpleScopeTypeType",value:t}}for(let t of ys){let{spokenForms:e}=er.pairedDelimiter[t];for(let r of e)$t[r]={type:"pairedDelimiter",value:t}}for(let[t,e]of Object.entries(Hs))e!=null&&($t[e]={type:"simpleMarkType",value:t});er.modifierExtra.next.spokenForms.forEach(t=>{$t[t]={type:"direction",value:"forward"}});er.modifierExtra.previous.spokenForms.forEach(t=>{$t[t]={type:"direction",value:"backward"}});var tr=new Bs({ws:/[ \t]+/,placeholderTarget:{match:/<target\d*>/,value:t=>t.slice(7,-1)},token:{match:Object.keys($t),type:t=>$t[t].type,value:t=>$t[t].value}});function I_(t,e){return{name:t,target:e}}function C_(t,e,r){return{name:t,source:e,destination:r}}function Ws(t,e){let r={type:"primitive"};return t!=null&&(r.modifiers=t),e!=null&&(r.mark=e),r}function O_(t,e){return{type:"primitive",insertionMode:t,target:e}}function N_(t){return{type:"containingScope",scopeType:t}}function H_(t,e){return{type:"relativeScope",scopeType:t,offset:1,length:1,direction:e}}function U_(t){return{type:t}}function V_(t){return{type:"surroundingPair",delimiter:t}}function B_(t){return{type:t}}function W_(t){return{type:"target",target:{type:"placeholder",index:t.length===0?0:parseInt(t)-1}}}function Um(t){return t[0]}var FM={Lexer:tr,ParserRules:[{name:"main",symbols:["action"],postprocess:Um},{name:"action",symbols:[tr.has("simpleActionName")?{type:"simpleActionName"}:simpleActionName,"target"],postprocess:([t,e])=>I_(t,e)},{name:"action",symbols:[tr.has("bringMove")?{type:"bringMove"}:bringMove,"target","destination"],postprocess:([t,e,r])=>C_(t,e,r)},{name:"destination",symbols:["primitiveDestination"],postprocess:Um},{name:"destination",symbols:[tr.has("insertionMode")?{type:"insertionMode"}:insertionMode,"target"],postprocess:([t,e])=>O_(t,e)},{name:"target",symbols:["primitiveTarget"],postprocess:Um},{name:"primitiveTarget$ebnf$1",symbols:["modifier"]},{name:"primitiveTarget$ebnf$1",symbols:["primitiveTarget$ebnf$1","modifier"],postprocess:t=>t[0].concat([t[1]])},{name:"primitiveTarget",symbols:["primitiveTarget$ebnf$1"],postprocess:([t])=>Ws(t,void 0)},{name:"primitiveTarget",symbols:["mark"],postprocess:([t])=>Ws(void 0,t)},{name:"primitiveTarget$ebnf$2",symbols:["modifier"]},{name:"primitiveTarget$ebnf$2",symbols:["primitiveTarget$ebnf$2","modifier"],postprocess:t=>t[0].concat([t[1]])},{name:"primitiveTarget",symbols:["primitiveTarget$ebnf$2","mark"],postprocess:([t,e])=>Ws(t,e)},{name:"modifier",symbols:["scopeType"],postprocess:([t])=>N_(t)},{name:"modifier",symbols:[tr.has("direction")?{type:"direction"}:direction,"scopeType"],postprocess:([t,e])=>H_(e,t)},{name:"scopeType",symbols:[tr.has("simpleScopeTypeType")?{type:"simpleScopeTypeType"}:simpleScopeTypeType],postprocess:([t])=>U_(t)},{name:"scopeType",symbols:[tr.has("pairedDelimiter")?{type:"pairedDelimiter"}:pairedDelimiter],postprocess:([t])=>V_(t)},{name:"mark",symbols:[tr.has("simpleMarkType")?{type:"simpleMarkType"}:simpleMarkType],postprocess:([t])=>B_(t)},{name:"mark",symbols:[tr.has("placeholderTarget")?{type:"placeholderTarget"}:placeholderTarget],postprocess:([t])=>W_(t)}],ParserStart:"main"},$_=FM;function IM(){return new $s.Parser($s.Grammar.fromCompiled($_))}function j_(t){let e=IM();if(e.feed(t),e.results.length!==1)throw new Error(`Expected exactly one result, got ${e.results.length}`);return e.results[0]}function js(t,e){let r=j_(t);return Os(r,e)}function qs(t){switch(t.name){case"callAsFunction":return[t.callee,t.argument];case"replaceWithTarget":case"moveToTarget":return[t.source,...q_(t.destination)];case"swapTargets":return[t.target1,t.target2];case"pasteFromClipboard":case"insertSnippet":case"replace":case"editNew":return q_(t.destination);case"parsed":return qs(js(t.content,t.arguments));default:return[t.target]}}function q_(t){switch(t.type){case"list":return t.destinations.map(({target:e})=>e);case"primitive":return[t.target];case"implicit":return[]}}function Bm(t){return t.flatMap(Vm)}function Vm(t){switch(t.type){case"primitive":return[t];case"list":return t.elements.flatMap(Vm);case"range":return[t.anchor,t.active].flatMap(Vm);case"implicit":return[]}}var CM={arrowFunction:"anonymousFunction",dictionary:"map",regex:"regularExpression"},OM={purple:"pink"};function NM(t){t.modifiers?.forEach(e=>{(e.type==="containingScope"||e.type==="everyScope")&&(e.scopeType.type=CM[e.scopeType.type]??e.scopeType.type)})}function HM(t){t.mark?.type==="decoratedSymbol"&&(t.mark.symbolColor=OM[t.mark.symbolColor]??t.mark.symbolColor)}function Wm(t){Bm(t).forEach(e=>{NM(e),HM(e)})}function z_(t){return{...t,version:1}}var UM={type:"primitive",mark:{type:"cursor"},selectionType:"token",position:"contents",modifier:{type:"identity"},insideOutsideType:"inside"},VM={type:"primitive",isImplicit:!0},G_=t=>_r(t,UM)?VM:t;function K_(t){let e=t.action;return{spokenForm:t.spokenForm,action:{name:e,args:t.extraArgs},targets:WM(t.targets,e),usePrePhraseSnapshot:t.usePrePhraseSnapshot??!1,version:2}}function BM(t){switch(t.type){case"identity":return[];case"containingScope":{let{includeSiblings:e,scopeType:r,type:n,...o}=t;return[{type:e?"everyScope":"containingScope",scopeType:{type:r},...o}]}case"surroundingPair":{let{delimiterInclusion:e,...r}=t,n={type:"containingScope",scopeType:r};return e==="interiorOnly"||e==="excludeInterior"?n.scopeType.delimiter==="any"?[{type:e}]:[{type:e},n]:[n]}case"subpiece":{let{type:e,pieceType:r,...n}=t;return[{type:"ordinalRange",scopeType:{type:r},...n}]}case"head":return[{type:"extendThroughStartOf"}];case"tail":return[{type:"extendThroughEndOf"}];default:return[t]}}function $m(t,e){let{type:r,isImplicit:n,mark:o,insideOutsideType:a,modifier:s,selectionType:c,position:p}=t,l=[];if(p&&p!=="contents"&&(p==="before"?a==="inside"?l.push({type:"position",position:"start"}):e==="remove"?l.push({type:"leading"}):l.push({type:"position",position:"before"}):a==="inside"?l.push({type:"position",position:"end"}):e==="remove"?l.push({type:"trailing"}):l.push({type:"position",position:"after"})),c)switch(c){case"token":if(s?.type==="subpiece")break;case"line":if(o?.type==="lineNumber")break;default:l.push({type:"containingScope",scopeType:{type:c}})}return s&&l.push(...BM(s)),{type:r,isImplicit:n,modifiers:l.length>0?l:void 0,mark:o?.type==="cursorToken"?void 0:o}}function Q_(t,e){switch(t.type){case"list":return{...t,elements:t.elements.map(r=>Q_(r,e))};case"range":{let{type:r,rangeType:n,start:o,end:a,excludeStart:s,excludeEnd:c}=t;return{type:r,rangeType:n,anchor:$m(o,e),active:$m(a,e),excludeAnchor:s??!1,excludeActive:c??!1}}case"primitive":return $m(t,e)}}function WM(t,e){return t.map(r=>Q_(r,e)).map(r=>r.type==="primitive"?G_(r):r)}function J_(t){return{...t,version:3,targets:t.targets.map(Y_)}}function Y_(t){switch(t.type){case"list":return{...t,elements:t.elements.map(e=>Y_(e))};case"range":{let{anchor:e,active:r,...n}=t;return{anchor:jm(e),active:jm(r),...n}}case"primitive":return jm(t)}}function jm(t){let e=t.modifiers!=null?t.modifiers.map(jM):void 0;if(t.mark?.type==="lineNumber"){let{anchor:r,active:n}=t.mark;if(r.type!==n.type||r.lineNumber<0!=n.lineNumber<0)return{type:"range",anchor:{type:"primitive",mark:Io(r),modifiers:e},active:{type:"primitive",mark:Io(n)},excludeAnchor:!1,excludeActive:!1}}return{...t,mark:t.mark!=null?$M(t.mark):void 0,modifiers:e}}function $M(t){switch(t.type){case"lineNumber":return qM(t);default:return t}}function jM(t){switch(t.type){case"ordinalRange":return zM(t);default:return t}}function qM(t){return _r(t.anchor,t.active)?Io(t.anchor):{type:"range",anchor:Io(t.anchor),active:Io(t.active)}}function zM(t){return t.anchor===t.active?Fo(t.scopeType,t.anchor):t.anchor===0&&t.active>t.anchor?Fo(t.scopeType,t.anchor,t.active-t.anchor+1):t.anchor<0&&t.active===-1?Fo(t.scopeType,t.anchor,-t.anchor):{type:"range",anchor:Fo(t.scopeType,t.anchor),active:Fo(t.scopeType,t.active),excludeAnchor:t.excludeAnchor,excludeActive:t.excludeActive}}function Io(t){return{type:"lineNumber",lineNumberType:t.type,lineNumber:t.lineNumber}}function Fo(t,e,r=1){return{type:"ordinalScope",scopeType:t,start:e,length:r}}function X_(t){return{...t,version:4,targets:t.targets.map(eT)}}function eT(t){switch(t.type){case"primitive":return Z_(t);case"range":{let{anchor:e,...r}=t;return{...r,anchor:Z_(e)}}case"list":{let{elements:e,...r}=t;return{...r,elements:e.map(eT)}}}}function Z_(t){return t.mark==null&&t.modifiers==null||t.isImplicit?{type:"implicit"}:t}function tT(t){return{...t,version:5,action:GM(t.action),targets:t.targets.map(zs)}}function GM(t){switch(t.name){case"wrapWithSnippet":{let[e,r]=KM(t.args[0]);return{name:"wrapWithSnippet",args:[{type:"named",name:e,variableName:r}]}}case"insertSnippet":{let[e,r]=t.args,n={type:"named",name:e};return r!=null&&(n.substitutions=r),{name:"insertSnippet",args:[n]}}default:return t}}function KM(t){let[e,r]=t.split(".");if(e==null||r==null)throw new Error("Snippet location missing '.'");return[e,r]}function zs(t){switch(t.type){case"implicit":return t;case"list":return{...t,elements:t.elements.map(zs)};case"range":return{...t,anchor:zs(t.anchor),active:zs(t.active)};case"primitive":return{...t,mark:t.mark!=null?qm(t.mark):void 0,modifiers:t.modifiers!=null&&t.modifiers.length>0?t.modifiers.map(zm):void 0}}}function qm(t){return t.type==="range"?{...t,anchor:qm(t.anchor),active:qm(t.active),excludeAnchor:t.excludeAnchor??!1,excludeActive:t.excludeActive??!1}:t}function zm(t){return t.type==="range"?{...t,anchor:zm(t.anchor),active:zm(t.active),excludeAnchor:t.excludeAnchor??!1,excludeActive:t.excludeActive??!1}:t}var QM={bring:"replaceWithTarget",call:"callAsFunction",clear:"clearAndSetSelection",commentLines:"toggleLineComment",copy:"copyToClipboard",cut:"cutToClipboard",delete:"remove",editNewLineAbove:"editNewLineBefore",editNewLineBelow:"editNewLineAfter",findInFiles:"findInWorkspace",fold:"foldRegion",indentLines:"indentLine",insertEmptyLineAbove:"insertEmptyLineBefore",insertEmptyLineBelow:"insertEmptyLineAfter",insertLineAfter:"editNewLineAfter",insertLineBefore:"editNewLineBefore",move:"moveToTarget",outdentLines:"outdentLine",paste:"pasteFromClipboard",reverse:"reverseTargets",setBreakpoint:"toggleLineBreakpoint",sort:"sortTargets",swap:"swapTargets",unfold:"unfoldRegion",use:"replaceWithTarget",wrap:"wrapWithPairedDelimiter"};function Gm(t){let e=QM[t]??t;if(!Zy.includes(e))throw new Error(`Unknown action name: ${e}`);return e}function rT(t){return{version:6,spokenForm:t.spokenForm,usePrePhraseSnapshot:t.usePrePhraseSnapshot,action:JM(t.action,t.targets)}}function JM(t,e){let r=Gm(t.name);switch(r){case"replaceWithTarget":case"moveToTarget":return{name:r,source:Mt(e[0]),destination:Co(e[1])};case"swapTargets":return{name:r,target1:Mt(e[0]),target2:Mt(e[1])};case"callAsFunction":return{name:r,callee:Mt(e[0]),argument:Mt(e[1])};case"pasteFromClipboard":return{name:r,destination:Co(e[0])};case"wrapWithPairedDelimiter":case"rewrapWithPairedDelimiter":return{name:r,left:t.args[0],right:t.args[1],target:Mt(e[0])};case"generateSnippet":return{name:r,snippetName:t.args?.[0],target:Mt(e[0])};case"insertSnippet":return{name:r,snippetDescription:t.args[0],destination:Co(e[0])};case"wrapWithSnippet":return{name:r,snippetDescription:t.args[0],target:Mt(e[0])};case"executeCommand":return{name:r,commandId:t.args[0],options:t.args?.[1],target:Mt(e[0])};case"replace":return{name:r,replaceWith:t.args[0],destination:Co(e[0])};case"highlight":{let n={name:r,target:Mt(e[0])};return t.args?.[0]!=null&&(n.highlightId=t.args?.[0]),n}case"editNew":return{name:r,destination:Co(e[0])};case"getText":return{name:r,options:t.args?.[0],target:Mt(e[0])};case"parsed":throw Error("Parsed action should not be present in V5");default:return{name:r,target:Mt(e[0])}}}function Mt(t){switch(t.type){case"list":case"range":case"primitive":return YM(t);case"implicit":return t}}function YM(t){switch(t.type){case"list":return ZM(t);case"range":case"primitive":return Gs(t)}}function ZM(t){return{...t,elements:t.elements.map(Gs)}}function Gs(t){switch(t.type){case"range":return nT(t);case"primitive":return Ks(t)}}function nT(t){let{anchor:e,active:r}=t,n={type:"range",anchor:e.type==="implicit"?e:Ks(e),active:Ks(r),excludeAnchor:t.excludeAnchor,excludeActive:t.excludeActive};return t.rangeType!=null&&(n.rangeType=t.rangeType),n}function Ks(t){let e={type:"primitive"},r=iD(t.modifiers);return r!=null&&(e.modifiers=r),t.mark!=null&&(e.mark=t.mark),e}function Co(t){switch(t.type){case"list":return XM(t);case"range":return eD(t);case"primitive":return tD(t);case"implicit":return rD()}}function XM(t){let e=[],r=[],n,o=()=>{r.length>0&&e.push({type:"primitive",insertionMode:n??"to",target:r.length===1?r[0]:{type:"list",elements:r}})};return t.elements.forEach(a=>{let s=Qs(a);s!=null?(o(),r=[Gs(a)],n=s):r.push(Gs(a))}),o(),e.length>1?{type:"list",destinations:e}:e[0]}function eD(t){return{type:"primitive",insertionMode:Qs(t.anchor)??"to",target:nT(t)}}function tD(t){return{type:"primitive",insertionMode:Qs(t)??"to",target:Ks(t)}}function rD(){return{type:"implicit"}}function Qs(t){switch(t.type){case"implicit":return"to";case"primitive":return nD(t);case"range":return Qs(t.anchor)}}function nD(t){let e=t.modifiers?.find(r=>r.type==="position");if(e!=null){if(t.modifiers.indexOf(e)!==0)throw Error("Position modifier has to be at first index");if(e?.position==="before"||e?.position==="after")return e.position}}function iD(t){let e=[];if(t!=null)for(let r of t)r.type==="position"?r.position==="start"?e.push({type:"startOf"}):r.position==="end"&&e.push({type:"endOf"}):e.push(r);return e.length>0?e:void 0}function iT(t){return{...t,version:7}}function Qm(t){let e=oD(t,7),{action:r,usePrePhraseSnapshot:n=!1,spokenForm:o}=e;return{version:7,spokenForm:o,action:Cs(r,a=>{let s=qs(a);Wm(s),r.name}),usePrePhraseSnapshot:n}}function oD(t,e){if(t.version>7)throw new ka;for(;t.version<e;)switch(t.version){case 0:t=z_(t);break;case 1:t=K_(t);break;case 2:t=J_(t);break;case 3:t=X_(t);break;case 4:t=tT(t);break;case 5:t=rT(t);break;case 6:t=iT(t);break;default:throw new Error(`Can't upgrade from unknown version ${t.version}`)}return t}var Jm;function Ym(t){Jm=t}function h(){if(Jm==null)throw Error("Tried to access ide before it was injected");return Jm}var Js=class{constructor(e){this.maxLength=e;this.stack=[];this.index=void 0}push(e){this.index!=null?this.stack.splice(this.index+1,this.stack.length-this.index-1,e):this.stack.push(e),this.stack.length>this.maxLength&&this.stack.shift(),this.index=this.stack.length-1}undo(){if(this.index!=null&&this.index>0)return this.index--,this.stack[this.index]}redo(){if(this.index!=null&&this.index<this.stack.length-1)return this.index++,this.stack[this.index]}};var aD=25,Ys=class{constructor(){this.targetMap=new Map;this.targetHistory=new xi(()=>new Js(aD));this.notifier=new Pe}set(e,r,{history:n=!1}={}){this.targetMap.set(e,r),n&&r!=null&&this.targetHistory.get(e).push(r),this.notifier.notifyListeners(e,r)}get(e){return this.targetMap.get(e)}undo(e){let r=this.targetHistory.get(e).undo();r!=null&&this.set(e,r,{history:!1})}redo(e){let r=this.targetHistory.get(e).redo();r!=null&&this.set(e,r,{history:!1})}onStoredTargets(e){for(let r of am)e(r,this.get(r));return this.notifier.registerListener(e)}};function Ue(t){if(t.length===0)throw new Error("Require at least one target with this action");let e=t.map(r=>r.editor);if(new Set(e).size>1)throw new Error("Can only have one editor with this action");return e[0]}function mt(t){if(t.length!==1)throw new Error("Can only have one target with this action");return t[0]}async function xr(t,e,r){return Promise.all(Zm(t,e).map(([n,o])=>r(n,o)))}async function be(t,e){return xr(t,r=>r.editor,e)}async function oT(t,e){let r=Zm(t,o=>o.editor),n=[];for(let[o,a]of r)n.push(await e(o,a));return n}function aT(t){return Zm(t,e=>e.editor)}function Zm(t,e){let n=xs(t,o=>e(o).document.uri);return Array.from(n.values(),o=>[e(o[0]),o])}function Dt(t,e){return e!=null?Be(t,e).map(([n,o])=>({editor:n.editor,selection:n?.isReversed?new Me(o.end,o.start):new Me(o.start,o.end)})):t.map(n=>({editor:n.editor,selection:n.contentSelection}))}function Lt(t,e){return t.textualType==="line"?Pt(e):at(e)}function sD(t){return Lt(t,t.contentRange)}function ue(t,e,r,n=sD){return t.flashRanges(e.map(o=>({editor:o.editor,range:n(o),style:r})))}function Ur(t,e){return new D(new pe(e.start.line,0),t.document.lineAt(e.end).range.end)}function Xm(t,e){return e.isEmpty?0:t.document.offsetAt(e.end)-t.document.offsetAt(e.start)}function sT(t,e){let[r,n]=e instanceof pe?[e,e]:[e.start,e.end];return t.start.isBefore(r)&&t.end.isAfter(n)}function Sr(t,...e){for(let r of e)r!=null&&(t=t.union(r));return t}var Zs=class t{constructor(e,r,n){this.target=e;this.insertionMode=r;this.contentRange=pD(e.contentRange,r),this.isBefore=r==="before",this.isLineDelimiter=e.insertionDelimiter.includes(`
`),this.indentationString=n??this.isLineDelimiter?cD(e.editor,e.contentRange):"",this.insertionPrefix=e.prefixRange!=null?e.editor.document.getText(e.prefixRange):void 0}get contentSelection(){return this.contentRange.toSelection(this.target.isReversed)}get editor(){return this.target.editor}get insertionDelimiter(){return this.target.insertionDelimiter}get isRaw(){return this.target.isRaw}withTarget(e){return new t(e,this.insertionMode,this.indentationString)}getEditNewActionType(){return this.insertionMode==="after"&&this.target.contentRange.isSingleLine&&this.insertionDelimiter===`
`&&this.insertionPrefix==null?"insertLineAfter":"edit"}constructChangeEdit(e,r=!1){return this.insertionMode==="before"||this.insertionMode==="after"?this.constructEditWithDelimiters(e,r):this.constructEditWithoutDelimiters(e)}constructEditWithDelimiters(e,r){let n=this.getEditRange(),o=this.getEditText(e,r),a=s=>this.updateRange(s,e,r);return{range:n,text:o,isReplace:this.insertionMode==="after",updateRange:a}}constructEditWithoutDelimiters(e){return{range:this.contentRange,text:e,updateRange:r=>r}}getEditRange(){let e=(()=>{let r=this.isBefore?Sr(this.target.contentRange,this.target.prefixRange).start:this.target.contentRange.end;if(this.isLineDelimiter){let n=this.editor.document.lineAt(r),o=this.isBefore?n.rangeTrimmed?.start??n.range.start:n.rangeTrimmed?.end??n.range.end;if(r.isEqual(o))return this.isBefore?n.range.start:n.range.end}return r})();return new D(e,e)}getEditText(e,r){let o=(r?"":this.indentationString)+(this.insertionPrefix??"")+e;return this.isBefore?o+this.insertionDelimiter:this.insertionDelimiter+o}updateRange(e,r,n){let o=this.editor.document.offsetAt(e.start)+(n?0:this.indentationString.length)+(this.insertionPrefix?.length??0),a=this.isBefore?o:o+this.getLengthOfInsertionDelimiter(),s=a+r.length;return new D(this.editor.document.positionAt(a),this.editor.document.positionAt(s))}getLengthOfInsertionDelimiter(){if(this.editor.document.eol==="CRLF"){let e=this.insertionDelimiter.match(/\n/g);if(e!=null)return this.insertionDelimiter.length+e.length}return this.insertionDelimiter.length}};function cD(t,e){let r=Number.MAX_SAFE_INTEGER,n="";for(let o=e.start.line;o<=e.end.line;++o){let a=t.document.lineAt(o);if(a.range.isEmpty||a.isEmptyOrWhitespace&&!e.isSingleLine)continue;let s=a.rangeTrimmed?.start??a.range.end;s.character<r&&(r=s.character,n=a.text.slice(0,r))}return n}function pD(t,e){switch(e){case"before":return t.start.toEmptyRange();case"after":return t.end.toEmptyRange();case"to":return t}}function wi(t,e,r,n){return lD(t.contentRange,e.contentRange,r,n)}function lD(t,e,r,n){return new D(r?t.start:t.end,n?e.end:e.start)}function Ei(t,e,r,n){let o=r?t.contentRange.start:new pe(t.contentRange.end.line+1,0),a=n?e.contentRange.end:e.editor.document.lineAt(e.contentRange.start.line-1).range.end;return new D(o,a)}var he=class t{constructor(e){this.hasExplicitScopeType=!0;this.hasExplicitRange=!0;this.isRaw=!1;this.isImplicit=!1;this.isNotebookCell=!1;this.textualType="token";this.state={editor:e.editor,isReversed:e.isReversed,contentRange:e.contentRange,thatTarget:e.thatTarget}}get editor(){return this.state.editor}get isReversed(){return this.state.isReversed}get thatTarget(){return this.state.thatTarget!=null?this.state.thatTarget.thatTarget:this}get contentText(){return this.editor.document.getText(this.contentRange)}get contentSelection(){return this.contentRange.toSelection(this.isReversed)}get contentRange(){return this.state.contentRange}constructRemovalEdit(){return{range:this.getRemovalRange(),text:"",updateRange:e=>e}}getRemovalHighlightRange(){return Lt(this,this.getRemovalRange())}withThatTarget(e){return this.cloneWith({thatTarget:e})}withContentRange(e){return this.cloneWith({contentRange:e})}getInterior(){}getBoundary(){}cloneWith(e){let r=Object.getPrototypeOf(this).constructor;return new r({...this.getCloneParameters(),...e})}maybeCreateRichRangeTarget(e,r){let{constructor:n}=Object.getPrototypeOf(this);return new n({...this.getCloneParameters(),isReversed:e,contentRange:wi(this,r,!0,!0)})}isEqual(e){return e instanceof t&&_r(this.getEqualityParameters(),e.getEqualityParameters())}getEqualityParameters(){let{thatTarget:e,...r}=this.getCloneParameters();return{...r}}toDestination(e){return new Zs(this,e)}toPlainObject(){return{type:this.type,contentRange:py(this.contentRange),isReversed:this.isReversed,hasExplicitRange:this.hasExplicitRange}}};function Tn(t,e){let{document:r}=t,n=r.getText(e),o=n.length-n.trimStart().length,a=n.length-n.trimEnd().length,s=r.offsetAt(e.start)+o,c=r.offsetAt(e.end)-a,p=r.positionAt(s),l=r.positionAt(c);return new D(p,l)}function Xs(t,e,r,n){return r==null?void 0:new t({editor:e,isReversed:n,contentRange:r})}var ye=class extends he{constructor(r){super(r);this.type="PlainTarget";this.getLeadingDelimiterTarget=()=>{};this.getTrailingDelimiterTarget=()=>{};this.getRemovalRange=()=>this.contentRange;this.textualType=r.textualType??"token",this.insertionDelimiter=r.insertionDelimiter??""}getCloneParameters(){return{...this.state,textualType:this.textualType,insertionDelimiter:this.insertionDelimiter}}};function Ri(t,e,r){return Xs(ye,t,e,r)}var ec=class extends he{constructor(r){super(r);this.type="DocumentTarget";this.textualType="line";this.insertionDelimiter=`

`}getInterior(){return[new ye({editor:this.editor,isReversed:this.isReversed,contentRange:Tn(this.editor,this.contentRange)})]}getRemovalRange(){return this.contentRange}getLeadingDelimiterTarget(){}getTrailingDelimiterTarget(){}getCloneParameters(){return this.state}};var dt=class t extends he{constructor(){super(...arguments);this.type="LineTarget";this.textualType="line";this.insertionDelimiter=`
`;this.getRemovalHighlightRange=()=>Pt(this.fullLineContentRange)}get fullLineContentRange(){return Ur(this.editor,this.contentRange)}getLeadingDelimiterTarget(){return Ri(this.editor,uD(this.editor,this.fullLineContentRange),this.isReversed)}getTrailingDelimiterTarget(){return Ri(this.editor,mD(this.editor,this.fullLineContentRange),this.isReversed)}getRemovalRange(){let r=this.fullLineContentRange,n=this.getTrailingDelimiterTarget()??this.getLeadingDelimiterTarget();return n==null?r:r.union(n.contentRange)}maybeCreateRichRangeTarget(r,n){return new t({editor:this.editor,isReversed:r,contentRange:Ei(this,n,!0,!0)})}getCloneParameters(){return this.state}};function uD(t,e){let{start:r}=e;return r.line>0?new D(t.document.lineAt(r.line-1).range.end,e.start):void 0}function mD(t,e){let{end:r}=e;return r.line+1<t.document.lineCount?new D(e.end,new pe(r.line+1,0)):void 0}function ed(t,e,r){return Xs(dt,t,e,r)}var tc=class t{constructor(e,r){this.target=e;this.insertionMode=r}get editor(){return this.target.editor}get contentRange(){return this.target.contentRange}get contentSelection(){return this.target.contentSelection}get insertionDelimiter(){return this.target.insertionDelimiter}get isRaw(){return this.target.isRaw}withTarget(e){return new t(e,this.insertionMode)}getEditNewActionType(){throw new Error("Method not implemented.")}constructChangeEdit(e){throw new Error("Method not implemented.")}};var rc=class extends he{constructor(r){super(r);this.type="NotebookCellTarget";this.insertionDelimiter=`
`;this.isNotebookCell=!0;this.getLeadingDelimiterTarget=()=>{};this.getTrailingDelimiterTarget=()=>{};this.getRemovalRange=()=>this.contentRange}getCloneParameters(){return this.state}toDestination(r){return new tc(this,r)}};var Vr=class t extends he{constructor(){super(...arguments);this.type="ParagraphTarget";this.textualType="line";this.insertionDelimiter=`

`}getLeadingDelimiterTarget(){return ed(this.editor,dD(this.editor,this.fullLineContentRange),this.isReversed)}getTrailingDelimiterTarget(){return ed(this.editor,fD(this.editor,this.fullLineContentRange),this.isReversed)}getRemovalRange(){let r=this.getTrailingDelimiterTarget()??this.getLeadingDelimiterTarget(),n=r!=null?this.contentRange.union(r.contentRange):this.contentRange;return new dt({contentRange:n,editor:this.editor,isReversed:this.isReversed}).getRemovalRange()}get fullLineContentRange(){return Ur(this.editor,this.contentRange)}getRemovalHighlightRange(){let r=this.getTrailingDelimiterTarget()??this.getLeadingDelimiterTarget(),n=r!=null?this.fullLineContentRange.union(r.contentRange):this.fullLineContentRange;return Pt(n)}maybeCreateRichRangeTarget(r,n){return new t({...this.getCloneParameters(),isReversed:r,contentRange:Ei(this,n,!0,!0)})}getCloneParameters(){return this.state}};function dD(t,e){let{document:r}=t,n=r.lineAt(e.start),o=gD(r,n);if(o!=null)return o.lineNumber+1===n.lineNumber?void 0:new D(new pe(o.lineNumber+1,0),r.lineAt(n.lineNumber-1).range.end);if(n.lineNumber>0)return new D(new pe(0,0),r.lineAt(n.lineNumber-1).range.end)}function fD(t,e){let{document:r}=t,n=r.lineAt(e.end),o=hD(r,n);if(o!=null)return o.lineNumber-1===n.lineNumber?void 0:new D(new pe(n.lineNumber+1,0),r.lineAt(o.lineNumber-1).range.end);if(n.lineNumber<r.lineCount-1)return new D(new pe(n.lineNumber+1,0),r.lineAt(r.lineCount-1).range.end)}function gD(t,e){for(;e.lineNumber>0;){let r=t.lineAt(e.lineNumber-1);if(!r.isEmptyOrWhitespace)return r;e=r}return null}function hD(t,e){for(;e.lineNumber+1<t.lineCount;){let r=t.lineAt(e.lineNumber+1);if(!r.isEmptyOrWhitespace)return r;e=r}return null}var Br=class extends he{constructor(){super(...arguments);this.type="RawSelectionTarget";this.textualType="character";this.insertionDelimiter="";this.isRaw=!0;this.getLeadingDelimiterTarget=()=>{};this.getTrailingDelimiterTarget=()=>{};this.getRemovalRange=()=>this.contentRange;this.getCloneParameters=()=>this.state}};function Oo(t){let e=Sr(t.contentRange,t.prefixRange),r=t.getTrailingDelimiterTarget()??t.getLeadingDelimiterTarget();return r!=null?e.union(r.contentRange):e}var yD=['"',"'","(","[","{","<"],_D=['"',"'",")","]","}",">",",",";",":"];function rr(t){let{editor:e}=t,{start:r}=Sr(t.contentRange,t.prefixRange),a=e.document.lineAt(r).text.slice(0,r.character).match(/\s+$/);return a==null?void 0:new ye({contentRange:new D(r.line,r.character-a[0].length,r.line,r.character),editor:e,isReversed:t.isReversed})}function nr(t){let{editor:e}=t,{end:r}=t.contentRange,a=e.document.lineAt(r).text.slice(r.character).match(/^\s+/);return a==null?void 0:new ye({contentRange:new D(r.line,r.character,r.line,r.character+a[0].length),editor:e,isReversed:t.isReversed})}function Wr(t){let{editor:e}=t,r=Sr(t.contentRange,t.prefixRange),{start:n,end:o}=r,a=t.getLeadingDelimiterTarget()?.contentRange??n.toEmptyRange(),s=t.getTrailingDelimiterTarget()?.contentRange??o.toEmptyRange(),c=Ur(e,r);return a.union(s).isRangeEqual(c)?c:!s.isEmpty&&(!a.isEmpty||r.start.isEqual(c.start)||yD.includes(TD(e,r)))?r.union(s):!a.isEmpty&&(r.end.isEqual(c.end)||_D.includes(xD(e,r)))?r.union(a):r}function TD(t,e){let{start:r}=e,n=t.document.lineAt(r);return r.isAfter(n.range.start)?t.document.getText(new D(r.translate(void 0,-1),r)):""}function xD(t,e){let{end:r}=e,n=t.document.lineAt(r);return r.isBefore(n.range.end)?t.document.getText(new D(r.translate(void 0,1),r)):""}var et=class extends he{constructor(){super(...arguments);this.type="TokenTarget";this.textualType="token";this.insertionDelimiter=" "}getLeadingDelimiterTarget(){return rr(this)}getTrailingDelimiterTarget(){return nr(this)}getRemovalRange(){return Wr(this)}getCloneParameters(){return this.state}};function td(t){let{editor:e,isReversed:r}=t,{document:n}=e,o=Sr(t.contentRange,t.prefixRange);return SD(n,o)?vD(n,o)?new Vr({editor:e,isReversed:r,contentRange:o}):new dt({editor:e,isReversed:r,contentRange:o}):new et({editor:e,isReversed:r,contentRange:o})}function SD(t,e){let r=t.lineAt(e.start).rangeTrimmed?.start,n=t.lineAt(e.end).rangeTrimmed?.end;return r!=null&&n!=null&&r.isEqual(e.start)&&n.isEqual(e.end)}function vD(t,e){let{start:r,end:n}=e;return(r.line===0||t.lineAt(r.line-1).isEmptyOrWhitespace)&&(n.line===t.lineCount-1||t.lineAt(n.line+1).isEmptyOrWhitespace)}var ki=class t extends he{constructor(r){super(r);this.type="ScopeTypeTarget";this.scopeTypeType_=r.scopeTypeType,this.removalRange_=r.removalRange,this.leadingDelimiterRange_=r.leadingDelimiterRange,this.trailingDelimiterRange_=r.trailingDelimiterRange,this.prefixRange=r.prefixRange,this.insertionDelimiter=r.insertionDelimiter??bD(r.scopeTypeType),this.hasDelimiterRange_=!!this.leadingDelimiterRange_||!!this.trailingDelimiterRange_}getLeadingDelimiterTarget(){if(this.leadingDelimiterRange_!=null)return new ye({editor:this.editor,isReversed:this.isReversed,contentRange:this.leadingDelimiterRange_});if(!this.hasDelimiterRange_)return rr(this)}getTrailingDelimiterTarget(){if(this.trailingDelimiterRange_!=null)return new ye({editor:this.editor,isReversed:this.isReversed,contentRange:this.trailingDelimiterRange_});if(!this.hasDelimiterRange_)return nr(this)}getRemovalRange(){return this.removalRange_!=null?this.removalRange_:this.hasDelimiterRange_?Oo(this):td(this).getRemovalRange()}getRemovalHighlightRange(){return this.removalRange_!=null?Lt(this,this.removalRange_):this.hasDelimiterRange_?Lt(this,Oo(this)):td(this).getRemovalHighlightRange()}maybeCreateRichRangeTarget(r,n){if(this.scopeTypeType_!==n.scopeTypeType_)return null;let o=this.removalRange_!=null||n.removalRange_!=null?(this.removalRange_??this.contentRange).union(n.removalRange_??n.contentRange):void 0;return new t({...this.getCloneParameters(),isReversed:r,leadingDelimiterRange:this.leadingDelimiterRange_,trailingDelimiterRange:n.trailingDelimiterRange_,removalRange:o,contentRange:this.contentRange.union(n.contentRange)})}getCloneParameters(){return{...this.state,insertionDelimiter:this.insertionDelimiter,prefixRange:this.prefixRange,removalRange:void 0,interiorRange:void 0,scopeTypeType:this.scopeTypeType_,leadingDelimiterRange:this.leadingDelimiterRange_,trailingDelimiterRange:this.trailingDelimiterRange_}}};function bD(t){switch(t){case"class":case"namedFunction":case"section":case"sectionLevelOne":case"sectionLevelTwo":case"sectionLevelThree":case"sectionLevelFour":case"sectionLevelFive":case"sectionLevelSix":case"part":case"chapter":case"subSection":case"subSubSection":case"namedParagraph":case"subParagraph":return`

`;case"anonymousFunction":case"statement":case"ifStatement":case"comment":case"xmlElement":case"collectionItem":case"branch":case"environment":return`
`;default:return" "}}var nc=class t extends he{constructor(r){super(r);this.type="SubTokenWordTarget";this.textualType="word";this.leadingDelimiterRange_=r.leadingDelimiterRange,this.trailingDelimiterRange_=r.trailingDelimiterRange,this.insertionDelimiter=r.insertionDelimiter}getLeadingDelimiterTarget(){return Ri(this.editor,this.leadingDelimiterRange_,this.isReversed)}getTrailingDelimiterTarget(){return Ri(this.editor,this.trailingDelimiterRange_,this.isReversed)}getRemovalRange(){return Oo(this)}maybeCreateRichRangeTarget(r,n){return new t({...this.getCloneParameters(),isReversed:r,contentRange:wi(this,n,!0,!0),trailingDelimiterRange:n.trailingDelimiterRange_})}getCloneParameters(){return{...this.state,leadingDelimiterRange:this.leadingDelimiterRange_,trailingDelimiterRange:this.trailingDelimiterRange_,insertionDelimiter:this.insertionDelimiter}}};var Ai=class t extends he{constructor(r){super({...r,contentRange:Tn(r.editor,r.fullInteriorRange)});this.type="InteriorTarget";this.insertionDelimiter=" ";this.getLeadingDelimiterTarget=()=>{};this.getTrailingDelimiterTarget=()=>{};this.getRemovalRange=()=>this.fullInteriorRange;this.fullInteriorRange=r.fullInteriorRange}getCloneParameters(){return{...this.state,fullInteriorRange:this.fullInteriorRange}}maybeCreateRichRangeTarget(r,n){return new t({...this.getCloneParameters(),isReversed:r,fullInteriorRange:this.fullInteriorRange.union(n.fullInteriorRange)})}};var ic=class extends he{constructor(r){super(r);this.type="SurroundingPairTarget";this.insertionDelimiter=" ";this.boundary_=r.boundary,this.interiorRange_=r.interiorRange}getLeadingDelimiterTarget(){return rr(this)}getTrailingDelimiterTarget(){return nr(this)}getRemovalRange(){return Wr(this)}getInterior(){return[new Ai({editor:this.editor,isReversed:this.isReversed,fullInteriorRange:this.interiorRange_})]}getBoundary(){return this.boundary_.map(r=>new et({editor:this.editor,isReversed:this.isReversed,contentRange:r}))}getCloneParameters(){return{...this.state,interiorRange:this.interiorRange_,boundary:this.boundary_}}};var Ge=class extends he{constructor(r){super(r);this.type="UntypedTarget";this.insertionDelimiter=" ";this.hasExplicitScopeType=!1;this.hasExplicitRange=r.hasExplicitRange,this.textualType=r.textualType??"token"}getLeadingDelimiterTarget(){return rr(this)}getTrailingDelimiterTarget(){return nr(this)}getRemovalRange(){return this.editor.document.getText(this.contentRange).trim().length===0?this.contentRange:Wr(this)}maybeCreateRichRangeTarget(){return null}getCloneParameters(){return{...this.state,textualType:this.textualType,hasExplicitRange:this.hasExplicitRange}}};var oc=class extends he{constructor(){super(...arguments);this.type="ImplicitTarget";this.textualType="character";this.insertionDelimiter="";this.isRaw=!0;this.hasExplicitScopeType=!1;this.isImplicit=!0;this.getLeadingDelimiterTarget=()=>{};this.getTrailingDelimiterTarget=()=>{};this.getRemovalRange=()=>this.contentRange;this.getCloneParameters=()=>this.state}};var ac=class extends he{constructor(r){let{inputTarget:n,modifiedTarget:o,isHead:a}=r;super({...r,contentRange:cT(n.contentRange,o.contentRange,a)});this.type="HeadTailTarget";this.insertionDelimiter=" ";this.inputTarget=n,this.modifiedTarget=o,this.isHead=a}getLeadingDelimiterTarget(){return rr(this)}getTrailingDelimiterTarget(){return nr(this)}getRemovalRange(){return Wr(this)}getInterior(){let r=this.modifiedTarget.getInterior();if(r!=null)return r.map(n=>new ye({editor:this.editor,contentRange:cT(this.inputTarget.contentRange,n.contentRange,this.isHead),isReversed:this.isReversed}))}getCloneParameters(){return{...this.state,inputTarget:this.inputTarget,modifiedTarget:this.modifiedTarget,isHead:this.isHead}}};function cT(t,e,r){return r?new D(e.start,t.end):new D(t.start,e.end)}var sc=class t extends he{constructor(r){super({...r,contentRange:wD(r.paragraphTarget.contentRange,r.containingInterior.contentRange)});this.type="BoundedParagraphTarget";this.textualType="line";this.insertionDelimiter=`

`;this.containingInterior=r.containingInterior,this.paragraphTarget=r.paragraphTarget,this.startLineGap=this.contentRange.start.line-this.containingInterior.fullInteriorRange.start.line,this.endLineGap=this.containingInterior.fullInteriorRange.end.line-this.contentRange.end.line}getLeadingDelimiterTarget(){return this.startLineGap>1?this.paragraphTarget.getLeadingDelimiterTarget():void 0}getTrailingDelimiterTarget(){return this.endLineGap>1?this.paragraphTarget.getTrailingDelimiterTarget():void 0}getRemovalRange(){let r=this.getTrailingDelimiterTarget()??this.getLeadingDelimiterTarget(),n=r!=null?this.contentRange.union(r.contentRange):this.contentRange;return this.startLineGap<=0||this.endLineGap<=0?n:new dt({contentRange:n,editor:this.editor,isReversed:this.isReversed}).getRemovalRange()}get fullLineContentRange(){return Ur(this.editor,this.contentRange)}getRemovalHighlightRange(){let r=(()=>{if(this.startLineGap<1||this.endLineGap<1)return this.getRemovalRange();let n=this.getTrailingDelimiterTarget()??this.getLeadingDelimiterTarget();return n!=null?this.fullLineContentRange.union(n.contentRange):this.fullLineContentRange})();return Pt(r)}maybeCreateRichRangeTarget(r,n){return new t({...this.getCloneParameters(),isReversed:r,containingInterior:this.containingInterior.maybeCreateRichRangeTarget(r,n.containingInterior),paragraphTarget:this.paragraphTarget.maybeCreateRichRangeTarget(r,n.paragraphTarget)})}getCloneParameters(){return{...this.state,paragraphTarget:this.paragraphTarget,containingInterior:this.containingInterior}}};function wD(t,e){let r=t.intersection(e);if(r==null||r.isEmpty)throw new Error("Ranges do not intersect");return r}function cc(t){return t.activeTextEditor?.selections.map(e=>({selection:e,editor:t.activeTextEditor}))??[]}var Pi=class{run(){return cc(h()).map(e=>new Ge({editor:e.editor,isReversed:e.selection.isReversed,contentRange:e.selection,hasExplicitRange:!e.selection.isEmpty,textualType:"character"}))}};var ir=class{constructor(e,r){this.debouncer=new Ra(r,e.getOwnConfiguration("decorationDebounceDelayMs")),this.run=this.run.bind(this)}run(){this.debouncer.run()}dispose(){this.debouncer.dispose()}};var pc=class{constructor(e,r){this.ide=e;this.storedTargets=r;this.disposables=[];this.debouncer=new ir(e.configuration,()=>this.updateKeyboardTarget()),this.disposables.push(e.configuration.onDidChangeConfiguration(()=>this.maybeActivate()),this.debouncer),this.maybeActivate()}maybeActivate(){if(this.ide.configuration.getOwnConfiguration("experimental.keyboardTargetFollowsSelection")){this.selectionWatcherDisposable==null&&(this.selectionWatcherDisposable=this.ide.onDidChangeTextEditorSelection(this.debouncer.run));return}this.selectionWatcherDisposable!=null&&(this.selectionWatcherDisposable.dispose(),this.selectionWatcherDisposable=void 0)}updateKeyboardTarget(){this.ide.activeTextEditor==null||this.storedTargets.get("keyboard")==null||this.storedTargets.set("keyboard",new Pi().run())}dispose(){this.disposables.forEach(e=>e.dispose()),this.selectionWatcherDisposable?.dispose()}};var lc=class{constructor(e){this.ide=e;switch(e.disposeOnExit(this),this.evaluateSetting=this.evaluateSetting.bind(this),this.active=!0,e.runMode){case"development":this.enableDebugLog();break;case"test":this.disableDebugLog();break;case"production":this.evaluateSetting(),this.disposableConfiguration=e.configuration.onDidChangeConfiguration(this.evaluateSetting);break}}log(...e){this.active&&console.log(...e)}dispose(){this.disposableConfiguration&&this.disposableConfiguration.dispose()}enableDebugLog(){this.active=!0}disableDebugLog(){this.active=!1}evaluateSetting(){this.ide.configuration.getOwnConfiguration("debug")?this.enableDebugLog():this.disableDebugLog()}};var ED=["!","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_","`","{","|","}","~","\xA3",'"'],RD=ED.map(St).join("|"),kD=["[a-zA-Z0-9]",RD].join("|"),AD=new RegExp(`^(${kD})$`,"u"),PD="[unk]",MD=/\p{L}\p{M}*|[\p{N}\p{P}\p{S}]/gu,uc=class{constructor(){this.disposables=[];this.algorithmChangeNotifier=new Pe;this.getTokenGraphemes=e=>kt(e,MD,r=>({text:this.normalizeGrapheme(r[0]),tokenStartOffset:r.index,tokenEndOffset:r.index+r[0].length}));this.registerAlgorithmChangeListener=this.algorithmChangeNotifier.registerListener;h().disposeOnExit(this),this.updateTokenHatSplittingMode=this.updateTokenHatSplittingMode.bind(this),this.getTokenGraphemes=this.getTokenGraphemes.bind(this),this.updateTokenHatSplittingMode(),this.disposables.push(h().configuration.onDidChangeConfiguration(this.updateTokenHatSplittingMode))}updateTokenHatSplittingMode(){let{lettersToPreserve:e,symbolsToPreserve:r,...n}=h().configuration.getOwnConfiguration("tokenHatSplittingMode");this.tokenHatSplittingMode={lettersToPreserve:e.map(o=>o.toLowerCase().normalize("NFC")),symbolsToPreserve:r.map(o=>o.normalize("NFC")),...n},this.algorithmChangeNotifier.notifyListeners()}normalizeGrapheme(e){let{preserveCase:r,lettersToPreserve:n,symbolsToPreserve:o}=this.tokenHatSplittingMode,a=e.normalize("NFC");return o.includes(a)||(r||(a=a.toLowerCase()),n.includes(a.toLowerCase()))||(a=Vu(a),AD.test(a)||(a=PD)),a}dispose(){this.disposables.forEach(({dispose:e})=>e())}};function xn(){return rd==null&&(rd=new uc),rd}var rd;var DD=["-","+","*","/","=","<",">","_","#",".","|","&",":"],LD=["!==","!=","+=","-=","*=","/=","%=","<=",">=","=>","->","??",'"""',"```","/*","*/","<!--","-->"],FD=["\\p{L}","\\p{M}","\\p{N}"],ID="[^\\s\\w]",CD="(?<![.\\d])\\d+\\.\\d+(?![.\\d])";function OD(t){let{fixedTokens:e,repeatableSymbols:r,identifierWordRegexes:n,identifierWordDelimiters:o,numbersRegex:a,singleSymbolsRegex:s}=t,c=r.map(St).map(g=>`${g}+`).join("|"),p=e.map(St).join("|"),u=`(${n.concat(o.map(St)).join("|")})+`,m=`(${n.join("|")})+`,d=[p,a,u,c,s].join("|");return{identifierMatcher:new RegExp(u,"gu"),wordMatcher:new RegExp(m,"gu"),tokenMatcher:new RegExp(d,"gu")}}var nd=new Map;function ft(t){let e=h().configuration.getOwnConfiguration("wordSeparators",{languageId:t}),r=e.join("\0");if(!nd.has(r)){let n={fixedTokens:LD,repeatableSymbols:DD,identifierWordRegexes:FD,identifierWordDelimiters:e,numbersRegex:CD,singleSymbolsRegex:ID};nd.set(r,OD(n))}return nd.get(r)}function pT(t,e,r){return kt(t,ft(e).tokenMatcher,r)}var ND=/\p{Lu}?\p{Ll}+|\p{Lu}+(?!\p{Ll})|\p{N}+/gu,Mi=class{constructor(e){this.wordRegex=ft(e).wordMatcher}splitIdentifier(e){let r=So(e,this.wordRegex);return r.length>1?r:So(e,ND)}};var lT=({penalty:t})=>-t,uT=({isFirstLetter:t})=>t?-1:0;function mT(t){return({grapheme:{text:e},style:r})=>{let n=t.get({grapheme:e,hatStyle:r});return n==null?1/0:-n}}function dT(t,e){let r=yo(n=>zu(e[n].filter(o=>o>t))??1/0);return({grapheme:{text:n}})=>r(n)}function id(t){return e=>e.grapheme.text===t?.grapheme&&e.style===t?.hatStyle?1:0}function fT(t){switch(t){case"greedy":return({penalty:e})=>-e;case"balanced":return({penalty:e})=>-(e<2?0:1);case"stable":return e=>0}}function gT(t,e){if(t.length===0)return;let r=t;for(let n of e){if(r.length===1)return r[0];r=HD(r,n)}return r[0]}function HD(t,e){let r=-1/0,n=[];for(let o of t){let a=e(o);a<r||(a>r&&(r=a,n.length=0),n.push(o))}return n}function hT({hatOldTokenRanks:t,graphemeTokenRanks:e},r,n,o,a,s){return gT(s,[id(o),fT(r),id(a),mT(t),lT,uT,dT(n,e)])}function yT(t,e,r){let n={},o=new Nr(({grapheme:a,hatStyle:s})=>[a,s]);return t.forEach(({token:a,rank:s})=>{let c=e.get(a);c!=null&&o.set(c,s),r.getTokenGraphemes(a.text).forEach(({text:p})=>{let l;p in n?l=n[p]:(l=[],n[p]=l),l.push(s)})}),{hatOldTokenRanks:o,graphemeTokenRanks:n}}function _T(t,e=[]){return new Map(qu(Se,pn)(To([e],t.visibleRanges.map(r=>Gu(r.start.line,r.end.line+1)))).sort((r,n)=>r-n).map((r,n)=>[r,n]))}function TT(t,e){return(r,n)=>{let o=Math.abs(r.displayLine-t),a=Math.abs(n.displayLine-t);if(o<a)return-1;if(o>a)return 1;let s=Math.abs(r.range.start.character-e),c=Math.abs(n.range.start.character-e);return s-c}}function xT(t,e){let r=t.document.languageId,n=t.document.getText(e),o=t.document.offsetAt(e.start);return pT(n,r,a=>{let s=o+a.index,c=o+a.index+a[0].length,p=new D(t.document.positionAt(s),t.document.positionAt(c));return{editor:t,text:a[0],range:p,offsets:{start:s,end:c}}})}function ST(t,e,r){let o=VD(t,e).flatMap(a=>{let s=a.selections[0].active,c=_T(a,[s.line]),p=Se(a.visibleRanges.map(l=>xT(a,l).map(u=>({...u,displayLine:c.get(u.range.start.line)}))));return p.sort(TT(c.get(s.line),s.character)),p});return UD(r,o).map((a,s)=>({token:a,rank:-s}))}function UD(t,e){return t==null?e:e.sort((r,n)=>{let o=t.has(r),a=t.has(n);return o&&!a?-1:!o&&a?1:0})}function VD(t,e){let r;return t==null?r=e:r=[t,...e.filter(n=>n!==t)],r}function od({tokenGraphemeSplitter:t,enabledHatStyles:e,forceTokenHats:r,oldTokenHats:n,hatStability:o,activeTextEditor:a,visibleTextEditors:s}){let c=r==null?void 0:vT(r),p=vT(n),l=ST(a,s,c),u=yT(l,p,t),m=Object.keys(e),d=new xi(()=>[...m]);return l.map(({token:g,rank:b})=>{let w=BD(t,g,d,e),I=hT(u,o,b,c?.get(g),p.get(g),w);if(I!=null)return d.set(I.grapheme.text,d.get(I.grapheme.text).filter(L=>L!==I.style)),WD(g,I)}).filter(g=>g!=null)}function vT(t){let e=new Nr(({editor:r,offsets:n})=>[r.id,n.start,n.end]);return t.forEach(r=>e.set(r.token,r)),e}function BD(t,e,r,n){let o=[],a=t.getTokenGraphemes(e.text),s=new Set(new Mi(e.editor.document.languageId).splitIdentifier(e.text).map(c=>c.index));for(let c of a){let p=s.has(c.tokenStartOffset);for(let l of r.get(c.text))o.push({grapheme:c,style:l,penalty:n[l].penalty,isFirstLetter:p})}return o}function WD(t,e){return{hatStyle:e.style,grapheme:e.grapheme.text,token:t,hatRange:new D(t.range.start.translate(void 0,e.grapheme.tokenStartOffset),t.range.start.translate(void 0,e.grapheme.tokenEndOffset))}}var mc=class{constructor(e,r){this.hats=e;this.context=r;this.disposables=[];h().disposeOnExit(this);let n=new ir(h().configuration,()=>this.allocateHats());this.disposables.push(this.hats.onDidChangeEnabledHatStyles(n.run),this.hats.onDidChangeIsEnabled(n.run),h().onDidOpenTextDocument(n.run),h().onDidCloseTextDocument(n.run),h().onDidChangeActiveTextEditor(n.run),h().onDidChangeVisibleTextEditors(n.run),h().onDidChangeTextDocument(n.run),h().onDidChangeTextEditorSelection(n.run),h().onDidChangeTextEditorVisibleRanges(n.run),xn().registerAlgorithmChangeListener(n.run),n)}async allocateHats(e){let r=await this.context.getActiveMap();e=e?.map(o=>({...o,grapheme:xn().normalizeGrapheme(o.grapheme)}));let n=this.hats.isEnabled?od({tokenGraphemeSplitter:xn(),enabledHatStyles:this.hats.enabledHatStyles,forceTokenHats:e,oldTokenHats:r.tokenHats,hatStability:h().configuration.getOwnConfiguration("experimental.hatStability"),activeTextEditor:h().activeTextEditor,visibleTextEditors:h().visibleTextEditors}):[];r.setTokenHats(n),await this.hats.setHatRanges(n.map(({hatStyle:o,hatRange:a,token:{editor:s}})=>({editor:s,range:a,styleName:o})))}dispose(){this.disposables.forEach(({dispose:e})=>e())}};var dc=class t{constructor(e){this.rangeUpdater=e;this.isExpired=!1;this.documentTokenLists=new Map;this.deregisterFunctions=[];this.map={};this._tokenHats=[]}get tokenHats(){return this._tokenHats}getDocumentTokenList(e){let r=e.uri.toString(),n=this.documentTokenLists.get(r);return n==null&&(n=[],this.documentTokenLists.set(r,n),this.deregisterFunctions.push(this.rangeUpdater.registerRangeInfoList(e,n))),n}clone(){let e=new t(this.rangeUpdater);return e.setTokenHats(this._tokenHats),e}setTokenHats(e){this.map={},this.documentTokenLists=new Map,this.deregisterFunctions.forEach(n=>n());let r=e.map(n=>{let{hatStyle:o,grapheme:a,token:s}=n,c=this.makeTokenLive(s);return this.map[vs(o,a)]=c,{...n,token:c}});this._tokenHats=r}makeTokenLive(e){let{tokenMatcher:r}=ft(e.editor.document.languageId),n={...e,expansionBehavior:{start:{type:"regex",regex:r},end:{type:"regex",regex:r}}};return this.getDocumentTokenList(e.editor.document).push(n),n}getEntries(){return this.checkExpired(),Object.entries(this.map)}getToken(e,r){return this.checkExpired(),this.map[vs(e,xn().normalizeGrapheme(r))]}checkExpired(){if(this.isExpired)throw Error("Map snapshot has expired")}dispose(){this.isExpired=!0,this.deregisterFunctions.forEach(e=>e())}};var $D=6e4,fc=class{constructor(e,r,n,o){this.debug=r;this.commandServerApi=o;this.prePhraseMapsSnapshotTimestamp=null;this.lastSignalVersion=null;h().disposeOnExit(this),this.activeMap=new dc(e),this.getActiveMap=this.getActiveMap.bind(this),this.allocateHats=this.allocateHats.bind(this),this.hatAllocator=new mc(n,{getActiveMap:this.getActiveMap})}allocateHats(e){return this.hatAllocator.allocateHats(e)}async getActiveMap(){return await this.maybeTakePrePhraseSnapshot(),this.activeMap}async getReadableMap(e){return await this.maybeTakePrePhraseSnapshot(),e?this.lastSignalVersion==null?(console.error("Pre phrase snapshot requested but no signal was present; please upgrade command client"),this.activeMap):this.prePhraseMapSnapshot==null?(console.error("Navigation map pre-phrase snapshot requested, but no snapshot has been taken"),this.activeMap):performance.now()-this.prePhraseMapsSnapshotTimestamp>$D?(console.error("Navigation map pre-phrase snapshot requested, but snapshot is more than a minute old"),this.activeMap):this.prePhraseMapSnapshot:this.activeMap}dispose(){this.activeMap.dispose(),this.prePhraseMapSnapshot!=null&&this.prePhraseMapSnapshot.dispose()}async maybeTakePrePhraseSnapshot(){let e=await this.commandServerApi.signals.prePhrase.getVersion();e!==this.lastSignalVersion&&(this.debug.log("taking snapshot"),this.lastSignalVersion=e,e!=null&&this.takePrePhraseSnapshot())}takePrePhraseSnapshot(){this.prePhraseMapSnapshot!=null&&this.prePhraseMapSnapshot.dispose(),this.prePhraseMapSnapshot=this.activeMap.clone(),this.prePhraseMapsSnapshotTimestamp=performance.now()}};function ad(t,e,r){let n=t.get(e);return n==null&&(n=r(),t.set(e,n)),n}var ld=mo(hc(),1);function ud(t,e){let{originalOffsets:{start:r,end:n},finalOffsets:{end:o},displacement:a}=t,{offsets:{start:s,end:c}}=e;return(0,ld.invariant)(n>r,()=>"Change range expected to be nonempty"),(0,ld.invariant)(n>=s&&r<=c,()=>"Change range expected to intersect with selection range"),{start:n<=s?s+a:Math.min(s,o),end:n<=c?c+a:Math.min(c,o)}}var AT=mo(hc(),1);function md(t,e){let{event:{text:r,isReplace:n},finalOffsets:{start:o,end:a}}=t;if((0,AT.invariant)(o===t.originalOffsets.end&&o===e.offsets.start&&o===e.offsets.end,()=>"Selection range and change range expected to be same empty range"),n){let s=e.expansionBehavior.end;switch(s.type){case"closed":return{start:o,end:o};case"open":return{start:o,end:a};case"regex":{let c=r.match(ss(s.regex));return c==null?{start:o,end:o}:{start:o,end:o+c[0].length}}}}else{let s=e.expansionBehavior.start;switch(s.type){case"closed":return{start:a,end:a};case"open":return{start:o,end:a};case"regex":{let c=r.search(as(s.regex));return c===-1?{start:a,end:a}:{start:o+c,end:a}}}}}var dd=mo(hc(),1);function fd(t,e){let{event:{text:r},originalOffsets:{start:n},displacement:o}=t,{offsets:{start:a,end:s},text:c}=e;if((0,dd.invariant)(s>a,()=>"Selection range expected to be nonempty"),(0,dd.invariant)(n>=a&&n<=s,()=>"Insertion offset expected to intersect with selection range"),n>a&&n<s)return{start:a,end:s+o};if(n===a){let p=e.expansionBehavior.start,l=s+o;switch(p.type){case"closed":return{start:a+o,end:l};case"open":return{start:a,end:l};case"regex":{let u=r+c,m=as(p.regex),d=u.search(m);for(;d>r.length;)u=u.slice(0,d),d=u.search(m);return d===-1?{start:a,end:l}:{start:a+d,end:l}}}}else{let p=e.expansionBehavior.end,l=a;switch(p.type){case"closed":return{start:l,end:s};case"open":return{start:l,end:s+o};case"regex":{let u=c+r,m=ss(p.regex),d=u.match(m),g=d==null?0:d[0].length;for(;g!==0&&g<c.length;)u=c.slice(g)+r,d=u.match(m),g=d==null?0:g+d[0].length;return g===0?{start:l,end:s}:{start:l,end:a+g}}}}}function PT(t,e,r){let{start:n,end:o}=t.originalOffsets,{start:a,end:s}=e.offsets,c=Math.min(n,a),p="";return a<n&&(p+=e.text.substring(0,n-a)),p+=t.event.text,o<s&&(p+=e.text.substring(s-o,e.text.length)),p.substring(r.start-c,r.end-c)}function MT(t,e){let{document:r,contentChanges:n}=t,o=n.map(a=>{let s=a.text.length-a.rangeLength,c=a.rangeOffset,p=c+a.rangeLength,l=c,u=p+s;return{displacement:s,event:a,originalOffsets:{start:c,end:p},finalOffsets:{start:l,end:u}}});for(let a of e){let s=a.offsets,c=o.map(l=>{let u;return l.originalOffsets.start>s.end?{start:0,end:0}:l.originalOffsets.end<s.start?{start:l.displacement,end:l.displacement}:(l.event.rangeLength===0?a.range.isEmpty?u=md(l,a):u=fd(l,a):u=ud(l,a),a.text=PT(l,a,u),{start:u.start-s.start,end:u.end-s.end})}),p={start:s.start+is(c,({start:l})=>l),end:s.end+is(c,({end:l})=>l)};a.range=a.range.with(r.positionAt(p.start),r.positionAt(p.end)),a.offsets=p}}var yc=class{constructor(){this.rangeInfoLists=new Map;this.replaceEditLists=new Map;this.listenForDocumentChanges()}getDocumentRangeInfoLists(e){return ad(this.rangeInfoLists,e.uri.toString(),()=>[])}getDocumentReplaceEditLists(e){return ad(this.replaceEditLists,e.uri.toString(),()=>[])}registerRangeInfoList(e,r){let n=this.getDocumentRangeInfoLists(e);return n.push(r),()=>ot(n,r)}registerReplaceEditList(e,r){let n=this.getDocumentReplaceEditLists(e);return n.push(r),()=>ot(n,r)}*documentRangeInfoGenerator(e){let r=this.getDocumentRangeInfoLists(e);for(let n of r)for(let o of n)yield o}listenForDocumentChanges(){this.disposable=h().onDidChangeTextDocument(e=>{let r=this.getDocumentReplaceEditLists(e.document),n={...e,contentChanges:e.contentChanges.map(o=>ZD(r,o)?{...o,isReplace:!0}:o)};MT(n,this.documentRangeInfoGenerator(e.document))})}dispose(){this.disposable.dispose()}};function ZD(t,e){for(let r of t)for(let n of r)if(n.range.isRangeEqual(e.range)&&n.text===e.text)return!0;return!1}var _c=class{constructor(){this.signals={prePhrase:{getVersion(){return Promise.resolve(null)}}}}getFocusedElementType(){return Promise.resolve(void 0)}};var Tc=class{async allocateHats(){}async getReadableMap(){return{getEntries(){return[]},getToken(){throw new Error("Hat map is disabled")}}}dispose(){}};var xc=class{onDidChangeDefinition(e){return{dispose:()=>{}}}loadLanguage(e){return Promise.resolve()}get(e){}getNodeAtLocation(e,r){}dispose(){}};var Sc=class{getSnippetStrict(e){throw new Error("Snippets are not implemented.")}openNewSnippetFile(e,r){throw new Error("Snippets are not implemented.")}};var vc=class{getSpokenFormEntries(){throw new Ti}onDidChange(){return{dispose:()=>{}}}};var bc=class{getTree(e){throw new Error("Tree sitter not provided")}loadLanguage(e){return Promise.resolve(!1)}getNodeAtLocation(e,r){throw new Error("Tree sitter not provided")}createQuery(e,r){throw new Error("Tree sitter not provided")}};var we=class extends Error{constructor(r,n=!1,o=!1){super(`No spoken form for: ${r}`);this.reason=r;this.requiresTalonUpdate=n;this.isPrivate=o}};var DT={curlyBrackets:["{","}"],angleBrackets:["<",">"],escapedDoubleQuotes:['\\"','\\"'],escapedSingleQuotes:["\\'","\\'"],escapedParentheses:["\\(","\\)"],escapedSquareBrackets:["\\[","\\]"],doubleQuotes:['"','"'],parentheses:["(",")"],backtickQuotes:["`","`"],squareBrackets:["[","]"],singleQuotes:["'","'"],tripleBacktickQuotes:["```","```"],tripleDoubleQuotes:['"""','"""'],tripleSingleQuotes:["'''","'''"],whitespace:[" "," "],any:null,string:null,collectionBoundary:null};var LT=new Nr(t=>t);for(let[t,e]of Object.entries(DT))e!=null&&LT.set(e,t);function FT(t,e,r){let n=LT.get([e,r]);if(n==null)throw Error(`Unknown surrounding pair delimiters '${e} ${r}'`);return t.pairedDelimiter[n]}function IT(t){throw new we(`${t.type} insertion snippet`)}function CT(t){throw new we(`${t.type} wrap with snippet`)}function Ho(t,e,r){let n=r==="vertical"?`${Ce.verticalRange} `:"";if(t&&e)return n+Ce.rangeExclusive;if(t)throw new we("Range exclude anchor");return e?n+Ce.rangeExcludingEnd:r==="vertical"?Ce.verticalRange:Ce.rangeInclusive}function OT(t){return Object.fromEntries(Object.entries(t).map(([e,r])=>[e,Object.fromEntries(Object.entries(r).map(([n,o])=>[n,{type:"customizable",spokenForms:o,spokenFormType:e,id:n}]))]))}var XD=["zero","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen","twenty","twenty one","twenty two","twenty three","twenty four","twenty five","twenty six","twenty seven","twenty eight","twenty nine","thirty","thirty one","thirty two","thirty three","thirty four","thirty five","thirty six","thirty seven","thirty eight","thirty nine","forty","forty one","forty two","forty three","forty four","forty five","forty six","forty seven","forty eight","forty nine","fifty","fifty one","fifty two","fifty three","fifty four","fifty five","fifty six","fifty seven","fifty eight","fifty nine","sixty","sixty one","sixty two","sixty three","sixty four","sixty five","sixty six","sixty seven","sixty eight","sixty nine","seventy","seventy one","seventy two","seventy three","seventy four","seventy five","seventy six","seventy seven","seventy eight","seventy nine","eighty","eighty one","eighty two","eighty three","eighty four","eighty five","eighty six","eighty seven","eighty eight","eighty nine","ninety","ninety one","ninety two","ninety three","ninety four","ninety five","ninety six","ninety seven","ninety eight","ninety nine"],eL=["zeroth","first","second","third","fourth","fifth","sixth","seventh","eighth","ninth","tenth","eleventh","twelfth","thirteenth","fourteenth","fifteenth","sixteenth","seventeenth","eighteenth","nineteenth","twentieth"];function Di(t){let e=XD[t];if(e==null)throw Error(`Unknown number '${t}'`);return e}function Uo(t){let e=eL[t];if(e==null)throw Error(`Unknown ordinal '${t}'`);return e}var wc=class{constructor(e){this.spokenFormMap=e;this.handleModifier=this.handleModifier.bind(this)}handlePrimitiveTarget(e){let r=[];return e.modifiers!=null&&r.push(e.modifiers.map(this.handleModifier)),e.mark!=null&&r.push(this.handleMark(e.mark)),r}handleModifier(e){switch(e.type){case"cascading":case"modifyIfUntyped":case"preferredScope":throw new we(`Modifier '${e.type}'`);case"containingScope":return e.ancestorIndex==null||e.ancestorIndex===0?this.handleScopeType(e.scopeType):[new Array(e.ancestorIndex).fill(this.spokenFormMap.modifierExtra.ancestor),this.handleScopeType(e.scopeType)];case"everyScope":return[this.spokenFormMap.simpleModifier.everyScope,this.handleScopeType(e.scopeType)];case"extendThroughStartOf":case"extendThroughEndOf":{let r=this.spokenFormMap.simpleModifier[e.type];return e.modifiers!=null?[r,e.modifiers.map(this.handleModifier)]:[r]}case"relativeScope":return e.offset===0?this.handleRelativeScopeInclusive(e):this.handleRelativeScopeExclusive(e);case"ordinalScope":{let r=this.handleScopeType(e.scopeType),n=e.isEvery?this.spokenFormMap.simpleModifier.everyScope:[];if(e.length===1)return e.start===-1?[n,this.spokenFormMap.modifierExtra.last,r]:e.start===0?[n,this.spokenFormMap.modifierExtra.first,r]:e.start<0?[n,Uo(Math.abs(e.start)),this.spokenFormMap.modifierExtra.last,r]:[n,Uo(e.start+1),r];let o=Di(e.length);if(e.start===0)return[n,this.spokenFormMap.modifierExtra.first,o,Vo(r)];if(e.start===-e.length)return[n,this.spokenFormMap.modifierExtra.last,o,Vo(r)];throw new we(`'${e.type}' with count > 1 and offset away from start / end`)}case"range":{if(e.anchor.type==="ordinalScope"&&e.active.type==="ordinalScope"&&e.anchor.length===1&&e.active.length===1&&e.anchor.scopeType.type===e.active.scopeType.type){let r=e.anchor.start===-1?this.spokenFormMap.modifierExtra.last:Uo(e.anchor.start+1),n=this.handleModifier(e.active),o=Ho(e.excludeAnchor,e.excludeActive);return[r,o,n]}throw Error(`Modifier '${e.type}' is not fully implemented`)}default:return[this.spokenFormMap.simpleModifier[e.type]]}}handleRelativeScopeInclusive(e){let r=this.handleScopeType(e.scopeType),n=e.isEvery?this.spokenFormMap.simpleModifier.everyScope:[];if(e.length===1){let s=e.direction==="forward"?Ce.forward:Ce.backward;return[n,r,s]}let o=Di(e.length),a=Vo(r);return e.direction==="forward"?[n,o,a]:[n,o,a,Ce.backward]}handleRelativeScopeExclusive(e){let r=this.handleScopeType(e.scopeType),n=e.direction==="forward"?Ce.next:Ce.previous,o=e.isEvery?this.spokenFormMap.simpleModifier.everyScope:[];if(e.offset===1){let a=Di(e.length);if(e.length===1)return[o,n,r];let s=Vo(r);return[o,n,a,s]}if(e.length===1){let a=Uo(e.offset);return[o,a,n,r]}throw new we(`${e.type} modifier with offset > 1 and length > 1`)}handleScopeType(e){switch(e.type){case"oneOf":case"surroundingPairInterior":throw new we(`Scope type '${e.type}'`);case"glyph":return[this.spokenFormMap.complexScopeTypeType.glyph,HT(this.spokenFormMap.grapheme,"grapheme",e.character)];case"surroundingPair":{let r=this.spokenFormMap.pairedDelimiter[e.delimiter];return e.forceDirection!=null?[this.spokenFormMap.surroundingPairForceDirection[e.forceDirection],r]:r}case"customRegex":return this.spokenFormMap.customRegex[e.regex]??{type:"customizable",spokenForms:{spokenForms:[],isCustom:!0,defaultSpokenForms:[],requiresTalonUpdate:!1,isPrivate:!1},spokenFormType:"customRegex",id:e.regex};case"interior":return this.spokenFormMap.simpleModifier.interiorOnly;default:return this.spokenFormMap.simpleScopeTypeType[e.type]}}handleMark(e){switch(e.type){case"decoratedSymbol":{let[r,n]=e.symbolColor.split("-"),o=[];return r!=="default"&&o.push(k_(r)),n!=null&&o.push(A_(n)),o.push(HT(this.spokenFormMap.grapheme,"grapheme",e.character)),o}case"lineNumber":return this.handleLineNumberMark(e);case"range":{if(e.anchor.type==="lineNumber"&&e.active.type==="lineNumber"){let[r,n]=this.handleLineNumberMark(e.anchor),[o,a]=this.handleLineNumberMark(e.active);if(r===o){let s=Ho(e.excludeAnchor,e.excludeActive);return[r,n,s,a]}}throw Error(`Mark '${e.type}' is not fully implemented`)}case"explicit":case"keyboard":case"target":throw new we(`Mark '${e.type}'`);default:return[Hs[e.type]]}}handleLineNumberMark(e){switch(e.lineNumberType){case"absolute":throw new we("Absolute line numbers");case"modulo100":return[Us.modulo100,Di(e.lineNumber+1)];case"relative":return[e.lineNumber<0?Us.relativeUp:Us.relativeDown,Di(Math.abs(e.lineNumber))]}}};function Vo(t){if(typeof t=="string")return NT(t);if(Array.isArray(t)){if(t.length===0)return t;let e=t[t.length-1];return[...t.slice(0,-1),Vo(e)]}return{...t,spokenForms:{...t.spokenForms,spokenForms:t.spokenForms.spokenForms.map(NT)}}}function NT(t){return`${t}s`}function HT(t,e,r){let n=t[r];if(n==null)throw new we(`${e} '${r}'`);return n}var Bo=class{constructor(e){this.spokenFormMap=OT(e),this.primitiveGenerator=new wc(this.spokenFormMap)}getSpokenFormForSingleTerm(e,r){return this.componentsToSpokenForm(()=>{let n=this.spokenFormMap[e][r];if(n==null)throw new we(`${e} with id ${r}`);return n})}processCommand(e){return this.componentsToSpokenForm(()=>this.handleAction(e.action))}processScopeType(e){return this.componentsToSpokenForm(()=>[this.primitiveGenerator.handleScopeType(e)])}componentsToSpokenForm(e){try{return{type:"success",spokenForms:UT(e())}}catch(r){if(r instanceof we)return{type:"error",reason:r.reason,requiresTalonUpdate:r.requiresTalonUpdate,isPrivate:r.isPrivate};throw r}}handleAction(e){switch(e.name){case"editNew":case"getText":case"replace":case"executeCommand":case"parsed":case"private.getTargets":case"private.setKeyboardTarget":throw new we(`Action '${e.name}'`);case"replaceWithTarget":case"moveToTarget":return[this.spokenFormMap.action[e.name],this.handleTarget(e.source),this.handleDestination(e.destination)];case"swapTargets":return[this.spokenFormMap.action[e.name],this.handleTarget(e.target1),Ce.swapConnective,this.handleTarget(e.target2)];case"callAsFunction":return e.argument.type==="implicit"?[this.spokenFormMap.action[e.name],this.handleTarget(e.callee)]:[this.spokenFormMap.action[e.name],this.handleTarget(e.callee),"on",this.handleTarget(e.argument)];case"wrapWithPairedDelimiter":case"rewrapWithPairedDelimiter":return[FT(this.spokenFormMap,e.left,e.right),this.spokenFormMap.action[e.name],this.handleTarget(e.target)];case"pasteFromClipboard":return[this.spokenFormMap.action[e.name],this.handleDestination(e.destination)];case"insertSnippet":return[this.spokenFormMap.action[e.name],IT(e.snippetDescription),this.handleDestination(e.destination)];case"generateSnippet":if(e.snippetName!=null)throw new we(`${e.name}.snippetName`);return[this.spokenFormMap.action[e.name],this.handleTarget(e.target)];case"wrapWithSnippet":return[CT(e.snippetDescription),this.spokenFormMap.action[e.name],this.handleTarget(e.target)];case"highlight":{if(e.highlightId!=null)throw new we(`${e.name}.highlightId`);return[this.spokenFormMap.action[e.name],this.handleTarget(e.target)]}default:return[this.spokenFormMap.action[e.name],this.handleTarget(e.target)]}}handleTarget(e){switch(e.type){case"list":if(e.elements.length<2)throw new we("List target with < 2 elements");return e.elements.map((r,n)=>n===0?this.handleTarget(r):[Ce.listConnective,this.handleTarget(r)]);case"range":{let r=this.handleTarget(e.anchor),n=this.handleTarget(e.active),o=Ho(e.excludeAnchor,e.excludeActive,e.rangeType);return[r,o,n]}case"primitive":return this.primitiveGenerator.handlePrimitiveTarget(e);case"implicit":return[]}}handleDestination(e){switch(e.type){case"list":if(e.destinations.length<2)throw new we("List destination with < 2 elements");return e.destinations.map((r,n)=>n===0?this.handleDestination(r):[Ce.listConnective,this.handleDestination(r)]);case"primitive":return[this.handleInsertionMode(e.insertionMode),this.handleTarget(e.target)];case"implicit":return[]}}handleInsertionMode(e){switch(e){case"to":return Ce.sourceDestinationConnective;case"before":return Ce.before;case"after":return Ce.after}}};function UT(t){if(typeof t=="string")return[t];if(Array.isArray(t))return t.length===0?[""]:VT(t.map(UT)).map(e=>e.filter(r=>r.length!==0).join(" "));if(t.spokenForms.spokenForms.length===0){let e=`${Ao(t.spokenFormType)} with id ${t.id}`,r;throw t.spokenForms.isPrivate?r="this is a private spoken form currently only for internal experimentation":t.spokenForms.requiresTalonUpdate?r="please update talon to the latest version (see https://www.cursorless.org/docs/user/updating/)":r="please see https://www.cursorless.org/docs/user/customization/ for more information",new we(`${e}; ${r}`,t.spokenForms.requiresTalonUpdate,t.spokenForms.isPrivate)}return t.spokenForms.spokenForms}function VT(t){if(t.length===0)return[];if(t.length===1)return t[0].map(o=>[o]);let[e,...r]=t,n=VT(r);return e.flatMap(o=>n.map(a=>[o,...a]))}var Ec=class{constructor(e){this.talonSpokenForms=e;this.notifier=new Pe;this.spokenFormMap_={...er};this.onDidChangeCustomSpokenForms=this.notifier.registerListener;this.disposable=e.onDidChange(()=>this.updateSpokenFormMaps()),this.customSpokenFormsInitialized=this.updateSpokenFormMaps()}get spokenFormMap(){return this.spokenFormMap_}get needsInitialTalonUpdate(){return this.needsInitialTalonUpdate_}async updateSpokenFormMaps(){let e;try{if(e=await this.talonSpokenForms.getSpokenFormEntries(),e.length===0)throw new Error("Custom spoken forms list empty")}catch(r){if(r instanceof _s)this.needsInitialTalonUpdate_=!0;else if(!(r instanceof Ti)){console.error("Error loading custom spoken forms",r);let n=r.message.replace(/\.$/,"");De(h().messages,"CustomSpokenForms.updateSpokenFormMaps",`Error loading custom spoken forms: ${n}. Falling back to default spoken forms.`)}this.spokenFormMap_={...er},this.notifier.notifyListeners();return}for(let r of e_)tL(this.spokenFormMap_,r,Hm[r],Object.fromEntries(e.filter(n=>n.type===r).map(({id:n,spokenForms:o})=>[n,o])));this.notifier.notifyListeners()}getCustomRegexScopeTypes(){return Object.keys(this.spokenFormMap_.customRegex).map(e=>({type:"customRegex",regex:e}))}dispose(){this.disposable.dispose()}};function tL(t,e,r,n){let o=Array.from(new Set([...Object.keys(r),...Object.keys(n)])),a={};for(let s of o){let{defaultSpokenForms:c=[],isPrivate:p=!1}=r[s]??{},l=n[s];a[s]=l==null?{defaultSpokenForms:c,spokenForms:[],requiresTalonUpdate:!p,isCustom:!1,isPrivate:p}:{defaultSpokenForms:c,spokenForms:l,requiresTalonUpdate:!1,isCustom:!_r(c,l),isPrivate:p}}t[e]=a}var Rc=class{constructor(e){this.customSpokenForms=new Ec(e),this.customSpokenFormsInitialized=this.customSpokenForms.customSpokenFormsInitialized,this.spokenFormGenerator=new Bo(this.customSpokenForms.spokenFormMap),this.disposable=this.customSpokenForms.onDidChangeCustomSpokenForms(()=>{this.spokenFormGenerator=new Bo(this.customSpokenForms.spokenFormMap)})}onDidChangeCustomSpokenForms(e){return this.customSpokenForms.onDidChangeCustomSpokenForms(e)}commandToSpokenForm(e){return this.spokenFormGenerator.processCommand(e)}scopeTypeToSpokenForm(e){return this.spokenFormGenerator.processScopeType(e)}actionIdToSpokenForm(e){return this.spokenFormGenerator.getSpokenFormForSingleTerm("action",e)}graphemeToSpokenForm(e){return this.spokenFormGenerator.getSpokenFormForSingleTerm("grapheme",e)}getCustomRegexScopeTypes(){return this.customSpokenForms.getCustomRegexScopeTypes()}get needsInitialTalonUpdate(){return this.customSpokenForms.needsInitialTalonUpdate}dispose(){this.disposable.dispose()}};function*rL(t){for(let e of t)for(let r of e)yield r}function*Wo(t,e){let r=Ac(e),n=t;for(;n-- >0;){let o=r.next();if(!o.done)yield o.value;else return}}function*gd(t){let e=Ac(t),r=e.next();if(r.done)return;let n=r.value;for(let o of e)yield[n,o],n=o}var $Y=Symbol();function*nL(t=0,e=1){let r=t;for(;;)yield r,r+=e}function*kc(t,e){let r=0;for(let n of t)e(n,r++)&&(yield n)}function*Ke(t,e){for(let r of t)yield e(r)}function*WT(t,e,r,n=1){let o,a;if(r!==void 0?(o=e,a=r):(o=0,a=e),o<0)throw new Error("start cannot be negative");if(a!==null&&a<0)throw new Error("stop cannot be negative");if(n<=0)throw new Error("step cannot be negative");let s=-1,c=Ac(t),p;for(;;){if(s++,a!==null&&s>=a||(p=c.next(),p.done))return;s<o||(s-o)%n===0&&(yield p.value)}}function*iL(t,e){let r=0,n=Ac(t),o;for(;!(o=n.next()).done;){let a=o.value;if(!e(a,r++))return;yield a}}function Ac(t){return t[Symbol.iterator]()}function Li(t,e){return Array.from(Ke(t,e))}function BT(t,e,r){let n=nL(t,r),o=r>=0?a=>a<e:a=>a>e;return iL(n,o)}function $T(t,e,r=1){return e!==void 0?BT(t,e,r):BT(0,t,r)}function Pc(t,e){return rL(Ke(t,e))}function wt(t,e,{domain:r},{domain:n}){return t==="forward"?oL(e,r,n):aL(e,r,n)}function oL(t,e,r){let n=e.start.isAfterOrEqual(t),o=r.start.isAfterOrEqual(t);if(n&&o){let s=e.start.compareTo(r.start);return s===0?e.end.compareTo(r.end):s}if(!n&&!o){let s=e.end.compareTo(r.end);return s===0?-e.start.compareTo(r.start):s}if(!n&&o){let s=e.end.compareTo(r.start);return s!==0?s:r.isEmpty?1:-1}let a=e.start.compareTo(r.end);return a!==0?a:e.isEmpty?-1:1}function aL(t,e,r){let n=e.end.isBeforeOrEqual(t),o=r.end.isBeforeOrEqual(t);if(n&&o){let s=-e.end.compareTo(r.end);return s===0?-e.start.compareTo(r.start):s}if(!n&&!o){let s=-e.start.compareTo(r.start);return s===0?e.end.compareTo(r.end):s}if(!n&&o){let s=-e.start.compareTo(r.end);return s!==0?s:r.isEmpty?1:-1}let a=-e.end.compareTo(r.start);return a!==0?a:e.isEmpty?-1:1}function jT(t,e,r,n,o,a){return sL(t,n,o,a)&&(o==null||wt(r,n.includeDescendantScopes?t:e,o,a)<0)}function sL(t,e,r,n){let{containment:o,distalPosition:a,allowAdjacentScopes:s,skipAncestorScopes:c}=e,{domain:p}=n;switch(o){case"disallowed":if(p.contains(t))return!1;break;case"disallowedIfStrict":if(sT(p,t))return!1;break;case"required":if(!p.contains(t))return!1;break}return c&&r!=null&&p.contains(r.domain)?!1:cL(new D(t,a),p,s)}function cL(t,e,r){let n=t.intersection(e);return n==null?!1:!n.isEmpty||r||e.isEmpty}var pL={containment:null,allowAdjacentScopes:!1,skipAncestorScopes:!1,includeDescendantScopes:!1},de=class{constructor(){this.includeAdjacentInEvery=!1}*generateScopes(e,r,n,o={}){let a={...pL,...o,distalPosition:o.distalPosition??(n==="forward"?e.document.range.end:e.document.range.start)},s,c=r;for(let p of this.generateScopeCandidates(e,r,n,a))if(jT(r,c,n,a,s,p)&&(yield p,s=p,c=n==="forward"?p.domain.end:p.domain.start),this.canStopEarly(r,n,a,s,p))return}canStopEarly(e,r,n,o,a){let{containment:s,distalPosition:c,skipAncestorScopes:p}=n;if(this.isHierarchical&&!p)return!1;let l=this.isHierarchical&&p?o:a;return l==null?!1:!!(s==="required"&&(r==="forward"?l.domain.end.isAfter(e):l.domain.start.isBefore(e))||(r==="forward"?l.domain.end.isAfterOrEqual(c):l.domain.start.isBeforeOrEqual(c)))}};var gt=class extends de{constructor(r,n,o){super();this.scopeHandlerFactory=r;this.scopeType=n;this.languageId=o;this.isHierarchical=!1}get searchScopeType(){return this.iterationScopeType}get searchScopeHandler(){return this._searchScopeHandler==null&&(this._searchScopeHandler=this.scopeHandlerFactory.create(this.searchScopeType,this.languageId)),this._searchScopeHandler}generateScopeCandidates(r,n,o,a){let{containment:s,...c}=a,p=this.searchScopeHandler.generateScopes(r,n,o,{containment:s==="required"?"required":void 0,...c});return Pc(p,l=>this.generateScopesInSearchScope(o,l))}};var Mc=class extends de{constructor(r,n){super();this.scopeType={type:"line"};this.iterationScopeType={type:"paragraph"};this.isHierarchical=!1;this.includeAdjacentInEvery=!0}*generateScopeCandidates(r,n,o){if(o==="forward")for(let a=n.line;a<r.document.lineCount;a++)yield qT(r,a);else for(let a=n.line;a>=0;a--)yield qT(r,a)}};function qT(t,e){let{range:r}=t.document.lineAt(e);return{editor:t,domain:r,getTargets:n=>[hd(t,n,r)]}}function hd(t,e,r){return new dt({editor:t,isReversed:e,contentRange:yd(t,r)})}function yd(t,e){let r=t.document.lineAt(e.start),n=t.document.lineAt(e.end);return new D(r.rangeTrimmed?.start??r.range.start,n.rangeTrimmed?.end??n.range.end)}function It(t,e,r,n){let o=e.document.offsetAt(r.start),a=e.document.getText(r),s=c=>new D(e.document.positionAt(o+c.index),e.document.positionAt(o+c.index+c[0].length));return t.lastIndex=0,n==="forward"?Ke(a.matchAll(t),s):Array.from(a.matchAll(t),s).reverse()}var Dc=class extends gt{constructor(){super(...arguments);this.scopeType={type:"identifier"};this.iterationScopeType={type:"line"};this.regex=ft(this.languageId).identifierMatcher}generateScopesInSearchScope(r,{editor:n,domain:o}){return Ke(It(this.regex,n,o,r),a=>({editor:n,domain:a,getTargets:s=>[new et({editor:n,contentRange:a,isReversed:s})]}))}};function Lc(t,e,r){let n=t.editor.document.getText(t.domain),o=e.editor.document.getText(e.domain);for(let a of r){let s=ln(a,n),c=ln(a,o);if(s&&!c)return!0;if(c&&!s)return!1}}var lL=/\p{L}\p{M}*|[\p{N}\p{P}\p{S}\p{Z}\p{C}]/gu,uL=/[$]/g,mL=/\p{L}\p{M}*|[\p{N}\p{P}\p{S}]/gu,Fc=class extends gt{constructor(){super(...arguments);this.scopeType={type:"character"};this.iterationScopeType={type:"token"}}get searchScopeType(){return{type:"line"}}generateScopesInSearchScope(r,{editor:n,domain:o}){return Ke(It(lL,n,o,r),a=>({editor:n,domain:a,getTargets:s=>[new ye({editor:n,contentRange:a,isReversed:s,textualType:"character"})]}))}isPreferredOver(r,n){let{identifierMatcher:o}=ft(this.languageId);return Lc(r,n,[o,uL,mL])}};var Ic=class extends gt{constructor(){super(...arguments);this.scopeType={type:"word"};this.iterationScopeType={type:"identifier"};this.wordTokenizer=new Mi(this.languageId)}getScopesInSearchScope({editor:r,domain:n}){let{document:o}=r,a=o.offsetAt(n.start),c=this.wordTokenizer.splitIdentifier(o.getText(n)).map(p=>new D(o.positionAt(a+p.index),o.positionAt(a+p.index+p.text.length)));return c.map((p,l)=>({editor:r,domain:p,getTargets:u=>{let m=l>0?c[l-1]:null,d=l+1<c.length?c[l+1]:null;return[dL(u,r,m,p,d)]}}))}generateScopesInSearchScope(r,n){let o=this.getScopesInSearchScope(n);return r==="backward"&&o.reverse(),o}};function dL(t,e,r,n,o){let a=r!=null&&n.start.isAfter(r.end)?new D(r.end,n.start):void 0,s=o!=null&&o.start.isAfter(n.end)?new D(n.end,o.start):void 0,p=a!=null||s!=null?e.document.getText(a??s):"";return new nc({editor:e,isReversed:t,contentRange:n,insertionDelimiter:p,leadingDelimiterRange:a,trailingDelimiterRange:s})}var fL=/[$]/g,Cc=class extends gt{constructor(){super(...arguments);this.scopeType={type:"token"};this.iterationScopeType={type:"line"};this.regex=ft(this.languageId).tokenMatcher}generateScopesInSearchScope(r,{editor:n,domain:o}){return Ke(It(this.regex,n,o,r),a=>({editor:n,domain:a,getTargets:s=>[new et({editor:n,contentRange:a,isReversed:s})]}))}isPreferredOver(r,n){let{identifierMatcher:o}=ft(this.languageId);return Lc(r,n,[o,fL])}};var Oc=class extends de{constructor(r,n){super();this.scopeType={type:"document"};this.iterationScopeType={type:"document"};this.isHierarchical=!1}*generateScopeCandidates(r,n,o){let a=r.document.range;yield{editor:r,domain:a,getTargets:s=>[new ec({editor:r,isReversed:s,contentRange:a})]}}};function Nc(t,e,r,n,o){if(!t&&n!=null&&o!=null&&Xm(e,n)>Xm(e,o))return r.union(n)}function Fi(t){return t.containment==null&&t.skipAncestorScopes}function zT(t,e,r,{containment:n,distalPosition:o,allowAdjacentScopes:a}){let{start:s,end:c}=gL(t.offsetAt(e),t.offsetAt(o),r,n,a);return{start:t.positionAt(s),end:t.positionAt(c)}}function gL(t,e,r,n,o){let a=o?1:0;if(n==="required")return r==="forward"?{start:t-a,end:t+1}:{start:t-1,end:t+a};let s=n==="disallowed"?1:-a;return r==="forward"?{start:t+s,end:e+a}:{start:e-a,end:t-s}}function GT(t,e,r){let n=[],o=[];for(let a of t)o.length===0||e(o[o.length-1],a)?o.push(a):(n.push(r(o)),o=[a]);return o.length>0&&n.push(r(o)),n}var Ii=class extends de{constructor(r){super();this.query=r}*generateScopeCandidates(r,n,o,a){let{document:s}=r,c=Fi(a),{start:p,end:l}=zT(s,n,o,a),u=this.query.matches(s,p,l).map(m=>this.matchToScope(r,m,c)).filter(m=>m!=null).sort((m,d)=>wt(o,n,m,d));yield*GT(u,(m,d)=>m.domain.isRangeEqual(d.domain),m=>m.length===1?m[0]:{...m[0],getTargets(d){let g=xo(m.flatMap(b=>b.getTargets(d)),(b,w)=>b.isEqual(w));if(g.length>1&&!m.every(b=>b.allowMultiple)){let b="Please use #allow-multiple! predicate in your query to allow multiple matches for this scope type";if(De(h().messages,"BaseTreeSitterScopeHandler.allow-multiple",b),h().runMode==="test")throw Error(b)}return g}})}};function _d(t,e,r,n){return n?Ci(t,`${e}.${r}`,`_.${r}`):Ci(t,`${e}.${r}`)??(Ci(t,e)!=null?Ci(t,`_.${r}`):void 0)}function jr(t,e,r,n){return _d(t,e,r,n)?.range}function Ci(t,...e){return t.captures.find(r=>e.some(n=>r.name===n))}var Hc=class extends Ii{constructor(r,n){super(r);this.iterateeScopeType=n;this.isHierarchical=!0;this.scopeType=void 0}get iterationScopeType(){throw Error("Not implemented")}matchToScope(r,n,o){let a=this.iterateeScopeType.type,s=_d(n,a,"iteration",!1);if(s==null)return;let{range:c,allowMultiple:p}=s;if(c.isEmpty)return;let l=jr(n,a,"iteration.domain",!1)??c;return{editor:r,domain:l,allowMultiple:p,getTargets:u=>[new ye({editor:r,isReversed:u,contentRange:c})]}}};var Uc=class extends Ii{constructor(r,n){super(r);this.scopeType=n;this.isHierarchical=!0}get iterationScopeType(){return{type:"custom",scopeHandler:new Hc(this.query,this.scopeType)}}matchToScope(r,n,o){let a=this.scopeType.type,s=Ci(n,a);if(s==null)return;let{range:c,allowMultiple:p,insertionDelimiter:l}=s,u=jr(n,a,"domain",!0)??c,m=jr(n,a,"prefix",!0)?.with(void 0,c.start),d=jr(n,a,"leading",!0)?.with(void 0,m?.start??c.start),g=jr(n,a,"trailing",!0)?.with(c.end),b=jr(n,a,"removal",!0);return b==null&&(a==="collectionItem"||a==="argumentOrParameter")&&(b=Nc(o,r,c,d,g)),{editor:r,domain:u,allowMultiple:p,getTargets:w=>[new ki({scopeTypeType:a,editor:r,isReversed:w,contentRange:c,prefixRange:m,removalRange:b,leadingDelimiterRange:d,trailingDelimiterRange:g,insertionDelimiter:l})]}}};function KT(t){return t.flatMap((e,r)=>{let{value:n,done:o}=e.next();return o?[]:[{iterator:e,value:n,index:r}]})}function QT(t,e){return t.flatMap(r=>{let{iterator:n,index:o}=r,{value:a}=r,s=!1;for(;!s&&!e(a);)({value:a,done:s}=n.next());return s?[]:[{iterator:n,value:a,index:o}]})}var ar=class t extends de{constructor(r,n){super();this.scopeHandlers=r;this.getIterationScopeHandler=n;this.isHierarchical=!0;this.scopeType=void 0}static create(r,n,o){let a=n.scopeTypes.map(s=>r.create(s,o));return this.createFromScopeHandlers(r,o,a)}static createFromScopeHandlers(r,n,o){let a=()=>new t(o.map(s=>r.create(s.iterationScopeType,n)),()=>{throw new Error("Not implemented")});return new t(o,a)}get iterationScopeType(){return this.iterationScopeHandler==null&&(this.iterationScopeHandler=this.getIterationScopeHandler()),{type:"custom",scopeHandler:this.iterationScopeHandler}}*generateScopeCandidates(r,n,o,a){if(this.iterationScopeHandler?.lastYieldedIndex!=null){let p=this.iterationScopeHandler.lastYieldedIndex;yield*this.scopeHandlers[p].generateScopes(r,n,o,a);return}let s=this.scopeHandlers.map(p=>p.generateScopes(r,n,o,a)[Symbol.iterator]()),c=KT(s);for(;c.length>0;){c.sort((u,m)=>wt(o,n,u.value,m.value));let p=c[0],l=p.value;this.lastYieldedIndex=p.index,yield l,c=QT(c,u=>wt(o,n,l,u)<0)}}};var Vc=class extends de{constructor(r,n){super();this.scopeType={type:"paragraph"};this.iterationScopeType={type:"document"};this.isHierarchical=!1}*generateScopeCandidates(r,n,o){let{document:a}=r,s=o==="forward"?1:-1,c=o==="forward"?a.lineCount:-1,p=hL(a,n,o),l=r.document.lineAt(n);for(let u=n.line+s;u!==c;u+=s){let m=r.document.lineAt(u);m.isEmptyOrWhitespace?p!=null&&(yield JT(r,p.range.union(l.range)),p=void 0):p==null&&(p=m),l=m}p!=null&&(yield JT(r,p.range.union(l.range)))}};function hL(t,e,r){let n=r==="forward"?-1:1,o=r==="forward"?-1:t.lineCount,a=t.lineAt(e);if(!a.isEmptyOrWhitespace){for(let s=e.line+n;s!==o;s+=n){let c=t.lineAt(s);if(c.isEmptyOrWhitespace)break;a=c}return a}}function JT(t,e){return{editor:t,domain:e,getTargets:r=>[new Vr({editor:t,isReversed:r,contentRange:yd(t,e)})]}}function $o(t,e){return e.length>1?e.indexOf(t.slice(-1))>-1:t.slice(-1)===e}function YT(t,e){return t.slice(t.length-e.length)===e}var Td,_L=["al","adj","assn","Ave","BSc","MSc","Cell","Ch","Co","cc","Corp","Dem","Dept","ed","eg","Eq","Eqs","est","est","etc","Ex","ext","Fig","fig","Figs","figs","i.e","ie","Inc","inc","Jan","Feb","Mar","Apr","Jun","Jul","Aug","Sep","Sept","Oct","Nov","Dec","jr","mi","Miss","Mrs","Mr","Ms","Mol","mt","mts","no","Nos","PhD","MD","BA","MA","MM","pl","pop","pp","Prof","Dr","pt","Ref","Refs","Rep","repr","rev","Sec","Secs","Sgt","Col","Gen","Rep","Sen","Gov","Lt","Maj","Capt","St","Sr","sr","Jr","jr","Rev","Sun","Mon","Tu","Tue","Tues","Wed","Th","Thu","Thur","Thurs","Fri","Sat","trans","Univ","Viz","Vol","vs","v"];function ZT(t){t?Td=t:Td=_L}function xd(t){return/^[A-Z][a-z].*/.test(t)||Bc(t)}function XT(t){return xd(t)||/``|"|'/.test(t.substring(0,2))}function ex(t){let e=t.replace(/[-'`~!@#$%^&*()_|+=?;:'",.<>{}[\]\\/]/gi,"");return~Td.indexOf(e)}function tx(t,e){return(t==="a.m."||t==="p.m.")&&e.replace(/\W+/g,"").slice(-3).toLowerCase()==="day"}function Sd(t){let e=t.replace(/[()[]{}]/g,"").match(/(.\.)*/);return e&&e[0].length>0}function rx(t){return t.length<=3?!0:xd(t)}function vd(t,e){return e.length>0?t<5&&e[0].length<6&&xd(e[0])?!0:e.filter(function(n){return/[A-Z]/.test(n.charAt(0))}).length>=3:!1}function Bc(t,e){return e&&(t=t.slice(e-1,e+2)),!isNaN(t)}function nx(t){return t.match(/^(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?$/)}function ix(t){return t.match(/[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/)}function ox(t){let e=0;return((e=t.indexOf("."))>-1||(e=t.indexOf("!"))>-1||(e=t.indexOf("?"))>-1)&&t.charAt(e+1).match(/[a-zA-Z].*/)?[t.slice(0,e),t.slice(e+1)]:!1}function ax(t){return t==="."||t==="!"||t==="?"}var cx=" @~@ ",sx=cx.trim(),xL=new RegExp("\\S",""),SL=new RegExp("\\n+|[-#=_+*]{4,}","g"),vL=new RegExp("\\S+|\\n","g"),bL={newlineBoundaries:!1,preserveWhitespace:!1,abbreviations:void 0};function px(t,e){if(!t)return[];if(!xL.test(t))return[];let r={...bL,...e};ZT(r.abbreviations),r.newlineBoundaries&&(t=t.replace(SL,cx));let n,o;r.preserveWhitespace?(o=t.split(/(<br\s*\/?>|\S+|\n+)/),n=o.filter(function(m,d){return d%2})):n=t.trim().match(vL)??[];let a=0,s=0,c=[],p=[],l=[];if(!n||!n.length)return[];for(let m=0,d=n.length;m<d;m++){if(a++,l.push(n[m]),~n[m].indexOf(",")&&(a=0),ax(n[m])||$o(n[m],"?!")||n[m]===sx){r.newlineBoundaries&&n[m]===sx&&l.pop(),p.push(l),a=0,l=[];continue}if(($o(n[m],'"')||$o(n[m],"\u201D"))&&(n[m]=n[m].slice(0,-1)),$o(n[m],".")){if(m+1<d){if(n[m].length===2&&isNaN(n[m].charAt(0))||ex(n[m]))continue;if(XT(n[m+1])){if(tx(n[m],n[m+1])||vd(a,n.slice(m,6))||Bc(n[m+1])&&rx(n[m]))continue}else if(YT(n[m],"..")||Sd(n[m])||vd(a,n.slice(m,5)))continue}p.push(l),l=[],a=0;continue}(s=n[m].indexOf("."))>-1&&(Bc(n[m],s)||Sd(n[m])||ix(n[m])||nx(n[m]))||(c=ox(n[m]))&&(l.pop(),l.push(c[0]),p.push(l),l=[],a=0,l.push(c[1]))}return l.length&&p.push(l),p=p.filter(function(m){return m.length>0}),p.slice(1).reduce(function(m,d){let g=m[m.length-1];return g.length===1&&/^.{1,2}[.]$/.test(g[0])&&!/[.]/.test(d[0])?(m.pop(),m.push(g.concat(d)),m):(m.push(d),m)},[p[0]]).map(function(m,d){if(r.preserveWhitespace&&!r.newlineBoundaries){let g=m.length*2;return d===0&&(g+=1),o.splice(0,g).join("")}return m.join(" ")})}var wL=/\S*\p{L}/u,lx=/(\r?\n[^\p{L}]*\r?\n)|(?<=[.!?])(\s*\r?\n)/gu,EL={newlineBoundaries:!1,preserveWhitespace:!0},Wc=class{*segment(e){let r=px(e,EL),n=0;for(let o of r){let a=o.split(lx).filter(s=>s!=null);for(let s of a){if(!kL(s)){let c=RL(s,n);c!=null&&(yield c)}n+=s.length}}}};function RL(t,e){let r=ry(wL,t);if(r==null)return;let n=r.index;return n!==0&&(e+=n,t=t.slice(n)),{text:t.trimEnd(),index:e}}function kL(t){return ln(lx,t)}var $c=class extends gt{constructor(){super(...arguments);this.scopeType={type:"sentence"};this.iterationScopeType={type:"paragraph"};this.segmenter=new Wc}generateScopesInSearchScope(r,{editor:n,domain:o}){let a=n.document.offsetAt(o.start),s=n.document.getText(o),c=l=>{let u=new D(n.document.positionAt(a+l.index),n.document.positionAt(a+l.index+l.text.length));return{editor:n,domain:u,getTargets:m=>[new et({editor:n,contentRange:u,isReversed:m})]}},p=this.segmenter.segment(s);return r==="forward"?Ke(p,c):Array.from(p,c).reverse()}};var Oi=class extends gt{constructor(){super(...arguments);this.iterationScopeType={type:"line"}}generateScopesInSearchScope(r,{editor:n,domain:o}){return Ke(It(this.regex,n,o,r),a=>({editor:n,domain:a,getTargets:s=>[new et({editor:n,contentRange:a,isReversed:s})]}))}},jc=class extends Oi{constructor(){super(...arguments);this.regex=/\S+/g}},qc=class extends Oi{constructor(r,n,o){super(r,n,o);this.scopeType=n;this.regex=/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/g}},zc=class extends Oi{constructor(r,n,o){super(r,n,o);this.scopeType=n}get regex(){return new RegExp(this.scopeType.regex,this.scopeType.flags??"gu")}},Gc=class extends Oi{constructor(r,n,o){super(r,n,o);this.scopeType=n}get regex(){return new RegExp(St(this.scopeType.character),"gui")}};var Kc=class extends de{constructor(r,n,o){super();this.scopeHandlerFactory=r;this.languageId=n;this.targetScopeType=o;this.isHierarchical=!0;this.targetScopeHandler=this.scopeHandlerFactory.create(this.targetScopeType,this.languageId),this.surroundingPairInteriorScopeHandler=this.scopeHandlerFactory.create({type:"surroundingPairInterior",delimiter:"any"},this.languageId)}get iterationScopeType(){switch(this.targetScopeHandler.iterationScopeType.type){case"custom":case"fallback":case"conditional":throw Error(`Iteration scope type can't be '${this.targetScopeHandler.iterationScopeType.type}' for BoundedBaseScopeHandler`)}return{type:"oneOf",scopeTypes:[this.targetScopeHandler.iterationScopeType,{type:"surroundingPairInterior",delimiter:"any"}]}}*generateScopeCandidates(r,n,o,a){let s=this.targetScopeHandler.generateScopes(r,n,o,{...a,containment:a.containment!=="disallowed"?a.containment:void 0}),c=Array.from(this.surroundingPairInteriorScopeHandler.generateScopes(r,n,o,{...a,containment:Fi(a)?"required":a.containment}));for(let p of s){let l=[];for(let u of c){let m=p.domain.intersection(u.domain);m!=null&&!m.isEmpty&&l.push({editor:r,domain:m,getTargets:d=>[this.getTargets(ux(p,d),ux(u,d))]})}l.push(p),l.sort((u,m)=>wt(o,n,u,m)),yield*l}}};function ux(t,e){let r=t.getTargets(e);if(r.length!==1)throw Error(`Expected one target but got ${r.length}`);return r[0]}var Qc=class extends Kc{constructor(r,n,o){super(r,o,{type:"nonWhitespaceSequence"});this.scopeType={type:"boundedNonWhitespaceSequence"}}getTargets(r,n){let o=r.contentRange.intersection(n.contentRange);if(o==null||o.isEmpty)throw Error("Expected non empty intersection");return new et({editor:r.editor,isReversed:r.isReversed,contentRange:o})}},Jc=class extends Kc{constructor(r,n,o){super(r,o,{type:"paragraph"});this.scopeType={type:"boundedParagraph"}}getTargets(r,n){if(!(r instanceof Vr))throw Error("Expected ParagraphTarget");return new sc({editor:r.editor,isReversed:r.isReversed,paragraphTarget:r,containingInterior:n})}};var sr=class{constructor(e){this.items=e;this.index=0}add(e){this.items.push(e)}contains(e){return this.advance(e)}getContaining(e){if(this.advance(e))return this.items[this.index]}advance(e){for(;this.index<this.items.length;){let r=this.items[this.index].range;if(r.contains(e))return!0;if(e.end.isBeforeOrEqual(r.start))return!1;this.index++}return!1}};var Ni=class{constructor(e){this.children=AL(e)}getSmallestContaining(e){return this.children.getContaining(e)?.getSmallestContaining(e)}};function AL(t){let e=[],r=[];for(let n of t){let o=new bd(n);for(;r.length>0&&!r[r.length-1].range.contains(n.range);)r.pop();let a=r[r.length-1];a!=null?a.children.add(o):e.push(o),r.push(o)}return new sr(e)}var bd=class{constructor(e){this.item=e;this.children=new sr([])}get range(){return this.item.range}getSmallestContaining(e){return this.children.getContaining(e)?.getSmallestContaining(e)??this.item}};var PL=",",wd=new RegExp(PL,"g");function mx(t){let e=t.getText();return kt(e,wd,r=>new D(t.positionAt(r.index),t.positionAt(r.index+r[0].length)))}var dx={type:"fallback",scopeTypes:[{type:"conditional",scopeType:{type:"surroundingPairInterior",delimiter:"collectionBoundary"},predicate:t=>!t.domain.isEmpty},{type:"conditional",scopeType:{type:"line"},predicate:t=>{let e=t.editor.document.getText(t.domain);return ln(wd,e)}}]};function Ed(t,e,r,n,o,a){let s=o!=null?new D(o.end,n.start):void 0,c=a!=null?new D(n.end,a.start):void 0,p=Nc(t,e,n,s,c),l=r.isSingleLine?", ":`,
`;return{editor:e,domain:n,getTargets(u){return[new ki({scopeTypeType:"collectionItem",editor:e,isReversed:u,contentRange:n,insertionDelimiter:l,leadingDelimiterRange:s,trailingDelimiterRange:c,removalRange:p})]}}}function Rd(t,e,r,n){let o=t.create({type:"surroundingPairInterior",delimiter:n},e);return Array.from(o.generateScopes(r,new pe(0,0),"forward",{containment:void 0,skipAncestorScopes:!1,includeDescendantScopes:!0}),a=>({range:a.domain}))}var Yc=class extends de{constructor(r,n){super();this.scopeHandlerFactory=r;this.languageId=n;this.scopeType={type:"collectionItem"};this.isHierarchical=!0}get iterationScopeType(){return dx}*generateScopeCandidates(r,n,o,a){let s=Fi(a),c=mx(r.document),p=Rd(this.scopeHandlerFactory,this.languageId,r,"collectionBoundary"),l=new Ni(p),u=Rd(this.scopeHandlerFactory,this.languageId,r,"string"),m=new sr(u),d=[],g=new Set,b=[];for(let w of c){if(m.contains(w))continue;let I;for(;b.length>0;){let X=b[b.length-1];if(X.iterationRange.contains(w)){I=X;break}this.addScopes(d,X),b.pop()}let L=l.getSmallestContaining(w)?.range,H=L??r.document.lineAt(w.start.line).range;if(I!=null&&I.iterationRange.isRangeEqual(H)){I.delimiters.push(w);continue}L!=null&&g.add(L),b.push({editor:r,isEveryScope:s,iterationRange:H,delimiters:[w]})}for(let w of b)this.addScopes(d,w);for(let w of p)if(!g.has(w.range)&&!w.range.isEmpty){let I=Tn(r,w.range);I.isEmpty||d.push(Ed(s,r,w.range,I))}d.sort((w,I)=>wt(o,n,w,I)),yield*d}addScopes(r,n){let{editor:o,iterationRange:a,isEveryScope:s,delimiters:c}=n;if(c.length===0)return;let p=[];for(let m=0;m<c.length;++m){let d=c[m],g=c[m-1]?.end??a.start;p.push(new D(g,d.start))}let l=c[c.length-1];p.push(new D(l.end,a.end));let u=p.map(m=>Tn(o,m));for(let m=0;m<u.length;++m)m===u.length-1&&o.document.getText(u[m]).trim()===""||r.push(Ed(s,o,a,u[m],u[m-1],u[m+1]))}};var Zc=class extends de{constructor(r,n,o){super();this.scopeType={type:"collectionItem"};this.isHierarchical=!0;this.scopeHandler=(()=>{let a=new Yc(r,o),s=n.get(o)?.getScopeHandler(this.scopeType);return s==null?a:ar.createFromScopeHandlers(r,o,[s,a])})()}get iterationScopeType(){return this.scopeHandler.iterationScopeType}generateScopeCandidates(r,n,o,a){return this.scopeHandler.generateScopes(r,n,o,a)}};var Xc=class extends de{constructor(r,n,o){super();this.scopeHandlerFactory=r;this.conditionalScopeType=n;this.languageId=o;this.scopeType=void 0;this.isHierarchical=!0}get iterationScopeType(){throw new Ie("Iteration scope for ConditionalScopeHandler")}generateScopeCandidates(r,n,o,a){let s=this.scopeHandlerFactory.create(this.conditionalScopeType.scopeType,this.languageId);return kc(s.generateScopes(r,n,o,a),this.conditionalScopeType.predicate)}};var Hi=class t extends de{constructor(r){super();this.scopeHandlers=r;this.scopeType=void 0;this.isHierarchical=!0}static create(r,n,o){let a=n.scopeTypes.map(s=>r.create(s,o));return this.createFromScopeHandlers(a)}static createFromScopeHandlers(r){return new t(r)}get iterationScopeType(){throw new Ie("Iteration scope for FallbackScopeHandler")}*generateScopeCandidates(r,n,o,a){for(let s of this.scopeHandlers)yield*s.generateScopes(r,n,o,a)}};var ep=class extends de{constructor(){super();this.scopeType={type:"notebookCell"};this.iterationScopeType={type:"document"};this.isHierarchical=!1}*generateScopeCandidates(r,n,o,a){let s=ML(r,n,o,a);for(let c of s)yield LL(c)}};function ML(t,e,r,n){let o=DL(t);if(o==null)return[];let{notebook:a,cell:s}=o;return n.containment==="required"?[s]:n.containment==="disallowed"||n.containment==="disallowedIfStrict"?r==="forward"?a.cells.slice(s.index+1):a.cells.slice(0,s.index).reverse():n.distalPosition!=null&&new D(e,n.distalPosition).isRangeEqual(t.document.range)?a.cells:r==="forward"?a.cells.slice(s.index):a.cells.slice(0,s.index+1).reverse()}function DL(t){let e=t.document.uri.toString();for(let r of h().visibleNotebookEditors)for(let n of r.cells)if(n.document.uri.toString()===e)return{notebook:r,cell:n}}function LL(t){let e=FL(t),r=e.document.range;return{editor:e,domain:r,getTargets:n=>[new rc({editor:e,isReversed:n,contentRange:r})]}}function FL(t){let e=t.document.uri.toString();for(let r of h().visibleTextEditors)if(r.document.uri.toString()===e)return r;throw new Error("Editor not found notebook cell")}var tp=class extends de{constructor(r,n,o,a){super();this.scopeType={type:"notebookCell"};this.isHierarchical=!1;this.scopeHandler=(()=>{let s=new ep,c=n.get(a)?.getScopeHandler(this.scopeType);return c==null?s:ar.createFromScopeHandlers(r,a,[c,s])})()}get iterationScopeType(){return this.scopeHandler.iterationScopeType}generateScopeCandidates(r,n,o,a){return this.scopeHandler.generateScopes(r,n,o,a)}};var rp=class extends de{constructor(r,n,o){super();this.scopeHandlerFactory=r;this.scopeType=n;this.languageId=o;this.isHierarchical=!0;this.surroundingPairScopeHandler=this.scopeHandlerFactory.create({type:"surroundingPair",delimiter:this.scopeType.delimiter,requireStrongContainment:!0},this.languageId)}get iterationScopeType(){return this.surroundingPairScopeHandler.iterationScopeType}*generateScopeCandidates(r,n,o,a){let s=this.surroundingPairScopeHandler.generateScopes(r,n,o,a);for(let c of s)yield{editor:r,domain:c.domain,getTargets(p){return c.getTargets(p).flatMap(l=>l.getInterior())}}}};function fx(t,{openingDelimiterRange:e,closingDelimiterRange:r},n){let o=e.union(r),a=new D(e.end,r.start);return{editor:t,domain:n?a:o,getTargets:s=>[new ic({editor:t,isReversed:s,contentRange:o,interiorRange:a,boundary:[e,r]})]}}function gx(t){let e=pn(t.map(({text:r})=>r)).map(St).join("|");return new RegExp(`(?<!\\\\)(${e})`,"gu")}function yx(t,e,r){if(r.length===0)return[];let n=t?.getCapturesMap(e)??{},o=new sr(kd(n.disqualifyDelimiter)),a=new sr(kd(n.pairDelimiter)),s=new Ni(kd(n.textFragment)),c=Object.fromEntries(r.map(u=>[u.text,u])),p=Xu(e.getText(),gx(r)),l=[];for(let u of p){let m=u[0],d=new D(e.positionAt(u.index),e.positionAt(u.index+m.length));hx(o.getContaining(d))==null&&l.push({delimiterInfo:c[m],textFragmentRange:s.getSmallestContaining(d)?.range,range:hx(a.getContaining(d))?.range??d})}return l}function hx(t){return t!=null&&!t.hasError()?t:void 0}function kd(t){return t==null?[]:(t.sort((e,r)=>e.range.start.compareTo(r.range.start)),t)}var np=Object.freeze({angleBrackets:[["</","<"],[">","/>"]],curlyBrackets:[["{","${"],"}"],tripleBacktickQuotes:[[],[]],tripleDoubleQuotes:[[],[]],tripleSingleQuotes:[[],[]],doubleQuotes:['"','"',{isSingleLine:!0}],escapedDoubleQuotes:['\\"','\\"',{isSingleLine:!0}],escapedParentheses:["\\(","\\)"],escapedSquareBrackets:["\\[","\\]"],escapedSingleQuotes:["\\'","\\'",{isSingleLine:!0}],parentheses:[["(","$("],")"],backtickQuotes:["`","`"],singleQuotes:["'","'",{isSingleLine:!0}],squareBrackets:["[","]"]}),_x={nix:{singleQuotes:["''","''"]},lua:{doubleQuotes:[['"',"[["],['"',"]]"]]},python:{tripleSingleQuotes:["'''","'''"],tripleDoubleQuotes:['"""','"""']},markdown:{tripleBacktickQuotes:["```","```"]},ruby:{tripleDoubleQuotes:["%Q(",")"]},csharp:{doubleQuotes:[['@"','"'],['"','"']]}},Kee=Object.fromEntries(Object.values(np)),Tx={any:Ss(np),string:["tripleDoubleQuotes","tripleSingleQuotes","tripleBacktickQuotes","doubleQuotes","singleQuotes","backtickQuotes"],collectionBoundary:["parentheses","squareBrackets","curlyBrackets","angleBrackets"]};function xx(t){return t!=null&&t in _x?{...np,..._x[t]}:np}function Sx(t,e){let r=Tx[t]??[t];return IL(e,r)}function IL(t,e){let r=xx(t);return e.flatMap(n=>{let[o,a,s]=r[n],{isSingleLine:c=!1}=s??{},p=Po(o)?[o]:o,l=Po(a)?[a]:a;return pn(To(p,l)).map(m=>{let d=p.includes(m),g=l.includes(m);return{text:m,side:d&&!g?"left":!d&&g?"right":"unknown",delimiterName:n,isSingleLine:c}})})}function vx(t){let e=[],r=[];for(let n of t){let{delimiterInfo:{delimiterName:o,side:a,isSingleLine:s},textFragmentRange:c,range:p}=n;if(a==="left")r.push(n);else{let l=cn(r,m=>m.delimiterInfo.delimiterName===o&&CL(m.textFragmentRange,c)&&OL(s,m.range,p));if(l===-1){a==="unknown"&&r.push(n);continue}let u=r[l];r.length=l,e.push({delimiterName:o,openingDelimiterRange:u.range,closingDelimiterRange:p})}}return e}function CL(t,e){return t==null||e==null?t===e:t.isRangeEqual(e)}function OL(t,e,r){return!t||e.start.line===r.start.line}var ip=class extends de{constructor(r,n,o){super();this.languageDefinitions=r;this.scopeType=n;this.languageId=o;this.iterationScopeType={type:"conditional",scopeType:{type:"line"},predicate:r=>!r.domain.isEmpty};this.isHierarchical=!0}*generateScopeCandidates(r,n,o,a){if(this.scopeType.forceDirection!=null){De(h().messages,"deprecatedForceDirection","forceDirection is deprecated. If this is important to you please file an issue on the cursorless repo.");return}let s=yx(this.languageDefinitions.get(this.languageId),r.document,Sx(this.scopeType.delimiter,this.languageId)),c=vx(s);c=NL(o,a,n,c),yield*c.map(p=>fx(r,p,this.scopeType.requireStrongContainment??!1)).sort((p,l)=>wt(o,n,p,l))}};function NL(t,e,r,n){return t==="forward"&&e.containment==="required"&&e.allowAdjacentScopes&&e.skipAncestorScopes?n.filter((o,a)=>!(o.closingDelimiterRange.end.isEqual(r)&&n[a+1]?.closingDelimiterRange.start.isEqual(r))):n}var op=class extends de{constructor(r,n,o,a){super();this.scopeHandlerFactory=r;this.languageDefinitions=n;this.scopeType=o;this.languageId=a;this.isHierarchical=!0}get iterationScopeType(){throw new Ie("Iteration scope for InteriorScopeHandler")}*generateScopeCandidates(r,n,o,a){let s=new D(n,a.distalPosition),c=this.getScopeHandler();if(c==null)return;let p=c.generateScopes(r,n,o,a);for(let l of p)this.shouldYield(s,l)&&(yield HL(l))}getScopeHandler(){let r=this.languageDefinitions.get(this.languageId)?.getScopeHandler(this.scopeType),n=this.scopeHandlerFactory.create({type:"surroundingPair",delimiter:"any"},this.languageId);return this.scopeType.explicitScopeType?r==null?n:Hi.createFromScopeHandlers([r,n]):r==null?n:ar.createFromScopeHandlers(this.scopeHandlerFactory,this.languageId,[r,n])}shouldYield(r,n){return!this.scopeType.explicitScopeType||r.contains(n.domain)}};function HL(t){return{editor:t.editor,domain:t.domain,getTargets(e){return t.getTargets(e).flatMap(UL)}}}function UL(t){let e=t.getInterior();return e??[new Ai({editor:t.editor,isReversed:t.isReversed,fullInteriorRange:t.contentRange})]}var Ui=class{constructor(e){this.languageDefinitions=e;this.maybeCreate=this.maybeCreate.bind(this),this.create=this.create.bind(this)}maybeCreate(e,r){switch(e.type){case"character":return new Fc(this,e,r);case"word":return new Ic(this,e,r);case"token":return new Cc(this,e,r);case"identifier":return new Dc(this,e,r);case"line":return new Mc(e,r);case"sentence":return new $c(this,e,r);case"paragraph":return new Vc(e,r);case"boundedParagraph":return new Jc(this,e,r);case"document":return new Oc(e,r);case"nonWhitespaceSequence":return new jc(this,e,r);case"boundedNonWhitespaceSequence":return new Qc(this,e,r);case"url":return new qc(this,e,r);case"customRegex":return new zc(this,e,r);case"glyph":return new Gc(this,e,r);case"collectionItem":return new Zc(this,this.languageDefinitions,r);case"surroundingPair":return new ip(this.languageDefinitions,e,r);case"surroundingPairInterior":return new rp(this,e,r);case"notebookCell":return new tp(this,this.languageDefinitions,e,r);case"interior":return new op(this,this.languageDefinitions,e,r);case"custom":return e.scopeHandler;case"oneOf":return ar.create(this,e,r);case"fallback":return Hi.create(this,e,r);case"conditional":return new Xc(this,e,r);case"instance":throw Error("Unexpected scope type 'instance'");default:return this.languageDefinitions.get(r)?.getScopeHandler(e)}}create(e,r){let n=this.maybeCreate(e,r);if(n==null)throw new Error(`Couldn't create scope handler for '${e.type}'`);return n}};function bx(t){return new D(t.startPosition.row,t.startPosition.column,t.endPosition.row,t.endPosition.column)}function wx(t,e){if(t.length===1)return!0;let r=!1,n=t.filter(({name:p})=>p.endsWith(".start")).map(({range:{end:p}})=>p).sort((p,l)=>p.compareTo(l)).at(-1),o=t.filter(({name:p})=>p.endsWith(".end")).map(({range:{start:p}})=>p).sort((p,l)=>p.compareTo(l)).at(0);n!=null&&o!=null&&n.isAfter(o)&&(De(e,"TreeSitterQuery.checkCaptures.badOrder",`Start capture must be before end capture: ${t.map(p=>p.name)}`),r=!0);let a=t.filter(({name:p})=>p.endsWith(".start")).length,s=t.filter(({name:p})=>p.endsWith(".end")).length,c=t.length-a-s;return c>0&&(a>0||s>0)&&(De(e,"TreeSitterQuery.checkCaptures.mixRegularStartEnd",`Please do not mix regular captures and start/end captures: ${t.map(({name:p,range:l})=>p+" "+l.toString())}`),r=!0),c>1&&(De(e,"TreeSitterQuery.checkCaptures.duplicate",`A capture with the same name may only appear once in a single pattern: ${t.map(({name:p,range:l})=>p+" "+l.toString())}`),r=!0),!r}function Ex(t){if(t.hasError)return!0;let e=t.parent;for(;e!=null;){if(e.isError)return!0;if(e.hasError)return!1;if(e.previousSibling?.isError||e.nextSibling?.isError)return!0;e=e.parent}return!1}function Ad(t){return t.replace(/(\.(start|end))?(\.(startOf|endOf))?$/,"")}var se={};nv(se,{BRAND:()=>uF,DIRTY:()=>vn,EMPTY_PATH:()=>$L,INVALID:()=>Y,NEVER:()=>QF,OK:()=>tt,ParseStatus:()=>Qe,Schema:()=>ce,ZodAny:()=>Gr,ZodArray:()=>Er,ZodBigInt:()=>wn,ZodBoolean:()=>En,ZodBranded:()=>qo,ZodCatch:()=>On,ZodDate:()=>Rn,ZodDefault:()=>Cn,ZodDiscriminatedUnion:()=>cp,ZodEffects:()=>Nt,ZodEnum:()=>Fn,ZodError:()=>ht,ZodFirstPartyTypeKind:()=>Z,ZodFunction:()=>lp,ZodIntersection:()=>Mn,ZodIssueCode:()=>N,ZodLazy:()=>Dn,ZodLiteral:()=>Ln,ZodMap:()=>qi,ZodNaN:()=>Gi,ZodNativeEnum:()=>In,ZodNever:()=>qt,ZodNull:()=>An,ZodNullable:()=>lr,ZodNumber:()=>bn,ZodObject:()=>yt,ZodOptional:()=>Ct,ZodParsedType:()=>W,ZodPipeline:()=>zo,ZodPromise:()=>Kr,ZodReadonly:()=>Nn,ZodRecord:()=>pp,ZodSchema:()=>ce,ZodSet:()=>zi,ZodString:()=>zr,ZodSymbol:()=>$i,ZodTransformer:()=>Nt,ZodTuple:()=>pr,ZodType:()=>ce,ZodUndefined:()=>kn,ZodUnion:()=>Pn,ZodUnknown:()=>wr,ZodVoid:()=>ji,addIssueToContext:()=>B,any:()=>xF,array:()=>wF,bigint:()=>gF,boolean:()=>Ox,coerce:()=>KF,custom:()=>Fx,date:()=>hF,datetimeRegex:()=>Dx,defaultErrorMap:()=>vr,discriminatedUnion:()=>AF,effect:()=>VF,enum:()=>NF,function:()=>IF,getErrorMap:()=>Vi,getParsedType:()=>cr,instanceof:()=>dF,intersection:()=>PF,isAborted:()=>ap,isAsync:()=>Bi,isDirty:()=>sp,isValid:()=>qr,late:()=>mF,lazy:()=>CF,literal:()=>OF,makeIssue:()=>jo,map:()=>LF,nan:()=>fF,nativeEnum:()=>HF,never:()=>vF,null:()=>TF,nullable:()=>WF,number:()=>Cx,object:()=>EF,objectUtil:()=>Pd,oboolean:()=>GF,onumber:()=>zF,optional:()=>BF,ostring:()=>qF,pipeline:()=>jF,preprocess:()=>$F,promise:()=>UF,quotelessJson:()=>VL,record:()=>DF,set:()=>FF,setErrorMap:()=>WL,strictObject:()=>RF,string:()=>Ix,symbol:()=>yF,transformer:()=>VF,tuple:()=>MF,undefined:()=>_F,union:()=>kF,unknown:()=>SF,util:()=>me,void:()=>bF});var me;(function(t){t.assertEqual=o=>{};function e(o){}t.assertIs=e;function r(o){throw new Error}t.assertNever=r,t.arrayToEnum=o=>{let a={};for(let s of o)a[s]=s;return a},t.getValidEnumValues=o=>{let a=t.objectKeys(o).filter(c=>typeof o[o[c]]!="number"),s={};for(let c of a)s[c]=o[c];return t.objectValues(s)},t.objectValues=o=>t.objectKeys(o).map(function(a){return o[a]}),t.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{let a=[];for(let s in o)Object.prototype.hasOwnProperty.call(o,s)&&a.push(s);return a},t.find=(o,a)=>{for(let s of o)if(a(s))return s},t.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&Number.isFinite(o)&&Math.floor(o)===o;function n(o,a=" | "){return o.map(s=>typeof s=="string"?`'${s}'`:s).join(a)}t.joinValues=n,t.jsonStringifyReplacer=(o,a)=>typeof a=="bigint"?a.toString():a})(me||(me={}));var Pd;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(Pd||(Pd={}));var W=me.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),cr=t=>{switch(typeof t){case"undefined":return W.undefined;case"string":return W.string;case"number":return Number.isNaN(t)?W.nan:W.number;case"boolean":return W.boolean;case"function":return W.function;case"bigint":return W.bigint;case"symbol":return W.symbol;case"object":return Array.isArray(t)?W.array:t===null?W.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?W.promise:typeof Map<"u"&&t instanceof Map?W.map:typeof Set<"u"&&t instanceof Set?W.set:typeof Date<"u"&&t instanceof Date?W.date:W.object;default:return W.unknown}};var N=me.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),VL=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),ht=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(a){return a.message},n={_errors:[]},o=a=>{for(let s of a.issues)if(s.code==="invalid_union")s.unionErrors.map(o);else if(s.code==="invalid_return_type")o(s.returnTypeError);else if(s.code==="invalid_arguments")o(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let c=n,p=0;for(;p<s.path.length;){let l=s.path[p];p===s.path.length-1?(c[l]=c[l]||{_errors:[]},c[l]._errors.push(r(s))):c[l]=c[l]||{_errors:[]},c=c[l],p++}}};return o(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,me.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let o of this.issues)o.path.length>0?(r[o.path[0]]=r[o.path[0]]||[],r[o.path[0]].push(e(o))):n.push(e(o));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};ht.create=t=>new ht(t);var BL=(t,e)=>{let r;switch(t.code){case N.invalid_type:t.received===W.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case N.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,me.jsonStringifyReplacer)}`;break;case N.unrecognized_keys:r=`Unrecognized key(s) in object: ${me.joinValues(t.keys,", ")}`;break;case N.invalid_union:r="Invalid input";break;case N.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${me.joinValues(t.options)}`;break;case N.invalid_enum_value:r=`Invalid enum value. Expected ${me.joinValues(t.options)}, received '${t.received}'`;break;case N.invalid_arguments:r="Invalid function arguments";break;case N.invalid_return_type:r="Invalid function return type";break;case N.invalid_date:r="Invalid date";break;case N.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:me.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case N.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case N.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case N.custom:r="Invalid input";break;case N.invalid_intersection_types:r="Intersection results could not be merged";break;case N.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case N.not_finite:r="Number must be finite";break;default:r=e.defaultError,me.assertNever(t)}return{message:r}},vr=BL;var Rx=vr;function WL(t){Rx=t}function Vi(){return Rx}var jo=t=>{let{data:e,path:r,errorMaps:n,issueData:o}=t,a=[...r,...o.path||[]],s={...o,path:a};if(o.message!==void 0)return{...o,path:a,message:o.message};let c="",p=n.filter(l=>!!l).slice().reverse();for(let l of p)c=l(s,{data:e,defaultError:c}).message;return{...o,path:a,message:c}},$L=[];function B(t,e){let r=Vi(),n=jo({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===vr?void 0:vr].filter(o=>!!o)});t.common.issues.push(n)}var Qe=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let n=[];for(let o of r){if(o.status==="aborted")return Y;o.status==="dirty"&&e.dirty(),n.push(o.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let o of r){let a=await o.key,s=await o.value;n.push({key:a,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let o of r){let{key:a,value:s}=o;if(a.status==="aborted"||s.status==="aborted")return Y;a.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof s.value<"u"||o.alwaysSet)&&(n[a.value]=s.value)}return{status:e.value,value:n}}},Y=Object.freeze({status:"aborted"}),vn=t=>({status:"dirty",value:t}),tt=t=>({status:"valid",value:t}),ap=t=>t.status==="aborted",sp=t=>t.status==="dirty",qr=t=>t.status==="valid",Bi=t=>typeof Promise<"u"&&t instanceof Promise;var q;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(q||(q={}));var Ot=class{constructor(e,r,n,o){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=o}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},kx=(t,e)=>{if(qr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new ht(t.common.issues);return this._error=r,this._error}}};function ie(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:o}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:o}:{errorMap:(s,c)=>{let{message:p}=t;return s.code==="invalid_enum_value"?{message:p??c.defaultError}:typeof c.data>"u"?{message:p??n??c.defaultError}:s.code!=="invalid_type"?{message:c.defaultError}:{message:p??r??c.defaultError}},description:o}}var ce=class{get description(){return this._def.description}_getType(e){return cr(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:cr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Qe,ctx:{common:e.parent.common,data:e.data,parsedType:cr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Bi(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:cr(e)},o=this._parseSync({data:e,path:n.path,parent:n});return kx(n,o)}"~validate"(e){let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:cr(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return qr(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>qr(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:cr(e)},o=this._parse({data:e,path:n.path,parent:n}),a=await(Bi(o)?o:Promise.resolve(o));return kx(n,a)}refine(e,r){let n=o=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(o):r;return this._refinement((o,a)=>{let s=e(o),c=()=>a.addIssue({code:N.custom,...n(o)});return typeof Promise<"u"&&s instanceof Promise?s.then(p=>p?!0:(c(),!1)):s?!0:(c(),!1)})}refinement(e,r){return this._refinement((n,o)=>e(n)?!0:(o.addIssue(typeof r=="function"?r(n,o):r),!1))}_refinement(e){return new Nt({schema:this,typeName:Z.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Ct.create(this,this._def)}nullable(){return lr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Er.create(this)}promise(){return Kr.create(this,this._def)}or(e){return Pn.create([this,e],this._def)}and(e){return Mn.create(this,e,this._def)}transform(e){return new Nt({...ie(this._def),schema:this,typeName:Z.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new Cn({...ie(this._def),innerType:this,defaultValue:r,typeName:Z.ZodDefault})}brand(){return new qo({typeName:Z.ZodBranded,type:this,...ie(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new On({...ie(this._def),innerType:this,catchValue:r,typeName:Z.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return zo.create(this,e)}readonly(){return Nn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},jL=/^c[^\s-]{8,}$/i,qL=/^[0-9a-z]+$/,zL=/^[0-9A-HJKMNP-TV-Z]{26}$/i,GL=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,KL=/^[a-z0-9_-]{21}$/i,QL=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,JL=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,YL=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,ZL="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Md,XL=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,eF=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,tF=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,rF=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,nF=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,iF=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Px="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",oF=new RegExp(`^${Px}$`);function Mx(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);let r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function aF(t){return new RegExp(`^${Mx(t)}$`)}function Dx(t){let e=`${Px}T${Mx(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function sF(t,e){return!!((e==="v4"||!e)&&XL.test(t)||(e==="v6"||!e)&&tF.test(t))}function cF(t,e){if(!QL.test(t))return!1;try{let[r]=t.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),o=JSON.parse(atob(n));return!(typeof o!="object"||o===null||"typ"in o&&o?.typ!=="JWT"||!o.alg||e&&o.alg!==e)}catch{return!1}}function pF(t,e){return!!((e==="v4"||!e)&&eF.test(t)||(e==="v6"||!e)&&rF.test(t))}var zr=class t extends ce{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==W.string){let a=this._getOrReturnCtx(e);return B(a,{code:N.invalid_type,expected:W.string,received:a.parsedType}),Y}let n=new Qe,o;for(let a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(o=this._getOrReturnCtx(e,o),B(o,{code:N.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="max")e.data.length>a.value&&(o=this._getOrReturnCtx(e,o),B(o,{code:N.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="length"){let s=e.data.length>a.value,c=e.data.length<a.value;(s||c)&&(o=this._getOrReturnCtx(e,o),s?B(o,{code:N.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):c&&B(o,{code:N.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind==="email")YL.test(e.data)||(o=this._getOrReturnCtx(e,o),B(o,{validation:"email",code:N.invalid_string,message:a.message}),n.dirty());else if(a.kind==="emoji")Md||(Md=new RegExp(ZL,"u")),Md.test(e.data)||(o=this._getOrReturnCtx(e,o),B(o,{validation:"emoji",code:N.invalid_string,message:a.message}),n.dirty());else if(a.kind==="uuid")GL.test(e.data)||(o=this._getOrReturnCtx(e,o),B(o,{validation:"uuid",code:N.invalid_string,message:a.message}),n.dirty());else if(a.kind==="nanoid")KL.test(e.data)||(o=this._getOrReturnCtx(e,o),B(o,{validation:"nanoid",code:N.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid")jL.test(e.data)||(o=this._getOrReturnCtx(e,o),B(o,{validation:"cuid",code:N.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid2")qL.test(e.data)||(o=this._getOrReturnCtx(e,o),B(o,{validation:"cuid2",code:N.invalid_string,message:a.message}),n.dirty());else if(a.kind==="ulid")zL.test(e.data)||(o=this._getOrReturnCtx(e,o),B(o,{validation:"ulid",code:N.invalid_string,message:a.message}),n.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{o=this._getOrReturnCtx(e,o),B(o,{validation:"url",code:N.invalid_string,message:a.message}),n.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(o=this._getOrReturnCtx(e,o),B(o,{validation:"regex",code:N.invalid_string,message:a.message}),n.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(o=this._getOrReturnCtx(e,o),B(o,{code:N.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(o=this._getOrReturnCtx(e,o),B(o,{code:N.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(o=this._getOrReturnCtx(e,o),B(o,{code:N.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind==="datetime"?Dx(a).test(e.data)||(o=this._getOrReturnCtx(e,o),B(o,{code:N.invalid_string,validation:"datetime",message:a.message}),n.dirty()):a.kind==="date"?oF.test(e.data)||(o=this._getOrReturnCtx(e,o),B(o,{code:N.invalid_string,validation:"date",message:a.message}),n.dirty()):a.kind==="time"?aF(a).test(e.data)||(o=this._getOrReturnCtx(e,o),B(o,{code:N.invalid_string,validation:"time",message:a.message}),n.dirty()):a.kind==="duration"?JL.test(e.data)||(o=this._getOrReturnCtx(e,o),B(o,{validation:"duration",code:N.invalid_string,message:a.message}),n.dirty()):a.kind==="ip"?sF(e.data,a.version)||(o=this._getOrReturnCtx(e,o),B(o,{validation:"ip",code:N.invalid_string,message:a.message}),n.dirty()):a.kind==="jwt"?cF(e.data,a.alg)||(o=this._getOrReturnCtx(e,o),B(o,{validation:"jwt",code:N.invalid_string,message:a.message}),n.dirty()):a.kind==="cidr"?pF(e.data,a.version)||(o=this._getOrReturnCtx(e,o),B(o,{validation:"cidr",code:N.invalid_string,message:a.message}),n.dirty()):a.kind==="base64"?nF.test(e.data)||(o=this._getOrReturnCtx(e,o),B(o,{validation:"base64",code:N.invalid_string,message:a.message}),n.dirty()):a.kind==="base64url"?iF.test(e.data)||(o=this._getOrReturnCtx(e,o),B(o,{validation:"base64url",code:N.invalid_string,message:a.message}),n.dirty()):me.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(o=>e.test(o),{validation:r,code:N.invalid_string,...q.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...q.errToObj(e)})}url(e){return this._addCheck({kind:"url",...q.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...q.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...q.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...q.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...q.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...q.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...q.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...q.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...q.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...q.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...q.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...q.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...q.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...q.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...q.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...q.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...q.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...q.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...q.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...q.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...q.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...q.errToObj(r)})}nonempty(e){return this.min(1,q.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};zr.create=t=>new zr({checks:[],typeName:Z.ZodString,coerce:t?.coerce??!1,...ie(t)});function lF(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,o=r>n?r:n,a=Number.parseInt(t.toFixed(o).replace(".","")),s=Number.parseInt(e.toFixed(o).replace(".",""));return a%s/10**o}var bn=class t extends ce{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==W.number){let a=this._getOrReturnCtx(e);return B(a,{code:N.invalid_type,expected:W.number,received:a.parsedType}),Y}let n,o=new Qe;for(let a of this._def.checks)a.kind==="int"?me.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),B(n,{code:N.invalid_type,expected:"integer",received:"float",message:a.message}),o.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),B(n,{code:N.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),o.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),B(n,{code:N.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),o.dirty()):a.kind==="multipleOf"?lF(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),B(n,{code:N.not_multiple_of,multipleOf:a.value,message:a.message}),o.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),B(n,{code:N.not_finite,message:a.message}),o.dirty()):me.assertNever(a);return{status:o.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,q.toString(r))}gt(e,r){return this.setLimit("min",e,!1,q.toString(r))}lte(e,r){return this.setLimit("max",e,!0,q.toString(r))}lt(e,r){return this.setLimit("max",e,!1,q.toString(r))}setLimit(e,r,n,o){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:q.toString(o)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:q.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:q.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:q.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:q.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:q.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&me.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}};bn.create=t=>new bn({checks:[],typeName:Z.ZodNumber,coerce:t?.coerce||!1,...ie(t)});var wn=class t extends ce{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==W.bigint)return this._getInvalidInput(e);let n,o=new Qe;for(let a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),B(n,{code:N.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),o.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),B(n,{code:N.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),o.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),B(n,{code:N.not_multiple_of,multipleOf:a.value,message:a.message}),o.dirty()):me.assertNever(a);return{status:o.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return B(r,{code:N.invalid_type,expected:W.bigint,received:r.parsedType}),Y}gte(e,r){return this.setLimit("min",e,!0,q.toString(r))}gt(e,r){return this.setLimit("min",e,!1,q.toString(r))}lte(e,r){return this.setLimit("max",e,!0,q.toString(r))}lt(e,r){return this.setLimit("max",e,!1,q.toString(r))}setLimit(e,r,n,o){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:q.toString(o)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:q.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:q.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:q.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:q.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:q.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};wn.create=t=>new wn({checks:[],typeName:Z.ZodBigInt,coerce:t?.coerce??!1,...ie(t)});var En=class extends ce{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==W.boolean){let n=this._getOrReturnCtx(e);return B(n,{code:N.invalid_type,expected:W.boolean,received:n.parsedType}),Y}return tt(e.data)}};En.create=t=>new En({typeName:Z.ZodBoolean,coerce:t?.coerce||!1,...ie(t)});var Rn=class t extends ce{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==W.date){let a=this._getOrReturnCtx(e);return B(a,{code:N.invalid_type,expected:W.date,received:a.parsedType}),Y}if(Number.isNaN(e.data.getTime())){let a=this._getOrReturnCtx(e);return B(a,{code:N.invalid_date}),Y}let n=new Qe,o;for(let a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(o=this._getOrReturnCtx(e,o),B(o,{code:N.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),n.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(o=this._getOrReturnCtx(e,o),B(o,{code:N.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),n.dirty()):me.assertNever(a);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:q.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:q.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};Rn.create=t=>new Rn({checks:[],coerce:t?.coerce||!1,typeName:Z.ZodDate,...ie(t)});var $i=class extends ce{_parse(e){if(this._getType(e)!==W.symbol){let n=this._getOrReturnCtx(e);return B(n,{code:N.invalid_type,expected:W.symbol,received:n.parsedType}),Y}return tt(e.data)}};$i.create=t=>new $i({typeName:Z.ZodSymbol,...ie(t)});var kn=class extends ce{_parse(e){if(this._getType(e)!==W.undefined){let n=this._getOrReturnCtx(e);return B(n,{code:N.invalid_type,expected:W.undefined,received:n.parsedType}),Y}return tt(e.data)}};kn.create=t=>new kn({typeName:Z.ZodUndefined,...ie(t)});var An=class extends ce{_parse(e){if(this._getType(e)!==W.null){let n=this._getOrReturnCtx(e);return B(n,{code:N.invalid_type,expected:W.null,received:n.parsedType}),Y}return tt(e.data)}};An.create=t=>new An({typeName:Z.ZodNull,...ie(t)});var Gr=class extends ce{constructor(){super(...arguments),this._any=!0}_parse(e){return tt(e.data)}};Gr.create=t=>new Gr({typeName:Z.ZodAny,...ie(t)});var wr=class extends ce{constructor(){super(...arguments),this._unknown=!0}_parse(e){return tt(e.data)}};wr.create=t=>new wr({typeName:Z.ZodUnknown,...ie(t)});var qt=class extends ce{_parse(e){let r=this._getOrReturnCtx(e);return B(r,{code:N.invalid_type,expected:W.never,received:r.parsedType}),Y}};qt.create=t=>new qt({typeName:Z.ZodNever,...ie(t)});var ji=class extends ce{_parse(e){if(this._getType(e)!==W.undefined){let n=this._getOrReturnCtx(e);return B(n,{code:N.invalid_type,expected:W.void,received:n.parsedType}),Y}return tt(e.data)}};ji.create=t=>new ji({typeName:Z.ZodVoid,...ie(t)});var Er=class t extends ce{_parse(e){let{ctx:r,status:n}=this._processInputParams(e),o=this._def;if(r.parsedType!==W.array)return B(r,{code:N.invalid_type,expected:W.array,received:r.parsedType}),Y;if(o.exactLength!==null){let s=r.data.length>o.exactLength.value,c=r.data.length<o.exactLength.value;(s||c)&&(B(r,{code:s?N.too_big:N.too_small,minimum:c?o.exactLength.value:void 0,maximum:s?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),n.dirty())}if(o.minLength!==null&&r.data.length<o.minLength.value&&(B(r,{code:N.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),n.dirty()),o.maxLength!==null&&r.data.length>o.maxLength.value&&(B(r,{code:N.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((s,c)=>o.type._parseAsync(new Ot(r,s,r.path,c)))).then(s=>Qe.mergeArray(n,s));let a=[...r.data].map((s,c)=>o.type._parseSync(new Ot(r,s,r.path,c)));return Qe.mergeArray(n,a)}get element(){return this._def.type}min(e,r){return new t({...this._def,minLength:{value:e,message:q.toString(r)}})}max(e,r){return new t({...this._def,maxLength:{value:e,message:q.toString(r)}})}length(e,r){return new t({...this._def,exactLength:{value:e,message:q.toString(r)}})}nonempty(e){return this.min(1,e)}};Er.create=(t,e)=>new Er({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Z.ZodArray,...ie(e)});function Wi(t){if(t instanceof yt){let e={};for(let r in t.shape){let n=t.shape[r];e[r]=Ct.create(Wi(n))}return new yt({...t._def,shape:()=>e})}else return t instanceof Er?new Er({...t._def,type:Wi(t.element)}):t instanceof Ct?Ct.create(Wi(t.unwrap())):t instanceof lr?lr.create(Wi(t.unwrap())):t instanceof pr?pr.create(t.items.map(e=>Wi(e))):t}var yt=class t extends ce{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=me.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==W.object){let l=this._getOrReturnCtx(e);return B(l,{code:N.invalid_type,expected:W.object,received:l.parsedType}),Y}let{status:n,ctx:o}=this._processInputParams(e),{shape:a,keys:s}=this._getCached(),c=[];if(!(this._def.catchall instanceof qt&&this._def.unknownKeys==="strip"))for(let l in o.data)s.includes(l)||c.push(l);let p=[];for(let l of s){let u=a[l],m=o.data[l];p.push({key:{status:"valid",value:l},value:u._parse(new Ot(o,m,o.path,l)),alwaysSet:l in o.data})}if(this._def.catchall instanceof qt){let l=this._def.unknownKeys;if(l==="passthrough")for(let u of c)p.push({key:{status:"valid",value:u},value:{status:"valid",value:o.data[u]}});else if(l==="strict")c.length>0&&(B(o,{code:N.unrecognized_keys,keys:c}),n.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let l=this._def.catchall;for(let u of c){let m=o.data[u];p.push({key:{status:"valid",value:u},value:l._parse(new Ot(o,m,o.path,u)),alwaysSet:u in o.data})}}return o.common.async?Promise.resolve().then(async()=>{let l=[];for(let u of p){let m=await u.key,d=await u.value;l.push({key:m,value:d,alwaysSet:u.alwaysSet})}return l}).then(l=>Qe.mergeObjectSync(n,l)):Qe.mergeObjectSync(n,p)}get shape(){return this._def.shape()}strict(e){return q.errToObj,new t({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{let o=this._def.errorMap?.(r,n).message??n.defaultError;return r.code==="unrecognized_keys"?{message:q.errToObj(e).message??o}:{message:o}}}:{}})}strip(){return new t({...this._def,unknownKeys:"strip"})}passthrough(){return new t({...this._def,unknownKeys:"passthrough"})}extend(e){return new t({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new t({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Z.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new t({...this._def,catchall:e})}pick(e){let r={};for(let n of me.objectKeys(e))e[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}omit(e){let r={};for(let n of me.objectKeys(this.shape))e[n]||(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}deepPartial(){return Wi(this)}partial(e){let r={};for(let n of me.objectKeys(this.shape)){let o=this.shape[n];e&&!e[n]?r[n]=o:r[n]=o.optional()}return new t({...this._def,shape:()=>r})}required(e){let r={};for(let n of me.objectKeys(this.shape))if(e&&!e[n])r[n]=this.shape[n];else{let a=this.shape[n];for(;a instanceof Ct;)a=a._def.innerType;r[n]=a}return new t({...this._def,shape:()=>r})}keyof(){return Lx(me.objectKeys(this.shape))}};yt.create=(t,e)=>new yt({shape:()=>t,unknownKeys:"strip",catchall:qt.create(),typeName:Z.ZodObject,...ie(e)});yt.strictCreate=(t,e)=>new yt({shape:()=>t,unknownKeys:"strict",catchall:qt.create(),typeName:Z.ZodObject,...ie(e)});yt.lazycreate=(t,e)=>new yt({shape:t,unknownKeys:"strip",catchall:qt.create(),typeName:Z.ZodObject,...ie(e)});var Pn=class extends ce{_parse(e){let{ctx:r}=this._processInputParams(e),n=this._def.options;function o(a){for(let c of a)if(c.result.status==="valid")return c.result;for(let c of a)if(c.result.status==="dirty")return r.common.issues.push(...c.ctx.common.issues),c.result;let s=a.map(c=>new ht(c.ctx.common.issues));return B(r,{code:N.invalid_union,unionErrors:s}),Y}if(r.common.async)return Promise.all(n.map(async a=>{let s={...r,common:{...r.common,issues:[]},parent:null};return{result:await a._parseAsync({data:r.data,path:r.path,parent:s}),ctx:s}})).then(o);{let a,s=[];for(let p of n){let l={...r,common:{...r.common,issues:[]},parent:null},u=p._parseSync({data:r.data,path:r.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!a&&(a={result:u,ctx:l}),l.common.issues.length&&s.push(l.common.issues)}if(a)return r.common.issues.push(...a.ctx.common.issues),a.result;let c=s.map(p=>new ht(p));return B(r,{code:N.invalid_union,unionErrors:c}),Y}}get options(){return this._def.options}};Pn.create=(t,e)=>new Pn({options:t,typeName:Z.ZodUnion,...ie(e)});var br=t=>t instanceof Dn?br(t.schema):t instanceof Nt?br(t.innerType()):t instanceof Ln?[t.value]:t instanceof Fn?t.options:t instanceof In?me.objectValues(t.enum):t instanceof Cn?br(t._def.innerType):t instanceof kn?[void 0]:t instanceof An?[null]:t instanceof Ct?[void 0,...br(t.unwrap())]:t instanceof lr?[null,...br(t.unwrap())]:t instanceof qo||t instanceof Nn?br(t.unwrap()):t instanceof On?br(t._def.innerType):[],cp=class t extends ce{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==W.object)return B(r,{code:N.invalid_type,expected:W.object,received:r.parsedType}),Y;let n=this.discriminator,o=r.data[n],a=this.optionsMap.get(o);return a?r.common.async?a._parseAsync({data:r.data,path:r.path,parent:r}):a._parseSync({data:r.data,path:r.path,parent:r}):(B(r,{code:N.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Y)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){let o=new Map;for(let a of r){let s=br(a.shape[e]);if(!s.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let c of s){if(o.has(c))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(c)}`);o.set(c,a)}}return new t({typeName:Z.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:o,...ie(n)})}};function Dd(t,e){let r=cr(t),n=cr(e);if(t===e)return{valid:!0,data:t};if(r===W.object&&n===W.object){let o=me.objectKeys(e),a=me.objectKeys(t).filter(c=>o.indexOf(c)!==-1),s={...t,...e};for(let c of a){let p=Dd(t[c],e[c]);if(!p.valid)return{valid:!1};s[c]=p.data}return{valid:!0,data:s}}else if(r===W.array&&n===W.array){if(t.length!==e.length)return{valid:!1};let o=[];for(let a=0;a<t.length;a++){let s=t[a],c=e[a],p=Dd(s,c);if(!p.valid)return{valid:!1};o.push(p.data)}return{valid:!0,data:o}}else return r===W.date&&n===W.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var Mn=class extends ce{_parse(e){let{status:r,ctx:n}=this._processInputParams(e),o=(a,s)=>{if(ap(a)||ap(s))return Y;let c=Dd(a.value,s.value);return c.valid?((sp(a)||sp(s))&&r.dirty(),{status:r.value,value:c.data}):(B(n,{code:N.invalid_intersection_types}),Y)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([a,s])=>o(a,s)):o(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};Mn.create=(t,e,r)=>new Mn({left:t,right:e,typeName:Z.ZodIntersection,...ie(r)});var pr=class t extends ce{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==W.array)return B(n,{code:N.invalid_type,expected:W.array,received:n.parsedType}),Y;if(n.data.length<this._def.items.length)return B(n,{code:N.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Y;!this._def.rest&&n.data.length>this._def.items.length&&(B(n,{code:N.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let a=[...n.data].map((s,c)=>{let p=this._def.items[c]||this._def.rest;return p?p._parse(new Ot(n,s,n.path,c)):null}).filter(s=>!!s);return n.common.async?Promise.all(a).then(s=>Qe.mergeArray(r,s)):Qe.mergeArray(r,a)}get items(){return this._def.items}rest(e){return new t({...this._def,rest:e})}};pr.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new pr({items:t,typeName:Z.ZodTuple,rest:null,...ie(e)})};var pp=class t extends ce{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==W.object)return B(n,{code:N.invalid_type,expected:W.object,received:n.parsedType}),Y;let o=[],a=this._def.keyType,s=this._def.valueType;for(let c in n.data)o.push({key:a._parse(new Ot(n,c,n.path,c)),value:s._parse(new Ot(n,n.data[c],n.path,c)),alwaysSet:c in n.data});return n.common.async?Qe.mergeObjectAsync(r,o):Qe.mergeObjectSync(r,o)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof ce?new t({keyType:e,valueType:r,typeName:Z.ZodRecord,...ie(n)}):new t({keyType:zr.create(),valueType:e,typeName:Z.ZodRecord,...ie(r)})}},qi=class extends ce{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==W.map)return B(n,{code:N.invalid_type,expected:W.map,received:n.parsedType}),Y;let o=this._def.keyType,a=this._def.valueType,s=[...n.data.entries()].map(([c,p],l)=>({key:o._parse(new Ot(n,c,n.path,[l,"key"])),value:a._parse(new Ot(n,p,n.path,[l,"value"]))}));if(n.common.async){let c=new Map;return Promise.resolve().then(async()=>{for(let p of s){let l=await p.key,u=await p.value;if(l.status==="aborted"||u.status==="aborted")return Y;(l.status==="dirty"||u.status==="dirty")&&r.dirty(),c.set(l.value,u.value)}return{status:r.value,value:c}})}else{let c=new Map;for(let p of s){let l=p.key,u=p.value;if(l.status==="aborted"||u.status==="aborted")return Y;(l.status==="dirty"||u.status==="dirty")&&r.dirty(),c.set(l.value,u.value)}return{status:r.value,value:c}}}};qi.create=(t,e,r)=>new qi({valueType:e,keyType:t,typeName:Z.ZodMap,...ie(r)});var zi=class t extends ce{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==W.set)return B(n,{code:N.invalid_type,expected:W.set,received:n.parsedType}),Y;let o=this._def;o.minSize!==null&&n.data.size<o.minSize.value&&(B(n,{code:N.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),r.dirty()),o.maxSize!==null&&n.data.size>o.maxSize.value&&(B(n,{code:N.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),r.dirty());let a=this._def.valueType;function s(p){let l=new Set;for(let u of p){if(u.status==="aborted")return Y;u.status==="dirty"&&r.dirty(),l.add(u.value)}return{status:r.value,value:l}}let c=[...n.data.values()].map((p,l)=>a._parse(new Ot(n,p,n.path,l)));return n.common.async?Promise.all(c).then(p=>s(p)):s(c)}min(e,r){return new t({...this._def,minSize:{value:e,message:q.toString(r)}})}max(e,r){return new t({...this._def,maxSize:{value:e,message:q.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};zi.create=(t,e)=>new zi({valueType:t,minSize:null,maxSize:null,typeName:Z.ZodSet,...ie(e)});var lp=class t extends ce{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==W.function)return B(r,{code:N.invalid_type,expected:W.function,received:r.parsedType}),Y;function n(c,p){return jo({data:c,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Vi(),vr].filter(l=>!!l),issueData:{code:N.invalid_arguments,argumentsError:p}})}function o(c,p){return jo({data:c,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Vi(),vr].filter(l=>!!l),issueData:{code:N.invalid_return_type,returnTypeError:p}})}let a={errorMap:r.common.contextualErrorMap},s=r.data;if(this._def.returns instanceof Kr){let c=this;return tt(async function(...p){let l=new ht([]),u=await c._def.args.parseAsync(p,a).catch(g=>{throw l.addIssue(n(p,g)),l}),m=await Reflect.apply(s,this,u);return await c._def.returns._def.type.parseAsync(m,a).catch(g=>{throw l.addIssue(o(m,g)),l})})}else{let c=this;return tt(function(...p){let l=c._def.args.safeParse(p,a);if(!l.success)throw new ht([n(p,l.error)]);let u=Reflect.apply(s,this,l.data),m=c._def.returns.safeParse(u,a);if(!m.success)throw new ht([o(u,m.error)]);return m.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new t({...this._def,args:pr.create(e).rest(wr.create())})}returns(e){return new t({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new t({args:e||pr.create([]).rest(wr.create()),returns:r||wr.create(),typeName:Z.ZodFunction,...ie(n)})}},Dn=class extends ce{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};Dn.create=(t,e)=>new Dn({getter:t,typeName:Z.ZodLazy,...ie(e)});var Ln=class extends ce{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return B(r,{received:r.data,code:N.invalid_literal,expected:this._def.value}),Y}return{status:"valid",value:e.data}}get value(){return this._def.value}};Ln.create=(t,e)=>new Ln({value:t,typeName:Z.ZodLiteral,...ie(e)});function Lx(t,e){return new Fn({values:t,typeName:Z.ZodEnum,...ie(e)})}var Fn=class t extends ce{_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),n=this._def.values;return B(r,{expected:me.joinValues(n),received:r.parsedType,code:N.invalid_type}),Y}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let r=this._getOrReturnCtx(e),n=this._def.values;return B(r,{received:r.data,code:N.invalid_enum_value,options:n}),Y}return tt(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return t.create(e,{...this._def,...r})}exclude(e,r=this._def){return t.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}};Fn.create=Lx;var In=class extends ce{_parse(e){let r=me.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==W.string&&n.parsedType!==W.number){let o=me.objectValues(r);return B(n,{expected:me.joinValues(o),received:n.parsedType,code:N.invalid_type}),Y}if(this._cache||(this._cache=new Set(me.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let o=me.objectValues(r);return B(n,{received:n.data,code:N.invalid_enum_value,options:o}),Y}return tt(e.data)}get enum(){return this._def.values}};In.create=(t,e)=>new In({values:t,typeName:Z.ZodNativeEnum,...ie(e)});var Kr=class extends ce{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==W.promise&&r.common.async===!1)return B(r,{code:N.invalid_type,expected:W.promise,received:r.parsedType}),Y;let n=r.parsedType===W.promise?r.data:Promise.resolve(r.data);return tt(n.then(o=>this._def.type.parseAsync(o,{path:r.path,errorMap:r.common.contextualErrorMap})))}};Kr.create=(t,e)=>new Kr({type:t,typeName:Z.ZodPromise,...ie(e)});var Nt=class extends ce{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Z.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:n}=this._processInputParams(e),o=this._def.effect||null,a={addIssue:s=>{B(n,s),s.fatal?r.abort():r.dirty()},get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),o.type==="preprocess"){let s=o.transform(n.data,a);if(n.common.async)return Promise.resolve(s).then(async c=>{if(r.value==="aborted")return Y;let p=await this._def.schema._parseAsync({data:c,path:n.path,parent:n});return p.status==="aborted"?Y:p.status==="dirty"?vn(p.value):r.value==="dirty"?vn(p.value):p});{if(r.value==="aborted")return Y;let c=this._def.schema._parseSync({data:s,path:n.path,parent:n});return c.status==="aborted"?Y:c.status==="dirty"?vn(c.value):r.value==="dirty"?vn(c.value):c}}if(o.type==="refinement"){let s=c=>{let p=o.refinement(c,a);if(n.common.async)return Promise.resolve(p);if(p instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(n.common.async===!1){let c=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return c.status==="aborted"?Y:(c.status==="dirty"&&r.dirty(),s(c.value),{status:r.value,value:c.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(c=>c.status==="aborted"?Y:(c.status==="dirty"&&r.dirty(),s(c.value).then(()=>({status:r.value,value:c.value}))))}if(o.type==="transform")if(n.common.async===!1){let s=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!qr(s))return Y;let c=o.transform(s.value,a);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:c}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(s=>qr(s)?Promise.resolve(o.transform(s.value,a)).then(c=>({status:r.value,value:c})):Y);me.assertNever(o)}};Nt.create=(t,e,r)=>new Nt({schema:t,typeName:Z.ZodEffects,effect:e,...ie(r)});Nt.createWithPreprocess=(t,e,r)=>new Nt({schema:e,effect:{type:"preprocess",transform:t},typeName:Z.ZodEffects,...ie(r)});var Ct=class extends ce{_parse(e){return this._getType(e)===W.undefined?tt(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Ct.create=(t,e)=>new Ct({innerType:t,typeName:Z.ZodOptional,...ie(e)});var lr=class extends ce{_parse(e){return this._getType(e)===W.null?tt(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};lr.create=(t,e)=>new lr({innerType:t,typeName:Z.ZodNullable,...ie(e)});var Cn=class extends ce{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return r.parsedType===W.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};Cn.create=(t,e)=>new Cn({innerType:t,typeName:Z.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ie(e)});var On=class extends ce{_parse(e){let{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},o=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Bi(o)?o.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new ht(n.common.issues)},input:n.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new ht(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};On.create=(t,e)=>new On({innerType:t,typeName:Z.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ie(e)});var Gi=class extends ce{_parse(e){if(this._getType(e)!==W.nan){let n=this._getOrReturnCtx(e);return B(n,{code:N.invalid_type,expected:W.nan,received:n.parsedType}),Y}return{status:"valid",value:e.data}}};Gi.create=t=>new Gi({typeName:Z.ZodNaN,...ie(t)});var uF=Symbol("zod_brand"),qo=class extends ce{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}},zo=class t extends ce{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let a=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?Y:a.status==="dirty"?(r.dirty(),vn(a.value)):this._def.out._parseAsync({data:a.value,path:n.path,parent:n})})();{let o=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?Y:o.status==="dirty"?(r.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:n.path,parent:n})}}static create(e,r){return new t({in:e,out:r,typeName:Z.ZodPipeline})}},Nn=class extends ce{_parse(e){let r=this._def.innerType._parse(e),n=o=>(qr(o)&&(o.value=Object.freeze(o.value)),o);return Bi(r)?r.then(o=>n(o)):n(r)}unwrap(){return this._def.innerType}};Nn.create=(t,e)=>new Nn({innerType:t,typeName:Z.ZodReadonly,...ie(e)});function Ax(t,e){let r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}function Fx(t,e={},r){return t?Gr.create().superRefine((n,o)=>{let a=t(n);if(a instanceof Promise)return a.then(s=>{if(!s){let c=Ax(e,n),p=c.fatal??r??!0;o.addIssue({code:"custom",...c,fatal:p})}});if(!a){let s=Ax(e,n),c=s.fatal??r??!0;o.addIssue({code:"custom",...s,fatal:c})}}):Gr.create()}var mF={object:yt.lazycreate},Z;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Z||(Z={}));var dF=(t,e={message:`Input not instance of ${t.name}`})=>Fx(r=>r instanceof t,e),Ix=zr.create,Cx=bn.create,fF=Gi.create,gF=wn.create,Ox=En.create,hF=Rn.create,yF=$i.create,_F=kn.create,TF=An.create,xF=Gr.create,SF=wr.create,vF=qt.create,bF=ji.create,wF=Er.create,EF=yt.create,RF=yt.strictCreate,kF=Pn.create,AF=cp.create,PF=Mn.create,MF=pr.create,DF=pp.create,LF=qi.create,FF=zi.create,IF=lp.create,CF=Dn.create,OF=Ln.create,NF=Fn.create,HF=In.create,UF=Kr.create,VF=Nt.create,BF=Ct.create,WF=lr.create,$F=Nt.createWithPreprocess,jF=zo.create,qF=()=>Ix().optional(),zF=()=>Cx().optional(),GF=()=>Ox().optional(),KF={string:t=>zr.create({...t,coerce:!0}),number:t=>bn.create({...t,coerce:!0}),boolean:t=>En.create({...t,coerce:!0}),bigint:t=>wn.create({...t,coerce:!0}),date:t=>Rn.create({...t,coerce:!0})};var QF=Y;function Ld(t,e){return new D(t.row,t.column,e.row,e.column)}function Nx(t){let e=t.operands.map(Fd).join(" ");return`(#${t.operator} ${e})`}function Fd(t){return t.type==="capture"?`@${t.name}`:t.value}function Hx(t,e){return e.errors.filter(r=>!(r.code==="invalid_type"&&r.path.length===2&&(r.path[1]==="name"||r.path[1]==="value"))).map(r=>JF(t,r))}function JF(t,e){if(e.path.length===0)return e.code==="too_small"?"Too few arguments":e.code==="too_big"?"Too many arguments":e.message;let r=e.message;e.code==="invalid_literal"&&e.path[1]==="type"&&(r=e.expected==="capture"?"Capture names must be prefixed with @":"Expected string, but received capture");let n=e.path[0],o=Fd(t[n]);return`Error on argument ${n} (\`${o}\`): ${r}`}var Le=class{allowMissingNode(){return!1}createPredicate(e){let r=this.schema.safeParse(e);return r.success?{success:!0,predicate:n=>{try{let o=this.constructAcceptArgs(r.data,n);return this.run(...o)}catch(o){if(o instanceof up&&this.allowMissingNode())return!0;throw o}}}:{success:!1,errors:Hx(e,r.error)}}constructAcceptArgs(e,r){return e.map(n=>{if(n.type==="capture"){let o=r.captures.find(a=>a.name===n.name);if(o==null)throw new up(n.name);return o}else return n.value})}},up=class extends Error{constructor(e){super(`Could not find capture ${e}`)}};function Id(t,e){if(t.parent==null)throw Error("Node has no parent");let r=t.parent.walk(),n=r.gotoFirstChild(),o=!0;for(;n;){if(r.currentFieldName===e){if(r.currentNode.id===t.id)return o;o=!o}n=r.gotoNextSibling()}throw Error(`Node not found in parent for field: ${e}`)}var Cd=se.object({type:se.literal("string"),value:se.string()}),j={node:se.object({type:se.literal("capture"),name:se.string()}),string:Cd,integer:Cd.transform((t,e)=>{let r=parseInt(t.value);return isNaN(r)?(e.addIssue({code:se.ZodIssueCode.custom,message:"Expected an integer"}),se.NEVER):{type:"integer",value:r}}),boolean:Cd.transform((t,e)=>t.value==="true"?{type:"boolean",value:!0}:t.value==="false"?{type:"boolean",value:!1}:(e.addIssue({code:se.ZodIssueCode.custom,message:"Expected true or false"}),se.NEVER))};var Od=class extends Le{constructor(){super(...arguments);this.name="even?";this.schema=se.tuple([j.node,j.string])}run({node:r},n){return Id(r,n)}},Nd=class extends Le{constructor(){super(...arguments);this.name="odd?";this.schema=se.tuple([j.node,j.string])}run({node:r},n){return!Id(r,n)}},Hd=class extends Le{constructor(){super(...arguments);this.name="text?";this.schema=se.tuple([j.node,j.string]).rest(j.string)}run({document:r,range:n},...o){return o.includes(r.getText(n))}},Ud=class extends Le{constructor(){super(...arguments);this.name="type?";this.schema=se.tuple([j.node,j.string]).rest(j.string)}run({node:r},...n){return n.includes(r.type)}},Vd=class extends Le{constructor(){super(...arguments);this.name="not-type?";this.schema=se.tuple([j.node,j.string]).rest(j.string)}run({node:r},...n){return!n.includes(r.type)}},Bd=class extends Le{constructor(){super(...arguments);this.name="not-parent-type?";this.schema=se.tuple([j.node,j.string]).rest(j.string)}run({node:r},...n){return r.parent==null||!n.includes(r.parent.type)}},Wd=class extends Le{constructor(){super(...arguments);this.name="is-nth-child?";this.schema=se.tuple([j.node,j.integer])}run({node:r},n){return r.parent?.children.findIndex(o=>o.id===r.id)===n}},$d=class extends Le{constructor(){super(...arguments);this.name="has-multiple-children-of-type?";this.schema=se.tuple([j.node,j.string])}run({node:r},n){return r.children.filter(a=>a.type===n).length>1}},jd=class extends Le{constructor(){super(...arguments);this.name="child-range!";this.schema=se.union([se.tuple([j.node,j.integer]),se.tuple([j.node,j.integer,j.integer]),se.tuple([j.node,j.integer,j.integer,j.boolean]),se.tuple([j.node,j.integer,j.integer,j.boolean,j.boolean])])}run(r,n,o,a,s){let{node:{children:c}}=r;n=n<0?c.length+n:n,o=o??-1,o=o<0?c.length+o:o;let p=c[n],l=c[o];return r.range=Ld(a?p.endPosition:p.startPosition,s?l.startPosition:l.endPosition),!0}},qd=class extends Le{constructor(){super(...arguments);this.name="character-range!";this.schema=se.union([se.tuple([j.node,j.integer]),se.tuple([j.node,j.integer,j.integer])])}run(r,n,o){return r.range=new D(r.range.start.translate(void 0,n),r.range.end.translate(void 0,o??0)),!0}},zd=class extends Le{constructor(){super(...arguments);this.name="shrink-to-match!";this.schema=se.tuple([j.node,j.string])}run(r,n){let{document:o,range:a}=r,c=o.getText(a).match(new RegExp(n,"ds"));if(c?.index==null)throw Error(`No match for pattern '${n}'`);let[p,l]=c.indices?.groups?.keep??c.indices[0],u=o.offsetAt(a.start);return r.range=new D(o.positionAt(u+p),o.positionAt(u+l)),!0}},Gd=class extends Le{constructor(){super(...arguments);this.name="grow-to-named-siblings!";this.schema=se.union([se.tuple([j.node]),se.tuple([j.node,j.string])])}run(r,n){let{node:o,range:a,document:s}=r;if(o.parent==null)throw Error("Node has no parent");let{children:c}=o.parent,p=c.findIndex(u=>u.id===o.id),l=null;if(p===-1)throw Error("Node not found in parent");for(let u=p+1;u<c.length;++u){let m=c[u];if(!m.isNamed)break;let d=Ld(m.startPosition,m.endPosition);if(n!=null&&n===s.getText(d))break;l=d.end}return l!=null&&(r.range=new D(a.start,l)),!0}},Kd=class extends Le{constructor(){super(...arguments);this.name="trim-end!";this.schema=se.tuple([j.node])}run(r){let{document:n,range:o}=r,a=n.getText(o),s=a.length-a.trimEnd().length;return s>0&&(r.range=new D(o.start,ey(n,o.end,-s))),!0}},Qd=class extends Le{constructor(){super(...arguments);this.name="document-range!";this.schema=se.tuple([j.node]).rest(j.node)}run(...r){for(let n of r)n.range=n.document.range;return!0}},Jd=class extends Le{constructor(){super(...arguments);this.name="allow-multiple!";this.schema=se.tuple([j.node]).rest(j.node)}allowMissingNode(){return!0}run(...r){for(let n of r)n.allowMultiple=!0;return!0}},Yd=class extends Le{constructor(){super(...arguments);this.name="log!";this.schema=se.tuple([j.node])}run(r){return console.log(`#log!: ${r.name}@${r.range}`),!0}},Zd=class extends Le{constructor(){super(...arguments);this.name="insertion-delimiter!";this.schema=se.tuple([j.node,j.string])}run(r,n){return r.insertionDelimiter=n,!0}},Xd=class extends Le{constructor(){super(...arguments);this.name="single-or-multi-line-delimiter!";this.schema=se.tuple([j.node,j.node,j.string,j.string])}run(r,n,o,a){return r.insertionDelimiter=n.range.isSingleLine?o:a,!0}},ef=class extends Le{constructor(){super(...arguments);this.name="empty-single-multi-delimiter!";this.schema=se.tuple([j.node,j.node,j.string,j.string,j.string])}run(r,n,o,a,s){let c=!n.node.children.some(p=>p.isNamed);return r.insertionDelimiter=c?o:n.range.isSingleLine?a:s,!0}},Ux=[new Yd,new Od,new Nd,new Hd,new Ud,new Vd,new Kd,new Qd,new Bd,new Wd,new jd,new qd,new zd,new Gd,new Jd,new Zd,new Xd,new ef,new $d];function Vx(t){let e=[],r=[];return t.forEach((n,o)=>{let a=[];n.forEach((s,c)=>{let p=Ux.find(({name:u})=>u===s.operator);if(p==null){e.push({patternIdx:o,predicateIdx:c,error:`Unknown predicate operator "${s.operator}"`});return}let l=p.createPredicate(s.operands);if(!l.success){e.push(...l.errors.map(u=>({patternIdx:o,predicateIdx:c,error:u})));return}a.push(l.predicate)}),r.push(a)}),{errors:e,predicates:r}}function Bx(t,e){let{errors:r,predicates:n}=Vx(e.predicates);if(r.length>0){for(let o of r){let a=[`language ${t}`,`pattern ${o.patternIdx}`,`predicate \`${Nx(e.predicates[o.patternIdx][o.predicateIdx])}\``].join(", ");De(h().messages,"TreeSitterQuery.parsePredicates",`Error parsing predicate for ${a}: ${o.error}`)}if(h().runMode==="test")throw new Error("Invalid predicates")}return n}function tf(t){return{row:t.line,column:t.character}}function Wx(t){return t.map(e=>({...e,range:rf(e),name:YF(e)}))}function rf(t){return t.name.endsWith(".startOf")?t.range.start.toEmptyRange():t.name.endsWith(".endOf")?t.range.end.toEmptyRange():t.range}function YF(t){return t.name.endsWith(".startOf")?t.name.slice(0,-8):t.name.endsWith(".endOf")?t.name.slice(0,-6):t.name}var nf=class{constructor(){this.documentVersion=-1;this.documentUri="";this.documentLanguageId="";this.matches=[]}clear(){this.documentUri="",this.documentVersion=-1,this.documentLanguageId="",this.startPosition=void 0,this.endPosition=void 0,this.matches=[]}isValid(e,r,n){return this.documentVersion===e.version&&this.documentUri===e.uri.toString()&&this.documentLanguageId===e.languageId&&$x(this.startPosition,r)&&$x(this.endPosition,n)}update(e,r,n,o){this.documentVersion=e.version,this.documentUri=e.uri.toString(),this.documentLanguageId=e.languageId,this.startPosition=r,this.endPosition=n,this.matches=o}get(){return this.matches}};function $x(t,e){return t==null||e==null?t===e:t.isEqual(e)}var Hn=new nf;var Go=class t{constructor(e,r,n){this.treeSitter=e;this.query=r;this.patternPredicates=n;this.shouldCheckCaptures=h().runMode!=="production"}static create(e,r,n){let o=Bx(e,n);return new t(r,n,o)}hasCapture(e){return this.query.captureNames.some(r=>Ad(r)===e)}matches(e,r,n){if(!Hn.isValid(e,r,n)){let o=this.getAllMatches(e,r,n);Hn.update(e,r,n,o)}return Hn.get()}getAllMatches(e,r,n){let o=this.getTreeMatches(e,r,n),a=[];for(let s of o){let c=this.createMutableQueryMatch(e,s);this.runPredicates(c)&&a.push(this.createQueryMatch(c))}return a}getTreeMatches(e,r,n){let{rootNode:o}=this.treeSitter.getTree(e);return this.query.matches(o,{startPosition:r!=null?tf(r):void 0,endPosition:n!=null?tf(n):void 0})}createMutableQueryMatch(e,r){return{patternIdx:r.patternIndex,captures:r.captures.map(({name:n,node:o})=>({name:n,node:o,document:e,range:bx(o),insertionDelimiter:void 0,allowMultiple:!1,hasError:()=>Ex(o)}))}}runPredicates(e){for(let r of this.patternPredicates[e.patternIdx])if(!r(e))return!1;return!0}createQueryMatch(e){let r=[],n=new Map;for(let o of e.captures){let a=Ad(o.name),s=rf(o),c=n.get(a);if(c==null){let p=[o],l={...o,name:a,range:s,hasError:()=>p.some(u=>u.hasError())};r.push(l),n.set(a,{acc:l,captures:p})}else c.acc.range=c.acc.range.union(s),c.acc.allowMultiple=c.acc.allowMultiple||o.allowMultiple,c.acc.insertionDelimiter=c.acc.insertionDelimiter??o.insertionDelimiter,c.captures.push(o)}return this.shouldCheckCaptures&&this.checkCaptures(Array.from(n.values())),{captures:r}}checkCaptures(e){for(let r of e)if(!wx(Wx(r.captures),h().messages)&&h().runMode==="test")throw new Error("Invalid captures")}};var qx="_",ZF=[qx,"interior",...fn],XF=["prefix","leading","trailing"],eI=["startOf","endOf","start.startOf","start.endOf","end.startOf","end.endOf"],tI=["domain","removal","iteration","iteration.domain"],jx=["start","end","start.startOf","start.endOf","end.startOf","end.endOf"],Un=new Set;for(let t of ZF){if(t!==qx){Un.add(t);for(let e of jx)Un.add(`${t}.${e}`)}for(let e of XF){Un.add(`${t}.${e}`);for(let r of eI)Un.add(`${t}.${e}.${r}`)}for(let e of tI){Un.add(`${t}.${e}`);for(let r of jx)Un.add(`${t}.${e}.${r}`)}}var rI=/^(?!;;).*(?<!"\w*)@([\w.]*)/gm;function zx(t,e){let r=e.matchAll(rI),n=[];for(let a of r){let s=a[1];if(!(s.length>1&&!s.includes(".")&&s.startsWith("_"))&&!Un.has(s)){let c=a.input.slice(0,a.index).split(`
`).length;n.push(`${t}(${c}) invalid capture '@${s}'.`)}}if(n.length===0)return;let o=n.join(`
`);if(De(h().messages,"validateQueryCaptures.invalidCaptureName",o),h().runMode==="test")throw new Error(o)}var mp=class t{constructor(e){this.query=e}static async create(e,r,n,o){let a=await nI(e,r,`${o}.scm`);if(a==null||!await n.loadLanguage(o))return;let s=n.createQuery(o,a);if(s==null)throw Error(`Could not create Tree sitter query for language ${o}`);let c=Go.create(o,n,s);return new t(c)}getScopeHandler(e){if(this.query.hasCapture(e.type))return new Uc(this.query,e)}getCapturesMap(e){let r=this.query.matches(e),n={};for(let o of r)for(let a of o.captures){let s=a.name;n[s]==null&&(n[s]=[]),n[s].push(a)}return n}};async function nI(t,e,r){let n={[r]:null},o=t.runMode!=="production";for(;Object.values(n).some(a=>a==null);)for(let[a,s]of Object.entries(n)){if(s!=null)continue;let c=await e.readQuery(a);if(c==null){if(a===r)return;if(De(t.messages,"LanguageDefinition.readQueryFileAndImports.queryNotFound",`Could not find imported query file ${a}`),t.runMode==="test")throw new Error("Invalid import statement");c=""}o&&zx(a,c),n[a]=c,kt(c,/^[^\S\r\n]*;;?[^\S\r\n]*(?:import|include)[^\S\r\n]+['"]?([\w|/\\.]+)['"]?[^\S\r\n]*$/gm,p=>{let l=p[1];o&&iI(t,a,l,p[0]),n[l]=n[l]??null})}return Object.values(n).join(`
`)}function iI(t,e,r,n){let o=!1;/[/\\]/g.test(r)&&(De(t.messages,"LanguageDefinition.readQueryFileAndImports.invalidImport",`Invalid import statement in ${e}: "${n}". Relative import paths not supported`),o=!0);let a=`;; import ${r}`;if(n!==a&&(De(t.messages,"LanguageDefinition.readQueryFileAndImports.malformedImport",`Malformed import statement in ${e}: "${n}". Import statements must be of the form "${a}"`),o=!0),o&&t.runMode==="test")throw new Error("Invalid import statement")}var Gx=Symbol("LANGUAGE_UNDEFINED"),dp=class t{constructor(e,r,n){this.ide=e;this.treeSitter=r;this.treeSitterQueryProvider=n;this.notifier=new Pe;this.languageDefinitions=new Map;this.disposables=[];this.onDidChangeDefinition=this.notifier.registerListener;let o=e.runMode==="test";e.onDidOpenTextDocument(a=>{o&&Hn.clear(),this.loadLanguage(a.languageId)}),e.onDidChangeVisibleTextEditors(a=>{a.forEach(({document:s})=>this.loadLanguage(s.languageId))}),this.disposables.push(n.onChanges(()=>this.reloadLanguageDefinitions()))}static async create(e,r,n){let o=new t(e,r,n);return await o.loadAllLanguages(),o}async loadAllLanguages(){let e=this.ide.visibleTextEditors.map(({document:r})=>r.languageId);try{await Promise.all(e.map(r=>this.loadLanguage(r)))}catch(r){if(De(this.ide.messages,"Failed to load language definitions",Wt(r)),this.ide.runMode==="test")throw r}}async loadLanguage(e){if(this.languageDefinitions.has(e))return;let r=await mp.create(this.ide,this.treeSitterQueryProvider,this.treeSitter,e)??Gx;this.languageDefinitions.set(e,r)}async reloadLanguageDefinitions(){this.languageDefinitions.clear(),await this.loadAllLanguages(),Hn.clear(),this.notifier.notifyListeners()}get(e){let r=this.languageDefinitions.get(e);if(r==null)throw new Error("Expected language definition entry is missing for languageId "+e);return r===Gx?void 0:r}getNodeAtLocation(e,r){return this.treeSitter.getNodeAtLocation(e,r)}dispose(){this.disposables.forEach(e=>e.dispose())}};var fp=class{constructor(e,r){this.modifierStageFactory=e;this.modifier=r}get nestedStages(){return this.nestedStages_==null&&(this.nestedStages_=this.modifier.modifiers.map(this.modifierStageFactory.create)),this.nestedStages_}run(e,r){for(let n of this.nestedStages)try{return n.run(e,r)}catch{continue}throw new Error("No modifier could be applied")}};var Ki=class{constructor(e,r){this.modifierStageFactory=e;this.nestedModifier=r;this.suppressErrors=!1}run(e,r){if(this.shouldModify(e))try{return this.nestedStage.run(e,r).map(n=>n.withThatTarget(e))}catch(n){if(!this.suppressErrors)throw n}return[e]}get nestedStage(){return this.nestedStage_==null&&(this.nestedStage_=this.modifierStageFactory.create(this.nestedModifier)),this.nestedStage_}},Qr=class extends Ki{constructor(e,r){super(e,r.modifier)}shouldModify(e){return!e.hasExplicitScopeType}},gp=class extends Ki{constructor(r,n,o){super(r,n);this.modificationCondition=o}shouldModify(r){return this.modificationCondition(r)}},Qi=class extends Ki{shouldModify(e){return!e.hasExplicitScopeType&&!e.isImplicit}},Ji=class extends Ki{constructor(r){super(r,{type:"containingScope",scopeType:{type:"token"}});this.suppressErrors=!0}shouldModify(r){return!r.hasExplicitScopeType&&!r.hasExplicitRange&&r.contentRange.isEmpty}};function Kx(t,e){return Object.getPrototypeOf(t).constructor===Object.getPrototypeOf(e).constructor}function Yi(t,e,r,n,o){if(e.editor!==r.editor)throw Error("Continuous targets must be in the same editor");if(n&&o&&Kx(e,r)){let a=e.maybeCreateRichRangeTarget(t,r);if(a!=null)return a}return e.textualType==="line"&&r.textualType==="line"?new dt({editor:e.editor,isReversed:t,contentRange:Ei(e,r,n,o)}):new Ge({editor:e.editor,isReversed:t,hasExplicitRange:!0,contentRange:wi(e,r,n,o),textualType:n&&o&&e.textualType==="token"&&r.textualType==="token"?"token":"character"})}function hp(t,e,r){if(e===r)return e.getTargets(t);let n=e.getTargets(t),o=r.getTargets(t);if(n.length!==1||o.length!==1)throw Error("Scope range targets must be single-target");let[a]=n,[s]=o,c=s.contentRange.start.isAfterOrEqual(a.contentRange.start),[p,l]=c?[a,s]:[s,a];return[Yi(t,p,l,!0,!0)]}function yp(t,e,r,n){let o=Array.from(t.generateScopes(e,r,"forward",{containment:"required",allowAdjacentScopes:!0,skipAncestorScopes:!0}));switch(o.length){case 0:return;case 1:return o[0];case 2:{let[a,s]=o;return n==="forward"?s:n==="backward"||(t.isPreferredOver?.(a,s)??!1)?a:s}default:throw new Error("Expected no more than 2 scope candidates")}}function _p(t,e,r=0){let{isReversed:n,editor:o,contentRange:{start:a,end:s}}=t;if(s.isEqual(a)){let l=yp(e,o,a);return l==null||(r>0&&(l=of(e,o,l.domain.end,"forward",r,!0)),l==null)?void 0:l.getTargets(n)}let c=of(e,o,a,"forward",r);if(c==null)return;if(c.domain.contains(s))return c.getTargets(n);let p=of(e,o,s,"backward",r);if(p!=null)return hp(n,c,p)}function of(t,e,r,n,o,a=!1){let s=0;for(let c of t.generateScopes(e,r,n,{containment:"required",allowAdjacentScopes:a})){if(s===o)return c;s+=1}}var Zi=class{constructor(e,r,n){this.modifierStageFactory=e;this.scopeHandlerFactory=r;this.modifier=n}run(e){let{scopeType:r,ancestorIndex:n=0}=this.modifier,o=this.scopeHandlerFactory.maybeCreate(r,e.editor.document.languageId);if(o==null)throw new Ie(r.type);let a=_p(e,o,n);if(a==null)throw new Ie(r.type);return a}};var Tp=class{constructor(e,r,n){this.modifierStageFactory=e;this.scopeHandlerFactory=r;this.modifier=n}run(e,r){let{scopeType:n}=this.modifier,{editor:o,isReversed:a}=e,s=this.scopeHandlerFactory.maybeCreate(n,o.document.languageId);if(s==null)throw new Ie(n.type);let c;if(e.hasExplicitRange&&(c=Qx(s,o,e.contentRange),c.length===1&&c[0].domain.contains(e.contentRange)&&!e.hasExplicitScopeType&&!r.multipleTargets&&(c=void 0)),c==null&&(c=this.getDefaultIterationRange(s,this.scopeHandlerFactory,e).flatMap(p=>Qx(s,o,p))),c.length===0)throw new Ie(n.type);return c.flatMap(p=>p.getTargets(a))}getDefaultIterationRange(e,r,n){let o=r.maybeCreate(e.iterationScopeType,n.editor.document.languageId);if(o==null)throw Error("Could not find iteration scope handler");let a=_p(n,o);if(a==null)throw new Ie(`iteration scope for ${e.scopeType.type}`);return a.map(s=>s.contentRange)}};function Qx(t,e,{start:r,end:n}){return Array.from(t.generateScopes(e,r,"forward",{distalPosition:n,skipAncestorScopes:!0,allowAdjacentScopes:t.includeAdjacentInEvery}))}var xp=class{constructor(e){this.modifier=e}run(e){return e.contentText.trim()!==""?[e]:[]}},Sp=class{constructor(e){this.modifier=e}run(e){return e.contentText.trim()===""?[e]:[]}};var vp=class{run(){return cc(h()).map(e=>new oc({editor:e.editor,isReversed:e.selection.isReversed,contentRange:e.selection}))}};var bp=class{constructor(e,r){this.modifierStageFactory=e;this.markStageFactory=r}run(e,{actionFinalStages:r=[],noAutomaticTokenExpansion:n=!1}={}){return new af(this.modifierStageFactory,this.markStageFactory,e,{actionFinalStages:r,noAutomaticTokenExpansion:n}).run()}},af=class{constructor(e,r,n,o){this.modifierStageFactory=e;this.markStageFactory=r;this.target=n;this.opts=o}run(){return aI(this.processTarget(this.target))}processTarget(e){switch(e.type){case"list":return e.elements.flatMap(r=>this.processTarget(r));case"range":return this.processRangeTarget(e);case"primitive":case"implicit":return this.processPrimitiveTarget(e)}}processRangeTarget(e){let r=this.processPrimitiveTarget(e.anchor),n=this.processPrimitiveTarget(e.active);return Be(r,n).flatMap(([o,a])=>{if(o==null||a==null)throw new Error("AnchorTargets and activeTargets lengths don't match");switch(e.rangeType){case"continuous":return this.processContinuousRangeTarget(o,a,e);case"vertical":return sI(o,a,e.excludeAnchor,e.excludeActive)}})}processContinuousRangeTarget(e,r,{excludeAnchor:n,excludeActive:o,exclusionScopeType:a}){if(a==null)return[Jr(e,r,n,o)];let s=pf(e,r);return[Jr(n?Jx(this.modifierStageFactory,e,a,s?"backward":"forward"):e,o?Jx(this.modifierStageFactory,r,a,s?"forward":"backward"):r,!1,!1)]}processPrimitiveTarget(e){let r,n,o=!1;e.type==="implicit"?(r=new vp,n=[]):(r=this.markStageFactory.create(e.mark),n=sf(this.modifierStageFactory,e.modifiers),o=oI(e));let a=r.run(),[s,c]=this.getPreAndPostStages(o),p=[...s,...n,...this.opts.actionFinalStages,...c];return cf(p,a)}getPreAndPostStages(e){if(this.opts.noAutomaticTokenExpansion)return[[],[]];let r=new Ji(this.modifierStageFactory);return e?[[r],[]]:[[],[r]]}};function oI(t){return t.modifiers.length>0&&t.modifiers.every(({type:e})=>e==="startOf"||e==="endOf")}function sf(t,e){return e.map(t.create).reverse()}function cf(t,e){return t.forEach(r=>{let n={multipleTargets:e.length>1};e=e.flatMap(o=>r.run(o,n))}),e}function Jx(t,e,r,n){let o={multipleTargets:!1};return t.create({type:"relativeScope",scopeType:r,direction:n,length:1,offset:1}).run(e,o)[0]}function pf(t,e){return t.contentRange.start.isAfter(e.contentRange.start)?!0:t.contentRange.start.isBefore(e.contentRange.start)?!1:t.contentRange.end.isAfter(e.contentRange.end)}function aI(t){return o_(t,(e,r)=>e.isEqual(r),e=>e.contentRange.concise())}function Yx(t,e){if(t.editor!==e.editor)throw new Error("Cannot form range between targets in different editors")}function Jr(t,e,r=!1,n=!1){Yx(t,e);let o=pf(t,e);return Yi(o,o?e:t,o?t:e,!(o?n:r),!(o?r:n))}function sI(t,e,r,n){Yx(t,e);let o=pf(t,e),a=o?-1:1,c=(o?t.contentRange.start:t.contentRange.end).line+(r?a:0),l=(o?e.contentRange.start:e.contentRange.end).line-(n?a:0),u=[];for(let m=c;;m+=a){let d=new D(m,t.contentRange.start.character,m,t.contentRange.end.character);if(u.push(new ye({editor:t.editor,isReversed:t.isReversed,contentRange:d,insertionDelimiter:t.insertionDelimiter})),m===l)return u}}var wp=class{constructor(e,r){this.modifierStageFactory=e;this.modifier=r}run(e){let r=this.getModifierStages(),n=cf(r,[e]),o=this.modifier.type==="extendThroughStartOf";return n.map(a=>new ac({editor:e.editor,isReversed:o,inputTarget:e,modifiedTarget:a,isHead:o}))}getModifierStages(){return this.modifier.modifiers!=null?sf(this.modifierStageFactory,this.modifier.modifiers):[new lf(this.modifierStageFactory,this.modifier)]}},lf=class{constructor(e,r){this.modifierStageFactory=e;this.modifier=r}run(e,r){let n=this.getContainingLine(e,r),o=this.getContainingPairInterior(e,r),a=o!=null?n.contentRange.intersection(o.contentRange):null;return a==null||a.isEmpty?[n]:[new ye({editor:e.editor,isReversed:e.isReversed,contentRange:a})]}getContainingPairInterior(e,r){try{return this.getContaining(e,r,{type:"surroundingPairInterior",delimiter:"any"})[0]}catch(n){if(n instanceof Ie)return;throw n}}getContainingLine(e,r){return this.getContaining(e,r,{type:"line"})[0]}getContaining(e,r,n){return this.modifierStageFactory.create({type:"containingScope",scopeType:n}).run(e,r)}};var ur=class extends Error{constructor(e,r){let n=r!=null?` #${r+1}`:"";super(`Scope '${e.type}'${n} is out of range`),this.name="OutOfRangeError"}};function Zx(t,e,r,n){return uf(t,e,r,n),e.slice(r,n+1)}function uf(t,e,r,n){if(r<0||r>=e.length)throw new ur(t,r);if(n<0||n>=e.length)throw new ur(t,n)}var Xi=class{constructor(e,r,n){this.modifierStageFactory=e;this.storedTargets=r;this.modifier=n}run(e,r){let n=new Ji(this.modifierStageFactory).run(e,r)[0];switch(this.modifier.type){case"everyScope":return this.handleEveryScope(n,r);case"ordinalScope":return this.handleOrdinalScope(n,r,this.modifier);case"relativeScope":return this.handleRelativeScope(n,r,this.modifier);default:throw Error(`${this.modifier.type} instance scope not supported`)}}handleEveryScope(e,r){return Array.from(Pc(this.getEveryRanges(e),([n,o])=>this.getTargetIterable(e,r,n,o,"forward")))}handleOrdinalScope(e,r,{start:n,length:o,scopeType:a}){return this.getEveryRanges(e).flatMap(([s,c])=>Xx(a,this.getTargetIterable(e,r,s,c,n>=0?"forward":"backward"),n>=0?n:-(o+n),o))}handleRelativeScope(e,r,{direction:n,offset:o,length:a,scopeType:s}){return(this.storedTargets.get("instanceReference")??[e]).flatMap(p=>{let{editor:l}=p,u=n==="forward"?new D(o===0?p.contentRange.start:p.contentRange.end,l.document.range.end):new D(l.document.range.start,o===0?p.contentRange.end:p.contentRange.start);return Xx(s,this.getTargetIterable(e,r,l,u,n),o===0?0:o-1,a)})}getEveryRanges({editor:e}){return this.storedTargets.get("instanceReference")?.map(({editor:r,contentRange:n})=>[r,n])??[[e,e.document.range]]}getTargetIterable(e,r,n,o,a){let s=Ke(It(new RegExp(St(e.contentText),"g"),n,o,a),p=>new ye({contentRange:p,editor:n,isReversed:!1,textualType:"character"})),c=cI(e);if(c!=null){let p=this.modifierStageFactory.create({type:"containingScope",scopeType:c});return kc(Ke(s,l=>{try{let u=p.run(l,r);return u.length===1&&u[0].contentRange.isRangeEqual(l.contentRange)?u[0]:null}catch{return null}}),l=>l!=null)}return s}};function cI(t){switch(t.textualType){case"line":case"token":case"word":return{type:t.textualType};default:return null}}function Xx(t,e,r,n){Array.from(Wo(r,e));let o=Array.from(Wo(n,e));if(o.length<n)throw new ur(t,r+n-1);return o}var Ep=class{constructor(e,r){this.modifierHandlerFactory=e;this.modifier=r}run(e,r){let n=e.getInterior();return n??this.modifierHandlerFactory.create({type:"containingScope",scopeType:{type:"interior",explicitScopeType:e.hasExplicitScopeType}}).run(e,r)}},Rp=class{constructor(e,r){this.modifierStageFactory=e;this.modifier=r;this.containingSurroundingPairIfNoBoundaryStage=mf(this.modifierStageFactory)}run(e,r){return this.containingSurroundingPairIfNoBoundaryStage.run(e,r).flatMap(n=>n.getBoundary())}};function mf(t){return new gp(t,{type:"containingScope",scopeType:{type:"surroundingPair",delimiter:"any"}},e=>e.getBoundary()==null)}var mr={type:"modifyIfUntyped",modifier:{type:"containingScope",scopeType:{type:"line"}}},df={type:"modifyIfUntyped",modifier:{type:"containingScope",scopeType:{type:"token"}}};var kp=class extends Error{constructor(e){super(`Target has no ${e} delimiter.`),this.name="NoDelimiterError"}},Ap=class{constructor(e,r){this.modifierStageFactory=e;this.modifier=r}run(e,r){return this.modifierStageFactory.create(df).run(e,r).map(n=>{let o=n.getLeadingDelimiterTarget();if(o==null)throw new kp("leading");return o})}},Pp=class{constructor(e,r){this.modifierStageFactory=e;this.modifier=r}run(e,r){return this.modifierStageFactory.create(df).run(e,r).map(n=>{let o=n.getTrailingDelimiterTarget();if(o==null)throw new kp("trailing");return o})}};function Mp(t,e,r,n,o){return uf(t,r,n,o),n===o?r[n]:Yi(e,r[n],r[o],!0,!0)}function Dp(t,e,r,n){return t.create({type:"everyScope",scopeType:n}).run(e,r)}var Lp=class{constructor(e,r){this.modifierStageFactory=e;this.modifier=r}run(e,r){let n=Dp(this.modifierStageFactory,e,r,this.modifier.scopeType),o=this.modifier.start+(this.modifier.start<0?n.length:0),a=o+this.modifier.length-1;return this.modifier.isEvery?Zx(this.modifier.scopeType,n,o,a):[Mp(this.modifier.scopeType,e.isReversed,n,o,a)]}};var Fp=class{run(e){let r={editor:e.editor,isReversed:e.isReversed,contentRange:this.getContentRange(e.contentRange)};return[e.isRaw?new Br(r):new ye({...r,textualType:"character"})]}},Ip=class extends Fp{getContentRange(e){return e.start.toEmptyRange()}},Cp=class extends Fp{getContentRange(e){return e.end.toEmptyRange()}};var Op=class{constructor(e,r,n){this.modifierStageFactory=e;this.scopeHandlerFactory=r;this.modifier=n}run(e){let{scopeType:r}=this.modifier,n=new Zi(this.modifierStageFactory,this.scopeHandlerFactory,{type:"containingScope",scopeType:r});try{return n.run(e)}catch(s){if(!(s instanceof Ie))throw s}let o=this.scopeHandlerFactory.create(this.modifier.scopeType,e.editor.document.languageId),a=pI(e,o);if(a==null)throw Error(`No scopes found for scope type: ${r.type}`);return a}};function pI(t,e){let r=e.generateScopes(t.editor,t.contentRange.start,"backward"),n=e.generateScopes(t.editor,t.contentRange.end,"forward"),{active:o}=t.contentSelection,a=eS(r,o),s=eS(n,o),c=a.distance<s.distance?a.scope:s.scope;return c?.getTargets(t.isReversed)}function eS(t,e){let r,n=1/0;for(let o of t){let a=Math.min(tS(e,o.domain.start),tS(e,o.domain.end));if(a<n)r=o,n=a;else break}return{scope:r,distance:n}}function tS(t,e){return Math.abs(t.line-e.line)*1e4+Math.abs(t.character-e.character)}var Np=class{constructor(e,r){this.modifierStageFactory=e;this.modifier=r}run(e,r){let n=this.modifierStageFactory.create(this.modifier.anchor),o=this.modifierStageFactory.create(this.modifier.active),a=n.run(e,r),s=o.run(e,r);if(a.length!==1||s.length!==1)throw new Error("Expected single anchor and active target");return[Jr(a[0],s[0],this.modifier.excludeAnchor,this.modifier.excludeActive)]}};var Hp=class{constructor(e){this.modifier=e}run(e){return[new Br({editor:e.editor,contentRange:e.contentRange,isReversed:e.isReversed})]}};var Up=class extends Error{constructor(e,r,n){super(`Requested ${e} ${n}s, but ${r} are already selected.`),this.name="TooFewScopesError"}};function rS(t,e,r,n){let o=Dp(t,dI(r),n,e.scopeType),a=mI(r.contentRange,o);return lI(e,r,o,a)}function lI(t,e,r,n){let o=t.direction==="forward",a=uI(t,e.contentRange,r,o,n),s=o?a+t.length-1:a-t.length+1,c=Math.min(a,s),p=Math.max(a,s);return[Mp(t.scopeType,e.isReversed,r,c,p)]}function uI(t,e,r,n,o){let a=t.offset===0;if(o==null){let p=n?r.findIndex(l=>l.contentRange.start.isAfter(e.start)):cn(r,l=>l.contentRange.start.isBefore(e.start));if(p===-1)throw new ur(t.scopeType);return a?p:n?p+t.offset-1:p-t.offset+1}let s=o.start,c=o.end;if(a){let p=c-s+1;if(p>t.length)throw new Up(t.length,p,t.scopeType.type);return n?s:c}return n?c+t.offset:s-t.offset}function mI(t,e){let r=e.map((o,a)=>({index:a,intersection:o.contentRange.intersection(t)})).filter(o=>o.intersection!=null);if(t.isEmpty){if(r.length===0)return;let o=r.at(-1).index;return{start:o,end:o}}let n=r.filter(o=>!o.intersection.isEmpty).map(o=>o.index);if(n.length!==0)return{start:n[0],end:n.at(-1)}}function dI(t){return new Ge({editor:t.editor,isReversed:t.isReversed,contentRange:t.contentRange,hasExplicitRange:!1})}var Vp=class{constructor(e,r,n){this.modifierStageFactory=e;this.scopeHandlerFactory=r;this.modifier=n}run(e,r){let n=this.scopeHandlerFactory.maybeCreate(this.modifier.scopeType,e.editor.document.languageId);if(n==null)return rS(this.modifierStageFactory,this.modifier,e,r);let o=Array.from(this.modifier.offset===0?fI(n,e,this.modifier):gI(n,e,this.modifier));if(o.length<this.modifier.length)throw new ur(this.modifier.scopeType,this.modifier.offset+this.modifier.length-1);let{isReversed:a}=e;return this.modifier.isEvery?o.flatMap(s=>s.getTargets(a)):hp(a,o[0],o[o.length-1])}};function fI(t,e,r){let{editor:n,contentRange:o}=e,{length:a,direction:s}=r,c=yp(t,n,s==="forward"?o.start:o.end,s)?.domain;if(c==null)throw new Ie(r.scopeType.type);return Wo(a,t.generateScopes(n,s==="forward"?c.start:c.end,s,{skipAncestorScopes:!0}))}function gI(t,e,r){let{editor:n,contentRange:o}=e,{length:a,direction:s,offset:c}=r,p=s==="forward"?o.end:o.start,l=o.isEmpty?"disallowed":"disallowedIfStrict";return WT(t.generateScopes(n,p,s,{containment:l,skipAncestorScopes:!0}),c-1,c+a-1)}var Bp=class{constructor(e){this.modifier=e}run(e){return e.editor.visibleRanges.map(r=>new ye({editor:e.editor,isReversed:e.isReversed,contentRange:r}))}};var eo=class{constructor(e,r,n){this.languageDefinitions=e;this.storedTargets=r;this.scopeHandlerFactory=n;this.create=this.create.bind(this)}create(e){switch(e.type){case"startOf":return new Ip;case"endOf":return new Cp;case"extendThroughStartOf":case"extendThroughEndOf":return new wp(this,e);case"toRawSelection":return new Hp(e);case"interiorOnly":return new Ep(this,e);case"excludeInterior":return new Rp(this,e);case"leading":return new Ap(this,e);case"trailing":return new Pp(this,e);case"visible":return new Bp(e);case"containingScope":return new Zi(this,this.scopeHandlerFactory,e);case"preferredScope":return new Op(this,this.scopeHandlerFactory,e);case"everyScope":return e.scopeType.type==="instance"?new Xi(this,this.storedTargets,e):new Tp(this,this.scopeHandlerFactory,e);case"ordinalScope":return e.scopeType.type==="instance"?new Xi(this,this.storedTargets,e):new Lp(this,e);case"relativeScope":return e.scopeType.type==="instance"?new Xi(this,this.storedTargets,e):new Vp(this,this.scopeHandlerFactory,e);case"keepContentFilter":return new xp(e);case"keepEmptyFilter":return new Sp(e);case"cascading":return new fp(this,e);case"modifyIfUntyped":return new Qr(this,e);case"range":return new Np(this,e);case"inferPreviousMark":throw Error(`Unexpected modifier '${e.type}'; it should have been removed during inference`);default:{let r=e,{type:n}=e;throw new Error(`Unknown modifier: ${n}`)}}}};async function nS(t,e,r){let n=t.registerReplaceEditList(e.document,r.filter(a=>a.isReplace)),o=await e.edit(r);return n(),o}async function le({rangeUpdater:t,editor:e,selections:r,preserveCursorSelections:n,...o}){let a=Ss(r),s=a.map(l=>{let u=r[l],m=hI(u);return iS(e.document,m.selections,m.behavior)});n||s.push(iS(e.document,e.selections,1));let c=await("edits"in o?TI(t,e,o.edits,s):oS(t,o.callback,e.document,s));return n||await e.setSelections(c.pop()),Object.fromEntries(a.map((l,u)=>[l,c[u]]))}function iS(t,e,r){return e.map(n=>yI(t,n,n instanceof Me?!n.isReversed:!0,r))}function hI(t){return"selections"in t?t:{selections:t,behavior:1}}function yI(t,e,r,n){return{range:e,isForward:r,expansionBehavior:{start:{type:n===1||n===3?"closed":"open"},end:{type:n===1||n===2?"closed":"open"}},offsets:{start:t.offsetAt(e.start),end:t.offsetAt(e.end)},text:t.getText(e)}}function _I(t){return t.map(e=>e.map(({range:{start:r,end:n},isForward:o})=>o?new Me(r,n):new Me(n,r)))}async function oS(t,e,r,n){let o=t.registerRangeInfoList(r,Se(n));return await e(),o(),_I(n)}async function TI(t,e,r,n){return await oS(t,async()=>{if(!await nS(t,e,r))throw new Error("Could not apply edits")},e.document,n)}var Wp=class{constructor(e){this.rangeUpdater=e;this.run=this.run.bind(this)}async run(e){return await ue(h(),e,"pendingModification0"),{thatSelections:Se(await be(e,async(n,o)=>{let a=o.map(({contentRange:l})=>l),s=xI(n,a),c=h().getEditableTextEditor(n),{contentRanges:p}=await le({rangeUpdater:this.rangeUpdater,editor:c,edits:s,selections:{contentRanges:a}});return Be(o,p).map(([l,u])=>({editor:l.editor,selection:u.toSelection(l.isReversed)}))}))}}};function xI(t,e){let{document:r}=t,n=[];for(let o of e){let a=o.start,s=r.lineAt(a),c=s.text.slice(0,s.rangeTrimmed?.start?.character??s.range.start.character),p=s.text.slice(0,a.character).search(/\s+$/),l=p>-1?new D(new pe(s.lineNumber,p),a):a.toEmptyRange();n.push({range:l,text:`
`+c,isReplace:!l.isEmpty})}return n}function $p(t){return t.length<2?t:aT(t).flatMap(([e,r])=>{if(r.length<2)return r;let n=[...r];n.sort((a,s)=>a.contentRange.start.compareTo(s.contentRange.start));let o=!0;for(;o;)[n,o]=SI(n);return n})}function SI(t){if(t.length<2)return[t,!1];let e=[],r=[];return t.forEach(n=>{r.length&&!vI(r[r.length-1],n)?(e.push(aS(r)),r=[n]):r.push(n)}),e.push(aS(r)),[e,e.length!==t.length]}function aS(t){if(t.length===1)return t[0];let e=t[0],r=t[t.length-1];return Jr(e,r)}function vI(t,e){return!!t.getRemovalRange().intersection(e.getRemovalRange())}var Ko=class{constructor(e,r){this.rangeUpdater=e;this.type=r}async decorateTargets(e,r){await Promise.all([ue(h(),e,this.decoration.sourceStyle,this.decoration.getSourceRangeCallback),ue(h(),r,this.decoration.destinationStyle)])}getEditsBringMove(e,r){let n=[],o=[],a=e.length!==r.length&&r.length===1;return e.forEach((s,c)=>{let p=r[c];if((s==null||p==null)&&!a)throw new Error("Targets must have same number of args");if(p!=null){let l;a?l=e.map((u,m)=>{let d=u.contentText,g=(p.isRaw?null:p.insertionDelimiter)??(u.isRaw?null:u.insertionDelimiter);return m>0&&g!=null?g+d:d}).join(""):l=s.contentText,o.push({edit:p.constructChangeEdit(l),editor:p.editor,originalTarget:p.target,isSource:!1})}else p=r[0];n.includes(s)||(n.push(s),this.type==="bring"&&o.push({edit:s.toDestination("to").constructChangeEdit(p.target.contentText),editor:s.editor,originalTarget:s,isSource:!0}))}),this.type==="move"&&$p(n).forEach(s=>{o.push({edit:s.constructRemovalEdit(),editor:s.editor,originalTarget:s,isSource:!0})}),o}async performEditsAndComputeThatMark(e){return Se(await xr(e,r=>r.editor,async(r,n)=>{let o=this.type!=="bring"?n:n.filter(({isSource:g})=>!g),a=this.type==="swap"?[]:n.filter(({isSource:g})=>g),s=this.type==="swap"?n:n.filter(({isSource:g})=>!g),c=a.map(({edit:g})=>g.range),p=s.map(({edit:g})=>g.range),l=h().getEditableTextEditor(r),{sourceEditRanges:u,destinationEditRanges:m}=await le({rangeUpdater:this.rangeUpdater,editor:l,edits:o.map(({edit:g})=>g),selections:{sourceEditRanges:c,destinationEditRanges:{selections:p,behavior:0}}}),d=[...this.getMarks(a,u),...this.getMarks(s,m)];return d.sort((g,b)=>n.findIndex(w=>w.originalTarget===g.target)-n.findIndex(w=>w.originalTarget===b.target)),d}))}getMarks(e,r){return e.map((n,o)=>{let a=r[o],s=n.edit.updateRange(a),c=n.originalTarget;return{editor:n.editor,selection:s.toSelection(c.isReversed),isSource:n.isSource,target:c}})}async decorateThatMark(e){let r=n=>Lt(n,e.find(o=>o.target===n).selection);return Promise.all([ue(h(),e.filter(({isSource:n})=>n).map(({target:n})=>n),this.decoration.sourceStyle,r),ue(h(),e.filter(({isSource:n})=>!n).map(({target:n})=>n),this.decoration.destinationStyle,r)])}calculateMarksBringMove(e){return{thatMark:e.filter(({isSource:r})=>!r),sourceMark:e.filter(({isSource:r})=>r)}}};function sS(t,e){return t.length===1?Array(e.length).fill(t[0]):t}var jp=class extends Ko{constructor(r){super(r,"bring");this.decoration={sourceStyle:"referenced",destinationStyle:"pendingModification0"};this.run=this.run.bind(this)}async run(r,n){r=sS(r,n),await this.decorateTargets(r,n.map(p=>p.target));let o=this.getEditsBringMove(r,n),a=await this.performEditsAndComputeThatMark(o),{thatMark:s,sourceMark:c}=this.calculateMarksBringMove(a);return await this.decorateThatMark(s),{thatSelections:s,sourceSelections:c}}},qp=class extends Ko{constructor(r){super(r,"move");this.decoration={sourceStyle:"pendingDelete",destinationStyle:"pendingModification0",getSourceRangeCallback:bI};this.run=this.run.bind(this)}async run(r,n){r=sS(r,n),await this.decorateTargets(r,n.map(p=>p.target));let o=this.getEditsBringMove(r,n),a=await this.performEditsAndComputeThatMark(o),{thatMark:s,sourceMark:c}=this.calculateMarksBringMove(a);return await this.decorateThatMark(s),{thatSelections:s,sourceSelections:c}}},zp=class extends Ko{constructor(r){super(r,"swap");this.decoration={sourceStyle:"pendingModification1",destinationStyle:"pendingModification0"};this.run=this.run.bind(this)}async run(r,n){await this.decorateTargets(r,n);let o=this.getEditsSwap(r,n),a=await this.performEditsAndComputeThatMark(o);return await this.decorateThatMark(a),{thatSelections:a,sourceSelections:[]}}getEditsSwap(r,n){let o=[];return r.forEach((a,s)=>{let c=n[s];if(a==null||c==null)throw new Error("Targets must have same number of args");o.push({edit:c.toDestination("to").constructChangeEdit(a.contentText),editor:c.editor,originalTarget:c,isSource:!1}),o.push({edit:a.toDestination("to").constructChangeEdit(c.contentText),editor:a.editor,originalTarget:a,isSource:!0})}),o}};function bI(t){return t.getRemovalHighlightRange()}var Qo=class{constructor(e){this.actions=e;this.run=this.run.bind(this)}async run(e,r){mt(e);let{returnValue:n}=await this.actions.getText.run(e,{showDecorations:!1}),{thatSelections:o}=await this.actions.wrapWithPairedDelimiter.run(r,n[0]+"(",")");return{thatSelections:o}}};var Jo=class{constructor(e){this.actions=e;this.run=this.run.bind(this)}async run(e){let r=Ue(e),n=e.map(a=>new ye({editor:a.editor,isReversed:a.isReversed,contentRange:a.contentRange})),{thatTargets:o}=await this.actions.remove.run(n);return o!=null&&await h().getEditableTextEditor(r).setSelections(o.map(({contentSelection:a})=>a),{focusEditor:!0}),{thatTargets:o}}};var to=t=>new Ge({editor:t.editor,isReversed:t.selection.isReversed,contentRange:t.selection,hasExplicitRange:!0});var ro=class{constructor(e){this.rangeUpdater=e;this.run=this.run.bind(this)}async run(e,r){r.showDecorations&&await ue(h(),e,"referenced"),r.ensureSingleEditor&&Ue(e),r.ensureSingleTarget&&mt(e);let n=h().activeEditableTextEditor,o=r.setSelection?oT:be,a=Se(await o(e,(s,c)=>this.runForEditor(r,s,c)));return r.setSelection&&r.restoreSelection&&n!=null&&!n.isActive&&await n.focus(),{thatTargets:a}}async runForEditor(e,r,n){let o=h().getEditableTextEditor(r),a=r.selections,s=r.document.version,c=n.map(u=>u.contentSelection);e.setSelection&&await o.setSelections(c,{focusEditor:!0,revealRange:!1});let{originalSelections:p,targetSelections:l}=await le({rangeUpdater:this.rangeUpdater,editor:o,callback:()=>e.callback(o,n),preserveCursorSelections:!0,selections:{originalSelections:a,targetSelections:c}});return e.setSelection&&e.restoreSelection&&await o.setSelections(p),r.document.version===s?n:l.map(u=>to({editor:r,selection:u}))}};var Ve=class{constructor(e){this.ensureSingleEditor=!1;this.ensureSingleTarget=!1;this.restoreSelection=!0;this.showDecorations=!0;this.callbackAction=new ro(e),this.run=this.run.bind(this)}async run(e,{showDecorations:r}={}){let n=h().capabilities.commands[this.command];if(n==null)throw Error(`Action ${this.command} is not supported by your ide`);let{acceptsLocation:o}=n;return this.callbackAction.run(e,{callback:(a,s)=>wI(a,o?s.map(c=>c.contentRange):void 0,this.command),setSelection:!o,ensureSingleEditor:this.ensureSingleEditor,ensureSingleTarget:this.ensureSingleTarget,restoreSelection:this.restoreSelection,showDecorations:r??this.showDecorations})}},Gp=class extends Ve{constructor(){super(...arguments);this.command="clipboardCopy";this.ensureSingleEditor=!0}},Kp=class extends Ve{constructor(){super(...arguments);this.command="toggleLineComment"}},Qp=class extends Ve{constructor(){super(...arguments);this.command="indentLine"}},Jp=class extends Ve{constructor(){super(...arguments);this.command="outdentLine"}},Yp=class extends Ve{constructor(){super(...arguments);this.command="fold"}},Zp=class extends Ve{constructor(){super(...arguments);this.command="unfold"}},Xp=class extends Ve{constructor(){super(...arguments);this.command="rename";this.ensureSingleTarget=!0}},el=class extends Ve{constructor(){super(...arguments);this.command="showReferences";this.ensureSingleTarget=!0}},tl=class extends Ve{constructor(){super(...arguments);this.command="quickFix";this.ensureSingleTarget=!0}},rl=class extends Ve{constructor(){super(...arguments);this.command="revealDefinition";this.ensureSingleTarget=!0;this.restoreSelection=!1}},nl=class extends Ve{constructor(){super(...arguments);this.command="revealTypeDefinition";this.ensureSingleTarget=!0;this.restoreSelection=!1}},il=class extends Ve{constructor(){super(...arguments);this.command="showHover";this.ensureSingleTarget=!0;this.restoreSelection=!1}},ol=class extends Ve{constructor(){super(...arguments);this.command="showDebugHover";this.ensureSingleTarget=!0;this.restoreSelection=!1}},al=class extends Ve{constructor(){super(...arguments);this.command="extractVariable";this.ensureSingleTarget=!0;this.restoreSelection=!1}},sl=class extends Ve{constructor(){super(...arguments);this.command="gitAccept";this.ensureSingleTarget=!0}},cl=class extends Ve{constructor(){super(...arguments);this.command="gitRevert";this.ensureSingleTarget=!0}},pl=class extends Ve{constructor(){super(...arguments);this.command="gitStage";this.ensureSingleTarget=!0}},ll=class extends Ve{constructor(){super(...arguments);this.command="gitUnstage";this.ensureSingleTarget=!0}};function wI(t,e,r){switch(r){case"toggleLineComment":return t.toggleLineComment(e);case"indentLine":return t.indentLine(e);case"outdentLine":return t.outdentLine(e);case"clipboardCopy":return t.clipboardCopy(e);case"fold":return t.fold(e);case"unfold":return t.unfold(e);case"insertLineAfter":return t.insertLineAfter(e);case"rename":return t.rename(e?.[0]);case"showReferences":return t.showReferences(e?.[0]);case"quickFix":return t.quickFix(e?.[0]);case"revealDefinition":return t.revealDefinition(e?.[0]);case"revealTypeDefinition":return t.revealTypeDefinition(e?.[0]);case"showHover":return t.showHover(e?.[0]);case"showDebugHover":return t.showDebugHover(e?.[0]);case"extractVariable":return t.extractVariable(e?.[0]);case"gitAccept":return t.gitAccept(e?.[0]);case"gitRevert":return t.gitRevert(e?.[0]);case"gitStage":return t.gitStage(e?.[0]);case"gitUnstage":return t.gitUnstage(e?.[0]);case"highlight":throw Error("Highlight command not supported as simple action")}}var ul=class{constructor(e,r){this.actions=e;this.rangeUpdater=r;this.run=this.run.bind(this)}async run(e,r={showDecorations:!0}){if(h().capabilities.commands.clipboardCopy!=null)return new Gp(this.rangeUpdater).run(e,r);r.showDecorations&&await ue(h(),e,"referenced");let n=e.map(o=>o.contentText).join(`
`);return await h().clipboard.writeText(n),{thatTargets:e}}};var ml=class{constructor(e){this.actions=e;this.run=this.run.bind(this)}async run(e){await h().flashRanges(e.flatMap(EI));let r={showDecorations:!1};await this.actions.copyToClipboard.run(e,r);let{thatTargets:n}=await this.actions.remove.run(e,r);return{thatTargets:n}}};function EI(t){let{editor:e,contentRange:r}=t,n=t.getRemovalHighlightRange(),o=[{editor:e,range:at(r),style:"referenced"}];return n.type==="line"?o.push({editor:e,range:n,style:"pendingDelete"}):o.push(...RI(r,n).map(a=>({editor:e,range:at(a),style:"pendingDelete"}))),o}function RI(t,e){let{start:r,end:n}=t,{start:o,end:a}=e,s=[];return o.isBefore(r)&&s.push(new D(o,r)),a.isAfter(n)&&s.push(new D(n,a)),s}var Yo=class{constructor(){this.run=this.run.bind(this)}async run(e){return await be(e,async(r,n)=>{let o=r.selections.filter(a=>!n.some(s=>{let c=s.contentRange.intersection(a);return c&&(!c.isEmpty||a.isEmpty)}));if(o.length===0)throw new ff;await h().getEditableTextEditor(r).setSelections(o)}),{thatTargets:e}}},ff=class extends Error{constructor(){super("Can't deselect every selection. At least one is required"),this.name="SelectionRequiredError"}};async function cS(t,e,r,n){let o=r.destinations.map((b,w)=>{if(n||r.actionTypes[w]==="edit")return{destination:b,index:w}}).filter(b=>!!b);if(o.length===0)return r;let a=o.map(b=>b.destination.constructChangeEdit("")),s=r.cursorRanges.map((b,w)=>({range:b,index:w})).filter(({range:b})=>b!=null),c=s.map(({index:b})=>b),p=s.map(({range:b})=>b),l=a.map(b=>b.range),{thatRanges:u,cursorRanges:m,editRanges:d}=await le({rangeUpdater:t,editor:e,edits:a,preserveCursorSelections:!0,selections:{thatRanges:r.thatRanges,cursorRanges:p,editRanges:{selections:l,behavior:0}}}),g=[...r.cursorRanges];return Be(c,m).forEach(([b,w])=>{g[b]=w}),o.forEach((b,w)=>{let L=a[w].updateRange(d[w]);g[b.index]=L}),{destinations:r.destinations,actionTypes:r.actionTypes,thatRanges:u,cursorRanges:g}}async function pS({acceptsLocation:t},e,r,n){let o=n.destinations.map((m,d)=>{if(n.actionTypes[d]==="insertLineAfter")return{destination:m,index:d}}).filter(m=>!!m);if(o.length===0)return n;let a=o.map(({destination:m})=>m.contentRange),s=n.destinations.map(({contentRange:m})=>m),c=async()=>{t?await r.insertLineAfter(a):(await r.setSelections(a.map(m=>m.toSelection(!1))),await r.focus(),await r.insertLineAfter())},{targetRanges:p,thatRanges:l}=await le({rangeUpdater:e,editor:r,callback:c,preserveCursorSelections:!0,selections:{targetRanges:s,thatRanges:n.thatRanges}}),u=[...n.cursorRanges];return o.forEach((m,d)=>{u[m.index]=r.selections[d]}),{destinations:n.destinations.map((m,d)=>m.withTarget(m.target.withContentRange(p[d]))),actionTypes:n.actionTypes,thatRanges:l,cursorRanges:u}}async function lS(t,e){let r=mt(e),n=h().getEditableTextEditor(r.editor),o=r.insertionMode==="before";if(r.insertionMode==="to")throw Error(`Unsupported insertion mode '${r.insertionMode}' for notebookcapell`);return await t.setSelection.run([r.target]),o?await n.editNewNotebookCellAbove():await n.editNewNotebookCellBelow(),{thatSelections:Dt([r.target.thatTarget])}}var dl=class{constructor(e,r){this.rangeUpdater=e;this.actions=r;this.run=this.run.bind(this)}async run(e){if(e.some(({target:c})=>c.isNotebookCell))return lS(this.actions,e);let r=h().getEditableTextEditor(Ue(e)),n={destinations:e,actionTypes:e.map(c=>c.getEditNewActionType()),thatRanges:e.map(({target:c})=>c.thatTarget.contentRange),cursorRanges:new Array(e.length).fill(void 0)},o=h().capabilities.commands.insertLineAfter,a=o!=null;a&&(n=await pS(o,this.rangeUpdater,r,n)),n=await cS(this.rangeUpdater,r,n,!a);let s=n.destinations.map((c,p)=>{let l=n.cursorRanges[p];if(l==null)throw Error("Cursor range is undefined for destination");return l.toSelection(c.target.isReversed)});return await r.setSelections(s,{focusEditor:!0}),{thatSelections:Dt(n.destinations.map(c=>c.target),n.thatRanges)}}};var fl=class{constructor(e,r){this.actions=e;this.modifierStageFactory=r;this.run=this.run.bind(this)}getFinalStages(){return[this.modifierStageFactory.create(mr)]}run(e){return this.actions.editNew.run(e.map(r=>r.toDestination(this.insertionMode)))}},gl=class extends fl{constructor(){super(...arguments);this.insertionMode="before"}},hl=class extends fl{constructor(){super(...arguments);this.insertionMode="after"}};var Zo=class{constructor(e){this.callbackAction=new ro(e),this.run=this.run.bind(this)}async run(e,r,{commandArgs:n,ensureSingleEditor:o,ensureSingleTarget:a,restoreSelection:s,showDecorations:c}={}){let p=n??[];return this.callbackAction.run(e,{callback:()=>h().executeCommand(r,...p),setSelection:!0,ensureSingleEditor:o??!1,ensureSingleTarget:a??!1,restoreSelection:s??!0,showDecorations:c??!0})}};var yl=class{constructor(e){this.actions=e;this.run=this.run.bind(this)}async run(e){mt(e);let{returnValue:r,thatTargets:n}=await this.actions.getText.run(e),[o]=r,a;return o.length>200?(a=o.substring(0,200),un(h().messages,"truncatedSearchText","Search text is longer than 200 characters; truncating")):a=o,await this.find(a),{thatTargets:n}}},_l=class extends yl{find(e){return h().findInDocument(e)}},Tl=class extends yl{find(e){return h().findInWorkspace(e)}};var xl=class{constructor(){this.run=this.run.bind(this)}async run(e){return await ue(h(),e,"referenced"),{thatTargets:e}}};var no=class{constructor(e){this.options=e;this.run=this.run.bind(this)}async run(e){let r=mt(e);return await ue(h(),e,"referenced"),await h().getEditableTextEditor(r.editor).openLink(r.contentRange,this.options),{thatSelections:Dt(e)}}};function uS(t){let e=t.split(/^---$/m),r={snippets:[]};for(let n of e){let o=n.match(/^-$/m),a=o!=null?n.slice(0,o.index):n,s=o!=null?n.slice(o.index+o[0].length):null,c=s?MI(s):null,p=kI(a);if(c!=null){p==null&&(p={variables:[]});let{variables:l,...u}=p;r.snippets.push({...u,body:c,variables:l})}else if(p!=null){if(r.header!=null||r.snippets.length!==0)throw Error("Header snippet must be first in file");r.header=p}}return r}function kI(t){let e={variables:[]},r=AI(t);if(Object.keys(r).length===0)return;let n={};for(let[o,a]of Object.entries(r))switch(o){case"name":e.name=a;break;case"description":e.description=a;break;case"phrase":e.phrases=Xo(a);break;case"insertionScope":e.insertionScopes=Xo(a);break;case"language":e.languages=Xo(a);break;default:if(!o.startsWith("$"))throw Error(`Invalid key '${o}'`);n[o]=a}return e.variables=PI(n),e}function AI(t){let e=t.split(/\r?\n/).map(n=>n.trim()).filter(Boolean),r={};for(let n of e){let o=n.split(":");if(o.length!==2)throw Error(`Invalid line '${n}'`);let a=o[0].trim(),s=o[1].trim();if(a.length===0||s.length===0)throw Error(`Invalid line '${n}'`);if(r[a]!=null)throw Error(`Duplicate key '${a}' in '${t}'`);r[a]=s}return r}function PI(t){let e={},r=n=>(e[n]==null&&(e[n]={name:n}),e[n]);for(let[n,o]of Object.entries(t)){let a=n.split(".");if(a.length!==2)throw Error(`Invalid variable key '${n}'`);let s=a[0].slice(1);switch(a[1]){case"insertionFormatter":r(s).insertionFormatters=Xo(o);break;case"wrapperPhrase":r(s).wrapperPhrases=Xo(o);break;case"wrapperScope":r(s).wrapperScope=o;break;default:throw Error(`Invalid variable key '${n}'`)}}return Object.values(e)}function MI(t){let e=t.match(/^[ \t]*\S/m);if(e?.index!=null)return t.slice(e.index).trimEnd().split(/\r?\n/).map(r=>r.trimEnd())}function Xo(t){return t.split("|").map(e=>e.trim())}function dS(t){let e=[];t.header!=null&&e.push(mS(t.header)),e.push(...t.snippets.map(mS));let r=e.filter(Boolean).join(`
---

`);return r?r+`
---
`:""}function mS(t){let e=[Yr("name",t.name),Yr("description",t.description),Yr("language",t.languages),Yr("phrase",t.phrases),Yr("insertionScope",t.insertionScopes)].filter(Boolean);return t.variables.length>0&&(e.length>0&&e.push(""),e.push(...DI(t.variables))),"body"in t&&e.push("-",...t.body),e.join(`
`)}function DI(t){let e=[...t];return e.sort(LI),e.flatMap(r=>[Yr(`$${r.name}.insertionFormatter`,r.insertionFormatters),Yr(`$${r.name}.wrapperPhrase`,r.wrapperPhrases),Yr(`$${r.name}.wrapperScope`,r.wrapperScope)]).filter(Boolean)}function Yr(t,e){return e==null?"":Array.isArray(e)?`${t}: ${e.join(" | ")}`:`${t}: ${e}`}function LI(t,e){return t.name==="0"?1:e.name==="0"?-1:t.name.localeCompare(e.name)}function fS(t,e){let r=[],n=0,o=null,[a,...s]=t.split(/\r?\n/);return[{text:e+a,startIndex:e.length},...s.map(p=>({text:p,startIndex:0}))].forEach(({text:p,startIndex:l})=>{let u=p.match(/^\s*/)?.[0]??"",m=u.length;o!=null&&(u.length>o.length?n++:u.length<o.length&&n--),o=u;let d=Math.max(m,l),g=Ku("	",n),b=p.slice(d);r.push(g+b)}),r}function gS(t,e){let r=Ju(e,a=>a.offsets.start),n="",o=0;for(let a of r)n+=t.slice(o,a.offsets.start)+a.text,o=a.offsets.end;return n+=t.slice(o),n}var io=class{constructor(e){this.snippets=e;this.run=this.run.bind(this)}async run(e,r,n){if(r==null)throw new Error("Directory argument is required for GenerateSnippet action. Please update Cursorless Talon");let o=mt(e),a=o.editor;if(ue(h(),e,"referenced"),n==null&&(n=await h().showInputBox({prompt:"Name of snippet",placeHolder:"helloWorld"}),!n))return{};let s=a.document.offsetAt(o.contentRange.start),c=II(a,o.contentRange),p=c.map((J,oe)=>({offsets:{start:a.document.offsetAt(J.start)-s,end:a.document.offsetAt(J.end)-s},name:oe===c.length-1?"0":`${oe+1}`})),l=a.document.getText(new D(o.contentRange.start.with(void 0,0),o.contentRange.start)),u=a.document.getText(o.contentRange),m=gS(u,[...kt(u,/\$|\\/g,J=>({offsets:{start:J.index,end:J.index+J[0].length},text:`\\${J[0]}`})),...p.map(({offsets:J,name:oe})=>({offsets:J,text:`$${oe}`}))]),d=fS(m,l),g,b={snippets:[]};h().runMode==="test"?g=h().getEditableTextEditor(a):(g=h().getEditableTextEditor(await this.snippets.openNewSnippetFile(n,r)),b=uS(g.document.getText())),await g.setSelections([g.document.range.toSelection(!1)]);let w=1,{header:I}=b,L=b.header?.phrases!=null?void 0:[`${gf}${w++}`],H=J=>{let oe=I?.variables?.some(rt=>rt.name===J.name&&rt.wrapperPhrases!=null);return{name:J.name,wrapperPhrases:oe?void 0:[`${gf}${w++}`]}},X={name:I?.name===n?void 0:n,phrases:L,languages:FI(a,I),body:d,variables:p.map(H)};b.snippets.push(X);let fe=dS(b).replace(/\$/g,"\\$").replaceAll(gf,"$");return await g.insertSnippet(fe),{thatSelections:e.map(({editor:J,contentSelection:oe})=>({editor:J,selection:oe}))}}};function FI(t,e){if(!e?.languages?.includes(t.document.languageId))return[t.document.languageId]}function II(t,e){let r=t.selections.filter(n=>e.contains(n));return r.sort((n,o)=>n.start.compareTo(o.start)),r}var gf="PLACEHOLDER_VFA77zcbLD6wXNmfMAay";var ea=class{constructor(){this.run=this.run.bind(this)}async run(e){return{returnValue:e.map(({contentRange:r})=>({contentRange:r})),thatTargets:e}}};var ta=class{constructor(){this.run=this.run.bind(this)}async run(e,{showDecorations:r=!0,ensureSingleTarget:n=!1}={}){return r&&await ue(h(),e,"referenced"),n&&mt(e),{returnValue:e.map(o=>o.contentText),thatTargets:e}}};var ra=class{constructor(){this.run=this.run.bind(this)}async run(e,r){if(h().capabilities.commands.highlight==null)throw Error("The highlight action is not supported by your ide");return e.length===0?await Promise.all(h().visibleTextEditors.map(n=>h().setHighlightRanges(r,n,[]))):await be(e,(n,o)=>h().setHighlightRanges(r,n,o.map(a=>Lt(a,a.contentRange)))),{thatTargets:e}}};var Sl=class{constructor(e,r){this.rangeUpdater=e;this.isIndent=r;this.run=this.run.bind(this),this.runForEditor=this.runForEditor.bind(this)}async run(e){return this.hasCapability()?this.runSimpleCommandAction(e):(await ue(h(),e,"pendingModification0"),{thatTargets:Se(await be(e,this.runForEditor))})}hasCapability(){return this.isIndent?h().capabilities.commands.indentLine!=null:h().capabilities.commands.outdentLine!=null}runSimpleCommandAction(e){return(this.isIndent?new Qp(this.rangeUpdater):new Jp(this.rangeUpdater)).run(e)}async runForEditor(e,r){let n=this.isIndent?CI(e,r):OI(e,r),{targetSelections:o}=await le({rangeUpdater:this.rangeUpdater,editor:h().getEditableTextEditor(e),edits:n,selections:{targetSelections:r.map(({contentSelection:a})=>a)}});return Be(r,o).map(([a,s])=>to({editor:e,selection:s.toSelection(a.isReversed)}))}},vl=class extends Sl{constructor(e){super(e,!0)}},bl=class extends Sl{constructor(e){super(e,!1)}};function CI(t,e){let{document:r}=t,n=hS(e),o=NI(t);return n.map(a=>({range:r.lineAt(a).range.start.toEmptyRange(),text:o}))}function OI(t,e){let{document:r}=t,n=hS(e),o=HI(t);return n.map(a=>{let s=r.lineAt(a),c=s.text.match(o),{start:p}=s.range,l=p.translate(void 0,c?.[0].length);return{range:new D(p,l),text:""}})}function hS(t){let e=new Set;for(let r of t){let{start:n,end:o}=r.contentRange;for(let a=n.line;a<=o.line;++a)e.add(a)}return[...e]}function NI(t){if(t.options.insertSpaces){let e=yS(t);return" ".repeat(e)}return"	"}function HI(t){if(t.options.insertSpaces){let e=yS(t);return new RegExp(`^[ ]{1,${e}}`)}return/^\t/}function yS(t){return typeof t.options.tabSize=="number"?t.options.tabSize:4}var wl=class{constructor(e,r,n){this.rangeUpdater=e;this.modifierStageFactory=r;this.isBefore=n;this.getFinalStages=()=>[this.modifierStageFactory.create(mr)];this.run=this.run.bind(this),this.runForEditor=this.runForEditor.bind(this)}async run(e){let r=Se(await be(e,this.runForEditor));return await h().flashRanges(r.flatMap(n=>n.thatMark.map(o=>({editor:o.editor,range:at(o.selection),style:"justAdded"})))),{sourceSelections:r.flatMap(({sourceMark:n})=>n),thatSelections:r.flatMap(({thatMark:n})=>n)}}async runForEditor(e,r){let n=this.isBefore?"after":"before",o=r.flatMap(d=>d.toDestination(n).constructChangeEdit(d.contentText)),a=r.map(({contentSelection:d})=>d),s=o.map(({range:d})=>d),c=h().getEditableTextEditor(e),{contentSelections:p,editRanges:l}=await le({rangeUpdater:this.rangeUpdater,editor:c,edits:o,selections:{contentSelections:a,editRanges:{selections:s,behavior:0}}}),u=Be(o,l).map(([d,g])=>d.updateRange(g)),m=e.selections[0];return p.some(d=>d.intersection(m)!=null)&&await c.revealRange(m),{sourceMark:Dt(r,u),thatMark:Dt(r,p)}}},El=class extends wl{constructor(e,r){super(e,r,!0)}},Rl=class extends wl{constructor(e,r){super(e,r,!1)}};var na=class{constructor(e,r){this.rangeUpdater=e;this.modifierStageFactory=r;this.run=this.run.bind(this)}getFinalStages(){return[this.modifierStageFactory.create(mr)]}async run(e){let r=await be(e,async(o,a)=>{let s=this.getEdits(a),c=a.map(u=>u.thatTarget.contentSelection),{contentSelections:p,editRanges:l}=await le({rangeUpdater:this.rangeUpdater,editor:h().getEditableTextEditor(o),edits:s,selections:{contentSelections:c,editRanges:{selections:s.map(u=>u.range),behavior:0}}});return{thatMark:p.map(u=>({editor:o,selection:u})),flashRanges:gn(s,l).map(([u,m])=>({editor:o,range:u.isLine?u.updateRange(m):m,isLine:u.isLine}))}});return await h().flashRanges(r.flatMap(o=>o.flashRanges.map(({editor:a,range:s,isLine:c})=>({editor:a,range:c?Pt(s):at(s),style:"justAdded"})))),{thatSelections:r.flatMap(o=>o.thatMark)}}},kl=class extends na{constructor(e,r){super(e,r)}getEdits(e){return e.flatMap(r=>[Ml(r,"before"),Ml(r,"after")])}},Al=class extends na{constructor(e,r){super(e,r)}getEdits(e){return e.map(r=>Ml(r,"before"))}},Pl=class extends na{constructor(e,r){super(e,r)}getEdits(e){return e.map(r=>Ml(r,"after"))}};function Ml(t,e){return{...t.toDestination(e).constructChangeEdit("",!0),isLine:t.textualType==="line"}}function oo(t,e){if(t.type==="named")throw new Error("Cursorless snippets are deprecated. Please use community snippets. Update to latest cursorless-talon and say 'cursorless migrate snippets'.");if(t.type==="custom")return t;let r=VI(t.snippets,e,t.fallbackLanguage);if(r==null){let n=UI(t.snippets);throw new Error(`No snippet available for language '${e}'. Available languages: ${n}`)}return r}function UI(t){let e=new Set(t.flatMap(r=>r.languages??[]));return Array.from(e).sort().join(", ")}function VI(t,e,r){let n=_S(t.filter(o=>o.languages?.includes(e)));return n==null&&r!=null&&(n=_S(t.filter(o=>o.languages?.includes(r)))),n==null&&(n=t.find(o=>o.languages==null)),n}function _S(t){if(t.length!==0)return t.reduce((e,r)=>{if(e.languages==null||r.languages==null)throw Error("Snippet must have languages defined to find the one with the fewest languages");return r.languages.length<e.languages.length?r:e})}var Ht=class Ht{constructor(){this.value="";this.pos=0}static isDigitCharacter(e){return e>=48&&e<=57}static isVariableCharacter(e){return e===95||e>=97&&e<=122||e>=65&&e<=90}text(e){this.value=e,this.pos=0}tokenText(e){return this.value.substr(e.pos,e.len)}next(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};let e=this.pos,r=0,n=this.value.charCodeAt(e),o;if(o=Ht._table[n],typeof o=="number")return this.pos+=1,{type:o,pos:e,len:1};if(Ht.isDigitCharacter(n)){o=8;do r+=1,n=this.value.charCodeAt(e+r);while(Ht.isDigitCharacter(n));return this.pos+=r,{type:o,pos:e,len:r}}if(Ht.isVariableCharacter(n)){o=9;do n=this.value.charCodeAt(e+ ++r);while(Ht.isVariableCharacter(n)||Ht.isDigitCharacter(n));return this.pos+=r,{type:o,pos:e,len:r}}o=10;do r+=1,n=this.value.charCodeAt(e+r);while(!isNaN(n)&&typeof Ht._table[n]>"u"&&!Ht.isDigitCharacter(n)&&!Ht.isVariableCharacter(n));return this.pos+=r,{type:o,pos:e,len:r}}};Ht._table={36:0,58:1,44:2,123:3,125:4,92:5,47:6,124:7,43:11,45:12,63:13};var hf=Ht,Zr=class{constructor(){this._children=[]}appendChild(e){return e instanceof Je&&this._children[this._children.length-1]instanceof Je?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this}replace(e,r){let{parent:n}=e,o=n.children.indexOf(e),a=n.children.slice(0);a.splice(o,1,...r),n._children=a,function s(c,p){for(let l of c)l.parent=p,s(l.children,l)}(r,n)}get children(){return this._children}get snippet(){let e=this;for(;;){if(!e)return;if(e instanceof Fl)return e;e=e.parent}}toString(){return this.children.reduce((e,r)=>e+r.toString(),"")}len(){return 0}},Je=class t extends Zr{constructor(r){super();this.value=r}static escape(r){return r.replace(/\$|}|\\/g,"\\$&")}toString(){return this.value}toTextmateString(){return t.escape(this.value)}len(){return this.value.length}clone(){return new t(this.value)}},Dl=class extends Zr{},Ye=class t extends Dl{constructor(r){super();this.index=r}static compareByIndex(r,n){return r.index===n.index?0:r.isFinalTabstop?1:n.isFinalTabstop||r.index<n.index?-1:r.index>n.index?1:0}get isFinalTabstop(){return this.index===0}get choice(){return this._children.length===1&&this._children[0]instanceof Ll?this._children[0]:void 0}toTextmateString(){let r="";return this.transform&&(r=this.transform.toTextmateString()),this.children.length===0&&!this.transform?`$${this.index}`:this.children.length===0?`\${${this.index}${r}}`:this.choice?`\${${this.index}|${this.choice.toTextmateString()}|${r}}`:`\${${this.index}:${this.children.map(n=>n.toTextmateString()).join("")}${r}}`}clone(){let r=new t(this.index);return this.transform&&(r.transform=this.transform.clone()),r._children=this.children.map(n=>n.clone()),r}},Ll=class t extends Zr{constructor(){super(...arguments);this.options=[]}appendChild(r){return r instanceof Je&&(r.parent=this,this.options.push(r)),this}toString(){return this.options[0].value}toTextmateString(){return this.options.map(r=>r.value.replace(/\||,|\\/g,"\\$&")).join(",")}len(){return this.options[0].len()}clone(){let r=new t;return this.options.forEach(r.appendChild,r),r}},yf=class t extends Zr{constructor(){super(...arguments);this.regexp=new RegExp("")}resolve(r){let n=this,o=!1,a=r.replace(this.regexp,function(){return o=!0,n._replace(Array.prototype.slice.call(arguments,0,-2))});return!o&&this._children.some(s=>s instanceof zt&&!!s.elseValue)&&(a=this._replace([])),a}_replace(r){let n="";for(let o of this._children)if(o instanceof zt){let a=r[o.index]||"";a=o.resolve(a),n+=a}else n+=o.toString();return n}toString(){return""}toTextmateString(){return`/${this.regexp.source}/${this.children.map(r=>r.toTextmateString())}/${(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")}`}clone(){let r=new t;return r.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),r._children=this.children.map(n=>n.clone()),r}},zt=class t extends Zr{constructor(r,n,o,a){super();this.index=r;this.shorthandName=n;this.ifValue=o;this.elseValue=a}resolve(r){return this.shorthandName==="upcase"?r?r.toLocaleUpperCase():"":this.shorthandName==="downcase"?r?r.toLocaleLowerCase():"":this.shorthandName==="capitalize"?r?r[0].toLocaleUpperCase()+r.substr(1):"":this.shorthandName==="pascalcase"?r?this._toPascalCase(r):"":this.shorthandName==="camelcase"?r?this._toCamelCase(r):"":r&&typeof this.ifValue=="string"?this.ifValue:!r&&typeof this.elseValue=="string"?this.elseValue:r||""}_toPascalCase(r){let n=r.match(/[a-z0-9]+/gi);return n?n.map(o=>o.charAt(0).toUpperCase()+o.substr(1).toLowerCase()).join(""):r}_toCamelCase(r){let n=r.match(/[a-z0-9]+/gi);return n?n.map((o,a)=>a===0?o.toLowerCase():o.charAt(0).toUpperCase()+o.substr(1).toLowerCase()).join(""):r}toTextmateString(){let r="${";return r+=this.index,this.shorthandName?r+=`:/${this.shorthandName}`:this.ifValue&&this.elseValue?r+=`:?${this.ifValue}:${this.elseValue}`:this.ifValue?r+=`:+${this.ifValue}`:this.elseValue&&(r+=`:-${this.elseValue}`),r+="}",r}clone(){return new t(this.index,this.shorthandName,this.ifValue,this.elseValue)}},Gt=class t extends Dl{constructor(r){super();this.name=r}resolve(r){let n=r.resolve(this);return this.transform&&(n=this.transform.resolve(n||"")),n!==void 0?(this._children=[new Je(n)],!0):!1}toTextmateString(){let r="";return this.transform&&(r=this.transform.toTextmateString()),this.children.length===0?`\${${this.name}${r}}`:`\${${this.name}:${this.children.map(n=>n.toTextmateString()).join("")}${r}}`}clone(){let r=new t(this.name);return this.transform&&(r.transform=this.transform.clone()),r._children=this.children.map(n=>n.clone()),r}};function TS(t,e){let r=[...t];for(;r.length>0;){let n=r.shift();if(!e(n))break;r.unshift(...n.children)}}var Fl=class t extends Zr{get placeholderInfo(){if(!this._placeholders){let e=[],r;this.walk(function(n){return n instanceof Ye&&(e.push(n),r=!r||r.index<n.index?n:r),!0}),this._placeholders={all:e,last:r}}return this._placeholders}get placeholders(){let{all:e}=this.placeholderInfo;return e}offset(e){let r=0,n=!1;return this.walk(o=>o===e?(n=!0,!1):(r+=o.len(),!0)),n?r:-1}fullLen(e){let r=0;return TS([e],n=>(r+=n.len(),!0)),r}enclosingPlaceholders(e){let r=[],{parent:n}=e;for(;n;)n instanceof Ye&&r.push(n),n=n.parent;return r}resolveVariables(e){return this.walk(r=>(r instanceof Gt&&r.resolve(e)&&(this._placeholders=void 0),!0)),this}appendChild(e){return this._placeholders=void 0,super.appendChild(e)}replace(e,r){return this._placeholders=void 0,super.replace(e,r)}toTextmateString(){return this.children.reduce((e,r)=>e+r.toTextmateString(),"")}clone(){let e=new t;return this._children=this.children.map(r=>r.clone()),e}walk(e){TS(this.children,e)}},fr=class{constructor(){this._scanner=new hf;this._token={type:14,pos:0,len:0}}static escape(e){return e.replace(/\$|}|\\/g,"\\$&")}static guessNeedsClipboard(e){return/\${?CLIPBOARD/.test(e)}text(e){return this.parse(e).toString()}parse(e,r,n){this._scanner.text(e),this._token=this._scanner.next();let o=new Fl;for(;this._parse(o););let a=new Map,s=[],c=0;o.walk(p=>(p instanceof Ye&&(c+=1,p.isFinalTabstop?a.set(0,void 0):!a.has(p.index)&&p.children.length>0?a.set(p.index,p.children):s.push(p)),!0));for(let p of s){let l=a.get(p.index);if(l){let u=new Ye(p.index);u.transform=p.transform;for(let m of l)u.appendChild(m.clone());o.replace(p,[u])}}return n||(n=c>0&&r),!a.has(0)&&n&&o.appendChild(new Ye(0)),o}_accept(e,r){if(e===void 0||this._token.type===e){let n=r?this._scanner.tokenText(this._token):!0;return this._token=this._scanner.next(),n}return!1}_backTo(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1}_until(e){let r=this._token;for(;this._token.type!==e;){if(this._token.type===14)return!1;if(this._token.type===5){let o=this._scanner.next();if(o.type!==0&&o.type!==4&&o.type!==5)return!1}this._token=this._scanner.next()}let n=this._scanner.value.substring(r.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),n}_parse(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)}_parseEscaped(e){let r;return(r=this._accept(5,!0))?(r=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||r,e.appendChild(new Je(r)),!0):!1}_parseTabstopOrVariableName(e){let r,n=this._token;return this._accept(0)&&(r=this._accept(9,!0)||this._accept(8,!0))?(e.appendChild(/^\d+$/.test(r)?new Ye(Number(r)):new Gt(r)),!0):this._backTo(n)}_parseComplexPlaceholder(e){let r,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(r=this._accept(8,!0))))return this._backTo(n);let a=new Ye(Number(r));if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(a),!0;if(!this._parse(a))return e.appendChild(new Je("${"+r+":")),a.children.forEach(e.appendChild,e),!0}else if(a.index>0&&this._accept(7)){let s=new Ll;for(;;){if(this._parseChoiceElement(s)){if(this._accept(2))continue;if(this._accept(7)&&(a.appendChild(s),this._accept(4)))return e.appendChild(a),!0}return this._backTo(n),!1}}else return this._accept(6)?this._parseTransform(a)?(e.appendChild(a),!0):(this._backTo(n),!1):this._accept(4)?(e.appendChild(a),!0):this._backTo(n)}_parseChoiceElement(e){let r=this._token,n=[];for(;!(this._token.type===2||this._token.type===7);){let o;if((o=this._accept(5,!0))?o=this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||o:o=this._accept(void 0,!0),!o)return this._backTo(r),!1;n.push(o)}return n.length===0?(this._backTo(r),!1):(e.appendChild(new Je(n.join(""))),!0)}_parseComplexVariable(e){let r,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(r=this._accept(9,!0))))return this._backTo(n);let a=new Gt(r);if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(a),!0;if(!this._parse(a))return e.appendChild(new Je("${"+r+":")),a.children.forEach(e.appendChild,e),!0}else return this._accept(6)?this._parseTransform(a)?(e.appendChild(a),!0):(this._backTo(n),!1):this._accept(4)?(e.appendChild(a),!0):this._backTo(n)}_parseTransform(e){let r=new yf,n="",o="";for(;!this._accept(6);){let a;if(a=this._accept(5,!0)){a=this._accept(6,!0)||a,n+=a;continue}if(this._token.type!==14){n+=this._accept(void 0,!0);continue}return!1}for(;!this._accept(6);){let a;if(a=this._accept(5,!0)){a=this._accept(5,!0)||this._accept(6,!0)||a,r.appendChild(new Je(a));continue}if(!(this._parseFormatString(r)||this._parseAnything(r)))return!1}for(;!this._accept(4);){if(this._token.type!==14){o+=this._accept(void 0,!0);continue}return!1}try{r.regexp=new RegExp(n,o)}catch{return!1}return e.transform=r,!0}_parseFormatString(e){let r=this._token;if(!this._accept(0))return!1;let n=!1;this._accept(3)&&(n=!0);let o=this._accept(8,!0);if(o)if(n){if(this._accept(4))return e.appendChild(new zt(Number(o))),!0;if(!this._accept(1))return this._backTo(r),!1}else return e.appendChild(new zt(Number(o))),!0;else return this._backTo(r),!1;if(this._accept(6)){let a=this._accept(9,!0);return!a||!this._accept(4)?(this._backTo(r),!1):(e.appendChild(new zt(Number(o),a)),!0)}else if(this._accept(11)){let a=this._until(4);if(a)return e.appendChild(new zt(Number(o),void 0,a,void 0)),!0}else if(this._accept(12)){let a=this._until(4);if(a)return e.appendChild(new zt(Number(o),void 0,void 0,a)),!0}else if(this._accept(13)){let a=this._until(1);if(a){let s=this._until(4);if(s)return e.appendChild(new zt(Number(o),void 0,a,s)),!0}}else{let a=this._until(4);if(a)return e.appendChild(new zt(Number(o),void 0,void 0,a)),!0}return this._backTo(r),!1}_parseAnything(e){return this._token.type!==14?(e.appendChild(new Je(this._scanner.tokenText(this._token))),this._accept(void 0),!0):!1}};var Il=Object.freeze({CURRENT_YEAR:!0,CURRENT_YEAR_SHORT:!0,CURRENT_MONTH:!0,CURRENT_DATE:!0,CURRENT_HOUR:!0,CURRENT_MINUTE:!0,CURRENT_SECOND:!0,CURRENT_DAY_NAME:!0,CURRENT_DAY_NAME_SHORT:!0,CURRENT_MONTH_NAME:!0,CURRENT_MONTH_NAME_SHORT:!0,CURRENT_SECONDS_UNIX:!0,SELECTION:!0,CLIPBOARD:!0,TM_SELECTED_TEXT:!0,TM_CURRENT_LINE:!0,TM_CURRENT_WORD:!0,TM_LINE_INDEX:!0,TM_LINE_NUMBER:!0,TM_FILENAME:!0,TM_FILENAME_BASE:!0,TM_DIRECTORY:!0,TM_FILEPATH:!0,RELATIVE_FILEPATH:!0,BLOCK_COMMENT_START:!0,BLOCK_COMMENT_END:!0,LINE_COMMENT:!0,WORKSPACE_NAME:!0,WORKSPACE_FOLDER:!0,RANDOM:!0,RANDOM_HEX:!0,UUID:!0});function Cl(t,e,r){let n=BI(t)+1,o={};t.walk(a=>{if(a instanceof Gt){if(a.name===e)a.name="TM_SELECTED_TEXT";else if(r!=null&&Object.prototype.hasOwnProperty.call(r,a.name))a.parent.replace(a,[new Je(r[a.name])]);else if(!Il[a.name]){let s;a.name in o?s=o[a.name]:(s=n++,o[a.name]=s);let c=new Ye(s);a.children.forEach(p=>c.appendChild(p)),a.parent.replace(a,[c])}}else a instanceof Ye&&(a.index.toString()===e?a.parent.replace(a,[new Gt("TM_SELECTED_TEXT")]):r!=null&&Object.prototype.hasOwnProperty.call(r,a.index)&&a.parent.replace(a,[new Je(r[a.index])]));return!0})}function BI(t){let e=0;return t.walk(r=>(r instanceof Ye&&(e=Math.max(e,r.index)),!0)),e}function Ol(t,e,r){let n=WI(t)+1,o={};t.walk(a=>{if(a instanceof Gt){if(a.name===e)a.name="TM_SELECTED_TEXT";else if(r!=null&&Object.prototype.hasOwnProperty.call(r,a.name))a.parent.replace(a,[new Je(r[a.name])]);else if(!Il[a.name]){let s;a.name in o?s=o[a.name]:(s=n++,o[a.name]=s);let c=new Ye(s);a.children.forEach(p=>c.appendChild(p)),a.parent.replace(a,[c])}}else a instanceof Ye&&a.index.toString()===e&&a.parent.replace(a,[new Gt("TM_SELECTED_TEXT")]);return!0})}function WI(t){let e=0;return t.walk(r=>(r instanceof Ye&&(e=Math.max(e,r.index)),!0)),e}function Nl(t,e,r){let n=e.map(a=>$I(t,a,r)),o=n[0];if(!n.every(a=>a===o))throw new Error("Multiple snippet definitions match the given context");if(o===-1)throw new Error("Couldn't find matching snippet definition");return r[o]}function $I(t,e,r){let n=e.editor.document.languageId,o={multipleTargets:!1};return r.findIndex(({scope:a})=>{if(a==null)return!0;let{langIds:s,scopeTypes:c,excludeDescendantScopeTypes:p}=a;if(s!=null&&!s.includes(n))return!1;if(c!=null){let l=c.concat(p??[]),u,m;for(let d of l)try{let g=t.create({type:"containingScope",scopeType:{type:d}}).run(e,o)[0];e.contentRange.isRangeEqual(g.contentRange)&&(g=t.create({type:"containingScope",scopeType:{type:d},ancestorIndex:1}).run(e,o)[0]),(u==null||u.contentRange.contains(g.contentRange))&&(u=g,m=d)}catch{continue}return m==null?!1:u!=null&&!(p??[]).includes(m)}return!0})}var xS=!1;function Hl(){xS||(un(h().messages,"legacySnippets","Talon community snippets are now fully supported in Cursorless! Cursorless's experimental snippets are now deprecated, but in most cases we can help you migrate automatically. Update cursorless-talon and say 'cursorless migrate snippets'."),xS=!0)}var vS={camelCase(t){if(t.length===0)return"";let[e,...r]=t;return e+r.map(SS).join("")},snakeCase(t){return t.join("_")},upperSnakeCase(t){return t.map(e=>e.toUpperCase()).join("_")},pascalCase(t){return t.map(SS).join("")}};function SS(t){return t.length===0?"":t[0].toUpperCase()+t.substr(1)}var ia=class{constructor(e,r,n,o){this.rangeUpdater=e;this.snippets=r;this.actions=n;this.modifierStageFactory=o;this.snippetParser=new fr;this.run=this.run.bind(this)}getFinalStages(e){let r=this.getScopeTypes(e);return r.length===0?[]:[new Qi(this.modifierStageFactory,{type:"cascading",modifiers:r.map(n=>({type:"containingScope",scopeType:n}))})]}getScopeTypes(e){let{name:r}=e,o=this.snippets.getSnippetStrict(r).insertionScopeTypes;return o==null?[]:o.map(a=>({type:a}))}getSnippetInfo(e,r){let{name:n}=e,o=this.snippets.getSnippetStrict(n),a=Nl(this.modifierStageFactory,r,o.definitions);return{body:a.body.join(`
`),formatSubstitutions(s){return s==null?void 0:jI(o,a,s)}}}async run(e,r){Hl();let n=h().getEditableTextEditor(Ue(e));await this.actions.editNew.run(e);let{body:o,formatSubstitutions:a}=this.getSnippetInfo(r,n.selections.map(l=>new Ge({editor:n,contentRange:l,isReversed:!1,hasExplicitRange:!0}))),s=this.snippetParser.parse(o);Ol(s,null,a(r.substitutions));let c=s.toTextmateString(),{editorSelections:p}=await le({rangeUpdater:this.rangeUpdater,editor:n,callback:()=>n.insertSnippet(c),preserveCursorSelections:!0,selections:{editorSelections:{selections:n.selections,behavior:0}}});return{thatSelections:p.map(l=>({editor:n,selection:l}))}}};function jI(t,e,r){return Object.fromEntries(Object.entries(r).map(([n,o])=>{let a=(e.variables??{})[n]?.formatter??(t.variables??{})[n]?.formatter;if(a==null)return[n,o];let s=vS[a];if(s==null)throw new Error(`Couldn't find formatter ${a} for variable ${n}`);return[n,s(o.split(" "))]}))}var oa=class{constructor(e,r,n,o){this.rangeUpdater=e;this.snippets=r;this.actions=n;this.modifierStageFactory=o;this.snippetParser=new fr;this.run=this.run.bind(this)}getFinalStages(e,r){if(r.type==="named")return this.legacy().getFinalStages(r);let n=Ue(e),a=oo(r,n.document.languageId).scopeTypes??[];return a.length===0?[]:[new Qi(this.modifierStageFactory,{type:"cascading",modifiers:a.map(s=>({type:"containingScope",scopeType:s}))})]}async run(e,r){if(r.type==="named")return this.legacy().run(e,r);let n=h().getEditableTextEditor(Ue(e)),o=oo(r,n.document.languageId),a=this.snippetParser.parse(o.body),s=o.substitutions??r.substitutions;Cl(a,null,s);let c=a.toTextmateString();await this.actions.editNew.run(e);let{editorSelections:p}=await le({rangeUpdater:this.rangeUpdater,editor:n,callback:()=>n.insertSnippet(c),preserveCursorSelections:!0,selections:{editorSelections:{selections:n.selections,behavior:0}}});return{thatSelections:p.map(l=>({editor:n,selection:l}))}}legacy(){return new ia(this.rangeUpdater,this.snippets,this.actions,this.modifierStageFactory)}};var aa=class{constructor(e,r){this.rangeUpdater=e;this.modifierStageFactory=r;this.run=this.run.bind(this)}getFinalStages(){return[this.modifierStageFactory.create(mr)]}async run(e){return await ue(h(),e.map(({thatTarget:n})=>n),"pendingModification0"),{thatSelections:Se(await be(e,async(n,o)=>{let{thatRanges:a}=await le({rangeUpdater:this.rangeUpdater,editor:h().getEditableTextEditor(n),edits:qI(n,o),selections:{thatRanges:o.map(({contentRange:s})=>s)}});return gn(o,a).map(([s,c])=>({editor:n,selection:c.toSelection(s.isReversed)}))}))}}};function qI(t,e){let r=[];for(let n of e){let o=n.textualType==="token"?zI(n):GI(n);r.push(...o)}return r}function zI(t){let{editor:e,contentRange:r}=t,n=ft(e.document.languageId).tokenMatcher,o=It(n,e,r,"forward");return Array.from(gd(o)).map(([a,s])=>({range:new D(a.end,s.start),text:"",isReplace:!0}))}function GI(t){let{document:e}=t.editor,r=t.contentRange,n=r.start.line,o=r.isSingleLine?Math.min(n+1,e.lineCount-1):r.end.line,a=Li($T(n,o+1),s=>e.lineAt(s));return Array.from(gd(a)).map(([s,c])=>({range:new D(s.rangeTrimmed?.end??s.range.end,c.rangeTrimmed?.start??c.range.start),text:c.isEmptyOrWhitespace?"":" ",isReplace:!0}))}var Ul=class{constructor(e,r){this.rangeUpdater=e;this.actions=r;this.run=this.run.bind(this)}async run(e){let r=h().getEditableTextEditor(Ue(e)),n=h().activeEditableTextEditor,o=async()=>{await this.actions.editNew.run(e)},{cursorSelections:a}=await le({rangeUpdater:this.rangeUpdater,editor:r,preserveCursorSelections:!0,callback:o,selections:{cursorSelections:r.selections}}),{originalCursorSelections:s,editorSelections:c}=await le({rangeUpdater:this.rangeUpdater,editor:r,callback:()=>r.clipboardPaste(),selections:{originalCursorSelections:a,editorSelections:{selections:r.selections,behavior:0}}});return await r.setSelections(s),n!=null&&!n.isActive&&await n.focus(),await h().flashRanges(c.map(p=>({editor:r,range:at(p),style:"justAdded"}))),{thatSelections:c.map(p=>({editor:r,selection:p}))}}};var Vl=class{constructor(e){this.rangeUpdater=e;this.runForEditor=this.runForEditor.bind(this)}async run(e){let r=await h().clipboard.readText(),n=r.split(/\r?\n/g),o=e.length===n.length?gn(e,n).map(([s,c])=>({destination:s,text:c})):e.map(s=>({destination:s,text:r}));return{thatSelections:Se(await xr(o,({destination:s})=>s.editor,this.runForEditor))}}async runForEditor(e,r){let n=r.map(({destination:s,text:c})=>s.constructChangeEdit(c)),{editSelections:o}=await le({rangeUpdater:this.rangeUpdater,editor:h().getEditableTextEditor(e),edits:n,selections:{editSelections:{selections:n.map(({range:s})=>s),behavior:0}}}),a=gn(n,o).map(([s,c])=>s.updateRange(c).toSelection(c.isReversed));return await h().flashRanges(a.map(s=>({editor:e,range:at(s),style:"justAdded"}))),a.map(s=>({editor:e,selection:s}))}};var Bl=class{constructor(e,r){this.run=this.run.bind(this),this.runner=h().capabilities.commands.clipboardPaste!=null?new Ul(e,r):new Vl(e)}run(e){return this.runner.run(e)}};var sa=class{constructor(e){this.rangeUpdater=e;this.run=this.run.bind(this),this.runForEditor=this.runForEditor.bind(this)}async run(e,{showDecorations:r=!0}={}){return e=$p(e),r&&await ue(h(),e,"pendingDelete",o=>o.getRemovalHighlightRange()),{thatTargets:Se(await be(e,this.runForEditor))}}async runForEditor(e,r){let n=r.map(s=>s.constructRemovalEdit()),o=h().getEditableTextEditor(e),{editRanges:a}=await le({rangeUpdater:this.rangeUpdater,editor:o,edits:n,selections:{editRanges:n.map(({range:s})=>s)}});return Be(r,a).map(([s,c])=>new Br({editor:s.editor,isReversed:s.isReversed,contentRange:c}))}};var ca=class{constructor(e){this.rangeUpdater=e;this.run=this.run.bind(this)}getTexts(e,r){if(Array.isArray(r))return r.length===1?Array(e.length).fill(r[0]):r;let n=[];for(let o=0;o<e.length;++o)n[o]=(r.start+o).toString();return n}async run(e,r){await ue(h(),e.map(c=>c.target),"pendingModification0");let n=this.getTexts(e,r);if(e.length!==n.length)throw new Error("Targets and texts must have same length");let o=Be(e,n).map(([c,p])=>({editor:c.editor,target:c.target,edit:c.constructChangeEdit(p)})),a=[],s=[];return await xr(o,c=>c.editor,async(c,p)=>{let l=p.map(({edit:d})=>d),{contentSelections:u,editRanges:m}=await le({rangeUpdater:this.rangeUpdater,editor:h().getEditableTextEditor(c),edits:l,selections:{contentSelections:p.map(({target:d})=>d.contentSelection),editRanges:{selections:l.map(({range:d})=>d),behavior:0}}});for(let[d,g]of Be(p,u))a.push(d.target.withContentRange(g));for(let[d,g]of Be(p,m))s.push({editor:c,selection:d.edit.updateRange(g).toSelection(!1)})}),{sourceTargets:a,thatSelections:s}}};var pa=class{constructor(e,r){this.rangeUpdater=e;this.modifierStageFactory=r;this.getFinalStages=()=>[mf(this.modifierStageFactory)];this.run=this.run.bind(this)}async run(e,r,n){let o=e.flatMap(s=>{let c=s.getBoundary();if(c.length!==2)throw Error("Target must have an opening and closing delimiter");return c});await ue(h(),o,"pendingModification0");let a=await be(o,async(s,c)=>{let p=c.map((m,d)=>({editor:s,range:m.contentRange,text:d%2===0?r:n})),{sourceRanges:l,thatRanges:u}=await le({rangeUpdater:this.rangeUpdater,editor:h().getEditableTextEditor(s),edits:p,selections:{sourceRanges:e.map(m=>m.thatTarget.contentRange),thatRanges:e.map(m=>m.contentRange)}});return{sourceMark:Dt(e,l),thatMark:Dt(e,u)}});return{sourceSelections:a.flatMap(({sourceMark:s})=>s),thatSelections:a.flatMap(({thatMark:s})=>s)}}};var la=class{constructor(e){this.at=e;this.run=this.run.bind(this)}async run(e){let r=xs(e,s=>s.editor),n=Array.from(r,([s,c])=>({lineNumber:KI(c,this.at),editor:s})),o=h().activeEditableTextEditor;for(let s of n)await h().getEditableTextEditor(s.editor).revealLine(s.lineNumber,this.at);o!=null&&!o.isActive&&await o.focus();let a=e.filter(s=>{let c=s.editor.visibleRanges,p=c[0].start.line,l=c[c.length-1].end.line;return s.contentRange.start.line>p||s.contentRange.end.line<l||s.contentRange.start.line===p&&s.contentRange.end.line===l});return await h().flashRanges(a.map(s=>({editor:s.editor,range:Pt(s.contentRange),style:"referenced"}))),{thatTargets:e}}},Wl=class extends la{constructor(){super("top")}},$l=class extends la{constructor(){super("center")}},jl=class extends la{constructor(){super("bottom")}};function KI(t,e){let r=Number.MAX_SAFE_INTEGER,n=0;return t.forEach(o=>{r=Math.min(r,o.contentRange.start.line),n=Math.max(n,o.contentRange.end.line)}),e==="top"?r:e==="bottom"?n:Math.floor((r+n)/2)}var Xr=class{constructor(e,r){this.selectionMode=e;this.rangeMode=r;this.run=this.run.bind(this)}async run(e){let r=Ue(e),n=this.getSelections(e),o=this.selectionMode==="add"?r.selections.concat(n):n,a=this.selectionMode==="set"&&o.length===1&&o[0].isEmpty;return await h().getEditableTextEditor(r).setSelections(o,{focusEditor:!0,highlightWord:a}),{thatTargets:e}}getSelections(e){switch(this.rangeMode){case"content":return e.map(r=>r.contentSelection);case"before":return e.map(r=>new Me(r.contentRange.start,r.contentRange.start));case"after":return e.map(r=>new Me(r.contentRange.end,r.contentRange.end))}}},ql=class extends Xr{constructor(){super("set","content")}},zl=class extends Xr{constructor(){super("set","before")}},Gl=class extends Xr{constructor(){super("set","after")}},Kl=class extends Xr{constructor(){super("add","content")}},Ql=class extends Xr{constructor(){super("add","before")}},Jl=class extends Xr{constructor(){super("add","after")}};var ua=class{constructor(e){this.key=e;this.noAutomaticTokenExpansion=!0;this.run=this.run.bind(this)}async run(e){return{thatTargets:e,[`${this.key}Targets`]:e}}};var ma=class{constructor(e){this.treeSitter=e;this.run=this.run.bind(this)}async run(e){await ue(h(),e,"referenced");let r=["# Cursorless parse tree"];for(let n of e){let{editor:o,contentRange:a}=n,s=this.treeSitter.getTree(o.document);r.push(QI(o.document,s,a))}return h().openUntitledTextDocument({language:"markdown",content:r.join(`

`)}),{thatTargets:e}}};function QI(t,e,r){let n=[],o=[];return bS(n,o,r,e.walk(),0),[`## ${t.filename} [${r}]
`,`\`\`\`${t.languageId}`,t.getText(r),"```","","```scm",...o,"```","","```js",...n,"```",""].join(`
`)}function bS(t,e,r,n,o){for(;;){let a=new D(n.startPosition.row,n.startPosition.column,n.endPosition.row,n.endPosition.column);if(r.intersection(a)!=null){let s="  ".repeat(o),c=JI(n),p=s+c;if(n.nodeIsNamed)t.push(`${p}${n.nodeType} [${a}]`),e.push(`${p}(${n.nodeType}`),n.gotoFirstChild()?(bS(t,e,r,n,o+1),n.gotoParent(),e.push(`${s})`)):e[e.length-1]+=")";else{let l=`"${n.nodeType}"`;t.push(`${p}${l} [${a}]`),e.push(`${p}${l}`)}}if(!n.gotoNextSibling())return}}function JI(t){let e=t.currentFieldName;return e!=null?`${e}: `:""}var da=class{constructor(e){this.actions=e;this.run=this.run.bind(this)}async run(e){e.length<2&&un(h().messages,"tooFewTargets",'This action works on multiple targets, e.g. "sort every line block" instead of "sort block".');let r=e.slice().sort((s,c)=>s.contentRange.start.compareTo(c.contentRange.start)),{returnValue:n}=await this.actions.getText.run(r,{showDecorations:!1}),o=this.sortTexts(n),{thatSelections:a}=await this.actions.replace.run(r.map(s=>s.toDestination("to")),o);return{thatSelections:a}}},Yl=class extends da{sortTexts(e){return e.sort((r,n)=>r.localeCompare(n,void 0,{numeric:!0,caseFirst:"upper"}))}},Zl=class extends da{sortTexts(e){return e.reverse()}},Xl=class extends da{sortTexts(e){return Qu(e)}};var fa=class{constructor(e){this.modifierStageFactory=e;this.getFinalStages=()=>[this.modifierStageFactory.create(mr)];this.run=this.run.bind(this)}async run(e){let r=e.map(({thatTarget:n})=>n);return await ue(h(),r,"referenced"),await be(e,async(n,o)=>{let a=o.map(s=>Lt(s,s.contentRange));await h().getEditableTextEditor(n).toggleBreakpoint(a)}),{thatTargets:e}}};var ga=class{constructor(e){this.rangeUpdater=e;this.run=this.run.bind(this)}async run(e,r,n){let o=await be(e,async(a,s)=>{let c=s.map(w=>({start:new Me(w.contentRange.start,w.contentRange.start),end:new Me(w.contentRange.end,w.contentRange.end)})),p=c.flatMap(({start:w,end:I})=>[{text:r,range:w},{text:n,range:I,isReplace:!0}]),l=s.map(w=>w.contentSelection),{boundariesStartSelections:u,boundariesEndSelections:m,sourceSelections:d,thatSelections:g}=await le({rangeUpdater:this.rangeUpdater,editor:h().getEditableTextEditor(a),edits:p,selections:{boundariesStartSelections:{selections:c.map(({start:w})=>w),behavior:2},boundariesEndSelections:{selections:c.map(({end:w})=>w),behavior:3},sourceSelections:{selections:l,behavior:1},thatSelections:{selections:l,behavior:0}}}),b=[...u,...m];return await h().flashRanges(b.map(w=>({editor:a,range:at(w),style:"justAdded"}))),{sourceMark:d.map(w=>({editor:a,selection:w})),thatMark:g.map(w=>({editor:a,selection:w}))}});return{sourceSelections:o.flatMap(({sourceMark:a})=>a),thatSelections:o.flatMap(({thatMark:a})=>a)}}};var ha=class{constructor(e,r,n){this.rangeUpdater=e;this.snippets=r;this.modifierStageFactory=n;this.snippetParser=new fr;this.run=this.run.bind(this)}getFinalStages(e){let r=this.getScopeType(e);return r==null?[]:[new Qr(this.modifierStageFactory,{type:"modifyIfUntyped",modifier:{type:"containingScope",scopeType:r}})]}getScopeType(e){let{name:r,variableName:n}=e,s=(this.snippets.getSnippetStrict(r).variables??{})[n]?.wrapperScopeType;return s==null?void 0:{type:s}}getBody(e,r){let{name:n}=e,o=this.snippets.getSnippetStrict(n);return Nl(this.modifierStageFactory,r,o.definitions).body.join(`
`)}async run(e,r){Hl();let n=h().getEditableTextEditor(Ue(e)),o=this.getBody(r,e),a=this.snippetParser.parse(o);Ol(a,r.variableName);let s=a.toTextmateString();await ue(h(),e,"pendingModification0");let c=e.map(u=>u.contentSelection),p=()=>n.insertSnippet(s,c),{targetSelections:l}=await le({rangeUpdater:this.rangeUpdater,editor:n,callback:p,preserveCursorSelections:!0,selections:{targetSelections:c}});return{thatSelections:l.map(u=>({editor:n,selection:u}))}}};var ya=class{constructor(e,r,n){this.rangeUpdater=e;this.snippets=r;this.modifierStageFactory=n;this.snippetParser=new fr;this.run=this.run.bind(this)}getFinalStages(e,r){if(r.type==="named")return this.legacy().getFinalStages(r);let n=Ue(e),o=oo(r,n.document.languageId);return o.scopeType==null?[]:[new Qr(this.modifierStageFactory,{type:"modifyIfUntyped",modifier:{type:"containingScope",scopeType:o.scopeType}})]}async run(e,r){if(r.type==="named")return this.legacy().run(e,r);let n=h().getEditableTextEditor(Ue(e)),o=oo(r,n.document.languageId),a=this.snippetParser.parse(o.body);Cl(a,o.variableName);let s=a.toTextmateString();await ue(h(),e,"pendingModification0");let c=e.map(l=>l.contentSelection),{targetSelections:p}=await le({rangeUpdater:this.rangeUpdater,editor:n,callback:()=>n.insertSnippet(s,c),preserveCursorSelections:!0,selections:{targetSelections:c}});return{thatSelections:p.map(l=>({editor:n,selection:l}))}}legacy(){return new ha(this.rangeUpdater,this.snippets,this.modifierStageFactory)}};var YI=/-?\d+(\.\d+)?/g,eu=class{constructor(e,r){this.actions=e;this.isIncrement=r;this.run=this.run.bind(this)}async run(e){let r=[];return await xr(e,n=>n.editor,async(n,o)=>{let a=await this.runOnEditor(n,o);r.push(...a)}),{thatSelections:r}}async runOnEditor(e,r){let{document:n}=e,o=[],a=[];for(let c of r){let p=n.offsetAt(c.contentRange.start),l=c.contentText,u=So(l,YI);for(let m of u)o.push(ZI(e,p,m)),a.push(XI(this.isIncrement,m.text))}let{thatSelections:s}=await this.actions.replace.run(o,a);return s}},tu=class extends eu{constructor(e){super(e,!0)}},ru=class extends eu{constructor(e){super(e,!1)}};function ZI(t,e,r){return new ye({editor:t,isReversed:!1,contentRange:new D(t.document.positionAt(e+r.index),t.document.positionAt(e+r.index+r.text.length))}).toDestination("to")}function XI(t,e){return e.includes(".")?tC(t,e).toString():eC(t,e).toString()}function eC(t,e){let r=parseInt(e),n=1;return r+(t?n:-n)}function tC(t,e){let r=parseFloat(e),o=Math.abs(r)<=1?.1:1,a=r+(t?o:-o);return parseFloat(a.toPrecision(15))/1}var nu=class{constructor(e,r,n,o){this.addSelection=new Kl,this.addSelectionBefore=new Ql,this.addSelectionAfter=new Jl,this.callAsFunction=new Qo(this),this.clearAndSetSelection=new Jo(this),this.copyToClipboard=new ul(this,n),this.cutToClipboard=new ml(this),this.decrement=new ru(this),this.deselect=new Yo,this.editNew=new dl(n,this),this.editNewLineAfter=new hl(this,o),this.editNewLineBefore=new gl(this,o),this.executeCommand=new Zo(n),this.extractVariable=new al(n),this.findInDocument=new _l(this),this.findInWorkspace=new Tl(this),this.flashTargets=new xl,this.foldRegion=new Yp(n),this.followLink=new no({openAside:!1}),this.followLinkAside=new no({openAside:!0}),this.generateSnippet=new io(r),this.getText=new ta,this.gitAccept=new sl(n),this.gitRevert=new cl(n),this.gitStage=new pl(n),this.gitUnstage=new ll(n),this.highlight=new ra,this.increment=new tu(this),this.indentLine=new vl(n),this.insertCopyAfter=new Rl(n,o),this.insertCopyBefore=new El(n,o),this.insertEmptyLineAfter=new Pl(n,o),this.insertEmptyLineBefore=new Al(n,o),this.insertEmptyLinesAround=new kl(n,o),this.insertSnippet=new oa(n,r,this,o),this.joinLines=new aa(n,o),this.breakLine=new Wp(n),this.moveToTarget=new qp(n),this.outdentLine=new bl(n),this.pasteFromClipboard=new Bl(n,this),this.randomizeTargets=new Xl(this),this.remove=new sa(n),this.rename=new Xp(n),this.replace=new ca(n),this.replaceWithTarget=new jp(n),this.revealDefinition=new rl(n),this.revealTypeDefinition=new nl(n),this.reverseTargets=new Zl(this),this.rewrapWithPairedDelimiter=new pa(n,o),this.scrollToBottom=new jl,this.scrollToCenter=new $l,this.scrollToTop=new Wl,this.setSelection=new ql,this.setSelectionAfter=new Gl,this.setSelectionBefore=new zl,this.showDebugHover=new ol(n),this.showHover=new il(n),this.showQuickFix=new tl(n),this.showReferences=new el(n),this.sortTargets=new Yl(this),this.swapTargets=new zp(n),this.toggleLineBreakpoint=new fa(o),this.toggleLineComment=new Kp(n),this.unfoldRegion=new Zp(n),this.wrapWithPairedDelimiter=new ga(n),this.wrapWithSnippet=new ya(n,r,o),this["experimental.setInstanceReference"]=new ua("instanceReference"),this["private.showParseTree"]=new ma(e),this["private.getTargets"]=new ea,this["private.setKeyboardTarget"]=new ua("keyboard")}};async function wS(t,e,r){let n=await t.getFocusedElementType();if(n==null||n==="textEditor")return null;let o=r.action;switch(o.name){case"replace":return iu(o.destination)&&Array.isArray(o.replaceWith)?{action:"insert",modifiers:ou(o.destination),text:o.replaceWith.join(`
`)}:null;case"replaceWithTarget":return iu(o.destination)?{action:"insert",modifiers:ou(o.destination),text:await _f(e,o.source)}:null;case"moveToTarget":if(iu(o.destination)){let a=await _f(e,o.source);return await rC(e,o.source),{action:"insert",modifiers:ou(o.destination),text:a}}return null;case"callAsFunction":return au(o.argument)?{action:o.name,modifiers:su(o.argument),callee:await _f(e,o.callee)}:null;case"wrapWithPairedDelimiter":case"rewrapWithPairedDelimiter":return au(o.target)?{action:o.name,modifiers:su(o.target),left:o.left,right:o.right}:null;case"pasteFromClipboard":return iu(o.destination)?{action:o.name,modifiers:ou(o.destination)}:null;case"swapTargets":case"editNew":case"insertSnippet":case"generateSnippet":case"wrapWithSnippet":case"parsed":return null;default:return au(o.target)?{action:o.name,modifiers:su(o.target)}:null}}function iu(t){return t.type==="implicit"?!0:t.type==="primitive"?t.insertionMode==="to"&&au(t.target):!1}function au(t){return t.type==="implicit"?!0:t.type==="primitive"?t.mark==null||t.mark.type==="cursor":!1}function ou(t){return t.type==="primitive"?su(t.target):[]}function su(t){return t.type==="primitive"&&t.modifiers!=null&&t.modifiers.length>0?t.modifiers:[]}async function _f(t,e){return(await t({name:"getText",target:e})).returnValue.join(`
`)}async function rC(t,e){await t({name:"remove",target:e})}function ES(t,e){let{anchor:r,rangeType:n,active:o}=t;if(r.type!=="primitive"||n!=="continuous")return t;let a=r.modifiers.map((s,c)=>[s,c]);for(let[s,c]of a.reverse())for(let p of nC){let l=p.accept(s);if(l.accepted){let[u,m]=[r.modifiers.slice(0,c+1),r.modifiers.slice(c+1)],d={...t,anchor:m.length===0&&e?{type:"implicit"}:{type:"primitive",mark:r.mark,modifiers:m},active:Cs(o,g=>{g.modifiers=g.modifiers.slice(cn(g.modifiers,b=>p.accept(b).accepted)+1)})};return d=l.transformTarget?.(d)??d,{type:"primitive",mark:{type:"target",target:d},modifiers:u}}}return t}var nC=[{accept(t){return t.type==="everyScope"&&t.scopeType.type!=="instance"?{accepted:!0,transformTarget(e){return{...e,exclusionScopeType:t.scopeType}}}:{accepted:!1}}},{accept(t){return{accepted:(t.type==="everyScope"||t.type==="relativeScope"||t.type==="ordinalScope")&&t.scopeType.type==="instance"}}}];function xf(t,e){switch(t.type){case"list":return iC(t,e);case"range":return RS(t,e);case"primitive":return cu(t,e);case"implicit":return t}}function iC(t,e){return{...t,elements:t.elements.map((r,n)=>{let o=e.concat(t.elements.slice(0,n));switch(r.type){case"range":return RS(r,o);case"primitive":return cu(r,o)}})}}function RS(t,e){let r=oC(t,e),n=t.anchor.type==="implicit"||t.anchor.mark==null;return ES(r,n)}function oC(t,e){return{type:"range",rangeType:t.rangeType??"continuous",excludeAnchor:t.excludeAnchor??!1,excludeActive:t.excludeActive??!1,anchor:t.anchor.type==="implicit"?t.anchor:cu(t.anchor,e),active:cu(t.active,e.concat(t.anchor))}}function cu(t,e){let r=Tf(t.mark??(aC(t)?pC(e):null)??{type:"cursor"}),n=kS(t)??lC(e)??uC(e)??[];return{type:t.type,mark:r,modifiers:n}}function aC(t){return t.modifiers?.some(e=>e.type==="inferPreviousMark")??!1}function kS(t){let e=t.modifiers?.filter(r=>r.type!=="inferPreviousMark")??[];return e.length!==0?e:void 0}function sC(t){if(cC(t))return[{type:"containingScope",scopeType:{type:"line"}}]}function cC(t){let e=r=>r?.type==="lineNumber";return e(t.mark)?!0:t.mark?.type==="range"?e(t.mark.anchor)&&e(t.mark.active):!1}function pC(t){return _a(t,e=>e.mark)}function lC(t){return _a(t,kS)}function uC(t){return _a(t,sC)}function _a(t,e){for(let r=t.length-1;r>-1;--r){let n=t[r];switch(n.type){case"primitive":{let o=e(n);if(o!=null)return o;break}case"range":{let o=_a([n.anchor],e);if(o!=null)return o;break}case"list":{let o=_a(n.elements,e);if(o!=null)return o;break}}}}function Tf(t){switch(t.type){case"range":return{...t,anchor:Tf(t.anchor),active:Tf(t.active)};case"target":return{type:"target",target:xf(t.target,[])};default:return t}}var pu=class{constructor(e,r,n,o,a){this.commandServerApi=e;this.debug=r;this.storedTargets=n;this.pipelineRunner=o;this.actions=a;this.finalStages=[];this.runAction=this.runAction.bind(this),this.inferenceContext=new Sf(this.debug)}async run(e){if(Ts(e)){let l=await wS(this.commandServerApi,this.runAction,e);if(l!=null)return{fallback:l}}let{returnValue:r,thatSelections:n,thatTargets:o,sourceSelections:a,sourceTargets:s,instanceReferenceTargets:c,keyboardTargets:p}=await this.runAction(e.action);return this.storedTargets.set("that",AS(o,n)),this.storedTargets.set("source",AS(s,a)),this.storedTargets.set("instanceReference",c),this.storedTargets.set("keyboard",p,{history:!0}),{returnValue:r}}runAction(e){switch(this.inferenceContext.reset(),this.finalStages=[],e.name){case"replaceWithTarget":return this.actions.replaceWithTarget.run(this.getTargets(e.source),this.getDestinations(e.destination));case"moveToTarget":return this.actions.moveToTarget.run(this.getTargets(e.source),this.getDestinations(e.destination));case"swapTargets":return this.actions.swapTargets.run(this.getTargets(e.target1),this.getTargets(e.target2));case"callAsFunction":return this.actions.callAsFunction.run(this.getTargets(e.callee),this.getTargets(e.argument));case"wrapWithPairedDelimiter":return this.actions.wrapWithPairedDelimiter.run(this.getTargets(e.target),e.left,e.right);case"rewrapWithPairedDelimiter":return this.finalStages=this.actions.rewrapWithPairedDelimiter.getFinalStages(),this.actions.rewrapWithPairedDelimiter.run(this.getTargets(e.target),e.left,e.right);case"pasteFromClipboard":return this.actions.pasteFromClipboard.run(this.getDestinations(e.destination));case"executeCommand":return this.actions.executeCommand.run(this.getTargets(e.target),e.commandId,e.options);case"replace":return this.actions.replace.run(this.getDestinations(e.destination),e.replaceWith);case"highlight":return this.actions.highlight.run(this.getTargets(e.target),e.highlightId);case"generateSnippet":return this.actions.generateSnippet.run(this.getTargets(e.target),e.directory,e.snippetName);case"insertSnippet":return this.finalStages=this.actions.insertSnippet.getFinalStages(this.getDestinations(e.destination),e.snippetDescription),this.actions.insertSnippet.run(this.getDestinations(e.destination),e.snippetDescription);case"wrapWithSnippet":return this.finalStages=this.actions.wrapWithSnippet.getFinalStages(this.getTargets(e.target),e.snippetDescription),this.actions.wrapWithSnippet.run(this.getTargets(e.target),e.snippetDescription);case"editNew":return this.actions.editNew.run(this.getDestinations(e.destination));case"getText":return this.actions.getText.run(this.getTargets(e.target),e.options);case"parsed":return this.runAction(js(e.content,e.arguments));default:{let r=this.actions[e.name];if(r==null)throw new Error(`Unknown action: ${e.name}`);return this.finalStages=r.getFinalStages?.()??[],this.noAutomaticTokenExpansion=r.noAutomaticTokenExpansion??!1,r.run(this.getTargets(e.target))}}}getTargets(e){let r=this.inferenceContext.run(e);return this.pipelineRunner.run(r,{actionFinalStages:this.finalStages,noAutomaticTokenExpansion:this.noAutomaticTokenExpansion})}getDestinations(e){switch(e.type){case"list":return e.destinations.flatMap(r=>this.getDestinations(r));case"primitive":return this.getTargets(e.target).map(r=>r.toDestination(e.insertionMode));case"implicit":return this.getTargets({type:"implicit"}).map(r=>r.toDestination("to"))}}},Sf=class{constructor(e){this.debug=e;this.previousTargets=[]}run(e){let r=xf(e,this.previousTargets);return this.debug.active&&(this.debug.log("Full target:"),this.debug.log(JSON.stringify(r,null,2))),this.previousTargets.push(e),r}reset(){this.previousTargets=[]}};function AS(t,e){if(t!=null&&e!=null)throw Error("Actions may only return full targets or selections for that mark");return e!=null?e.map(to):t}var lu=class{constructor(e,r){this.readableHatMap=e;this.mark=r}run(){let e=this.readableHatMap.getToken(this.mark.symbolColor,this.mark.character);if(e==null)throw new Error(`Couldn't find mark ${this.mark.symbolColor} '${this.mark.character}'`);return[new Ge({editor:e.editor,contentRange:e.range,isReversed:!1,hasExplicitRange:!1})]}};var uu=class{constructor(e){this.mark=e}run(){let{editorId:e,range:{start:r,end:n}}=this.mark,o=h().visibleTextEditors.find(s=>s.id===e);if(o==null)throw new Error(`Couldn't find editor '${e}'`);let a=new D(r.line,r.character,n.line,n.character);return[new Ge({editor:o,contentRange:a,isReversed:!1,hasExplicitRange:!1})]}};var mu=class{constructor(e){this.mark=e}run(){let e=h().activeTextEditor;if(e==null)return[];let r=mC(e,this.mark.lineNumberType,this.mark.lineNumber),n=e.document.lineAt(r).range;return[hd(e,!1,n)]}},mC=(t,e,r)=>{switch(e){case"absolute":return r;case"relative":return t.selections[0].active.line+r;case"modulo100":{let o=t.visibleRanges[0].start.line,a=t.visibleRanges[t.visibleRanges.length-1].end.line,s=Math.floor(o/100)*100,c=[],p=[],l=s+r;for(;l<=a;)l>=o&&(t.visibleRanges.find(m=>l>=m.start.line&&l<=m.end.line)?c.push(l):p.push(l)),l+=100;if(c.length===1)return c[0];if(c.length+p.length>1)throw new Error("Multiple lines matching");if(p.length===1)return p[0];throw new Error("Line is not in viewport")}}};var du=class{constructor(e){this.mark=e}run(){return[]}};var fu=class{constructor(e,r){this.markStageFactory=e;this.mark=r}run(){let e=this.markStageFactory.create(this.mark.anchor),r=this.markStageFactory.create(this.mark.active),n=e.run(),o=r.run();if(n.length!==1||o.length!==1)throw new Error("Expected single anchor and active target");return[Jr(n[0],o[0],this.mark.excludeAnchor,this.mark.excludeActive)]}};var gu=class{constructor(e,r){this.storedTargets=e;this.key=r}run(){let e=this.storedTargets.get(this.key);if(e==null||e.length===0)throw Error(`No available ${this.key} marks`);return e}};var hu=class{constructor(e,r){this.targetPipelineRunner=e;this.mark=r}run(){return this.targetPipelineRunner.run(this.mark.target)}};var yu=class{constructor(e,r){this.readableHatMap=e;this.storedTargets=r;this.create=this.create.bind(this)}setPipelineRunner(e){this.targetPipelineRunner=e}create(e){switch(e.type){case"cursor":return new Pi;case"that":case"source":case"keyboard":return new gu(this.storedTargets,e.type);case"decoratedSymbol":return new lu(this.readableHatMap,e);case"lineNumber":return new mu(e);case"range":return new fu(this,e);case"nothing":return new du(e);case"target":return new hu(this.targetPipelineRunner,e);case"explicit":return new uu(e);default:{let r=e,{type:n}=e;throw new Error(`Unknown mark: ${n}`)}}}};async function PS(t,e,r,n,o,a,s,c,p,l){r.active&&(r.log("command:"),r.log(JSON.stringify(l,null,2)));let u=Qm(l),m=await n.getReadableMap(u.usePrePhraseSnapshot),d=fC(t,e,s,r,a,m,o,c);for(let b of p)d=b.wrapCommandRunner(m,d);let g=await d.run(u);return await dC(l,g)}async function dC(t,e){if(Ts(t))return e;if("returnValue"in e)return e.returnValue}function fC(t,e,r,n,o,a,s,c){let p=new eo(r,o,new Ui(r)),l=new yu(a,o),u=new bp(p,l);return l.setPipelineRunner(u),new pu(e,n,o,u,new nu(t,s,c,p))}function MS(t){return Xy(t)?Ao(t.type).replace("."," "):t.type==="surroundingPair"?`Matching pair of ${Ao(t.delimiter)}`:t.type==="customRegex"?`Regex \`${t.regex}\``:"Unknown scope type"}var _u=class{constructor(e){this.customSpokenFormGenerator=e;this.listeners=[];this.disposable=e.onDidChangeCustomSpokenForms(()=>this.onChange()),this.onDidChangeScopeInfo=this.onDidChangeScopeInfo.bind(this),this.getScopeTypeInfo=this.getScopeTypeInfo.bind(this),this.updateScopeTypeInfos()}onDidChangeScopeInfo(e){return e(this.getScopeTypeInfos()),this.listeners.push(e),{dispose:()=>{ot(this.listeners,e)}}}async onChange(){this.updateScopeTypeInfos(),this.listeners.forEach(e=>e(this.scopeInfos))}updateScopeTypeInfos(){let e=[...fn.filter(r=>r!=="instance").map(r=>({type:r})),...ys.map(r=>({type:"surroundingPair",delimiter:r})),...this.customSpokenFormGenerator.getCustomRegexScopeTypes()];this.scopeInfos=e.map(r=>this.getScopeTypeInfo(r))}getScopeTypeInfos(){return this.scopeInfos}getScopeTypeInfo(e){return{scopeType:e,spokenForm:this.customSpokenFormGenerator.scopeTypeToSpokenForm(e),humanReadableName:MS(e),isLanguageSpecific:gC(e)}}dispose(){this.disposable.dispose()}};function gC(t){switch(t.type){case"string":case"argumentOrParameter":case"argumentList":case"anonymousFunction":case"attribute":case"branch":case"class":case"className":case"collectionItem":case"collectionKey":case"command":case"comment":case"private.fieldAccess":case"functionCall":case"functionCallee":case"functionName":case"ifStatement":case"instance":case"interior":case"list":case"map":case"name":case"namedFunction":case"regularExpression":case"statement":case"type":case"value":case"condition":case"section":case"sectionLevelOne":case"sectionLevelTwo":case"sectionLevelThree":case"sectionLevelFour":case"sectionLevelFive":case"sectionLevelSix":case"selector":case"private.switchStatementSubject":case"unit":case"xmlBothTags":case"xmlElement":case"xmlEndTag":case"xmlStartTag":case"part":case"chapter":case"subSection":case"subSubSection":case"namedParagraph":case"subParagraph":case"environment":case"textFragment":case"disqualifyDelimiter":case"pairDelimiter":return!0;case"character":case"word":case"token":case"identifier":case"line":case"sentence":case"paragraph":case"boundedParagraph":case"document":case"nonWhitespaceSequence":case"boundedNonWhitespaceSequence":case"url":case"notebookCell":case"surroundingPair":case"surroundingPairInterior":case"customRegex":case"glyph":return!1;case"oneOf":throw Error(`Can't decide whether scope type ${JSON.stringify(t,void 0,3)} is language-specific`)}}function vf(t,e,r){if(!r)return t.document.range;let n=t.visibleRanges.reduce((s,c)=>s.union(c));n=t.document.range.intersection(n.with(n.start.translate(-10),n.end.translate(10)));let o=rs(Array.from(e.generateScopes(t,n.start,"forward",{containment:"required"})))?.domain??n,a=rs(Array.from(e.generateScopes(t,n.end,"forward",{containment:"required"})))?.domain??n;return o.union(a)}function Vn(t){return{contentRange:t.contentRange,removalRange:t.getRemovalRange(),removalHighlightRange:t.getRemovalHighlightRange(),leadingDelimiter:DS(t.getLeadingDelimiterTarget()),trailingDelimiter:DS(t.getTrailingDelimiterTarget()),interior:t.getInterior()?.map(Vn),boundary:t.getBoundary()?.map(Vn),insertionDelimiter:t.insertionDelimiter}}function DS(t){return t!=null?Vn(t):void 0}function LS(t,e,r,n,o){let a={multipleTargets:!0};return Li(e.generateScopes(t,n.start,"forward",{includeDescendantScopes:!0,distalPosition:n.end}),s=>({domain:s.domain,ranges:s.getTargets(!1).map(c=>({range:c.contentRange,targets:o?hC(r,c,a).map(Vn):void 0}))}))}function hC(t,e,r){try{return t.run(e,r)}catch(n){if(n.name==="NoContainingScopeError")return[];throw n}}function FS(t,e,r){return Li(e.generateScopes(t,r.start,"forward",{includeDescendantScopes:!0,distalPosition:r.end}),n=>({domain:n.domain,targets:n.getTargets(!1).map(Vn)}))}var Tu=class{constructor(e,r){this.scopeHandlerFactory=e;this.modifierStageFactory=r;this.provideScopeRanges=this.provideScopeRanges.bind(this),this.provideIterationScopeRanges=this.provideIterationScopeRanges.bind(this)}provideScopeRanges(e,{scopeType:r,visibleOnly:n}){let o=this.scopeHandlerFactory.maybeCreate(r,e.document.languageId);return o==null?[]:FS(e,o,vf(e,o,n))}provideIterationScopeRanges(e,{scopeType:r,visibleOnly:n,includeNestedTargets:o}){let{languageId:a}=e.document,s=this.scopeHandlerFactory.maybeCreate(r,a);if(s==null)return[];let c=this.scopeHandlerFactory.maybeCreate(s.iterationScopeType,a);return c==null?[]:LS(e,c,this.modifierStageFactory.create({type:"everyScope",scopeType:r}),vf(e,s,n),o)}};var xu=class{constructor(e,r){this.scopeRangeProvider=r;this.disposables=[];this.listeners=[];this.onChange=this.onChange.bind(this),this.onDidChangeScopeRanges=this.onDidChangeScopeRanges.bind(this),this.onDidChangeIterationScopeRanges=this.onDidChangeIterationScopeRanges.bind(this);let n=new ir(h().configuration,()=>this.onChange());this.disposables.push(h().onDidChangeVisibleTextEditors(n.run),h().onDidOpenTextDocument(n.run),h().onDidCloseTextDocument(n.run),h().onDidChangeTextDocument(n.run),h().onDidChangeTextEditorVisibleRanges(n.run),e.onDidChangeDefinition(this.onChange),n)}onDidChangeScopeRanges(e,r){let n=()=>{h().visibleTextEditors.forEach(o=>{let a;try{a=this.scopeRangeProvider.provideScopeRanges(o,r)}catch(s){if(De(h().messages,"ScopeRangeWatcher.provide",s.message),a=[],h().runMode==="test")throw s}e(o,a)})};return this.listeners.push(n),n(),{dispose:()=>{ot(this.listeners,n)}}}onDidChangeIterationScopeRanges(e,r){let n=()=>{h().visibleTextEditors.forEach(o=>{e(o,this.scopeRangeProvider.provideIterationScopeRanges(o,r))})};return this.listeners.push(n),n(),{dispose:()=>{ot(this.listeners,n)}}}onChange(){this.listeners.forEach(e=>e())}dispose(){this.disposables.forEach(({dispose:e})=>{try{e()}catch{}})}};var Su=class{constructor(e){this.scopeHandlerFactory=e;this.getScopeSupport=this.getScopeSupport.bind(this),this.getIterationScopeSupport=this.getIterationScopeSupport.bind(this)}getScopeSupport(e,r){let{languageId:n}=e.document,o=this.scopeHandlerFactory.maybeCreate(r,n);return o==null?2:IS(e,o)?0:1}getIterationScopeSupport(e,r){let{languageId:n}=e.document,o=this.scopeHandlerFactory.maybeCreate(r,n);if(o==null)return 2;let a=this.scopeHandlerFactory.maybeCreate(o.iterationScopeType,n);return a==null?2:IS(e,a)?0:1}};function IS(t,e){return!n_(e.generateScopes(t,new pe(0,0),"forward"))}var vu=class{constructor(e,r,n){this.scopeSupportChecker=r;this.scopeInfoProvider=n;this.listeners=[];this.onChange=this.onChange.bind(this),this.onDidChangeScopeSupport=this.onDidChangeScopeSupport.bind(this);let o=new ir(h().configuration,()=>this.onChange());this.disposable=t_(h().onDidOpenTextDocument(o.run),h().onDidCloseTextDocument(o.run),h().onDidChangeActiveTextEditor(o.run),h().onDidChangeTextDocument(o.run),e.onDidChangeDefinition(o.run),this.scopeInfoProvider.onDidChangeScopeInfo(this.onChange),o)}onDidChangeScopeSupport(e){return e(this.getSupportLevels()),this.listeners.push(e),{dispose:()=>{ot(this.listeners,e)}}}onChange(){if(this.listeners.length===0)return;let e=this.getSupportLevels();this.listeners.forEach(r=>r(e))}getSupportLevels(){let e=h().activeTextEditor,r=e==null?()=>2:a=>this.scopeSupportChecker.getScopeSupport(e,a),n=e==null?()=>2:a=>this.scopeSupportChecker.getIterationScopeSupport(e,a);return this.scopeInfoProvider.getScopeTypeInfos().map(a=>({...a,support:r(a.scopeType),iterationScopeSupport:n(a.scopeType)}))}dispose(){this.disposable.dispose()}};async function CS({ide:t,hats:e,treeSitterQueryProvider:r,treeSitter:n=new bc,commandServerApi:o=new _c,talonSpokenForms:a=new vc,snippets:s=new Sc}){Ym(t);let c=new lc(t),p=new yc,l=new Ys,u=new pc(t,l),m=new Rc(a),d=e!=null?new fc(p,c,e,o):new Tc;d.allocateHats();let g=r?await dp.create(t,n,r):new xc;t.disposeOnExit(p,g,d,c,u);let b=[],w,I=L=>(w=L,PS(n,o,c,d,s,l,g,p,b,L));return{commandApi:{runCommand(L){return I(L)},runCommandSafe(...L){return I(r_(L))},repeatPreviousCommand(){if(w==null)throw new Error("No previous command");return I(w)}},scopeProvider:_C(g,l,m),customSpokenFormGenerator:m,storedTargets:l,hatTokenMap:d,injectIde:Ym,addCommandRunnerDecorator:L=>{b.push(L)}}}function _C(t,e,r){let n=new Ui(t),o=new Tu(n,new eo(t,e,n)),a=new xu(t,o),s=new Su(n),c=new _u(r),p=new vu(t,s,c);return{provideScopeRanges:o.provideScopeRanges,provideIterationScopeRanges:o.provideIterationScopeRanges,onDidChangeScopeRanges:a.onDidChangeScopeRanges,onDidChangeIterationScopeRanges:a.onDidChangeIterationScopeRanges,getScopeSupport:s.getScopeSupport,getIterationScopeSupport:s.getIterationScopeSupport,onDidChangeScopeSupport:p.onDidChangeScopeSupport,getScopeInfo:c.getScopeTypeInfo,onDidChangeScopeInfo:c.onDidChangeScopeInfo}}var ede=Symbol("unused");var Ta=class{constructor(e){this.position=e}},tde={$0:new Ta(0),$1:new Ta(1),$2:new Ta(2)};var TC=Object.defineProperty,v=(t,e)=>TC(t,"name",{value:e,configurable:!0}),OS=2,z=4,bf=4*z,_t=5*z,gr=2*z,va=2*z+2*gr,en={row:0,column:0},rn=Symbol("INTERNAL");function lo(t){if(t!==rn)throw new Error("Illegal constructor")}v(lo,"assertInternal");function Sa(t){return!!t&&typeof t.row=="number"&&typeof t.column=="number"}v(Sa,"isPoint");function HS(t){f=t}v(HS,"setModule");var f,ao,xC=(ao=class{constructor(e,r,n){re(this,0,0);re(this,"language");lo(e),this[0]=r,this.language=n}get currentTypeId(){return f._ts_lookahead_iterator_current_symbol(this[0])}get currentType(){return this.language.types[this.currentTypeId]||"ERROR"}delete(){f._ts_lookahead_iterator_delete(this[0]),this[0]=0}reset(e,r){return f._ts_lookahead_iterator_reset(this[0],e[0],r)?(this.language=e,!0):!1}resetState(e){return!!f._ts_lookahead_iterator_reset_state(this[0],e)}[Symbol.iterator](){return{next:v(()=>f._ts_lookahead_iterator_next(this[0])?{done:!1,value:this.currentType}:{done:!0,value:""},"next")}}},v(ao,"LookaheadIterator"),ao);function kf(t,e,r,n){let o=r-e,a=t.textCallback(e,n);if(a){for(e+=a.length;e<r;){let s=t.textCallback(e,n);if(s&&s.length>0)e+=s.length,a+=s;else break}e>r&&(a=a.slice(0,o))}return a??""}v(kf,"getText");var tn,SC=(tn=class{constructor(e,r,n,o){re(this,0,0);re(this,"textCallback");re(this,"language");lo(e),this[0]=r,this.language=n,this.textCallback=o}copy(){let e=f._ts_tree_copy(this[0]);return new tn(rn,e,this.language,this.textCallback)}delete(){f._ts_tree_delete(this[0]),this[0]=0}get rootNode(){return f._ts_tree_root_node_wasm(this[0]),Ee(this)}rootNodeWithOffset(e,r){let n=$+_t;return f.setValue(n,e,"i32"),Ut(n+z,r),f._ts_tree_root_node_with_offset_wasm(this[0]),Ee(this)}edit(e){VS(e),f._ts_tree_edit_wasm(this[0])}walk(){return this.rootNode.walk()}getChangedRanges(e){if(!(e instanceof tn))throw new TypeError("Argument must be a Tree");f._ts_tree_get_changed_ranges_wasm(this[0],e[0]);let r=f.getValue($,"i32"),n=f.getValue($+z,"i32"),o=new Array(r);if(r>0){let a=n;for(let s=0;s<r;s++)o[s]=wu(a),a+=va;f._free(n)}return o}getIncludedRanges(){f._ts_tree_included_ranges_wasm(this[0]);let e=f.getValue($,"i32"),r=f.getValue($+z,"i32"),n=new Array(e);if(e>0){let o=r;for(let a=0;a<e;a++)n[a]=wu(o),o+=va;f._free(r)}return n}},v(tn,"Tree"),tn),Wn,vC=(Wn=class{constructor(e,r){re(this,0,0);re(this,1,0);re(this,2,0);re(this,3,0);re(this,"tree");lo(e),this.tree=r,Et(this)}copy(){let e=new Wn(rn,this.tree);return f._ts_tree_cursor_copy_wasm(this.tree[0]),Et(e),e}delete(){Te(this),f._ts_tree_cursor_delete_wasm(this.tree[0]),this[0]=this[1]=this[2]=0}get currentNode(){return Te(this),f._ts_tree_cursor_current_node_wasm(this.tree[0]),Ee(this.tree)}get currentFieldId(){return Te(this),f._ts_tree_cursor_current_field_id_wasm(this.tree[0])}get currentFieldName(){return this.tree.language.fields[this.currentFieldId]}get currentDepth(){return Te(this),f._ts_tree_cursor_current_depth_wasm(this.tree[0])}get currentDescendantIndex(){return Te(this),f._ts_tree_cursor_current_descendant_index_wasm(this.tree[0])}get nodeType(){return this.tree.language.types[this.nodeTypeId]||"ERROR"}get nodeTypeId(){return Te(this),f._ts_tree_cursor_current_node_type_id_wasm(this.tree[0])}get nodeStateId(){return Te(this),f._ts_tree_cursor_current_node_state_id_wasm(this.tree[0])}get nodeId(){return Te(this),f._ts_tree_cursor_current_node_id_wasm(this.tree[0])}get nodeIsNamed(){return Te(this),f._ts_tree_cursor_current_node_is_named_wasm(this.tree[0])===1}get nodeIsMissing(){return Te(this),f._ts_tree_cursor_current_node_is_missing_wasm(this.tree[0])===1}get nodeText(){Te(this);let e=f._ts_tree_cursor_start_index_wasm(this.tree[0]),r=f._ts_tree_cursor_end_index_wasm(this.tree[0]);f._ts_tree_cursor_start_position_wasm(this.tree[0]);let n=Bn($);return kf(this.tree,e,r,n)}get startPosition(){return Te(this),f._ts_tree_cursor_start_position_wasm(this.tree[0]),Bn($)}get endPosition(){return Te(this),f._ts_tree_cursor_end_position_wasm(this.tree[0]),Bn($)}get startIndex(){return Te(this),f._ts_tree_cursor_start_index_wasm(this.tree[0])}get endIndex(){return Te(this),f._ts_tree_cursor_end_index_wasm(this.tree[0])}gotoFirstChild(){Te(this);let e=f._ts_tree_cursor_goto_first_child_wasm(this.tree[0]);return Et(this),e===1}gotoLastChild(){Te(this);let e=f._ts_tree_cursor_goto_last_child_wasm(this.tree[0]);return Et(this),e===1}gotoParent(){Te(this);let e=f._ts_tree_cursor_goto_parent_wasm(this.tree[0]);return Et(this),e===1}gotoNextSibling(){Te(this);let e=f._ts_tree_cursor_goto_next_sibling_wasm(this.tree[0]);return Et(this),e===1}gotoPreviousSibling(){Te(this);let e=f._ts_tree_cursor_goto_previous_sibling_wasm(this.tree[0]);return Et(this),e===1}gotoDescendant(e){Te(this),f._ts_tree_cursor_goto_descendant_wasm(this.tree[0],e),Et(this)}gotoFirstChildForIndex(e){Te(this),f.setValue($+bf,e,"i32");let r=f._ts_tree_cursor_goto_first_child_for_index_wasm(this.tree[0]);return Et(this),r===1}gotoFirstChildForPosition(e){Te(this),Ut($+bf,e);let r=f._ts_tree_cursor_goto_first_child_for_position_wasm(this.tree[0]);return Et(this),r===1}reset(e){ne(e),Te(this,$+_t),f._ts_tree_cursor_reset_wasm(this.tree[0]),Et(this)}resetTo(e){Te(this,$),Te(e,$+bf),f._ts_tree_cursor_reset_to_wasm(this.tree[0],e.tree[0]),Et(this)}},v(Wn,"TreeCursor"),Wn),so,bC=(so=class{constructor(e,{id:r,tree:n,startIndex:o,startPosition:a,other:s}){re(this,0,0);re(this,"_children");re(this,"_namedChildren");re(this,"id");re(this,"startIndex");re(this,"startPosition");re(this,"tree");lo(e),this[0]=s,this.id=r,this.tree=n,this.startIndex=o,this.startPosition=a}get typeId(){return ne(this),f._ts_node_symbol_wasm(this.tree[0])}get grammarId(){return ne(this),f._ts_node_grammar_symbol_wasm(this.tree[0])}get type(){return this.tree.language.types[this.typeId]||"ERROR"}get grammarType(){return this.tree.language.types[this.grammarId]||"ERROR"}get isNamed(){return ne(this),f._ts_node_is_named_wasm(this.tree[0])===1}get isExtra(){return ne(this),f._ts_node_is_extra_wasm(this.tree[0])===1}get isError(){return ne(this),f._ts_node_is_error_wasm(this.tree[0])===1}get isMissing(){return ne(this),f._ts_node_is_missing_wasm(this.tree[0])===1}get hasChanges(){return ne(this),f._ts_node_has_changes_wasm(this.tree[0])===1}get hasError(){return ne(this),f._ts_node_has_error_wasm(this.tree[0])===1}get endIndex(){return ne(this),f._ts_node_end_index_wasm(this.tree[0])}get endPosition(){return ne(this),f._ts_node_end_point_wasm(this.tree[0]),Bn($)}get text(){return kf(this.tree,this.startIndex,this.endIndex,this.startPosition)}get parseState(){return ne(this),f._ts_node_parse_state_wasm(this.tree[0])}get nextParseState(){return ne(this),f._ts_node_next_parse_state_wasm(this.tree[0])}equals(e){return this.tree===e.tree&&this.id===e.id}child(e){return ne(this),f._ts_node_child_wasm(this.tree[0],e),Ee(this.tree)}namedChild(e){return ne(this),f._ts_node_named_child_wasm(this.tree[0],e),Ee(this.tree)}childForFieldId(e){return ne(this),f._ts_node_child_by_field_id_wasm(this.tree[0],e),Ee(this.tree)}childForFieldName(e){let r=this.tree.language.fields.indexOf(e);return r!==-1?this.childForFieldId(r):null}fieldNameForChild(e){ne(this);let r=f._ts_node_field_name_for_child_wasm(this.tree[0],e);return r?f.AsciiToString(r):null}fieldNameForNamedChild(e){ne(this);let r=f._ts_node_field_name_for_named_child_wasm(this.tree[0],e);return r?f.AsciiToString(r):null}childrenForFieldName(e){let r=this.tree.language.fields.indexOf(e);return r!==-1&&r!==0?this.childrenForFieldId(r):[]}childrenForFieldId(e){ne(this),f._ts_node_children_by_field_id_wasm(this.tree[0],e);let r=f.getValue($,"i32"),n=f.getValue($+z,"i32"),o=new Array(r);if(r>0){let a=n;for(let s=0;s<r;s++)o[s]=Ee(this.tree,a),a+=_t;f._free(n)}return o}firstChildForIndex(e){ne(this);let r=$+_t;return f.setValue(r,e,"i32"),f._ts_node_first_child_for_byte_wasm(this.tree[0]),Ee(this.tree)}firstNamedChildForIndex(e){ne(this);let r=$+_t;return f.setValue(r,e,"i32"),f._ts_node_first_named_child_for_byte_wasm(this.tree[0]),Ee(this.tree)}get childCount(){return ne(this),f._ts_node_child_count_wasm(this.tree[0])}get namedChildCount(){return ne(this),f._ts_node_named_child_count_wasm(this.tree[0])}get firstChild(){return this.child(0)}get firstNamedChild(){return this.namedChild(0)}get lastChild(){return this.child(this.childCount-1)}get lastNamedChild(){return this.namedChild(this.namedChildCount-1)}get children(){if(!this._children){ne(this),f._ts_node_children_wasm(this.tree[0]);let e=f.getValue($,"i32"),r=f.getValue($+z,"i32");if(this._children=new Array(e),e>0){let n=r;for(let o=0;o<e;o++)this._children[o]=Ee(this.tree,n),n+=_t;f._free(r)}}return this._children}get namedChildren(){if(!this._namedChildren){ne(this),f._ts_node_named_children_wasm(this.tree[0]);let e=f.getValue($,"i32"),r=f.getValue($+z,"i32");if(this._namedChildren=new Array(e),e>0){let n=r;for(let o=0;o<e;o++)this._namedChildren[o]=Ee(this.tree,n),n+=_t;f._free(r)}}return this._namedChildren}descendantsOfType(e,r=en,n=en){Array.isArray(e)||(e=[e]);let o=[],a=this.tree.language.types;for(let u of e)u=="ERROR"&&o.push(65535);for(let u=0,m=a.length;u<m;u++)e.includes(a[u])&&o.push(u);let s=f._malloc(z*o.length);for(let u=0,m=o.length;u<m;u++)f.setValue(s+u*z,o[u],"i32");ne(this),f._ts_node_descendants_of_type_wasm(this.tree[0],s,o.length,r.row,r.column,n.row,n.column);let c=f.getValue($,"i32"),p=f.getValue($+z,"i32"),l=new Array(c);if(c>0){let u=p;for(let m=0;m<c;m++)l[m]=Ee(this.tree,u),u+=_t}return f._free(p),f._free(s),l}get nextSibling(){return ne(this),f._ts_node_next_sibling_wasm(this.tree[0]),Ee(this.tree)}get previousSibling(){return ne(this),f._ts_node_prev_sibling_wasm(this.tree[0]),Ee(this.tree)}get nextNamedSibling(){return ne(this),f._ts_node_next_named_sibling_wasm(this.tree[0]),Ee(this.tree)}get previousNamedSibling(){return ne(this),f._ts_node_prev_named_sibling_wasm(this.tree[0]),Ee(this.tree)}get descendantCount(){return ne(this),f._ts_node_descendant_count_wasm(this.tree[0])}get parent(){return ne(this),f._ts_node_parent_wasm(this.tree[0]),Ee(this.tree)}childWithDescendant(e){return ne(this),ne(e,1),f._ts_node_child_with_descendant_wasm(this.tree[0]),Ee(this.tree)}descendantForIndex(e,r=e){if(typeof e!="number"||typeof r!="number")throw new Error("Arguments must be numbers");ne(this);let n=$+_t;return f.setValue(n,e,"i32"),f.setValue(n+z,r,"i32"),f._ts_node_descendant_for_index_wasm(this.tree[0]),Ee(this.tree)}namedDescendantForIndex(e,r=e){if(typeof e!="number"||typeof r!="number")throw new Error("Arguments must be numbers");ne(this);let n=$+_t;return f.setValue(n,e,"i32"),f.setValue(n+z,r,"i32"),f._ts_node_named_descendant_for_index_wasm(this.tree[0]),Ee(this.tree)}descendantForPosition(e,r=e){if(!Sa(e)||!Sa(r))throw new Error("Arguments must be {row, column} objects");ne(this);let n=$+_t;return Ut(n,e),Ut(n+gr,r),f._ts_node_descendant_for_position_wasm(this.tree[0]),Ee(this.tree)}namedDescendantForPosition(e,r=e){if(!Sa(e)||!Sa(r))throw new Error("Arguments must be {row, column} objects");ne(this);let n=$+_t;return Ut(n,e),Ut(n+gr,r),f._ts_node_named_descendant_for_position_wasm(this.tree[0]),Ee(this.tree)}walk(){return ne(this),f._ts_tree_cursor_new_wasm(this.tree[0]),new vC(rn,this.tree)}edit(e){if(this.startIndex>=e.oldEndIndex){this.startIndex=e.newEndIndex+(this.startIndex-e.oldEndIndex);let r,n;this.startPosition.row>e.oldEndPosition.row?(r=this.startPosition.row-e.oldEndPosition.row,n=this.startPosition.column):(r=0,n=this.startPosition.column,this.startPosition.column>=e.oldEndPosition.column&&(n=this.startPosition.column-e.oldEndPosition.column)),r>0?(this.startPosition.row+=r,this.startPosition.column=n):this.startPosition.column+=n}else this.startIndex>e.startIndex&&(this.startIndex=e.newEndIndex,this.startPosition.row=e.newEndPosition.row,this.startPosition.column=e.newEndPosition.column)}toString(){ne(this);let e=f._ts_node_to_string_wasm(this.tree[0]),r=f.AsciiToString(e);return f._free(e),r}},v(so,"Node"),so);function Rf(t,e,r,n,o){for(let a=0,s=o.length;a<s;a++){let c=f.getValue(r,"i32");r+=z;let p=Ee(e,r);r+=_t,o[a]={patternIndex:n,name:t.captureNames[c],node:p}}return r}v(Rf,"unmarshalCaptures");function ne(t,e=0){let r=$+e*_t;f.setValue(r,t.id,"i32"),r+=z,f.setValue(r,t.startIndex,"i32"),r+=z,f.setValue(r,t.startPosition.row,"i32"),r+=z,f.setValue(r,t.startPosition.column,"i32"),r+=z,f.setValue(r,t[0],"i32")}v(ne,"marshalNode");function Ee(t,e=$){let r=f.getValue(e,"i32");if(e+=z,r===0)return null;let n=f.getValue(e,"i32");e+=z;let o=f.getValue(e,"i32");e+=z;let a=f.getValue(e,"i32");e+=z;let s=f.getValue(e,"i32");return new bC(rn,{id:r,tree:t,startIndex:n,startPosition:{row:o,column:a},other:s})}v(Ee,"unmarshalNode");function Te(t,e=$){f.setValue(e+0*z,t[0],"i32"),f.setValue(e+1*z,t[1],"i32"),f.setValue(e+2*z,t[2],"i32"),f.setValue(e+3*z,t[3],"i32")}v(Te,"marshalTreeCursor");function Et(t){t[0]=f.getValue($+0*z,"i32"),t[1]=f.getValue($+1*z,"i32"),t[2]=f.getValue($+2*z,"i32"),t[3]=f.getValue($+3*z,"i32")}v(Et,"unmarshalTreeCursor");function Ut(t,e){f.setValue(t,e.row,"i32"),f.setValue(t+z,e.column,"i32")}v(Ut,"marshalPoint");function Bn(t){return{row:f.getValue(t,"i32")>>>0,column:f.getValue(t+z,"i32")>>>0}}v(Bn,"unmarshalPoint");function US(t,e){Ut(t,e.startPosition),t+=gr,Ut(t,e.endPosition),t+=gr,f.setValue(t,e.startIndex,"i32"),t+=z,f.setValue(t,e.endIndex,"i32"),t+=z}v(US,"marshalRange");function wu(t){let e={};return e.startPosition=Bn(t),t+=gr,e.endPosition=Bn(t),t+=gr,e.startIndex=f.getValue(t,"i32")>>>0,t+=z,e.endIndex=f.getValue(t,"i32")>>>0,e}v(wu,"unmarshalRange");function VS(t,e=$){Ut(e,t.startPosition),e+=gr,Ut(e,t.oldEndPosition),e+=gr,Ut(e,t.newEndPosition),e+=gr,f.setValue(e,t.startIndex,"i32"),e+=z,f.setValue(e,t.oldEndIndex,"i32"),e+=z,f.setValue(e,t.newEndIndex,"i32"),e+=z}v(VS,"marshalEdit");function BS(t){let e={};return e.major_version=f.getValue(t,"i32"),t+=z,e.minor_version=f.getValue(t,"i32"),t+=z,e.field_count=f.getValue(t,"i32"),e}v(BS,"unmarshalLanguageMetadata");var wC=1,EC=2,RC=/[\w-]+/g,vde={Zero:0,ZeroOrOne:1,ZeroOrMore:2,One:3,OneOrMore:4},NS=v(t=>t.type==="capture","isCaptureStep"),Af=v(t=>t.type==="string","isStringStep"),Kt={Syntax:1,NodeName:2,FieldName:3,CaptureName:4,PatternStructure:5},$n,xa=($n=class extends Error{constructor(e,r,n,o){super($n.formatMessage(e,r)),this.kind=e,this.info=r,this.index=n,this.length=o,this.name="QueryError"}static formatMessage(e,r){switch(e){case Kt.NodeName:return`Bad node name '${r.word}'`;case Kt.FieldName:return`Bad field name '${r.word}'`;case Kt.CaptureName:return`Bad capture name @${r.word}`;case Kt.PatternStructure:return`Bad pattern structure at offset ${r.suffix}`;case Kt.Syntax:return`Bad syntax at offset ${r.suffix}`}}},v($n,"QueryError"),$n);function WS(t,e,r,n){if(t.length!==3)throw new Error(`Wrong number of arguments to \`#${r}\` predicate. Expected 2, got ${t.length-1}`);if(!NS(t[1]))throw new Error(`First argument of \`#${r}\` predicate must be a capture. Got "${t[1].value}"`);let o=r==="eq?"||r==="any-eq?",a=!r.startsWith("any-");if(NS(t[2])){let s=t[1].name,c=t[2].name;n[e].push(p=>{let l=[],u=[];for(let d of p)d.name===s&&l.push(d.node),d.name===c&&u.push(d.node);let m=v((d,g,b)=>b?d.text===g.text:d.text!==g.text,"compare");return a?l.every(d=>u.some(g=>m(d,g,o))):l.some(d=>u.some(g=>m(d,g,o)))})}else{let s=t[1].name,c=t[2].value,p=v(u=>u.text===c,"matches"),l=v(u=>u.text!==c,"doesNotMatch");n[e].push(u=>{let m=[];for(let g of u)g.name===s&&m.push(g.node);let d=o?p:l;return a?m.every(d):m.some(d)})}}v(WS,"parseAnyPredicate");function $S(t,e,r,n){if(t.length!==3)throw new Error(`Wrong number of arguments to \`#${r}\` predicate. Expected 2, got ${t.length-1}.`);if(t[1].type!=="capture")throw new Error(`First argument of \`#${r}\` predicate must be a capture. Got "${t[1].value}".`);if(t[2].type!=="string")throw new Error(`Second argument of \`#${r}\` predicate must be a string. Got @${t[2].name}.`);let o=r==="match?"||r==="any-match?",a=!r.startsWith("any-"),s=t[1].name,c=new RegExp(t[2].value);n[e].push(p=>{let l=[];for(let m of p)m.name===s&&l.push(m.node.text);let u=v((m,d)=>d?c.test(m):!c.test(m),"test");return l.length===0?!o:a?l.every(m=>u(m,o)):l.some(m=>u(m,o))})}v($S,"parseMatchPredicate");function jS(t,e,r,n){if(t.length<2)throw new Error(`Wrong number of arguments to \`#${r}\` predicate. Expected at least 1. Got ${t.length-1}.`);if(t[1].type!=="capture")throw new Error(`First argument of \`#${r}\` predicate must be a capture. Got "${t[1].value}".`);let o=r==="any-of?",a=t[1].name,s=t.slice(2);if(!s.every(Af))throw new Error(`Arguments to \`#${r}\` predicate must be strings.".`);let c=s.map(p=>p.value);n[e].push(p=>{let l=[];for(let u of p)u.name===a&&l.push(u.node.text);return l.length===0?!o:l.every(u=>c.includes(u))===o})}v(jS,"parseAnyOfPredicate");function qS(t,e,r,n,o){if(t.length<2||t.length>3)throw new Error(`Wrong number of arguments to \`#${r}\` predicate. Expected 1 or 2. Got ${t.length-1}.`);if(!t.every(Af))throw new Error(`Arguments to \`#${r}\` predicate must be strings.".`);let a=r==="is?"?n:o;a[e]||(a[e]={}),a[e][t[1].value]=t[2]?.value??null}v(qS,"parseIsPredicate");function zS(t,e,r){if(t.length<2||t.length>3)throw new Error(`Wrong number of arguments to \`#set!\` predicate. Expected 1 or 2. Got ${t.length-1}.`);if(!t.every(Af))throw new Error('Arguments to `#set!` predicate must be strings.".');r[e]||(r[e]={}),r[e][t[1].value]=t[2]?.value??null}v(zS,"parseSetDirective");function GS(t,e,r,n,o,a,s,c,p,l,u){if(e===wC){let m=n[r];a.push({type:"capture",name:m})}else if(e===EC)a.push({type:"string",value:o[r]});else if(a.length>0){if(a[0].type!=="string")throw new Error("Predicates must begin with a literal value");let m=a[0].value;switch(m){case"any-not-eq?":case"not-eq?":case"any-eq?":case"eq?":WS(a,t,m,s);break;case"any-not-match?":case"not-match?":case"any-match?":case"match?":$S(a,t,m,s);break;case"not-any-of?":case"any-of?":jS(a,t,m,s);break;case"is?":case"is-not?":qS(a,t,m,l,u);break;case"set!":zS(a,t,p);break;default:c[t].push({operator:m,operands:a.slice(1)})}a.length=0}}v(GS,"parsePattern");var co,Pf=(co=class{constructor(e,r){re(this,0,0);re(this,"exceededMatchLimit");re(this,"textPredicates");re(this,"captureNames");re(this,"captureQuantifiers");re(this,"predicates");re(this,"setProperties");re(this,"assertedProperties");re(this,"refutedProperties");re(this,"matchLimit");let n=f.lengthBytesUTF8(r),o=f._malloc(n+1);f.stringToUTF8(r,o,n+1);let a=f._ts_query_new(e[0],o,n,$,$+z);if(!a){let L=f.getValue($+z,"i32"),H=f.getValue($,"i32"),X=f.UTF8ToString(o,H).length,fe=r.slice(X,X+100).split(`
`)[0],J=fe.match(RC)?.[0]??"";switch(f._free(o),L){case Kt.Syntax:throw new xa(Kt.Syntax,{suffix:`${X}: '${fe}'...`},X,0);case Kt.NodeName:throw new xa(L,{word:J},X,J.length);case Kt.FieldName:throw new xa(L,{word:J},X,J.length);case Kt.CaptureName:throw new xa(L,{word:J},X,J.length);case Kt.PatternStructure:throw new xa(L,{suffix:`${X}: '${fe}'...`},X,0)}}let s=f._ts_query_string_count(a),c=f._ts_query_capture_count(a),p=f._ts_query_pattern_count(a),l=new Array(c),u=new Array(p),m=new Array(s);for(let L=0;L<c;L++){let H=f._ts_query_capture_name_for_id(a,L,$),X=f.getValue($,"i32");l[L]=f.UTF8ToString(H,X)}for(let L=0;L<p;L++){let H=new Array(c);for(let X=0;X<c;X++){let fe=f._ts_query_capture_quantifier_for_id(a,L,X);H[X]=fe}u[L]=H}for(let L=0;L<s;L++){let H=f._ts_query_string_value_for_id(a,L,$),X=f.getValue($,"i32");m[L]=f.UTF8ToString(H,X)}let d=new Array(p),g=new Array(p),b=new Array(p),w=new Array(p),I=new Array(p);for(let L=0;L<p;L++){let H=f._ts_query_predicates_for_pattern(a,L,$),X=f.getValue($,"i32");w[L]=[],I[L]=[];let fe=new Array,J=H;for(let oe=0;oe<X;oe++){let rt=f.getValue(J,"i32");J+=z;let Ze=f.getValue(J,"i32");J+=z,GS(L,rt,Ze,l,m,fe,I,w,d,g,b)}Object.freeze(I[L]),Object.freeze(w[L]),Object.freeze(d[L]),Object.freeze(g[L]),Object.freeze(b[L])}f._free(o),this[0]=a,this.captureNames=l,this.captureQuantifiers=u,this.textPredicates=I,this.predicates=w,this.setProperties=d,this.assertedProperties=g,this.refutedProperties=b,this.exceededMatchLimit=!1}delete(){f._ts_query_delete(this[0]),this[0]=0}matches(e,r={}){let n=r.startPosition??en,o=r.endPosition??en,a=r.startIndex??0,s=r.endIndex??0,c=r.matchLimit??4294967295,p=r.maxStartDepth??4294967295,l=r.timeoutMicros??0,u=r.progressCallback;if(typeof c!="number")throw new Error("Arguments must be numbers");if(this.matchLimit=c,s!==0&&a>s)throw new Error("`startIndex` cannot be greater than `endIndex`");if(o!==en&&(n.row>o.row||n.row===o.row&&n.column>o.column))throw new Error("`startPosition` cannot be greater than `endPosition`");u&&(f.currentQueryProgressCallback=u),ne(e),f._ts_query_matches_wasm(this[0],e.tree[0],n.row,n.column,o.row,o.column,a,s,c,p,l);let m=f.getValue($,"i32"),d=f.getValue($+z,"i32"),g=f.getValue($+2*z,"i32"),b=new Array(m);this.exceededMatchLimit=!!g;let w=0,I=d;for(let L=0;L<m;L++){let H=f.getValue(I,"i32");I+=z;let X=f.getValue(I,"i32");I+=z;let fe=new Array(X);if(I=Rf(this,e.tree,I,H,fe),this.textPredicates[H].every(J=>J(fe))){b[w]={pattern:H,patternIndex:H,captures:fe};let J=this.setProperties[H];b[w].setProperties=J;let oe=this.assertedProperties[H];b[w].assertedProperties=oe;let rt=this.refutedProperties[H];b[w].refutedProperties=rt,w++}}return b.length=w,f._free(d),f.currentQueryProgressCallback=null,b}captures(e,r={}){let n=r.startPosition??en,o=r.endPosition??en,a=r.startIndex??0,s=r.endIndex??0,c=r.matchLimit??4294967295,p=r.maxStartDepth??4294967295,l=r.timeoutMicros??0,u=r.progressCallback;if(typeof c!="number")throw new Error("Arguments must be numbers");if(this.matchLimit=c,s!==0&&a>s)throw new Error("`startIndex` cannot be greater than `endIndex`");if(o!==en&&(n.row>o.row||n.row===o.row&&n.column>o.column))throw new Error("`startPosition` cannot be greater than `endPosition`");u&&(f.currentQueryProgressCallback=u),ne(e),f._ts_query_captures_wasm(this[0],e.tree[0],n.row,n.column,o.row,o.column,a,s,c,p,l);let m=f.getValue($,"i32"),d=f.getValue($+z,"i32"),g=f.getValue($+2*z,"i32"),b=new Array;this.exceededMatchLimit=!!g;let w=new Array,I=d;for(let L=0;L<m;L++){let H=f.getValue(I,"i32");I+=z;let X=f.getValue(I,"i32");I+=z;let fe=f.getValue(I,"i32");if(I+=z,w.length=X,I=Rf(this,e.tree,I,H,w),this.textPredicates[H].every(J=>J(w))){let J=w[fe],oe=this.setProperties[H];J.setProperties=oe;let rt=this.assertedProperties[H];J.assertedProperties=rt;let Ze=this.refutedProperties[H];J.refutedProperties=Ze,b.push(J)}}return f._free(d),f.currentQueryProgressCallback=null,b}predicatesForPattern(e){return this.predicates[e]}disableCapture(e){let r=f.lengthBytesUTF8(e),n=f._malloc(r+1);f.stringToUTF8(e,n,r+1),f._ts_query_disable_capture(this[0],n,r),f._free(n)}disablePattern(e){if(e>=this.predicates.length)throw new Error(`Pattern index is ${e} but the pattern count is ${this.predicates.length}`);f._ts_query_disable_pattern(this[0],e)}didExceedMatchLimit(){return this.exceededMatchLimit}startIndexForPattern(e){if(e>=this.predicates.length)throw new Error(`Pattern index is ${e} but the pattern count is ${this.predicates.length}`);return f._ts_query_start_byte_for_pattern(this[0],e)}endIndexForPattern(e){if(e>=this.predicates.length)throw new Error(`Pattern index is ${e} but the pattern count is ${this.predicates.length}`);return f._ts_query_end_byte_for_pattern(this[0],e)}patternCount(){return f._ts_query_pattern_count(this[0])}captureIndexForName(e){return this.captureNames.indexOf(e)}isPatternRooted(e){return f._ts_query_is_pattern_rooted(this[0],e)===1}isPatternNonLocal(e){return f._ts_query_is_pattern_non_local(this[0],e)===1}isPatternGuaranteedAtStep(e){return f._ts_query_is_pattern_guaranteed_at_step(this[0],e)===1}},v(co,"Query"),co),kC=/^tree_sitter_\w+$/,jn,Mf=(jn=class{constructor(e,r){re(this,0,0);re(this,"types");re(this,"fields");lo(e),this[0]=r,this.types=new Array(f._ts_language_symbol_count(this[0]));for(let n=0,o=this.types.length;n<o;n++)f._ts_language_symbol_type(this[0],n)<2&&(this.types[n]=f.UTF8ToString(f._ts_language_symbol_name(this[0],n)));this.fields=new Array(f._ts_language_field_count(this[0])+1);for(let n=0,o=this.fields.length;n<o;n++){let a=f._ts_language_field_name_for_id(this[0],n);a!==0?this.fields[n]=f.UTF8ToString(a):this.fields[n]=null}}get name(){let e=f._ts_language_name(this[0]);return e===0?null:f.UTF8ToString(e)}get version(){return f._ts_language_version(this[0])}get abiVersion(){return f._ts_language_abi_version(this[0])}get metadata(){f._ts_language_metadata(this[0]);let e=f.getValue($,"i32"),r=f.getValue($+z,"i32");return e===0?null:BS(r)}get fieldCount(){return this.fields.length-1}get stateCount(){return f._ts_language_state_count(this[0])}fieldIdForName(e){let r=this.fields.indexOf(e);return r!==-1?r:null}fieldNameForId(e){return this.fields[e]??null}idForNodeType(e,r){let n=f.lengthBytesUTF8(e),o=f._malloc(n+1);f.stringToUTF8(e,o,n+1);let a=f._ts_language_symbol_for_name(this[0],o,n,r?1:0);return f._free(o),a||null}get nodeTypeCount(){return f._ts_language_symbol_count(this[0])}nodeTypeForId(e){let r=f._ts_language_symbol_name(this[0],e);return r?f.UTF8ToString(r):null}nodeTypeIsNamed(e){return!!f._ts_language_type_is_named_wasm(this[0],e)}nodeTypeIsVisible(e){return!!f._ts_language_type_is_visible_wasm(this[0],e)}get supertypes(){f._ts_language_supertypes_wasm(this[0]);let e=f.getValue($,"i32"),r=f.getValue($+z,"i32"),n=new Array(e);if(e>0){let o=r;for(let a=0;a<e;a++)n[a]=f.getValue(o,"i16"),o+=OS}return n}subtypes(e){f._ts_language_subtypes_wasm(this[0],e);let r=f.getValue($,"i32"),n=f.getValue($+z,"i32"),o=new Array(r);if(r>0){let a=n;for(let s=0;s<r;s++)o[s]=f.getValue(a,"i16"),a+=OS}return o}nextState(e,r){return f._ts_language_next_state(this[0],e,r)}lookaheadIterator(e){let r=f._ts_lookahead_iterator_new(this[0],e);return r?new xC(rn,r,this):null}query(e){return console.warn("Language.query is deprecated. Use new Query(language, source) instead."),new Pf(this,e)}static async load(e){let r;e instanceof Uint8Array?r=Promise.resolve(e):globalThis.process?.versions.node?r=(await import("fs/promises")).readFile(e):r=fetch(e).then(c=>c.arrayBuffer().then(p=>{if(c.ok)return new Uint8Array(p);{let l=new TextDecoder("utf-8").decode(p);throw new Error(`Language.load failed with status ${c.status}.

${l}`)}}));let n=await f.loadWebAssemblyModule(await r,{loadAsync:!0}),o=Object.keys(n),a=o.find(c=>kC.test(c)&&!c.includes("external_scanner_"));if(!a)throw console.log(`Couldn't find language function in WASM file. Symbols:
${JSON.stringify(o,null,2)}`),new Error("Language.load failed: no language function found in WASM file");let s=n[a]();return new jn(rn,s)}},v(jn,"Language"),jn),AC=(()=>{var _scriptName=import.meta.url;return async function(moduleArg={}){var moduleRtn,Module=moduleArg,readyPromiseResolve,readyPromiseReject,readyPromise=new Promise((e,r)=>{readyPromiseResolve=e,readyPromiseReject=r}),ENVIRONMENT_IS_WEB=typeof window=="object",ENVIRONMENT_IS_WORKER=typeof WorkerGlobalScope<"u",ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&process.type!="renderer",ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;if(ENVIRONMENT_IS_NODE){let{createRequire:e}=await import("module");var require=e(import.meta.url)}Module.currentQueryProgressCallback=null,Module.currentProgressCallback=null,Module.currentLogCallback=null,Module.currentParseCallback=null;var moduleOverrides=Object.assign({},Module),arguments_=[],thisProgram="./this.program",quit_=v((e,r)=>{throw r},"quit_"),scriptDirectory="";function locateFile(e){return Module.locateFile?Module.locateFile(e,scriptDirectory):scriptDirectory+e}v(locateFile,"locateFile");var readAsync,readBinary;if(ENVIRONMENT_IS_NODE){var fs=require("fs"),nodePath=require("path");import.meta.url.startsWith("data:")||(scriptDirectory=nodePath.dirname(require("url").fileURLToPath(import.meta.url))+"/"),readBinary=v(e=>{e=isFileURI(e)?new URL(e):e;var r=fs.readFileSync(e);return r},"readBinary"),readAsync=v(async(e,r=!0)=>{e=isFileURI(e)?new URL(e):e;var n=fs.readFileSync(e,r?void 0:"utf8");return n},"readAsync"),!Module.thisProgram&&process.argv.length>1&&(thisProgram=process.argv[1].replace(/\\/g,"/")),arguments_=process.argv.slice(2),quit_=v((e,r)=>{throw process.exitCode=e,r},"quit_")}else(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)&&(ENVIRONMENT_IS_WORKER?scriptDirectory=self.location.href:typeof document<"u"&&document.currentScript&&(scriptDirectory=document.currentScript.src),_scriptName&&(scriptDirectory=_scriptName),scriptDirectory.startsWith("blob:")?scriptDirectory="":scriptDirectory=scriptDirectory.slice(0,scriptDirectory.replace(/[?#].*/,"").lastIndexOf("/")+1),ENVIRONMENT_IS_WORKER&&(readBinary=v(e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)},"readBinary")),readAsync=v(async e=>{if(isFileURI(e))return new Promise((n,o)=>{var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=()=>{if(a.status==200||a.status==0&&a.response){n(a.response);return}o(a.status)},a.onerror=o,a.send(null)});var r=await fetch(e,{credentials:"same-origin"});if(r.ok)return r.arrayBuffer();throw new Error(r.status+" : "+r.url)},"readAsync"));var out=Module.print||console.log.bind(console),err=Module.printErr||console.error.bind(console);Object.assign(Module,moduleOverrides),moduleOverrides=null,Module.arguments&&(arguments_=Module.arguments),Module.thisProgram&&(thisProgram=Module.thisProgram);var dynamicLibraries=Module.dynamicLibraries||[],wasmBinary=Module.wasmBinary,wasmMemory,ABORT=!1,EXITSTATUS;function assert(e,r){e||abort(r)}v(assert,"assert");var HEAP,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAP64,HEAPU64,HEAPF64,HEAP_DATA_VIEW,runtimeInitialized=!1,isFileURI=v(e=>e.startsWith("file://"),"isFileURI");function updateMemoryViews(){var e=wasmMemory.buffer;Module.HEAP_DATA_VIEW=HEAP_DATA_VIEW=new DataView(e),Module.HEAP8=HEAP8=new Int8Array(e),Module.HEAP16=HEAP16=new Int16Array(e),Module.HEAPU8=HEAPU8=new Uint8Array(e),Module.HEAPU16=HEAPU16=new Uint16Array(e),Module.HEAP32=HEAP32=new Int32Array(e),Module.HEAPU32=HEAPU32=new Uint32Array(e),Module.HEAPF32=HEAPF32=new Float32Array(e),Module.HEAPF64=HEAPF64=new Float64Array(e),Module.HEAP64=HEAP64=new BigInt64Array(e),Module.HEAPU64=HEAPU64=new BigUint64Array(e)}if(v(updateMemoryViews,"updateMemoryViews"),Module.wasmMemory)wasmMemory=Module.wasmMemory;else{var INITIAL_MEMORY=Module.INITIAL_MEMORY||33554432;wasmMemory=new WebAssembly.Memory({initial:INITIAL_MEMORY/65536,maximum:32768})}updateMemoryViews();var __RELOC_FUNCS__=[];function preRun(){if(Module.preRun)for(typeof Module.preRun=="function"&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(onPreRuns)}v(preRun,"preRun");function initRuntime(){runtimeInitialized=!0,callRuntimeCallbacks(__RELOC_FUNCS__),wasmExports.__wasm_call_ctors(),callRuntimeCallbacks(onPostCtors)}v(initRuntime,"initRuntime");function preMain(){}v(preMain,"preMain");function postRun(){if(Module.postRun)for(typeof Module.postRun=="function"&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(onPostRuns)}v(postRun,"postRun");var runDependencies=0,dependenciesFulfilled=null;function getUniqueRunDependency(e){return e}v(getUniqueRunDependency,"getUniqueRunDependency");function addRunDependency(e){runDependencies++,Module.monitorRunDependencies?.(runDependencies)}v(addRunDependency,"addRunDependency");function removeRunDependency(e){if(runDependencies--,Module.monitorRunDependencies?.(runDependencies),runDependencies==0&&dependenciesFulfilled){var r=dependenciesFulfilled;dependenciesFulfilled=null,r()}}v(removeRunDependency,"removeRunDependency");function abort(e){Module.onAbort?.(e),e="Aborted("+e+")",err(e),ABORT=!0,e+=". Build with -sASSERTIONS for more info.";var r=new WebAssembly.RuntimeError(e);throw readyPromiseReject(r),r}v(abort,"abort");var wasmBinaryFile;function findWasmBinary(){return Module.locateFile?locateFile("tree-sitter.wasm"):new URL("tree-sitter.wasm",import.meta.url).href}v(findWasmBinary,"findWasmBinary");function getBinarySync(e){if(e==wasmBinaryFile&&wasmBinary)return new Uint8Array(wasmBinary);if(readBinary)return readBinary(e);throw"both async and sync fetching of the wasm failed"}v(getBinarySync,"getBinarySync");async function getWasmBinary(e){if(!wasmBinary)try{var r=await readAsync(e);return new Uint8Array(r)}catch{}return getBinarySync(e)}v(getWasmBinary,"getWasmBinary");async function instantiateArrayBuffer(e,r){try{var n=await getWasmBinary(e),o=await WebAssembly.instantiate(n,r);return o}catch(a){err(`failed to asynchronously prepare wasm: ${a}`),abort(a)}}v(instantiateArrayBuffer,"instantiateArrayBuffer");async function instantiateAsync(e,r,n){if(!e&&typeof WebAssembly.instantiateStreaming=="function"&&!isFileURI(r)&&!ENVIRONMENT_IS_NODE)try{var o=fetch(r,{credentials:"same-origin"}),a=await WebAssembly.instantiateStreaming(o,n);return a}catch(s){err(`wasm streaming compile failed: ${s}`),err("falling back to ArrayBuffer instantiation")}return instantiateArrayBuffer(r,n)}v(instantiateAsync,"instantiateAsync");function getWasmImports(){return{env:wasmImports,wasi_snapshot_preview1:wasmImports,"GOT.mem":new Proxy(wasmImports,GOTHandler),"GOT.func":new Proxy(wasmImports,GOTHandler)}}v(getWasmImports,"getWasmImports");async function createWasm(){function e(s,c){wasmExports=s.exports,wasmExports=relocateExports(wasmExports,1024);var p=getDylinkMetadata(c);return p.neededDynlibs&&(dynamicLibraries=p.neededDynlibs.concat(dynamicLibraries)),mergeLibSymbols(wasmExports,"main"),LDSO.init(),loadDylibs(),__RELOC_FUNCS__.push(wasmExports.__wasm_apply_data_relocs),removeRunDependency("wasm-instantiate"),wasmExports}v(e,"receiveInstance"),addRunDependency("wasm-instantiate");function r(s){return e(s.instance,s.module)}v(r,"receiveInstantiationResult");var n=getWasmImports();if(Module.instantiateWasm)return new Promise((s,c)=>{Module.instantiateWasm(n,(p,l)=>{e(p,l),s(p.exports)})});wasmBinaryFile??(wasmBinaryFile=findWasmBinary());try{var o=await instantiateAsync(wasmBinary,wasmBinaryFile,n),a=r(o);return a}catch(s){return readyPromiseReject(s),Promise.reject(s)}}v(createWasm,"createWasm");var ASM_CONSTS={};let t=class t{constructor(r){re(this,"name","ExitStatus");this.message=`Program terminated with exit(${r})`,this.status=r}};v(t,"ExitStatus");let ExitStatus=t;var GOT={},currentModuleWeakSymbols=new Set([]),GOTHandler={get(e,r){var n=GOT[r];return n||(n=GOT[r]=new WebAssembly.Global({value:"i32",mutable:!0})),currentModuleWeakSymbols.has(r)||(n.required=!0),n}},LE_HEAP_LOAD_F32=v(e=>HEAP_DATA_VIEW.getFloat32(e,!0),"LE_HEAP_LOAD_F32"),LE_HEAP_LOAD_F64=v(e=>HEAP_DATA_VIEW.getFloat64(e,!0),"LE_HEAP_LOAD_F64"),LE_HEAP_LOAD_I16=v(e=>HEAP_DATA_VIEW.getInt16(e,!0),"LE_HEAP_LOAD_I16"),LE_HEAP_LOAD_I32=v(e=>HEAP_DATA_VIEW.getInt32(e,!0),"LE_HEAP_LOAD_I32"),LE_HEAP_LOAD_U16=v(e=>HEAP_DATA_VIEW.getUint16(e,!0),"LE_HEAP_LOAD_U16"),LE_HEAP_LOAD_U32=v(e=>HEAP_DATA_VIEW.getUint32(e,!0),"LE_HEAP_LOAD_U32"),LE_HEAP_STORE_F32=v((e,r)=>HEAP_DATA_VIEW.setFloat32(e,r,!0),"LE_HEAP_STORE_F32"),LE_HEAP_STORE_F64=v((e,r)=>HEAP_DATA_VIEW.setFloat64(e,r,!0),"LE_HEAP_STORE_F64"),LE_HEAP_STORE_I16=v((e,r)=>HEAP_DATA_VIEW.setInt16(e,r,!0),"LE_HEAP_STORE_I16"),LE_HEAP_STORE_I32=v((e,r)=>HEAP_DATA_VIEW.setInt32(e,r,!0),"LE_HEAP_STORE_I32"),LE_HEAP_STORE_U16=v((e,r)=>HEAP_DATA_VIEW.setUint16(e,r,!0),"LE_HEAP_STORE_U16"),LE_HEAP_STORE_U32=v((e,r)=>HEAP_DATA_VIEW.setUint32(e,r,!0),"LE_HEAP_STORE_U32"),callRuntimeCallbacks=v(e=>{for(;e.length>0;)e.shift()(Module)},"callRuntimeCallbacks"),onPostRuns=[],addOnPostRun=v(e=>onPostRuns.unshift(e),"addOnPostRun"),onPreRuns=[],addOnPreRun=v(e=>onPreRuns.unshift(e),"addOnPreRun"),UTF8Decoder=typeof TextDecoder<"u"?new TextDecoder:void 0,UTF8ArrayToString=v((e,r=0,n=NaN)=>{for(var o=r+n,a=r;e[a]&&!(a>=o);)++a;if(a-r>16&&e.buffer&&UTF8Decoder)return UTF8Decoder.decode(e.subarray(r,a));for(var s="";r<a;){var c=e[r++];if(!(c&128)){s+=String.fromCharCode(c);continue}var p=e[r++]&63;if((c&224)==192){s+=String.fromCharCode((c&31)<<6|p);continue}var l=e[r++]&63;if((c&240)==224?c=(c&15)<<12|p<<6|l:c=(c&7)<<18|p<<12|l<<6|e[r++]&63,c<65536)s+=String.fromCharCode(c);else{var u=c-65536;s+=String.fromCharCode(55296|u>>10,56320|u&1023)}}return s},"UTF8ArrayToString"),getDylinkMetadata=v(e=>{var r=0,n=0;function o(){return e[r++]}v(o,"getU8");function a(){for(var M=0,T=1;;){var R=e[r++];if(M+=(R&127)*T,T*=128,!(R&128))break}return M}v(a,"getLEB");function s(){var M=a();return r+=M,UTF8ArrayToString(e,r-M,M)}v(s,"getString");function c(M,T){if(M)throw new Error(T)}v(c,"failIf");var p="dylink.0";if(e instanceof WebAssembly.Module){var l=WebAssembly.Module.customSections(e,p);l.length===0&&(p="dylink",l=WebAssembly.Module.customSections(e,p)),c(l.length===0,"need dylink section"),e=new Uint8Array(l[0]),n=e.length}else{var u=new Uint32Array(new Uint8Array(e.subarray(0,24)).buffer),m=u[0]==1836278016||u[0]==6386541;c(!m,"need to see wasm magic number"),c(e[8]!==0,"need the dylink section to be first"),r=9;var d=a();n=r+d,p=s()}var g={neededDynlibs:[],tlsExports:new Set,weakImports:new Set};if(p=="dylink"){g.memorySize=a(),g.memoryAlign=a(),g.tableSize=a(),g.tableAlign=a();for(var b=a(),w=0;w<b;++w){var I=s();g.neededDynlibs.push(I)}}else{c(p!=="dylink.0");for(var L=1,H=2,X=3,fe=4,J=256,oe=3,rt=1;r<n;){var Ze=o(),Qt=a();if(Ze===L)g.memorySize=a(),g.memoryAlign=a(),g.tableSize=a(),g.tableAlign=a();else if(Ze===H)for(var b=a(),w=0;w<b;++w)I=s(),g.neededDynlibs.push(I);else if(Ze===X)for(var k=a();k--;){var x=s(),y=a();y&J&&g.tlsExports.add(x)}else if(Ze===fe)for(var k=a();k--;){var A=s(),x=s(),y=a();(y&oe)==rt&&g.weakImports.add(x)}else r+=Qt}}return g},"getDylinkMetadata");function getValue(e,r="i8"){switch(r.endsWith("*")&&(r="*"),r){case"i1":return HEAP8[e];case"i8":return HEAP8[e];case"i16":return LE_HEAP_LOAD_I16((e>>1)*2);case"i32":return LE_HEAP_LOAD_I32((e>>2)*4);case"i64":return HEAP64[e>>3];case"float":return LE_HEAP_LOAD_F32((e>>2)*4);case"double":return LE_HEAP_LOAD_F64((e>>3)*8);case"*":return LE_HEAP_LOAD_U32((e>>2)*4);default:abort(`invalid type for getValue: ${r}`)}}v(getValue,"getValue");var newDSO=v((e,r,n)=>{var o={refcount:1/0,name:e,exports:n,global:!0};return LDSO.loadedLibsByName[e]=o,r!=null&&(LDSO.loadedLibsByHandle[r]=o),o},"newDSO"),LDSO={loadedLibsByName:{},loadedLibsByHandle:{},init(){newDSO("__main__",0,wasmImports)}},___heap_base=78224,alignMemory=v((e,r)=>Math.ceil(e/r)*r,"alignMemory"),getMemory=v(e=>{if(runtimeInitialized)return _calloc(e,1);var r=___heap_base,n=r+alignMemory(e,16);return ___heap_base=n,GOT.__heap_base.value=n,r},"getMemory"),isInternalSym=v(e=>["__cpp_exception","__c_longjmp","__wasm_apply_data_relocs","__dso_handle","__tls_size","__tls_align","__set_stack_limits","_emscripten_tls_init","__wasm_init_tls","__wasm_call_ctors","__start_em_asm","__stop_em_asm","__start_em_js","__stop_em_js"].includes(e)||e.startsWith("__em_js__"),"isInternalSym"),uleb128Encode=v((e,r)=>{e<128?r.push(e):r.push(e%128|128,e>>7)},"uleb128Encode"),sigToWasmTypes=v(e=>{for(var r={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},n={parameters:[],results:e[0]=="v"?[]:[r[e[0]]]},o=1;o<e.length;++o)n.parameters.push(r[e[o]]);return n},"sigToWasmTypes"),generateFuncType=v((e,r)=>{var n=e.slice(0,1),o=e.slice(1),a={i:127,p:127,j:126,f:125,d:124,e:111};r.push(96),uleb128Encode(o.length,r);for(var s=0;s<o.length;++s)r.push(a[o[s]]);n=="v"?r.push(0):r.push(1,a[n])},"generateFuncType"),convertJsFunctionToWasm=v((e,r)=>{if(typeof WebAssembly.Function=="function")return new WebAssembly.Function(sigToWasmTypes(r),e);var n=[1];generateFuncType(r,n);var o=[0,97,115,109,1,0,0,0,1];uleb128Encode(n.length,o),o.push(...n),o.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var a=new WebAssembly.Module(new Uint8Array(o)),s=new WebAssembly.Instance(a,{e:{f:e}}),c=s.exports.f;return c},"convertJsFunctionToWasm"),wasmTableMirror=[],wasmTable=new WebAssembly.Table({initial:31,element:"anyfunc"}),getWasmTableEntry=v(e=>{var r=wasmTableMirror[e];return r||(e>=wasmTableMirror.length&&(wasmTableMirror.length=e+1),wasmTableMirror[e]=r=wasmTable.get(e)),r},"getWasmTableEntry"),updateTableMap=v((e,r)=>{if(functionsInTableMap)for(var n=e;n<e+r;n++){var o=getWasmTableEntry(n);o&&functionsInTableMap.set(o,n)}},"updateTableMap"),functionsInTableMap,getFunctionAddress=v(e=>(functionsInTableMap||(functionsInTableMap=new WeakMap,updateTableMap(0,wasmTable.length)),functionsInTableMap.get(e)||0),"getFunctionAddress"),freeTableIndexes=[],getEmptyTableSlot=v(()=>{if(freeTableIndexes.length)return freeTableIndexes.pop();try{wasmTable.grow(1)}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e}return wasmTable.length-1},"getEmptyTableSlot"),setWasmTableEntry=v((e,r)=>{wasmTable.set(e,r),wasmTableMirror[e]=wasmTable.get(e)},"setWasmTableEntry"),addFunction=v((e,r)=>{var n=getFunctionAddress(e);if(n)return n;var o=getEmptyTableSlot();try{setWasmTableEntry(o,e)}catch(s){if(!(s instanceof TypeError))throw s;var a=convertJsFunctionToWasm(e,r);setWasmTableEntry(o,a)}return functionsInTableMap.set(e,o),o},"addFunction"),updateGOT=v((e,r)=>{for(var n in e)if(!isInternalSym(n)){var o=e[n];GOT[n]||(GOT[n]=new WebAssembly.Global({value:"i32",mutable:!0})),(r||GOT[n].value==0)&&(typeof o=="function"?GOT[n].value=addFunction(o):typeof o=="number"?GOT[n].value=o:err(`unhandled export type for '${n}': ${typeof o}`))}},"updateGOT"),relocateExports=v((e,r,n)=>{var o={};for(var a in e){var s=e[a];typeof s=="object"&&(s=s.value),typeof s=="number"&&(s+=r),o[a]=s}return updateGOT(o,n),o},"relocateExports"),isSymbolDefined=v(e=>{var r=wasmImports[e];return!(!r||r.stub)},"isSymbolDefined"),dynCall=v((e,r,n=[])=>{var o=getWasmTableEntry(r)(...n);return o},"dynCall"),stackSave=v(()=>_emscripten_stack_get_current(),"stackSave"),stackRestore=v(e=>__emscripten_stack_restore(e),"stackRestore"),createInvokeFunction=v(e=>(r,...n)=>{var o=stackSave();try{return dynCall(e,r,n)}catch(a){if(stackRestore(o),a!==a+0)throw a;if(_setThrew(1,0),e[0]=="j")return 0n}},"createInvokeFunction"),resolveGlobalSymbol=v((e,r=!1)=>{var n;return isSymbolDefined(e)?n=wasmImports[e]:e.startsWith("invoke_")&&(n=wasmImports[e]=createInvokeFunction(e.split("_")[1])),{sym:n,name:e}},"resolveGlobalSymbol"),onPostCtors=[],addOnPostCtor=v(e=>onPostCtors.unshift(e),"addOnPostCtor"),UTF8ToString=v((e,r)=>e?UTF8ArrayToString(HEAPU8,e,r):"","UTF8ToString"),loadWebAssemblyModule=v((binary,flags,libName,localScope,handle)=>{var metadata=getDylinkMetadata(binary);currentModuleWeakSymbols=metadata.weakImports;function loadModule(){var memAlign=Math.pow(2,metadata.memoryAlign),memoryBase=metadata.memorySize?alignMemory(getMemory(metadata.memorySize+memAlign),memAlign):0,tableBase=metadata.tableSize?wasmTable.length:0;handle&&(HEAP8[handle+8]=1,LE_HEAP_STORE_U32((handle+12>>2)*4,memoryBase),LE_HEAP_STORE_I32((handle+16>>2)*4,metadata.memorySize),LE_HEAP_STORE_U32((handle+20>>2)*4,tableBase),LE_HEAP_STORE_I32((handle+24>>2)*4,metadata.tableSize)),metadata.tableSize&&wasmTable.grow(metadata.tableSize);var moduleExports;function resolveSymbol(e){var r=resolveGlobalSymbol(e).sym;return!r&&localScope&&(r=localScope[e]),r||(r=moduleExports[e]),r}v(resolveSymbol,"resolveSymbol");var proxyHandler={get(e,r){switch(r){case"__memory_base":return memoryBase;case"__table_base":return tableBase}if(r in wasmImports&&!wasmImports[r].stub){var n=wasmImports[r];return n}if(!(r in e)){var o;e[r]=(...a)=>(o||(o=resolveSymbol(r)),o(...a))}return e[r]}},proxy=new Proxy({},proxyHandler),info={"GOT.mem":new Proxy({},GOTHandler),"GOT.func":new Proxy({},GOTHandler),env:proxy,wasi_snapshot_preview1:proxy};function postInstantiation(module,instance){updateTableMap(tableBase,metadata.tableSize),moduleExports=relocateExports(instance.exports,memoryBase),flags.allowUndefined||reportUndefinedSymbols();function addEmAsm(addr,body){for(var args=[],arity=0;arity<16&&body.indexOf("$"+arity)!=-1;arity++)args.push("$"+arity);args=args.join(",");var func=`(${args}) => { ${body} };`;ASM_CONSTS[start]=eval(func)}if(v(addEmAsm,"addEmAsm"),"__start_em_asm"in moduleExports)for(var start=moduleExports.__start_em_asm,stop=moduleExports.__stop_em_asm;start<stop;){var jsString=UTF8ToString(start);addEmAsm(start,jsString),start=HEAPU8.indexOf(0,start)+1}function addEmJs(name,cSig,body){var jsArgs=[];if(cSig=cSig.slice(1,-1),cSig!="void"){cSig=cSig.split(",");for(var i in cSig){var jsArg=cSig[i].split(" ").pop();jsArgs.push(jsArg.replace("*",""))}}var func=`(${jsArgs}) => ${body};`;moduleExports[name]=eval(func)}v(addEmJs,"addEmJs");for(var name in moduleExports)if(name.startsWith("__em_js__")){var start=moduleExports[name],jsString=UTF8ToString(start),parts=jsString.split("<::>");addEmJs(name.replace("__em_js__",""),parts[0],parts[1]),delete moduleExports[name]}var applyRelocs=moduleExports.__wasm_apply_data_relocs;applyRelocs&&(runtimeInitialized?applyRelocs():__RELOC_FUNCS__.push(applyRelocs));var init=moduleExports.__wasm_call_ctors;return init&&(runtimeInitialized?init():addOnPostCtor(init)),moduleExports}if(v(postInstantiation,"postInstantiation"),flags.loadAsync){if(binary instanceof WebAssembly.Module){var instance=new WebAssembly.Instance(binary,info);return Promise.resolve(postInstantiation(binary,instance))}return WebAssembly.instantiate(binary,info).then(e=>postInstantiation(e.module,e.instance))}var module=binary instanceof WebAssembly.Module?binary:new WebAssembly.Module(binary),instance=new WebAssembly.Instance(module,info);return postInstantiation(module,instance)}return v(loadModule,"loadModule"),flags.loadAsync?metadata.neededDynlibs.reduce((e,r)=>e.then(()=>loadDynamicLibrary(r,flags,localScope)),Promise.resolve()).then(loadModule):(metadata.neededDynlibs.forEach(e=>loadDynamicLibrary(e,flags,localScope)),loadModule())},"loadWebAssemblyModule"),mergeLibSymbols=v((e,r)=>{for(var[n,o]of Object.entries(e)){let a=v(c=>{isSymbolDefined(c)||(wasmImports[c]=o)},"setImport");a(n);let s="__main_argc_argv";n=="main"&&a(s),n==s&&a("main")}},"mergeLibSymbols"),asyncLoad=v(async e=>{var r=await readAsync(e);return new Uint8Array(r)},"asyncLoad");function loadDynamicLibrary(e,r={global:!0,nodelete:!0},n,o){var a=LDSO.loadedLibsByName[e];if(a)return r.global?a.global||(a.global=!0,mergeLibSymbols(a.exports,e)):n&&Object.assign(n,a.exports),r.nodelete&&a.refcount!==1/0&&(a.refcount=1/0),a.refcount++,o&&(LDSO.loadedLibsByHandle[o]=a),r.loadAsync?Promise.resolve(!0):!0;a=newDSO(e,o,"loading"),a.refcount=r.nodelete?1/0:1,a.global=r.global;function s(){if(o){var l=LE_HEAP_LOAD_U32((o+28>>2)*4),u=LE_HEAP_LOAD_U32((o+32>>2)*4);if(l&&u){var m=HEAP8.slice(l,l+u);return r.loadAsync?Promise.resolve(m):m}}var d=locateFile(e);if(r.loadAsync)return asyncLoad(d);if(!readBinary)throw new Error(`${d}: file not found, and synchronous loading of external files is not available`);return readBinary(d)}v(s,"loadLibData");function c(){return r.loadAsync?s().then(l=>loadWebAssemblyModule(l,r,e,n,o)):loadWebAssemblyModule(s(),r,e,n,o)}v(c,"getExports");function p(l){a.global?mergeLibSymbols(l,e):n&&Object.assign(n,l),a.exports=l}return v(p,"moduleLoaded"),r.loadAsync?c().then(l=>(p(l),!0)):(p(c()),!0)}v(loadDynamicLibrary,"loadDynamicLibrary");var reportUndefinedSymbols=v(()=>{for(var[e,r]of Object.entries(GOT))if(r.value==0){var n=resolveGlobalSymbol(e,!0).sym;if(!n&&!r.required)continue;if(typeof n=="function")r.value=addFunction(n,n.sig);else if(typeof n=="number")r.value=n;else throw new Error(`bad export type for '${e}': ${typeof n}`)}},"reportUndefinedSymbols"),loadDylibs=v(()=>{if(!dynamicLibraries.length){reportUndefinedSymbols();return}addRunDependency("loadDylibs"),dynamicLibraries.reduce((e,r)=>e.then(()=>loadDynamicLibrary(r,{loadAsync:!0,global:!0,nodelete:!0,allowUndefined:!0})),Promise.resolve()).then(()=>{reportUndefinedSymbols(),removeRunDependency("loadDylibs")})},"loadDylibs"),noExitRuntime=Module.noExitRuntime||!0;function setValue(e,r,n="i8"){switch(n.endsWith("*")&&(n="*"),n){case"i1":HEAP8[e]=r;break;case"i8":HEAP8[e]=r;break;case"i16":LE_HEAP_STORE_I16((e>>1)*2,r);break;case"i32":LE_HEAP_STORE_I32((e>>2)*4,r);break;case"i64":HEAP64[e>>3]=BigInt(r);break;case"float":LE_HEAP_STORE_F32((e>>2)*4,r);break;case"double":LE_HEAP_STORE_F64((e>>3)*8,r);break;case"*":LE_HEAP_STORE_U32((e>>2)*4,r);break;default:abort(`invalid type for setValue: ${n}`)}}v(setValue,"setValue");var ___memory_base=new WebAssembly.Global({value:"i32",mutable:!1},1024),___stack_pointer=new WebAssembly.Global({value:"i32",mutable:!0},78224),___table_base=new WebAssembly.Global({value:"i32",mutable:!1},1),__abort_js=v(()=>abort(""),"__abort_js");__abort_js.sig="v";var _emscripten_get_now=v(()=>performance.now(),"_emscripten_get_now");_emscripten_get_now.sig="d";var _emscripten_date_now=v(()=>Date.now(),"_emscripten_date_now");_emscripten_date_now.sig="d";var nowIsMonotonic=1,checkWasiClock=v(e=>e>=0&&e<=3,"checkWasiClock"),INT53_MAX=9007199254740992,INT53_MIN=-9007199254740992,bigintToI53Checked=v(e=>e<INT53_MIN||e>INT53_MAX?NaN:Number(e),"bigintToI53Checked");function _clock_time_get(e,r,n){if(r=bigintToI53Checked(r),!checkWasiClock(e))return 28;var o;if(e===0)o=_emscripten_date_now();else if(nowIsMonotonic)o=_emscripten_get_now();else return 52;var a=Math.round(o*1e3*1e3);return HEAP64[n>>3]=BigInt(a),0}v(_clock_time_get,"_clock_time_get"),_clock_time_get.sig="iijp";var getHeapMax=v(()=>2147483648,"getHeapMax"),growMemory=v(e=>{var r=wasmMemory.buffer,n=(e-r.byteLength+65535)/65536|0;try{return wasmMemory.grow(n),updateMemoryViews(),1}catch{}},"growMemory"),_emscripten_resize_heap=v(e=>{var r=HEAPU8.length;e>>>=0;var n=getHeapMax();if(e>n)return!1;for(var o=1;o<=4;o*=2){var a=r*(1+.2/o);a=Math.min(a,e+100663296);var s=Math.min(n,alignMemory(Math.max(e,a),65536)),c=growMemory(s);if(c)return!0}return!1},"_emscripten_resize_heap");_emscripten_resize_heap.sig="ip";var _fd_close=v(e=>52,"_fd_close");_fd_close.sig="ii";function _fd_seek(e,r,n,o){return r=bigintToI53Checked(r),70}v(_fd_seek,"_fd_seek"),_fd_seek.sig="iijip";var printCharBuffers=[null,[],[]],printChar=v((e,r)=>{var n=printCharBuffers[e];r===0||r===10?((e===1?out:err)(UTF8ArrayToString(n)),n.length=0):n.push(r)},"printChar"),flush_NO_FILESYSTEM=v(()=>{printCharBuffers[1].length&&printChar(1,10),printCharBuffers[2].length&&printChar(2,10)},"flush_NO_FILESYSTEM"),SYSCALLS={varargs:void 0,getStr(e){var r=UTF8ToString(e);return r}},_fd_write=v((e,r,n,o)=>{for(var a=0,s=0;s<n;s++){var c=LE_HEAP_LOAD_U32((r>>2)*4),p=LE_HEAP_LOAD_U32((r+4>>2)*4);r+=8;for(var l=0;l<p;l++)printChar(e,HEAPU8[c+l]);a+=p}return LE_HEAP_STORE_U32((o>>2)*4,a),0},"_fd_write");_fd_write.sig="iippp";function _tree_sitter_log_callback(e,r){if(Module.currentLogCallback){let n=UTF8ToString(r);Module.currentLogCallback(n,e!==0)}}v(_tree_sitter_log_callback,"_tree_sitter_log_callback");function _tree_sitter_parse_callback(e,r,n,o,a){let c=Module.currentParseCallback(r,{row:n,column:o});typeof c=="string"?(setValue(a,c.length,"i32"),stringToUTF16(c,e,10240)):setValue(a,0,"i32")}v(_tree_sitter_parse_callback,"_tree_sitter_parse_callback");function _tree_sitter_progress_callback(e,r){return Module.currentProgressCallback?Module.currentProgressCallback({currentOffset:e,hasError:r}):!1}v(_tree_sitter_progress_callback,"_tree_sitter_progress_callback");function _tree_sitter_query_progress_callback(e){return Module.currentQueryProgressCallback?Module.currentQueryProgressCallback({currentOffset:e}):!1}v(_tree_sitter_query_progress_callback,"_tree_sitter_query_progress_callback");var runtimeKeepaliveCounter=0,keepRuntimeAlive=v(()=>noExitRuntime||runtimeKeepaliveCounter>0,"keepRuntimeAlive"),_proc_exit=v(e=>{EXITSTATUS=e,keepRuntimeAlive()||(Module.onExit?.(e),ABORT=!0),quit_(e,new ExitStatus(e))},"_proc_exit");_proc_exit.sig="vi";var exitJS=v((e,r)=>{EXITSTATUS=e,_proc_exit(e)},"exitJS"),handleException=v(e=>{if(e instanceof ExitStatus||e=="unwind")return EXITSTATUS;quit_(1,e)},"handleException"),lengthBytesUTF8=v(e=>{for(var r=0,n=0;n<e.length;++n){var o=e.charCodeAt(n);o<=127?r++:o<=2047?r+=2:o>=55296&&o<=57343?(r+=4,++n):r+=3}return r},"lengthBytesUTF8"),stringToUTF8Array=v((e,r,n,o)=>{if(!(o>0))return 0;for(var a=n,s=n+o-1,c=0;c<e.length;++c){var p=e.charCodeAt(c);if(p>=55296&&p<=57343){var l=e.charCodeAt(++c);p=65536+((p&1023)<<10)|l&1023}if(p<=127){if(n>=s)break;r[n++]=p}else if(p<=2047){if(n+1>=s)break;r[n++]=192|p>>6,r[n++]=128|p&63}else if(p<=65535){if(n+2>=s)break;r[n++]=224|p>>12,r[n++]=128|p>>6&63,r[n++]=128|p&63}else{if(n+3>=s)break;r[n++]=240|p>>18,r[n++]=128|p>>12&63,r[n++]=128|p>>6&63,r[n++]=128|p&63}}return r[n]=0,n-a},"stringToUTF8Array"),stringToUTF8=v((e,r,n)=>stringToUTF8Array(e,HEAPU8,r,n),"stringToUTF8"),stackAlloc=v(e=>__emscripten_stack_alloc(e),"stackAlloc"),stringToUTF8OnStack=v(e=>{var r=lengthBytesUTF8(e)+1,n=stackAlloc(r);return stringToUTF8(e,n,r),n},"stringToUTF8OnStack"),AsciiToString=v(e=>{for(var r="";;){var n=HEAPU8[e++];if(!n)return r;r+=String.fromCharCode(n)}},"AsciiToString"),stringToUTF16=v((e,r,n)=>{if(n??(n=2147483647),n<2)return 0;n-=2;for(var o=r,a=n<e.length*2?n/2:e.length,s=0;s<a;++s){var c=e.charCodeAt(s);LE_HEAP_STORE_I16((r>>1)*2,c),r+=2}return LE_HEAP_STORE_I16((r>>1)*2,0),r-o},"stringToUTF16"),wasmImports={__heap_base:___heap_base,__indirect_function_table:wasmTable,__memory_base:___memory_base,__stack_pointer:___stack_pointer,__table_base:___table_base,_abort_js:__abort_js,clock_time_get:_clock_time_get,emscripten_resize_heap:_emscripten_resize_heap,fd_close:_fd_close,fd_seek:_fd_seek,fd_write:_fd_write,memory:wasmMemory,tree_sitter_log_callback:_tree_sitter_log_callback,tree_sitter_parse_callback:_tree_sitter_parse_callback,tree_sitter_progress_callback:_tree_sitter_progress_callback,tree_sitter_query_progress_callback:_tree_sitter_query_progress_callback},wasmExports=await createWasm(),___wasm_call_ctors=wasmExports.__wasm_call_ctors,_malloc=Module._malloc=wasmExports.malloc,_calloc=Module._calloc=wasmExports.calloc,_realloc=Module._realloc=wasmExports.realloc,_free=Module._free=wasmExports.free,_memcmp=Module._memcmp=wasmExports.memcmp,_ts_language_symbol_count=Module._ts_language_symbol_count=wasmExports.ts_language_symbol_count,_ts_language_state_count=Module._ts_language_state_count=wasmExports.ts_language_state_count,_ts_language_version=Module._ts_language_version=wasmExports.ts_language_version,_ts_language_abi_version=Module._ts_language_abi_version=wasmExports.ts_language_abi_version,_ts_language_metadata=Module._ts_language_metadata=wasmExports.ts_language_metadata,_ts_language_name=Module._ts_language_name=wasmExports.ts_language_name,_ts_language_field_count=Module._ts_language_field_count=wasmExports.ts_language_field_count,_ts_language_next_state=Module._ts_language_next_state=wasmExports.ts_language_next_state,_ts_language_symbol_name=Module._ts_language_symbol_name=wasmExports.ts_language_symbol_name,_ts_language_symbol_for_name=Module._ts_language_symbol_for_name=wasmExports.ts_language_symbol_for_name,_strncmp=Module._strncmp=wasmExports.strncmp,_ts_language_symbol_type=Module._ts_language_symbol_type=wasmExports.ts_language_symbol_type,_ts_language_field_name_for_id=Module._ts_language_field_name_for_id=wasmExports.ts_language_field_name_for_id,_ts_lookahead_iterator_new=Module._ts_lookahead_iterator_new=wasmExports.ts_lookahead_iterator_new,_ts_lookahead_iterator_delete=Module._ts_lookahead_iterator_delete=wasmExports.ts_lookahead_iterator_delete,_ts_lookahead_iterator_reset_state=Module._ts_lookahead_iterator_reset_state=wasmExports.ts_lookahead_iterator_reset_state,_ts_lookahead_iterator_reset=Module._ts_lookahead_iterator_reset=wasmExports.ts_lookahead_iterator_reset,_ts_lookahead_iterator_next=Module._ts_lookahead_iterator_next=wasmExports.ts_lookahead_iterator_next,_ts_lookahead_iterator_current_symbol=Module._ts_lookahead_iterator_current_symbol=wasmExports.ts_lookahead_iterator_current_symbol,_ts_parser_delete=Module._ts_parser_delete=wasmExports.ts_parser_delete,_ts_parser_reset=Module._ts_parser_reset=wasmExports.ts_parser_reset,_ts_parser_set_language=Module._ts_parser_set_language=wasmExports.ts_parser_set_language,_ts_parser_timeout_micros=Module._ts_parser_timeout_micros=wasmExports.ts_parser_timeout_micros,_ts_parser_set_timeout_micros=Module._ts_parser_set_timeout_micros=wasmExports.ts_parser_set_timeout_micros,_ts_parser_set_included_ranges=Module._ts_parser_set_included_ranges=wasmExports.ts_parser_set_included_ranges,_ts_query_new=Module._ts_query_new=wasmExports.ts_query_new,_ts_query_delete=Module._ts_query_delete=wasmExports.ts_query_delete,_iswspace=Module._iswspace=wasmExports.iswspace,_iswalnum=Module._iswalnum=wasmExports.iswalnum,_ts_query_pattern_count=Module._ts_query_pattern_count=wasmExports.ts_query_pattern_count,_ts_query_capture_count=Module._ts_query_capture_count=wasmExports.ts_query_capture_count,_ts_query_string_count=Module._ts_query_string_count=wasmExports.ts_query_string_count,_ts_query_capture_name_for_id=Module._ts_query_capture_name_for_id=wasmExports.ts_query_capture_name_for_id,_ts_query_capture_quantifier_for_id=Module._ts_query_capture_quantifier_for_id=wasmExports.ts_query_capture_quantifier_for_id,_ts_query_string_value_for_id=Module._ts_query_string_value_for_id=wasmExports.ts_query_string_value_for_id,_ts_query_predicates_for_pattern=Module._ts_query_predicates_for_pattern=wasmExports.ts_query_predicates_for_pattern,_ts_query_start_byte_for_pattern=Module._ts_query_start_byte_for_pattern=wasmExports.ts_query_start_byte_for_pattern,_ts_query_end_byte_for_pattern=Module._ts_query_end_byte_for_pattern=wasmExports.ts_query_end_byte_for_pattern,_ts_query_is_pattern_rooted=Module._ts_query_is_pattern_rooted=wasmExports.ts_query_is_pattern_rooted,_ts_query_is_pattern_non_local=Module._ts_query_is_pattern_non_local=wasmExports.ts_query_is_pattern_non_local,_ts_query_is_pattern_guaranteed_at_step=Module._ts_query_is_pattern_guaranteed_at_step=wasmExports.ts_query_is_pattern_guaranteed_at_step,_ts_query_disable_capture=Module._ts_query_disable_capture=wasmExports.ts_query_disable_capture,_ts_query_disable_pattern=Module._ts_query_disable_pattern=wasmExports.ts_query_disable_pattern,_ts_tree_copy=Module._ts_tree_copy=wasmExports.ts_tree_copy,_ts_tree_delete=Module._ts_tree_delete=wasmExports.ts_tree_delete,_ts_init=Module._ts_init=wasmExports.ts_init,_ts_parser_new_wasm=Module._ts_parser_new_wasm=wasmExports.ts_parser_new_wasm,_ts_parser_enable_logger_wasm=Module._ts_parser_enable_logger_wasm=wasmExports.ts_parser_enable_logger_wasm,_ts_parser_parse_wasm=Module._ts_parser_parse_wasm=wasmExports.ts_parser_parse_wasm,_ts_parser_included_ranges_wasm=Module._ts_parser_included_ranges_wasm=wasmExports.ts_parser_included_ranges_wasm,_ts_language_type_is_named_wasm=Module._ts_language_type_is_named_wasm=wasmExports.ts_language_type_is_named_wasm,_ts_language_type_is_visible_wasm=Module._ts_language_type_is_visible_wasm=wasmExports.ts_language_type_is_visible_wasm,_ts_language_supertypes_wasm=Module._ts_language_supertypes_wasm=wasmExports.ts_language_supertypes_wasm,_ts_language_subtypes_wasm=Module._ts_language_subtypes_wasm=wasmExports.ts_language_subtypes_wasm,_ts_tree_root_node_wasm=Module._ts_tree_root_node_wasm=wasmExports.ts_tree_root_node_wasm,_ts_tree_root_node_with_offset_wasm=Module._ts_tree_root_node_with_offset_wasm=wasmExports.ts_tree_root_node_with_offset_wasm,_ts_tree_edit_wasm=Module._ts_tree_edit_wasm=wasmExports.ts_tree_edit_wasm,_ts_tree_included_ranges_wasm=Module._ts_tree_included_ranges_wasm=wasmExports.ts_tree_included_ranges_wasm,_ts_tree_get_changed_ranges_wasm=Module._ts_tree_get_changed_ranges_wasm=wasmExports.ts_tree_get_changed_ranges_wasm,_ts_tree_cursor_new_wasm=Module._ts_tree_cursor_new_wasm=wasmExports.ts_tree_cursor_new_wasm,_ts_tree_cursor_copy_wasm=Module._ts_tree_cursor_copy_wasm=wasmExports.ts_tree_cursor_copy_wasm,_ts_tree_cursor_delete_wasm=Module._ts_tree_cursor_delete_wasm=wasmExports.ts_tree_cursor_delete_wasm,_ts_tree_cursor_reset_wasm=Module._ts_tree_cursor_reset_wasm=wasmExports.ts_tree_cursor_reset_wasm,_ts_tree_cursor_reset_to_wasm=Module._ts_tree_cursor_reset_to_wasm=wasmExports.ts_tree_cursor_reset_to_wasm,_ts_tree_cursor_goto_first_child_wasm=Module._ts_tree_cursor_goto_first_child_wasm=wasmExports.ts_tree_cursor_goto_first_child_wasm,_ts_tree_cursor_goto_last_child_wasm=Module._ts_tree_cursor_goto_last_child_wasm=wasmExports.ts_tree_cursor_goto_last_child_wasm,_ts_tree_cursor_goto_first_child_for_index_wasm=Module._ts_tree_cursor_goto_first_child_for_index_wasm=wasmExports.ts_tree_cursor_goto_first_child_for_index_wasm,_ts_tree_cursor_goto_first_child_for_position_wasm=Module._ts_tree_cursor_goto_first_child_for_position_wasm=wasmExports.ts_tree_cursor_goto_first_child_for_position_wasm,_ts_tree_cursor_goto_next_sibling_wasm=Module._ts_tree_cursor_goto_next_sibling_wasm=wasmExports.ts_tree_cursor_goto_next_sibling_wasm,_ts_tree_cursor_goto_previous_sibling_wasm=Module._ts_tree_cursor_goto_previous_sibling_wasm=wasmExports.ts_tree_cursor_goto_previous_sibling_wasm,_ts_tree_cursor_goto_descendant_wasm=Module._ts_tree_cursor_goto_descendant_wasm=wasmExports.ts_tree_cursor_goto_descendant_wasm,_ts_tree_cursor_goto_parent_wasm=Module._ts_tree_cursor_goto_parent_wasm=wasmExports.ts_tree_cursor_goto_parent_wasm,_ts_tree_cursor_current_node_type_id_wasm=Module._ts_tree_cursor_current_node_type_id_wasm=wasmExports.ts_tree_cursor_current_node_type_id_wasm,_ts_tree_cursor_current_node_state_id_wasm=Module._ts_tree_cursor_current_node_state_id_wasm=wasmExports.ts_tree_cursor_current_node_state_id_wasm,_ts_tree_cursor_current_node_is_named_wasm=Module._ts_tree_cursor_current_node_is_named_wasm=wasmExports.ts_tree_cursor_current_node_is_named_wasm,_ts_tree_cursor_current_node_is_missing_wasm=Module._ts_tree_cursor_current_node_is_missing_wasm=wasmExports.ts_tree_cursor_current_node_is_missing_wasm,_ts_tree_cursor_current_node_id_wasm=Module._ts_tree_cursor_current_node_id_wasm=wasmExports.ts_tree_cursor_current_node_id_wasm,_ts_tree_cursor_start_position_wasm=Module._ts_tree_cursor_start_position_wasm=wasmExports.ts_tree_cursor_start_position_wasm,_ts_tree_cursor_end_position_wasm=Module._ts_tree_cursor_end_position_wasm=wasmExports.ts_tree_cursor_end_position_wasm,_ts_tree_cursor_start_index_wasm=Module._ts_tree_cursor_start_index_wasm=wasmExports.ts_tree_cursor_start_index_wasm,_ts_tree_cursor_end_index_wasm=Module._ts_tree_cursor_end_index_wasm=wasmExports.ts_tree_cursor_end_index_wasm,_ts_tree_cursor_current_field_id_wasm=Module._ts_tree_cursor_current_field_id_wasm=wasmExports.ts_tree_cursor_current_field_id_wasm,_ts_tree_cursor_current_depth_wasm=Module._ts_tree_cursor_current_depth_wasm=wasmExports.ts_tree_cursor_current_depth_wasm,_ts_tree_cursor_current_descendant_index_wasm=Module._ts_tree_cursor_current_descendant_index_wasm=wasmExports.ts_tree_cursor_current_descendant_index_wasm,_ts_tree_cursor_current_node_wasm=Module._ts_tree_cursor_current_node_wasm=wasmExports.ts_tree_cursor_current_node_wasm,_ts_node_symbol_wasm=Module._ts_node_symbol_wasm=wasmExports.ts_node_symbol_wasm,_ts_node_field_name_for_child_wasm=Module._ts_node_field_name_for_child_wasm=wasmExports.ts_node_field_name_for_child_wasm,_ts_node_field_name_for_named_child_wasm=Module._ts_node_field_name_for_named_child_wasm=wasmExports.ts_node_field_name_for_named_child_wasm,_ts_node_children_by_field_id_wasm=Module._ts_node_children_by_field_id_wasm=wasmExports.ts_node_children_by_field_id_wasm,_ts_node_first_child_for_byte_wasm=Module._ts_node_first_child_for_byte_wasm=wasmExports.ts_node_first_child_for_byte_wasm,_ts_node_first_named_child_for_byte_wasm=Module._ts_node_first_named_child_for_byte_wasm=wasmExports.ts_node_first_named_child_for_byte_wasm,_ts_node_grammar_symbol_wasm=Module._ts_node_grammar_symbol_wasm=wasmExports.ts_node_grammar_symbol_wasm,_ts_node_child_count_wasm=Module._ts_node_child_count_wasm=wasmExports.ts_node_child_count_wasm,_ts_node_named_child_count_wasm=Module._ts_node_named_child_count_wasm=wasmExports.ts_node_named_child_count_wasm,_ts_node_child_wasm=Module._ts_node_child_wasm=wasmExports.ts_node_child_wasm,_ts_node_named_child_wasm=Module._ts_node_named_child_wasm=wasmExports.ts_node_named_child_wasm,_ts_node_child_by_field_id_wasm=Module._ts_node_child_by_field_id_wasm=wasmExports.ts_node_child_by_field_id_wasm,_ts_node_next_sibling_wasm=Module._ts_node_next_sibling_wasm=wasmExports.ts_node_next_sibling_wasm,_ts_node_prev_sibling_wasm=Module._ts_node_prev_sibling_wasm=wasmExports.ts_node_prev_sibling_wasm,_ts_node_next_named_sibling_wasm=Module._ts_node_next_named_sibling_wasm=wasmExports.ts_node_next_named_sibling_wasm,_ts_node_prev_named_sibling_wasm=Module._ts_node_prev_named_sibling_wasm=wasmExports.ts_node_prev_named_sibling_wasm,_ts_node_descendant_count_wasm=Module._ts_node_descendant_count_wasm=wasmExports.ts_node_descendant_count_wasm,_ts_node_parent_wasm=Module._ts_node_parent_wasm=wasmExports.ts_node_parent_wasm,_ts_node_child_with_descendant_wasm=Module._ts_node_child_with_descendant_wasm=wasmExports.ts_node_child_with_descendant_wasm,_ts_node_descendant_for_index_wasm=Module._ts_node_descendant_for_index_wasm=wasmExports.ts_node_descendant_for_index_wasm,_ts_node_named_descendant_for_index_wasm=Module._ts_node_named_descendant_for_index_wasm=wasmExports.ts_node_named_descendant_for_index_wasm,_ts_node_descendant_for_position_wasm=Module._ts_node_descendant_for_position_wasm=wasmExports.ts_node_descendant_for_position_wasm,_ts_node_named_descendant_for_position_wasm=Module._ts_node_named_descendant_for_position_wasm=wasmExports.ts_node_named_descendant_for_position_wasm,_ts_node_start_point_wasm=Module._ts_node_start_point_wasm=wasmExports.ts_node_start_point_wasm,_ts_node_end_point_wasm=Module._ts_node_end_point_wasm=wasmExports.ts_node_end_point_wasm,_ts_node_start_index_wasm=Module._ts_node_start_index_wasm=wasmExports.ts_node_start_index_wasm,_ts_node_end_index_wasm=Module._ts_node_end_index_wasm=wasmExports.ts_node_end_index_wasm,_ts_node_to_string_wasm=Module._ts_node_to_string_wasm=wasmExports.ts_node_to_string_wasm,_ts_node_children_wasm=Module._ts_node_children_wasm=wasmExports.ts_node_children_wasm,_ts_node_named_children_wasm=Module._ts_node_named_children_wasm=wasmExports.ts_node_named_children_wasm,_ts_node_descendants_of_type_wasm=Module._ts_node_descendants_of_type_wasm=wasmExports.ts_node_descendants_of_type_wasm,_ts_node_is_named_wasm=Module._ts_node_is_named_wasm=wasmExports.ts_node_is_named_wasm,_ts_node_has_changes_wasm=Module._ts_node_has_changes_wasm=wasmExports.ts_node_has_changes_wasm,_ts_node_has_error_wasm=Module._ts_node_has_error_wasm=wasmExports.ts_node_has_error_wasm,_ts_node_is_error_wasm=Module._ts_node_is_error_wasm=wasmExports.ts_node_is_error_wasm,_ts_node_is_missing_wasm=Module._ts_node_is_missing_wasm=wasmExports.ts_node_is_missing_wasm,_ts_node_is_extra_wasm=Module._ts_node_is_extra_wasm=wasmExports.ts_node_is_extra_wasm,_ts_node_parse_state_wasm=Module._ts_node_parse_state_wasm=wasmExports.ts_node_parse_state_wasm,_ts_node_next_parse_state_wasm=Module._ts_node_next_parse_state_wasm=wasmExports.ts_node_next_parse_state_wasm,_ts_query_matches_wasm=Module._ts_query_matches_wasm=wasmExports.ts_query_matches_wasm,_ts_query_captures_wasm=Module._ts_query_captures_wasm=wasmExports.ts_query_captures_wasm,_memset=Module._memset=wasmExports.memset,_memcpy=Module._memcpy=wasmExports.memcpy,_memmove=Module._memmove=wasmExports.memmove,_iswalpha=Module._iswalpha=wasmExports.iswalpha,_iswblank=Module._iswblank=wasmExports.iswblank,_iswdigit=Module._iswdigit=wasmExports.iswdigit,_iswlower=Module._iswlower=wasmExports.iswlower,_iswupper=Module._iswupper=wasmExports.iswupper,_iswxdigit=Module._iswxdigit=wasmExports.iswxdigit,_memchr=Module._memchr=wasmExports.memchr,_strlen=Module._strlen=wasmExports.strlen,_strcmp=Module._strcmp=wasmExports.strcmp,_strncat=Module._strncat=wasmExports.strncat,_strncpy=Module._strncpy=wasmExports.strncpy,_towlower=Module._towlower=wasmExports.towlower,_towupper=Module._towupper=wasmExports.towupper,_setThrew=wasmExports.setThrew,__emscripten_stack_restore=wasmExports._emscripten_stack_restore,__emscripten_stack_alloc=wasmExports._emscripten_stack_alloc,_emscripten_stack_get_current=wasmExports.emscripten_stack_get_current,___wasm_apply_data_relocs=wasmExports.__wasm_apply_data_relocs;Module.setValue=setValue,Module.getValue=getValue,Module.UTF8ToString=UTF8ToString,Module.stringToUTF8=stringToUTF8,Module.lengthBytesUTF8=lengthBytesUTF8,Module.AsciiToString=AsciiToString,Module.stringToUTF16=stringToUTF16,Module.loadWebAssemblyModule=loadWebAssemblyModule;function callMain(e=[]){var r=resolveGlobalSymbol("main").sym;if(r){e.unshift(thisProgram);var n=e.length,o=stackAlloc((n+1)*4),a=o;e.forEach(c=>{LE_HEAP_STORE_U32((a>>2)*4,stringToUTF8OnStack(c)),a+=4}),LE_HEAP_STORE_U32((a>>2)*4,0);try{var s=r(n,o);return exitJS(s,!0),s}catch(c){return handleException(c)}}}v(callMain,"callMain");function run(e=arguments_){if(runDependencies>0){dependenciesFulfilled=run;return}if(preRun(),runDependencies>0){dependenciesFulfilled=run;return}function r(){if(Module.calledRun=!0,!ABORT){initRuntime(),readyPromiseResolve(Module),Module.onRuntimeInitialized?.();var n=Module.noInitialRun;n||callMain(e),postRun()}}v(r,"doRun"),Module.setStatus?(Module.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>Module.setStatus(""),1),r()},1)):r()}if(v(run,"run"),Module.preInit)for(typeof Module.preInit=="function"&&(Module.preInit=[Module.preInit]);Module.preInit.length>0;)Module.preInit.pop()();return run(),moduleRtn=readyPromise,moduleRtn}})(),PC=AC,bu=null;async function KS(t){return bu||(bu=await PC(t)),bu}v(KS,"initializeBinding");function QS(){return!!bu}v(QS,"checkModule");var $,wf,Ef,po,Eu=(po=class{constructor(){re(this,0,0);re(this,1,0);re(this,"logCallback",null);re(this,"language",null);this.initialize()}static async init(e){HS(await KS(e)),$=f._ts_init(),wf=f.getValue($,"i32"),Ef=f.getValue($+z,"i32")}initialize(){if(!QS())throw new Error("cannot construct a Parser before calling `init()`");f._ts_parser_new_wasm(),this[0]=f.getValue($,"i32"),this[1]=f.getValue($+z,"i32")}delete(){f._ts_parser_delete(this[0]),f._free(this[1]),this[0]=0,this[1]=0}setLanguage(e){let r;if(!e)r=0,this.language=null;else if(e.constructor===Mf){r=e[0];let n=f._ts_language_version(r);if(n<Ef||wf<n)throw new Error(`Incompatible language version ${n}. Compatibility range ${Ef} through ${wf}.`);this.language=e}else throw new Error("Argument must be a Language");return f._ts_parser_set_language(this[0],r),this}parse(e,r,n){if(typeof e=="string")f.currentParseCallback=p=>e.slice(p);else if(typeof e=="function")f.currentParseCallback=e;else throw new Error("Argument must be a string or a function");n?.progressCallback?f.currentProgressCallback=n.progressCallback:f.currentProgressCallback=null,this.logCallback?(f.currentLogCallback=this.logCallback,f._ts_parser_enable_logger_wasm(this[0],1)):(f.currentLogCallback=null,f._ts_parser_enable_logger_wasm(this[0],0));let o=0,a=0;if(n?.includedRanges){o=n.includedRanges.length,a=f._calloc(o,va);let p=a;for(let l=0;l<o;l++)US(p,n.includedRanges[l]),p+=va}let s=f._ts_parser_parse_wasm(this[0],this[1],r?r[0]:0,a,o);if(!s)return f.currentParseCallback=null,f.currentLogCallback=null,f.currentProgressCallback=null,null;if(!this.language)throw new Error("Parser must have a language to parse");let c=new SC(rn,s,this.language,f.currentParseCallback);return f.currentParseCallback=null,f.currentLogCallback=null,f.currentProgressCallback=null,c}reset(){f._ts_parser_reset(this[0])}getIncludedRanges(){f._ts_parser_included_ranges_wasm(this[0]);let e=f.getValue($,"i32"),r=f.getValue($+z,"i32"),n=new Array(e);if(e>0){let o=r;for(let a=0;a<e;a++)n[a]=wu(o),o+=va;f._free(r)}return n}getTimeoutMicros(){return f._ts_parser_timeout_micros(this[0])}setTimeoutMicros(e){f._ts_parser_set_timeout_micros(this[0],0,e)}setLogger(e){if(!e)this.logCallback=null;else{if(typeof e!="function")throw new Error("Logger callback must be a function");this.logCallback=e}return this}getLogger(){return this.logCallback}},v(po,"Parser"),po);function Ru(...t){return t.join(MC())}function MC(){return/^win/i.test(process.platform)?"\\":"/"}var ku=class{constructor(e){this.wasmDirectory=e;this.parsers=new Map}getTree(e){if(this.getLanguage(e.languageId)){let r=this.parsers.get(e.languageId);if(r){let n=r.parse(e.getText());if(!n)throw new Error("Failed to parse document");return n}}throw new Error("Language not supported")}async loadLanguage(e){let r=new Eu,n=Ru(this.wasmDirectory,`tree-sitter-${e}.wasm`),o=await Mf.load(n);return r.setLanguage(o),this.parsers.set(e,r),!0}getLanguage(e){return this.parsers.get(e)?.language||void 0}getNodeAtLocation(e,r){let o=this.getTree(e).rootNode.descendantForPosition({row:r.start.line,column:r.start.character},{row:r.end.line,column:r.end.character});if(!o)throw new Error("Node not found at location");return o}createQuery(e,r){let n=this.getLanguage(e);if(n)try{return new Pf(n,r)}catch(o){console.error(`Failed to create query for language ${e}:`,o);return}}};var Au=class{constructor(e){this.ide=e;this.notifier=new Pe;this.disposables=[];this.onChanges=this.notifier.registerListener}async readQuery(e){return await this.ide.readQuery(e)}dispose(){this.disposables.forEach(e=>e.dispose())}};var Pu=class{constructor(e){this.signals={prePhrase:{getVersion:async()=>this.client.prePhraseVersion()}};this.client=e}getFocusedElementType(){return Promise.resolve(void 0)}};async function Vde(t,e){console.log("activate started"),await Eu.init({locateFile(a,s){return Ru(e,a)}}),console.log("Parser initialized");let r=new Pu(t.client),n=new Au(t.ide),o=await CS({ide:t.ide,hats:t.hats,treeSitterQueryProvider:n,treeSitter:new ku(e),commandServerApi:r});return console.log("activate completed"),o}export{wm as JetbrainsConfiguration,Rm as JetbrainsIDE,bm as JetbrainsPlugin,Vde as activate,MK as createIDE,Y9 as createJetbrainsConfiguration,z9 as createPlugin};
/*! Bundled license information:

lodash-es/lodash.js:
  (**
   * @license
   * Lodash (Custom Build) <https://lodash.com/>
   * Build: `lodash modularize exports="es" -o ./`
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)

itertools/dist/index.js:
  (* istanbul ignore else -- @preserve *)
  (* istanbul ignore if -- @preserve *)
*/
