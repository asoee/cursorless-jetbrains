var Pv=Object.create;var Xl=Object.defineProperty;var Dv=Object.getOwnPropertyDescriptor;var Mv=Object.getOwnPropertyNames;var Av=Object.getPrototypeOf,Fv=Object.prototype.hasOwnProperty;var o=(t,e)=>Xl(t,"name",{value:e,configurable:!0});var eu=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Iv=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Mv(e))!Fv.call(t,i)&&i!==r&&Xl(t,i,{get:()=>e[i],enumerable:!(n=Dv(e,i))||n.enumerable});return t};var Ai=(t,e,r)=>(r=t!=null?Pv(Av(t)):{},Iv(e||!t||!t.__esModule?Xl(r,"default",{value:t,enumerable:!0}):r,t));var Fy=eu((Ay,ds)=>{(function(t,e){typeof ds=="object"&&ds.exports?ds.exports=e():t.nearley=e()})(Ay,function(){function t(c,l,u){return this.id=++t.highestId,this.name=c,this.symbols=l,this.postprocess=u,this}o(t,"Rule"),t.highestId=0,t.prototype.toString=function(c){var l=typeof c>"u"?this.symbols.map(p).join(" "):this.symbols.slice(0,c).map(p).join(" ")+" \u25CF "+this.symbols.slice(c).map(p).join(" ");return this.name+" \u2192 "+l};function e(c,l,u,m){this.rule=c,this.dot=l,this.reference=u,this.data=[],this.wantedBy=m,this.isComplete=this.dot===c.symbols.length}o(e,"State"),e.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},e.prototype.nextState=function(c){var l=new e(this.rule,this.dot+1,this.reference,this.wantedBy);return l.left=this,l.right=c,l.isComplete&&(l.data=l.build(),l.right=void 0),l},e.prototype.build=function(){var c=[],l=this;do c.push(l.right.data),l=l.left;while(l.left);return c.reverse(),c},e.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,a.fail))};function r(c,l){this.grammar=c,this.index=l,this.states=[],this.wants={},this.scannable=[],this.completed={}}o(r,"Column"),r.prototype.process=function(c){for(var l=this.states,u=this.wants,m=this.completed,f=0;f<l.length;f++){var d=l[f];if(d.isComplete){if(d.finish(),d.data!==a.fail){for(var y=d.wantedBy,T=y.length;T--;){var k=y[T];this.complete(k,d)}if(d.reference===this.index){var R=d.rule.name;(this.completed[R]=this.completed[R]||[]).push(d)}}}else{var R=d.rule.symbols[d.dot];if(typeof R!="string"){this.scannable.push(d);continue}if(u[R]){if(u[R].push(d),m.hasOwnProperty(R))for(var A=m[R],T=0;T<A.length;T++){var ne=A[T];this.complete(d,ne)}}else u[R]=[d],this.predict(R)}}},r.prototype.predict=function(c){for(var l=this.grammar.byName[c]||[],u=0;u<l.length;u++){var m=l[u],f=this.wants[c],d=new e(m,0,this.index,f);this.states.push(d)}},r.prototype.complete=function(c,l){var u=c.nextState(l);this.states.push(u)};function n(c,l){this.rules=c,this.start=l||this.rules[0].name;var u=this.byName={};this.rules.forEach(function(m){u.hasOwnProperty(m.name)||(u[m.name]=[]),u[m.name].push(m)})}o(n,"Grammar"),n.fromCompiled=function(m,l){var u=m.Lexer;m.ParserStart&&(l=m.ParserStart,m=m.ParserRules);var m=m.map(function(d){return new t(d.name,d.symbols,d.postprocess)}),f=new n(m,l);return f.lexer=u,f};function i(){this.reset("")}o(i,"StreamLexer"),i.prototype.reset=function(c,l){this.buffer=c,this.index=0,this.line=l?l.line:1,this.lastLineBreak=l?-l.col:0},i.prototype.next=function(){if(this.index<this.buffer.length){var c=this.buffer[this.index++];return c===`
`&&(this.line+=1,this.lastLineBreak=this.index),{value:c}}},i.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},i.prototype.formatError=function(c,l){var u=this.buffer;if(typeof u=="string"){var m=u.split(`
`).slice(Math.max(0,this.line-5),this.line),f=u.indexOf(`
`,this.index);f===-1&&(f=u.length);var d=this.index-this.lastLineBreak,y=String(this.line).length;return l+=" at line "+this.line+" col "+d+`:

`,l+=m.map(function(k,R){return T(this.line-m.length+R+1,y)+" "+k},this).join(`
`),l+=`
`+T("",y+d)+`^
`,l}else return l+" at index "+(this.index-1);function T(k,R){var A=String(k);return Array(R-A.length+1).join(" ")+A}o(T,"pad")};function a(c,l,u){if(c instanceof n)var m=c,u=l;else var m=n.fromCompiled(c,l);this.grammar=m,this.options={keepHistory:!1,lexer:m.lexer||new i};for(var f in u||{})this.options[f]=u[f];this.lexer=this.options.lexer,this.lexerState=void 0;var d=new r(m,0),y=this.table=[d];d.wants[m.start]=[],d.predict(m.start),d.process(),this.current=0}o(a,"Parser"),a.fail={},a.prototype.feed=function(c){var l=this.lexer;l.reset(c,this.lexerState);for(var u;;){try{if(u=l.next(),!u)break}catch(pe){var y=new r(this.grammar,this.current+1);this.table.push(y);var m=new Error(this.reportLexerError(pe));throw m.offset=this.current,m.token=pe.token,m}var f=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var d=this.current+1,y=new r(this.grammar,d);this.table.push(y);for(var T=u.text!==void 0?u.text:u.value,k=l.constructor===i?u.value:l.transform?.(u)??u,R=f.scannable,A=R.length;A--;){var ne=R[A],Fe=ne.rule.symbols[ne.dot];if(Fe.test?Fe.test(k):Fe.type?Fe.type===u.type:Fe.literal===T){var yt=ne.nextState({data:k,token:u,isToken:!0,reference:d-1});y.states.push(yt)}}if(y.process(),y.states.length===0){var m=new Error(this.reportError(u));throw m.offset=this.current,m.token=u,m}this.options.keepHistory&&(f.lexerState=l.save()),this.current++}return f&&(this.lexerState=l.save()),this.results=this.finish(),this},a.prototype.reportLexerError=function(c){var l,u,m=c.token;return m?(l="input "+JSON.stringify(m.text[0])+" (lexer error)",u=this.lexer.formatError(m,"Syntax error")):(l="input (lexer error)",u=c.message),this.reportErrorCommon(u,l)},a.prototype.reportError=function(c){var l=(c.type?c.type+" token: ":"")+JSON.stringify(c.value!==void 0?c.value:c),u=this.lexer.formatError(c,"Syntax error");return this.reportErrorCommon(u,l)},a.prototype.reportErrorCommon=function(c,l){var u=[];u.push(c);var m=this.table.length-2,f=this.table[m],d=f.states.filter(function(T){var k=T.rule.symbols[T.dot];return k&&typeof k!="string"});if(d.length===0)u.push("Unexpected "+l+`. I did not expect any more input. Here is the state of my parse table:
`),this.displayStateStack(f.states,u);else{u.push("Unexpected "+l+`. Instead, I was expecting to see one of the following:
`);var y=d.map(function(T){return this.buildFirstStateStack(T,[])||[T]},this);y.forEach(function(T){var k=T[0],R=k.rule.symbols[k.dot],A=this.getSymbolDisplay(R);u.push("A "+A+" based on:"),this.displayStateStack(T,u)},this)}return u.push(""),u.join(`
`)},a.prototype.displayStateStack=function(c,l){for(var u,m=0,f=0;f<c.length;f++){var d=c[f],y=d.rule.toString(d.dot);y===u?m++:(m>0&&l.push("    ^ "+m+" more lines identical to this"),m=0,l.push("    "+y)),u=y}},a.prototype.getSymbolDisplay=function(c){return s(c)},a.prototype.buildFirstStateStack=function(c,l){if(l.indexOf(c)!==-1)return null;if(c.wantedBy.length===0)return[c];var u=c.wantedBy[0],m=[c].concat(l),f=this.buildFirstStateStack(u,m);return f===null?null:[c].concat(f)},a.prototype.save=function(){var c=this.table[this.current];return c.lexerState=this.lexerState,c},a.prototype.restore=function(c){var l=c.index;this.current=l,this.table[l]=c,this.table.splice(l+1),this.lexerState=c.lexerState,this.results=this.finish()},a.prototype.rewind=function(c){if(!this.options.keepHistory)throw new Error("set option `keepHistory` to enable rewinding");this.restore(this.table[c])},a.prototype.finish=function(){var c=[],l=this.grammar.start,u=this.table[this.table.length-1];return u.states.forEach(function(m){m.rule.name===l&&m.dot===m.rule.symbols.length&&m.reference===0&&m.data!==a.fail&&c.push(m)}),c.map(function(m){return m.data})};function s(c){var l=typeof c;if(l==="string")return c;if(l==="object"){if(c.literal)return JSON.stringify(c.literal);if(c instanceof RegExp)return"character matching "+c;if(c.type)return c.type+" token";if(c.test)return"token matching "+String(c.test);throw new Error("Unknown symbol type: "+c)}}o(s,"getSymbolLongDisplay");function p(c){var l=typeof c;if(l==="string")return c;if(l==="object"){if(c.literal)return JSON.stringify(c.literal);if(c instanceof RegExp)return c.toString();if(c.type)return"%"+c.type;if(c.test)return"<"+String(c.test)+">";throw new Error("Unknown symbol type: "+c)}}return o(p,"getSymbolShortDisplay"),{Parser:a,Grammar:n,Rule:t}})});var Uy=eu((Ly,ys)=>{(function(t,e){typeof define=="function"&&define.amd?define([],e):typeof ys=="object"&&ys.exports?ys.exports=e():t.moo=e()})(Ly,function(){"use strict";var t=Object.prototype.hasOwnProperty,e=Object.prototype.toString,r=typeof new RegExp().sticky=="boolean";function n(S){return S&&e.call(S)==="[object RegExp]"}o(n,"isRegExp");function i(S){return S&&typeof S=="object"&&!n(S)&&!Array.isArray(S)}o(i,"isObject");function a(S){return S.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}o(a,"reEscape");function s(S){var x=new RegExp("|"+S);return x.exec("").length-1}o(s,"reGroups");function p(S){return"("+S+")"}o(p,"reCapture");function c(S){if(!S.length)return"(?!)";var x=S.map(function(h){return"(?:"+h+")"}).join("|");return"(?:"+x+")"}o(c,"reUnion");function l(S){if(typeof S=="string")return"(?:"+a(S)+")";if(n(S)){if(S.ignoreCase)throw new Error("RegExp /i flag not allowed");if(S.global)throw new Error("RegExp /g flag is implied");if(S.sticky)throw new Error("RegExp /y flag is implied");if(S.multiline)throw new Error("RegExp /m flag is implied");return S.source}else throw new Error("Not a pattern: "+S)}o(l,"regexpOrLiteral");function u(S,x){return S.length>x?S:Array(x-S.length+1).join(" ")+S}o(u,"pad");function m(S,x){for(var h=S.length,v=0;;){var w=S.lastIndexOf(`
`,h-1);if(w===-1||(v++,h=w,v===x)||h===0)break}var P=v<x?0:h+1;return S.substring(P).split(`
`)}o(m,"lastNLines");function f(S){for(var x=Object.getOwnPropertyNames(S),h=[],v=0;v<x.length;v++){var w=x[v],P=S[w],D=[].concat(P);if(w==="include"){for(var I=0;I<D.length;I++)h.push({include:D[I]});continue}var V=[];D.forEach(function(N){i(N)?(V.length&&h.push(y(w,V)),h.push(y(w,N)),V=[]):V.push(N)}),V.length&&h.push(y(w,V))}return h}o(f,"objectToRules");function d(S){for(var x=[],h=0;h<S.length;h++){var v=S[h];if(v.include){for(var w=[].concat(v.include),P=0;P<w.length;P++)x.push({include:w[P]});continue}if(!v.type)throw new Error("Rule has no type: "+JSON.stringify(v));x.push(y(v.type,v))}return x}o(d,"arrayToRules");function y(S,x){if(i(x)||(x={match:x}),x.include)throw new Error("Matching rules cannot also include states");var h={defaultType:S,lineBreaks:!!x.error||!!x.fallback,pop:!1,next:null,push:null,error:!1,fallback:!1,value:null,type:null,shouldThrow:!1};for(var v in x)t.call(x,v)&&(h[v]=x[v]);if(typeof h.type=="string"&&S!==h.type)throw new Error("Type transform cannot be a string (type '"+h.type+"' for token '"+S+"')");var w=h.match;return h.match=Array.isArray(w)?w:w?[w]:[],h.match.sort(function(P,D){return n(P)&&n(D)?0:n(D)?-1:n(P)?1:D.length-P.length}),h}o(y,"ruleOptions");function T(S){return Array.isArray(S)?d(S):f(S)}o(T,"toRules");var k=y("error",{lineBreaks:!0,shouldThrow:!0});function R(S,x){for(var h=null,v=Object.create(null),w=!0,P=null,D=[],I=[],V=0;V<S.length;V++)S[V].fallback&&(w=!1);for(var V=0;V<S.length;V++){var N=S[V];if(N.include)throw new Error("Inheritance is not allowed in stateless lexers");if(N.error||N.fallback){if(h)throw!N.fallback==!h.fallback?new Error("Multiple "+(N.fallback?"fallback":"error")+" rules not allowed (for token '"+N.defaultType+"')"):new Error("fallback and error are mutually exclusive (for token '"+N.defaultType+"')");h=N}var z=N.match.slice();if(w)for(;z.length&&typeof z[0]=="string"&&z[0].length===1;){var ot=z.shift();v[ot.charCodeAt(0)]=N}if(N.pop||N.push||N.next){if(!x)throw new Error("State-switching options are not allowed in stateless lexers (for token '"+N.defaultType+"')");if(N.fallback)throw new Error("State-switching options are not allowed on fallback tokens (for token '"+N.defaultType+"')")}if(z.length!==0){w=!1,D.push(N);for(var Ir=0;Ir<z.length;Ir++){var Or=z[Ir];if(n(Or)){if(P===null)P=Or.unicode;else if(P!==Or.unicode&&N.fallback===!1)throw new Error("If one rule is /u then all must be")}}var fn=c(z.map(l)),Tt=new RegExp(fn);if(Tt.test(""))throw new Error("RegExp matches empty string: "+Tt);var Di=s(fn);if(Di>0)throw new Error("RegExp has capture groups: "+Tt+`
Use (?: \u2026 ) instead`);if(!N.lineBreaks&&Tt.test(`
`))throw new Error("Rule should declare lineBreaks: "+Tt);I.push(p(fn))}}var dn=h&&h.fallback,Mi=r&&!dn?"ym":"gm",Jo=r||dn?"":"|";P===!0&&(Mi+="u");var kv=new RegExp(c(I)+Jo,Mi);return{regexp:kv,groups:D,fast:v,error:h||k}}o(R,"compileRules");function A(S){var x=R(T(S));return new pe({start:x},"start")}o(A,"compile");function ne(S,x,h){var v=S&&(S.push||S.next);if(v&&!h[v])throw new Error("Missing state '"+v+"' (in token '"+S.defaultType+"' of state '"+x+"')");if(S&&S.pop&&+S.pop!=1)throw new Error("pop must be 1 (in token '"+S.defaultType+"' of state '"+x+"')")}o(ne,"checkStateGroup");function Fe(S,x){var h=S.$all?T(S.$all):[];delete S.$all;var v=Object.getOwnPropertyNames(S);x||(x=v[0]);for(var w=Object.create(null),P=0;P<v.length;P++){var D=v[P];w[D]=T(S[D]).concat(h)}for(var P=0;P<v.length;P++)for(var D=v[P],I=w[D],V=Object.create(null),N=0;N<I.length;N++){var z=I[N];if(z.include){var ot=[N,1];if(z.include!==D&&!V[z.include]){V[z.include]=!0;var Ir=w[z.include];if(!Ir)throw new Error("Cannot include nonexistent state '"+z.include+"' (in state '"+D+"')");for(var Or=0;Or<Ir.length;Or++){var fn=Ir[Or];I.indexOf(fn)===-1&&ot.push(fn)}}I.splice.apply(I,ot),N--}}for(var Tt=Object.create(null),P=0;P<v.length;P++){var D=v[P];Tt[D]=R(w[D],!0)}for(var P=0;P<v.length;P++){for(var Di=v[P],dn=Tt[Di],Mi=dn.groups,N=0;N<Mi.length;N++)ne(Mi[N],Di,Tt);for(var Jo=Object.getOwnPropertyNames(dn.fast),N=0;N<Jo.length;N++)ne(dn.fast[Jo[N]],Di,Tt)}return new pe(Tt,x)}o(Fe,"compileStates");function yt(S){for(var x=typeof Map<"u",h=x?new Map:Object.create(null),v=Object.getOwnPropertyNames(S),w=0;w<v.length;w++){var P=v[w],D=S[P],I=Array.isArray(D)?D:[D];I.forEach(function(V){if(typeof V!="string")throw new Error("keyword must be string (in keyword '"+P+"')");x?h.set(V,P):h[V]=P})}return function(V){return x?h.get(V):h[V]}}o(yt,"keywordTransform");var pe=o(function(S,x){this.startState=x,this.states=S,this.buffer="",this.stack=[],this.reset()},"Lexer");pe.prototype.reset=function(S,x){return this.buffer=S||"",this.index=0,this.line=x?x.line:1,this.col=x?x.col:1,this.queuedToken=x?x.queuedToken:null,this.queuedText=x?x.queuedText:"",this.queuedThrow=x?x.queuedThrow:null,this.setState(x?x.state:this.startState),this.stack=x&&x.stack?x.stack.slice():[],this},pe.prototype.save=function(){return{line:this.line,col:this.col,state:this.state,stack:this.stack.slice(),queuedToken:this.queuedToken,queuedText:this.queuedText,queuedThrow:this.queuedThrow}},pe.prototype.setState=function(S){if(!(!S||this.state===S)){this.state=S;var x=this.states[S];this.groups=x.groups,this.error=x.error,this.re=x.regexp,this.fast=x.fast}},pe.prototype.popState=function(){this.setState(this.stack.pop())},pe.prototype.pushState=function(S){this.stack.push(this.state),this.setState(S)};var Yo=r?function(S,x){return S.exec(x)}:function(S,x){var h=S.exec(x);return h[0].length===0?null:h};pe.prototype._getGroup=function(S){for(var x=this.groups.length,h=0;h<x;h++)if(S[h+1]!==void 0)return this.groups[h];throw new Error("Cannot find token type for matched text")};function Fr(){return this.value}if(o(Fr,"tokenToString"),pe.prototype.next=function(){var S=this.index;if(this.queuedGroup){var x=this._token(this.queuedGroup,this.queuedText,S);return this.queuedGroup=null,this.queuedText="",x}var h=this.buffer;if(S!==h.length){var D=this.fast[h.charCodeAt(S)];if(D)return this._token(D,h.charAt(S),S);var v=this.re;v.lastIndex=S;var w=Yo(v,h),P=this.error;if(w==null)return this._token(P,h.slice(S,h.length),S);var D=this._getGroup(w),I=w[0];return P.fallback&&w.index!==S?(this.queuedGroup=D,this.queuedText=I,this._token(P,h.slice(S,w.index),S)):this._token(D,I,S)}},pe.prototype._token=function(S,x,h){var v=0;if(S.lineBreaks){var w=/\n/g,P=1;if(x===`
`)v=1;else for(;w.exec(x);)v++,P=w.lastIndex}var D={type:typeof S.type=="function"&&S.type(x)||S.defaultType,value:typeof S.value=="function"?S.value(x):x,text:x,toString:Fr,offset:h,lineBreaks:v,line:this.line,col:this.col},I=x.length;if(this.index+=I,this.line+=v,v!==0?this.col=I-P+1:this.col+=I,S.shouldThrow){var V=new Error(this.formatError(D,"invalid syntax"));throw V}return S.pop?this.popState():S.push?this.pushState(S.push):S.next&&this.setState(S.next),D},typeof Symbol<"u"&&Symbol.iterator){var tr=o(function(S){this.lexer=S},"LexerIterator");tr.prototype.next=function(){var S=this.lexer.next();return{value:S,done:!S}},tr.prototype[Symbol.iterator]=function(){return this},pe.prototype[Symbol.iterator]=function(){return new tr(this)}}return pe.prototype.formatError=function(S,x){if(S==null)var h=this.buffer.slice(this.index),S={text:h,offset:this.index,lineBreaks:h.indexOf(`
`)===-1?0:1,line:this.line,col:this.col};var v=2,w=Math.max(S.line-v,1),P=S.line+v,D=String(P).length,I=m(this.buffer,this.line-S.line+v+1).slice(0,5),V=[];V.push(x+" at line "+S.line+" col "+S.col+":"),V.push("");for(var N=0;N<I.length;N++){var z=I[N],ot=w+N;V.push(u(String(ot),D)+"  "+z),ot===S.line&&V.push(u("",D+S.col+1)+"^")}return V.join(`
`)},pe.prototype.clone=function(){return new pe(this.states,this.state)},pe.prototype.has=function(S){return!0},{compile:A,states:Fe,error:Object.freeze({error:!0}),fallback:Object.freeze({fallback:!0}),keywords:yt}})});var Zs=eu((Ot,DT)=>{"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});function bt(t){return typeof t=="object"&&!("toString"in t)?Object.prototype.toString.call(t).slice(8,-1):t}o(bt,"stringifiable");var SA=typeof process=="object"&&process.env.NODE_ENV==="production";function lt(t,e){if(!t)throw SA?new Error("Invariant failed"):new Error(e())}o(lt,"invariant");Ot.invariant=lt;var Rm=Object.prototype.hasOwnProperty,vA=Array.prototype.splice,bA=Object.prototype.toString;function Kr(t){return bA.call(t).slice(8,-1)}o(Kr,"type");var Qs=Object.assign||function(t,e){return wm(e).forEach(function(r){Rm.call(e,r)&&(t[r]=e[r])}),t},wm=typeof Object.getOwnPropertySymbols=="function"?function(t){return Object.keys(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.keys(t)};function br(t){return Array.isArray(t)?Qs(t.constructor(t.length),t):Kr(t)==="Map"?new Map(t):Kr(t)==="Set"?new Set(t):t&&typeof t=="object"?Qs(Object.create(Object.getPrototypeOf(t)),t):t}o(br,"copy");var kT=function(){function t(){this.commands=Qs({},RA),this.update=this.update.bind(this),this.update.extend=this.extend=this.extend.bind(this),this.update.isEquals=function(e,r){return e===r},this.update.newContext=function(){return new t().update}}return o(t,"Context"),Object.defineProperty(t.prototype,"isEquals",{get:o(function(){return this.update.isEquals},"get"),set:o(function(e){this.update.isEquals=e},"set"),enumerable:!0,configurable:!0}),t.prototype.extend=function(e,r){this.commands[e]=r},t.prototype.update=function(e,r){var n=this,i=typeof r=="function"?{$apply:r}:r;Array.isArray(e)&&Array.isArray(i)||lt(!Array.isArray(i),function(){return"update(): You provided an invalid spec to update(). The spec may not contain an array except as the value of $set, $push, $unshift, $splice or any custom command allowing an array value."}),lt(typeof i=="object"&&i!==null,function(){return"update(): You provided an invalid spec to update(). The spec and every included key path must be plain objects containing one of the "+("following commands: "+Object.keys(n.commands).join(", ")+".")});var a=e;return wm(i).forEach(function(s){if(Rm.call(n.commands,s)){var p=e===a;a=n.commands[s](i[s],a,i,e),p&&n.isEquals(a,e)&&(a=e)}else{var c=Kr(e)==="Map"?n.update(e.get(s),i[s]):n.update(e[s],i[s]),l=Kr(a)==="Map"?a.get(s):a[s];(!n.isEquals(c,l)||typeof c>"u"&&!Rm.call(e,s))&&(a===e&&(a=br(e)),Kr(a)==="Map"?a.set(s,c):a[s]=c)}}),a},t}();Ot.Context=kT;var RA={$push:o(function(t,e,r){return ET(e,r,"$push"),t.length?e.concat(t):e},"$push"),$unshift:o(function(t,e,r){return ET(e,r,"$unshift"),t.length?t.concat(e):e},"$unshift"),$splice:o(function(t,e,r,n){return wA(e,r),t.forEach(function(i){PT(i),e===n&&i.length&&(e=br(n)),vA.apply(e,i)}),e},"$splice"),$set:o(function(t,e,r){return _A(r),t},"$set"),$toggle:o(function(t,e){so(t,"$toggle");var r=t.length?br(e):e;return t.forEach(function(n){r[n]=!e[n]}),r},"$toggle"),$unset:o(function(t,e,r,n){return so(t,"$unset"),t.forEach(function(i){Object.hasOwnProperty.call(e,i)&&(e===n&&(e=br(n)),delete e[i])}),e},"$unset"),$add:o(function(t,e,r,n){return _T(e,"$add"),so(t,"$add"),Kr(e)==="Map"?t.forEach(function(i){var a=i[0],s=i[1];e===n&&e.get(a)!==s&&(e=br(n)),e.set(a,s)}):t.forEach(function(i){e===n&&!e.has(i)&&(e=br(n)),e.add(i)}),e},"$add"),$remove:o(function(t,e,r,n){return _T(e,"$remove"),so(t,"$remove"),t.forEach(function(i){e===n&&e.has(i)&&(e=br(n)),e.delete(i)}),e},"$remove"),$merge:o(function(t,e,r,n){return kA(e,t),wm(t).forEach(function(i){t[i]!==e[i]&&(e===n&&(e=br(n)),e[i]=t[i])}),e},"$merge"),$apply:o(function(t,e){return EA(t),t(e)},"$apply")},Em=new kT;Ot.isEquals=Em.update.isEquals;Ot.extend=Em.extend;Ot.default=Em.update;Ot.default.default=DT.exports=Qs(Ot.default,Ot);function ET(t,e,r){lt(Array.isArray(t),function(){return"update(): expected target of "+bt(r)+" to be an array; got "+bt(t)+"."}),so(e[r],r)}o(ET,"invariantPushAndUnshift");function so(t,e){lt(Array.isArray(t),function(){return"update(): expected spec of "+bt(e)+" to be an array; got "+bt(t)+". Did you forget to wrap your parameter in an array?"})}o(so,"invariantSpecArray");function wA(t,e){lt(Array.isArray(t),function(){return"Expected $splice target to be an array; got "+bt(t)}),PT(e.$splice)}o(wA,"invariantSplices");function PT(t){lt(Array.isArray(t),function(){return"update(): expected spec of $splice to be an array of arrays; got "+bt(t)+". Did you forget to wrap your parameters in an array?"})}o(PT,"invariantSplice");function EA(t){lt(typeof t=="function",function(){return"update(): expected spec of $apply to be a function; got "+bt(t)+"."})}o(EA,"invariantApply");function _A(t){lt(Object.keys(t).length===1,function(){return"Cannot have more than one key in an object with $set"})}o(_A,"invariantSet");function kA(t,e){lt(e&&typeof e=="object",function(){return"update(): $merge expects a spec of type 'object'; got "+bt(e)}),lt(t&&typeof t=="object",function(){return"update(): $merge expects a target of type 'object'; got "+bt(t)})}o(kA,"invariantMerge");function _T(t,e){var r=Kr(t);lt(r==="Map"||r==="Set",function(){return"update(): "+bt(e)+" expects a target of type Set or Map; got "+bt(r)})}o(_T,"invariantMapOrSet")});var Xo=globalThis;Xo.process==null&&(Xo.process={env:{}});typeof print<"u"&&(Xo.console={log:print,error:print,warn:print,debug:print});Xo.setTimeout=(t,e)=>{t()};var Ff="cursorless.command",ea=class{constructor(e){this.baseTitle=e}static{o(this,"Command")}get title(){return`Cursorless: ${this.baseTitle}`}},ue=class extends ea{constructor(){super(...arguments);this.isVisible=!1}static{o(this,"HiddenCommand")}},de=class extends ea{constructor(){super(...arguments);this.isVisible=!0}static{o(this,"VisibleCommand")}};var SC={"cursorless.toggleDecorations":new de("Toggle decorations"),"cursorless.recomputeDecorationStyles":new de("Recompute decoration styles"),"cursorless.recordTestCase":new de("Record test case"),"cursorless.recordOneTestCaseThenPause":new de("Record one test case, then pause"),"cursorless.pauseRecording":new de("Pause test case recording"),"cursorless.resumeRecording":new de("Resume test case recording"),"cursorless.recordScopeTests.showUnimplementedFacets":new de("Bulk record unimplemented scope facets"),"cursorless.recordScopeTests.saveActiveDocument":new de("Bulk save scope tests for the active document"),"cursorless.showDocumentation":new de("Show documentation"),"cursorless.showScopeVisualizer":new de("Show the scope visualizer"),"cursorless.hideScopeVisualizer":new de("Hide the scope visualizer"),"cursorless.analyzeCommandHistory":new de("Analyze collected command history"),"cursorless.tutorial.start":new ue("Start a tutorial"),"cursorless.tutorial.next":new de("Tutorial next"),"cursorless.tutorial.previous":new de("Tutorial previous"),"cursorless.tutorial.restart":new de("Tutorial restart"),"cursorless.tutorial.resume":new de("Tutorial resume"),"cursorless.tutorial.list":new de("Tutorial list"),"cursorless.documentationOpened":new ue("Used by talon to notify us that the docs have been opened; for use with tutorial"),"cursorless.command":new ue("The core cursorless command"),"cursorless.repeatPreviousCommand":new de("Repeat the previous Cursorless command"),"cursorless.showQuickPick":new ue("Pop up a quick pick of all cursorless commands"),"cursorless.showCheatsheet":new ue("Display the cursorless cheatsheet"),"cursorless.internal.updateCheatsheetDefaults":new ue("Update the default values of the cheatsheet payload used on the website and for local development. Be sure to run this on stock community and cursorless."),"cursorless.private.logQuickActions":new ue("Log the quick actions available at the current cursor position"),"cursorless.takeSnapshot":new ue("Take a snapshot of the current editor state"),"cursorless.keyboard.escape":new ue("Should be mapped to the escape key when using cursorless keyboard. By default, exits modal keyboard mode, but changes behaviour when Cursorless is expecting a continuation keystroke.  For example, when you type a color and Cursorless is waiting for a character, it cancels the color and switches back to modal mode."),"cursorless.keyboard.targeted.targetHat":new ue("Sets the keyboard target to the given hat"),"cursorless.keyboard.targeted.targetScope":new ue("Sets the keyboard target to the scope containing the current target"),"cursorless.keyboard.targeted.targetSelection":new ue("Sets the keyboard target to the current selection"),"cursorless.keyboard.targeted.clearTarget":new ue("Clears the current keyboard target"),"cursorless.keyboard.targeted.runActionOnTarget":new ue("Run the given action on the current keyboard target"),"cursorless.keyboard.modal.modeOn":new ue("Turn on the cursorless modal mode"),"cursorless.keyboard.modal.modeOff":new ue("Turn off the cursorless modal mode"),"cursorless.keyboard.modal.modeToggle":new ue("Toggle the cursorless modal mode"),"cursorless.keyboard.undoTarget":new ue("Undo keyboard targeting changes"),"cursorless.keyboard.redoTarget":new ue("Redo keyboard targeting changes")};var ta=class{constructor(e,r){this.callback=e;this.debounceDelayMs=r;this.timeoutHandle=null;this.run=this.run.bind(this)}static{o(this,"Debouncer")}run(){this.timeoutHandle!=null&&clearTimeout(this.timeoutHandle),this.timeoutHandle=setTimeout(()=>{this.callback(),this.timeoutHandle=null},this.debounceDelayMs)}dispose(){this.timeoutHandle!=null&&clearTimeout(this.timeoutHandle)}};var ra=class extends Error{static{o(this,"UnsupportedLanguageError")}constructor(e){super(`Language '${e}' is not implemented yet; See https://www.cursorless.org/docs/contributing/adding-a-new-language/`),this.name="UnsupportedLanguageError"}};var na=class extends Error{static{o(this,"OutdatedExtensionError")}constructor(){super("Cursorless Talon version is ahead of Cursorless VSCode extension version. Please update Cursorless VSCode.")}},ve=class extends Error{static{o(this,"NoContainingScopeError")}constructor(e){super(`Couldn't find containing ${e}.`),this.name="NoContainingScopeError"}};var ia=class{static{o(this,"FakeCommandServerApi")}constructor(){this.signals={prePhrase:{getVersion:o(async()=>null,"getVersion")}}}async getFocusedElementType(){return this.focusedElementType}setFocusedElementType(e){this.focusedElementType=e}};var Ov=typeof global=="object"&&global&&global.Object===Object&&global,oa=Ov;var Cv=typeof self=="object"&&self&&self.Object===Object&&self,Nv=oa||Cv||Function("return this")(),be=Nv;var Lv=be.Symbol,Ie=Lv;var If=Object.prototype,Uv=If.hasOwnProperty,Hv=If.toString,Fi=Ie?Ie.toStringTag:void 0;function Vv(t){var e=Uv.call(t,Fi),r=t[Fi];try{t[Fi]=void 0;var n=!0}catch{}var i=Hv.call(t);return n&&(e?t[Fi]=r:delete t[Fi]),i}o(Vv,"getRawTag");var Of=Vv;var Bv=Object.prototype,Wv=Bv.toString;function jv(t){return Wv.call(t)}o(jv,"objectToString");var Cf=jv;var $v="[object Null]",qv="[object Undefined]",Nf=Ie?Ie.toStringTag:void 0;function zv(t){return t==null?t===void 0?qv:$v:Nf&&Nf in Object(t)?Of(t):Cf(t)}o(zv,"baseGetTag");var xt=zv;function Gv(t){return t!=null&&typeof t=="object"}o(Gv,"isObjectLike");var Oe=Gv;var Kv="[object Symbol]";function Qv(t){return typeof t=="symbol"||Oe(t)&&xt(t)==Kv}o(Qv,"isSymbol");var Ze=Qv;function Zv(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}o(Zv,"arrayMap");var at=Zv;var Yv=Array.isArray,X=Yv;var Jv=1/0,Lf=Ie?Ie.prototype:void 0,Uf=Lf?Lf.toString:void 0;function Hf(t){if(typeof t=="string")return t;if(X(t))return at(t,Hf)+"";if(Ze(t))return Uf?Uf.call(t):"";var e=t+"";return e=="0"&&1/t==-Jv?"-0":e}o(Hf,"baseToString");var Vf=Hf;var Xv=/\s/;function eb(t){for(var e=t.length;e--&&Xv.test(t.charAt(e)););return e}o(eb,"trimmedEndIndex");var Bf=eb;var tb=/^\s+/;function rb(t){return t&&t.slice(0,Bf(t)+1).replace(tb,"")}o(rb,"baseTrim");var Wf=rb;function nb(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}o(nb,"isObject");var Ye=nb;var jf=NaN,ib=/^[-+]0x[0-9a-f]+$/i,ob=/^0b[01]+$/i,ab=/^0o[0-7]+$/i,sb=parseInt;function pb(t){if(typeof t=="number")return t;if(Ze(t))return jf;if(Ye(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Ye(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Wf(t);var r=ob.test(t);return r||ab.test(t)?sb(t.slice(2),r?2:8):ib.test(t)?jf:+t}o(pb,"toNumber");var $f=pb;var qf=1/0,cb=17976931348623157e292;function lb(t){if(!t)return t===0?t:0;if(t=$f(t),t===qf||t===-qf){var e=t<0?-1:1;return e*cb}return t===t?t:0}o(lb,"toFinite");var gn=lb;function ub(t){var e=gn(t),r=e%1;return e===e?r?e-r:e:0}o(ub,"toInteger");var aa=ub;function mb(t){return t}o(mb,"identity");var Pe=mb;var fb="[object AsyncFunction]",db="[object Function]",gb="[object GeneratorFunction]",hb="[object Proxy]";function yb(t){if(!Ye(t))return!1;var e=xt(t);return e==db||e==gb||e==fb||e==hb}o(yb,"isFunction");var sa=yb;var Tb=be["__core-js_shared__"],pa=Tb;var zf=function(){var t=/[^.]+$/.exec(pa&&pa.keys&&pa.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function xb(t){return!!zf&&zf in t}o(xb,"isMasked");var Gf=xb;var Sb=Function.prototype,vb=Sb.toString;function bb(t){if(t!=null){try{return vb.call(t)}catch{}try{return t+""}catch{}}return""}o(bb,"toSource");var Vt=bb;var Rb=/[\\^$.*+?()[\]{}|]/g,wb=/^\[object .+?Constructor\]$/,Eb=Function.prototype,_b=Object.prototype,kb=Eb.toString,Pb=_b.hasOwnProperty,Db=RegExp("^"+kb.call(Pb).replace(Rb,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Mb(t){if(!Ye(t)||Gf(t))return!1;var e=sa(t)?Db:wb;return e.test(Vt(t))}o(Mb,"baseIsNative");var Kf=Mb;function Ab(t,e){return t?.[e]}o(Ab,"getValue");var Qf=Ab;function Fb(t,e){var r=Qf(t,e);return Kf(r)?r:void 0}o(Fb,"getNative");var Ue=Fb;var Ib=Ue(be,"WeakMap"),Cr=Ib;var Ob=Cr&&new Cr,tu=Ob;var Zf=Object.create,Cb=function(){function t(){}return o(t,"object"),function(e){if(!Ye(e))return{};if(Zf)return Zf(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),ca=Cb;function Nb(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}o(Nb,"apply");var Yf=Nb;function Lb(){}o(Lb,"baseLodash");var hn=Lb;var Ub=4294967295;function la(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ub,this.__views__=[]}o(la,"LazyWrapper");la.prototype=ca(hn.prototype);la.prototype.constructor=la;var yn=la;function Hb(){}o(Hb,"noop");var ua=Hb;var Vb=tu?function(t){return tu.get(t)}:ua,ma=Vb;var Bb={},ru=Bb;var Wb=Object.prototype,jb=Wb.hasOwnProperty;function $b(t){for(var e=t.name+"",r=ru[e],n=jb.call(ru,e)?r.length:0;n--;){var i=r[n],a=i.func;if(a==null||a==t)return i.name}return e}o($b,"getFuncName");var Tn=$b;function fa(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}o(fa,"LodashWrapper");fa.prototype=ca(hn.prototype);fa.prototype.constructor=fa;var rr=fa;function qb(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}o(qb,"copyArray");var nr=qb;function zb(t){if(t instanceof yn)return t.clone();var e=new rr(t.__wrapped__,t.__chain__);return e.__actions__=nr(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}o(zb,"wrapperClone");var Jf=zb;var Gb=Object.prototype,Kb=Gb.hasOwnProperty;function da(t){if(Oe(t)&&!X(t)&&!(t instanceof yn)){if(t instanceof rr)return t;if(Kb.call(t,"__wrapped__"))return Jf(t)}return new rr(t)}o(da,"lodash");da.prototype=hn.prototype;da.prototype.constructor=da;var Xf=da;function Qb(t){var e=Tn(t),r=Xf[e];if(typeof r!="function"||!(e in yn.prototype))return!1;if(t===r)return!0;var n=ma(r);return!!n&&t===n[0]}o(Qb,"isLaziable");var nu=Qb;var Zb=800,Yb=16,Jb=Date.now;function Xb(t){var e=0,r=0;return function(){var n=Jb(),i=Yb-(n-r);if(r=n,i>0){if(++e>=Zb)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}o(Xb,"shortOut");var ed=Xb;function eR(t){return function(){return t}}o(eR,"constant");var td=eR;var tR=function(){try{var t=Ue(Object,"defineProperty");return t({},"",{}),t}catch{}}(),xn=tR;var rR=xn?function(t,e){return xn(t,"toString",{configurable:!0,enumerable:!1,value:td(e),writable:!0})}:Pe,rd=rR;var nR=ed(rd),ga=nR;function iR(t,e,r,n){for(var i=t.length,a=r+(n?1:-1);n?a--:++a<i;)if(e(t[a],a,t))return a;return-1}o(iR,"baseFindIndex");var ha=iR;function oR(t){return t!==t}o(oR,"baseIsNaN");var nd=oR;function aR(t,e,r){for(var n=r-1,i=t.length;++n<i;)if(t[n]===e)return n;return-1}o(aR,"strictIndexOf");var id=aR;function sR(t,e,r){return e===e?id(t,e,r):ha(t,nd,r)}o(sR,"baseIndexOf");var ya=sR;function pR(t,e){var r=t==null?0:t.length;return!!r&&ya(t,e,0)>-1}o(pR,"arrayIncludes");var od=pR;var cR=9007199254740991,lR=/^(?:0|[1-9]\d*)$/;function uR(t,e){var r=typeof t;return e=e??cR,!!e&&(r=="number"||r!="symbol"&&lR.test(t))&&t>-1&&t%1==0&&t<e}o(uR,"isIndex");var Sn=uR;function mR(t,e,r){e=="__proto__"&&xn?xn(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}o(mR,"baseAssignValue");var ad=mR;function fR(t,e){return t===e||t!==t&&e!==e}o(fR,"eq");var vn=fR;var sd=Math.max;function dR(t,e,r){return e=sd(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,a=sd(n.length-e,0),s=Array(a);++i<a;)s[i]=n[e+i];i=-1;for(var p=Array(e+1);++i<e;)p[i]=n[i];return p[e]=r(s),Yf(t,this,p)}}o(dR,"overRest");var Ta=dR;function gR(t,e){return ga(Ta(t,e,Pe),t+"")}o(gR,"baseRest");var bn=gR;var hR=9007199254740991;function yR(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=hR}o(yR,"isLength");var Rn=yR;function TR(t){return t!=null&&Rn(t.length)&&!sa(t)}o(TR,"isArrayLike");var kt=TR;function xR(t,e,r){if(!Ye(r))return!1;var n=typeof e;return(n=="number"?kt(r)&&Sn(e,r.length):n=="string"&&e in r)?vn(r[e],t):!1}o(xR,"isIterateeCall");var Nr=xR;var SR=Object.prototype;function vR(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||SR;return t===r}o(vR,"isPrototype");var pd=vR;function bR(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}o(bR,"baseTimes");var xa=bR;var RR="[object Arguments]";function wR(t){return Oe(t)&&xt(t)==RR}o(wR,"baseIsArguments");var iu=wR;var cd=Object.prototype,ER=cd.hasOwnProperty,_R=cd.propertyIsEnumerable,kR=iu(function(){return arguments}())?iu:function(t){return Oe(t)&&ER.call(t,"callee")&&!_R.call(t,"callee")},wn=kR;function PR(){return!1}o(PR,"stubFalse");var ld=PR;var fd=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ud=fd&&typeof module=="object"&&module&&!module.nodeType&&module,DR=ud&&ud.exports===fd,md=DR?be.Buffer:void 0,MR=md?md.isBuffer:void 0,AR=MR||ld,Ii=AR;var FR="[object Arguments]",IR="[object Array]",OR="[object Boolean]",CR="[object Date]",NR="[object Error]",LR="[object Function]",UR="[object Map]",HR="[object Number]",VR="[object Object]",BR="[object RegExp]",WR="[object Set]",jR="[object String]",$R="[object WeakMap]",qR="[object ArrayBuffer]",zR="[object DataView]",GR="[object Float32Array]",KR="[object Float64Array]",QR="[object Int8Array]",ZR="[object Int16Array]",YR="[object Int32Array]",JR="[object Uint8Array]",XR="[object Uint8ClampedArray]",ew="[object Uint16Array]",tw="[object Uint32Array]",ie={};ie[GR]=ie[KR]=ie[QR]=ie[ZR]=ie[YR]=ie[JR]=ie[XR]=ie[ew]=ie[tw]=!0;ie[FR]=ie[IR]=ie[qR]=ie[OR]=ie[zR]=ie[CR]=ie[NR]=ie[LR]=ie[UR]=ie[HR]=ie[VR]=ie[BR]=ie[WR]=ie[jR]=ie[$R]=!1;function rw(t){return Oe(t)&&Rn(t.length)&&!!ie[xt(t)]}o(rw,"baseIsTypedArray");var dd=rw;function nw(t){return function(e){return t(e)}}o(nw,"baseUnary");var En=nw;var gd=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Oi=gd&&typeof module=="object"&&module&&!module.nodeType&&module,iw=Oi&&Oi.exports===gd,ou=iw&&oa.process,ow=function(){try{var t=Oi&&Oi.require&&Oi.require("util").types;return t||ou&&ou.binding&&ou.binding("util")}catch{}}(),au=ow;var hd=au&&au.isTypedArray,aw=hd?En(hd):dd,Sa=aw;var sw=Object.prototype,pw=sw.hasOwnProperty;function cw(t,e){var r=X(t),n=!r&&wn(t),i=!r&&!n&&Ii(t),a=!r&&!n&&!i&&Sa(t),s=r||n||i||a,p=s?xa(t.length,String):[],c=p.length;for(var l in t)(e||pw.call(t,l))&&!(s&&(l=="length"||i&&(l=="offset"||l=="parent")||a&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||Sn(l,c)))&&p.push(l);return p}o(cw,"arrayLikeKeys");var yd=cw;function lw(t,e){return function(r){return t(e(r))}}o(lw,"overArg");var Td=lw;var uw=Td(Object.keys,Object),xd=uw;var mw=Object.prototype,fw=mw.hasOwnProperty;function dw(t){if(!pd(t))return xd(t);var e=[];for(var r in Object(t))fw.call(t,r)&&r!="constructor"&&e.push(r);return e}o(dw,"baseKeys");var Sd=dw;function gw(t){return kt(t)?yd(t):Sd(t)}o(gw,"keys");var ir=gw;var hw=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,yw=/^\w*$/;function Tw(t,e){if(X(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||Ze(t)?!0:yw.test(t)||!hw.test(t)||e!=null&&t in Object(e)}o(Tw,"isKey");var _n=Tw;var xw=Ue(Object,"create"),Bt=xw;function Sw(){this.__data__=Bt?Bt(null):{},this.size=0}o(Sw,"hashClear");var vd=Sw;function vw(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}o(vw,"hashDelete");var bd=vw;var bw="__lodash_hash_undefined__",Rw=Object.prototype,ww=Rw.hasOwnProperty;function Ew(t){var e=this.__data__;if(Bt){var r=e[t];return r===bw?void 0:r}return ww.call(e,t)?e[t]:void 0}o(Ew,"hashGet");var Rd=Ew;var _w=Object.prototype,kw=_w.hasOwnProperty;function Pw(t){var e=this.__data__;return Bt?e[t]!==void 0:kw.call(e,t)}o(Pw,"hashHas");var wd=Pw;var Dw="__lodash_hash_undefined__";function Mw(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Bt&&e===void 0?Dw:e,this}o(Mw,"hashSet");var Ed=Mw;function kn(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}o(kn,"Hash");kn.prototype.clear=vd;kn.prototype.delete=bd;kn.prototype.get=Rd;kn.prototype.has=wd;kn.prototype.set=Ed;var su=kn;function Aw(){this.__data__=[],this.size=0}o(Aw,"listCacheClear");var _d=Aw;function Fw(t,e){for(var r=t.length;r--;)if(vn(t[r][0],e))return r;return-1}o(Fw,"assocIndexOf");var or=Fw;var Iw=Array.prototype,Ow=Iw.splice;function Cw(t){var e=this.__data__,r=or(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():Ow.call(e,r,1),--this.size,!0}o(Cw,"listCacheDelete");var kd=Cw;function Nw(t){var e=this.__data__,r=or(e,t);return r<0?void 0:e[r][1]}o(Nw,"listCacheGet");var Pd=Nw;function Lw(t){return or(this.__data__,t)>-1}o(Lw,"listCacheHas");var Dd=Lw;function Uw(t,e){var r=this.__data__,n=or(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}o(Uw,"listCacheSet");var Md=Uw;function Pn(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}o(Pn,"ListCache");Pn.prototype.clear=_d;Pn.prototype.delete=kd;Pn.prototype.get=Pd;Pn.prototype.has=Dd;Pn.prototype.set=Md;var ar=Pn;var Hw=Ue(be,"Map"),sr=Hw;function Vw(){this.size=0,this.__data__={hash:new su,map:new(sr||ar),string:new su}}o(Vw,"mapCacheClear");var Ad=Vw;function Bw(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}o(Bw,"isKeyable");var Fd=Bw;function Ww(t,e){var r=t.__data__;return Fd(e)?r[typeof e=="string"?"string":"hash"]:r.map}o(Ww,"getMapData");var pr=Ww;function jw(t){var e=pr(this,t).delete(t);return this.size-=e?1:0,e}o(jw,"mapCacheDelete");var Id=jw;function $w(t){return pr(this,t).get(t)}o($w,"mapCacheGet");var Od=$w;function qw(t){return pr(this,t).has(t)}o(qw,"mapCacheHas");var Cd=qw;function zw(t,e){var r=pr(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}o(zw,"mapCacheSet");var Nd=zw;function Dn(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}o(Dn,"MapCache");Dn.prototype.clear=Ad;Dn.prototype.delete=Id;Dn.prototype.get=Od;Dn.prototype.has=Cd;Dn.prototype.set=Nd;var Lr=Dn;var Gw="Expected a function";function pu(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Gw);var r=o(function(){var n=arguments,i=e?e.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var s=t.apply(this,n);return r.cache=a.set(i,s)||a,s},"memoized");return r.cache=new(pu.Cache||Lr),r}o(pu,"memoize");pu.Cache=Lr;var Ci=pu;var Kw=500;function Qw(t){var e=Ci(t,function(n){return r.size===Kw&&r.clear(),n}),r=e.cache;return e}o(Qw,"memoizeCapped");var Ld=Qw;var Zw=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Yw=/\\(\\)?/g,Jw=Ld(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Zw,function(r,n,i,a){e.push(i?a.replace(Yw,"$1"):n||r)}),e}),Ud=Jw;function Xw(t){return t==null?"":Vf(t)}o(Xw,"toString");var St=Xw;function eE(t,e){return X(t)?t:_n(t,e)?[t]:Ud(St(t))}o(eE,"castPath");var va=eE;var tE=1/0;function rE(t){if(typeof t=="string"||Ze(t))return t;var e=t+"";return e=="0"&&1/t==-tE?"-0":e}o(rE,"toKey");var cr=rE;function nE(t,e){e=va(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[cr(e[r++])];return r&&r==n?t:void 0}o(nE,"baseGet");var Mn=nE;function iE(t,e,r){var n=t==null?void 0:Mn(t,e);return n===void 0?r:n}o(iE,"get");var Wt=iE;function oE(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}o(oE,"arrayPush");var An=oE;var Hd=Ie?Ie.isConcatSpreadable:void 0;function aE(t){return X(t)||wn(t)||!!(Hd&&t&&t[Hd])}o(aE,"isFlattenable");var Vd=aE;function Bd(t,e,r,n,i){var a=-1,s=t.length;for(r||(r=Vd),i||(i=[]);++a<s;){var p=t[a];e>0&&r(p)?e>1?Bd(p,e-1,r,n,i):An(i,p):n||(i[i.length]=p)}return i}o(Bd,"baseFlatten");var Fn=Bd;function sE(t){var e=t==null?0:t.length;return e?Fn(t,1):[]}o(sE,"flatten");var oe=sE;function pE(t){return ga(Ta(t,void 0,oe),t+"")}o(pE,"flatRest");var Wd=pE;function cE(t){return function(e){return t?.[e]}}o(cE,"basePropertyOf");var jd=cE;var lE={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},uE=jd(lE),$d=uE;var mE=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,fE="\\u0300-\\u036f",dE="\\ufe20-\\ufe2f",gE="\\u20d0-\\u20ff",hE=fE+dE+gE,yE="["+hE+"]",TE=RegExp(yE,"g");function xE(t){return t=St(t),t&&t.replace(mE,$d).replace(TE,"")}o(xE,"deburr");var cu=xE;function SE(){this.__data__=new ar,this.size=0}o(SE,"stackClear");var qd=SE;function vE(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}o(vE,"stackDelete");var zd=vE;function bE(t){return this.__data__.get(t)}o(bE,"stackGet");var Gd=bE;function RE(t){return this.__data__.has(t)}o(RE,"stackHas");var Kd=RE;var wE=200;function EE(t,e){var r=this.__data__;if(r instanceof ar){var n=r.__data__;if(!sr||n.length<wE-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Lr(n)}return r.set(t,e),this.size=r.size,this}o(EE,"stackSet");var Qd=EE;function In(t){var e=this.__data__=new ar(t);this.size=e.size}o(In,"Stack");In.prototype.clear=qd;In.prototype.delete=zd;In.prototype.get=Gd;In.prototype.has=Kd;In.prototype.set=Qd;var On=In;function _E(t,e){for(var r=-1,n=t==null?0:t.length,i=0,a=[];++r<n;){var s=t[r];e(s,r,t)&&(a[i++]=s)}return a}o(_E,"arrayFilter");var ba=_E;function kE(){return[]}o(kE,"stubArray");var Zd=kE;var PE=Object.prototype,DE=PE.propertyIsEnumerable,Yd=Object.getOwnPropertySymbols,ME=Yd?function(t){return t==null?[]:(t=Object(t),ba(Yd(t),function(e){return DE.call(t,e)}))}:Zd,Jd=ME;function AE(t,e,r){var n=e(t);return X(t)?n:An(n,r(t))}o(AE,"baseGetAllKeys");var Xd=AE;function FE(t){return Xd(t,ir,Jd)}o(FE,"getAllKeys");var lu=FE;var IE=Ue(be,"DataView"),Ra=IE;var OE=Ue(be,"Promise"),wa=OE;var CE=Ue(be,"Set"),lr=CE;var eg="[object Map]",NE="[object Object]",tg="[object Promise]",rg="[object Set]",ng="[object WeakMap]",ig="[object DataView]",LE=Vt(Ra),UE=Vt(sr),HE=Vt(wa),VE=Vt(lr),BE=Vt(Cr),Ur=xt;(Ra&&Ur(new Ra(new ArrayBuffer(1)))!=ig||sr&&Ur(new sr)!=eg||wa&&Ur(wa.resolve())!=tg||lr&&Ur(new lr)!=rg||Cr&&Ur(new Cr)!=ng)&&(Ur=o(function(t){var e=xt(t),r=e==NE?t.constructor:void 0,n=r?Vt(r):"";if(n)switch(n){case LE:return ig;case UE:return eg;case HE:return tg;case VE:return rg;case BE:return ng}return e},"getTag"));var uu=Ur;var WE=be.Uint8Array,mu=WE;function jE(){var t=arguments.length;if(!t)return[];for(var e=Array(t-1),r=arguments[0],n=t;n--;)e[n-1]=arguments[n];return An(X(r)?nr(r):[r],Fn(e,1))}o(jE,"concat");var Ni=jE;var $E="__lodash_hash_undefined__";function qE(t){return this.__data__.set(t,$E),this}o(qE,"setCacheAdd");var og=qE;function zE(t){return this.__data__.has(t)}o(zE,"setCacheHas");var ag=zE;function Ea(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Lr;++e<r;)this.add(t[e])}o(Ea,"SetCache");Ea.prototype.add=Ea.prototype.push=og;Ea.prototype.has=ag;var _a=Ea;function GE(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}o(GE,"arraySome");var sg=GE;function KE(t,e){return t.has(e)}o(KE,"cacheHas");var ka=KE;var QE=1,ZE=2;function YE(t,e,r,n,i,a){var s=r&QE,p=t.length,c=e.length;if(p!=c&&!(s&&c>p))return!1;var l=a.get(t),u=a.get(e);if(l&&u)return l==e&&u==t;var m=-1,f=!0,d=r&ZE?new _a:void 0;for(a.set(t,e),a.set(e,t);++m<p;){var y=t[m],T=e[m];if(n)var k=s?n(T,y,m,e,t,a):n(y,T,m,t,e,a);if(k!==void 0){if(k)continue;f=!1;break}if(d){if(!sg(e,function(R,A){if(!ka(d,A)&&(y===R||i(y,R,r,n,a)))return d.push(A)})){f=!1;break}}else if(!(y===T||i(y,T,r,n,a))){f=!1;break}}return a.delete(t),a.delete(e),f}o(YE,"equalArrays");var Pa=YE;function JE(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}o(JE,"mapToArray");var pg=JE;function XE(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}o(XE,"setToArray");var Cn=XE;var e_=1,t_=2,r_="[object Boolean]",n_="[object Date]",i_="[object Error]",o_="[object Map]",a_="[object Number]",s_="[object RegExp]",p_="[object Set]",c_="[object String]",l_="[object Symbol]",u_="[object ArrayBuffer]",m_="[object DataView]",cg=Ie?Ie.prototype:void 0,fu=cg?cg.valueOf:void 0;function f_(t,e,r,n,i,a,s){switch(r){case m_:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case u_:return!(t.byteLength!=e.byteLength||!a(new mu(t),new mu(e)));case r_:case n_:case a_:return vn(+t,+e);case i_:return t.name==e.name&&t.message==e.message;case s_:case c_:return t==e+"";case o_:var p=pg;case p_:var c=n&e_;if(p||(p=Cn),t.size!=e.size&&!c)return!1;var l=s.get(t);if(l)return l==e;n|=t_,s.set(t,e);var u=Pa(p(t),p(e),n,i,a,s);return s.delete(t),u;case l_:if(fu)return fu.call(t)==fu.call(e)}return!1}o(f_,"equalByTag");var lg=f_;var d_=1,g_=Object.prototype,h_=g_.hasOwnProperty;function y_(t,e,r,n,i,a){var s=r&d_,p=lu(t),c=p.length,l=lu(e),u=l.length;if(c!=u&&!s)return!1;for(var m=c;m--;){var f=p[m];if(!(s?f in e:h_.call(e,f)))return!1}var d=a.get(t),y=a.get(e);if(d&&y)return d==e&&y==t;var T=!0;a.set(t,e),a.set(e,t);for(var k=s;++m<c;){f=p[m];var R=t[f],A=e[f];if(n)var ne=s?n(A,R,f,e,t,a):n(R,A,f,t,e,a);if(!(ne===void 0?R===A||i(R,A,r,n,a):ne)){T=!1;break}k||(k=f=="constructor")}if(T&&!k){var Fe=t.constructor,yt=e.constructor;Fe!=yt&&"constructor"in t&&"constructor"in e&&!(typeof Fe=="function"&&Fe instanceof Fe&&typeof yt=="function"&&yt instanceof yt)&&(T=!1)}return a.delete(t),a.delete(e),T}o(y_,"equalObjects");var ug=y_;var T_=1,mg="[object Arguments]",fg="[object Array]",Da="[object Object]",x_=Object.prototype,dg=x_.hasOwnProperty;function S_(t,e,r,n,i,a){var s=X(t),p=X(e),c=s?fg:uu(t),l=p?fg:uu(e);c=c==mg?Da:c,l=l==mg?Da:l;var u=c==Da,m=l==Da,f=c==l;if(f&&Ii(t)){if(!Ii(e))return!1;s=!0,u=!1}if(f&&!u)return a||(a=new On),s||Sa(t)?Pa(t,e,r,n,i,a):lg(t,e,c,r,n,i,a);if(!(r&T_)){var d=u&&dg.call(t,"__wrapped__"),y=m&&dg.call(e,"__wrapped__");if(d||y){var T=d?t.value():t,k=y?e.value():e;return a||(a=new On),i(T,k,r,n,a)}}return f?(a||(a=new On),ug(t,e,r,n,i,a)):!1}o(S_,"baseIsEqualDeep");var gg=S_;function hg(t,e,r,n,i){return t===e?!0:t==null||e==null||!Oe(t)&&!Oe(e)?t!==t&&e!==e:gg(t,e,r,n,hg,i)}o(hg,"baseIsEqual");var Nn=hg;var v_=1,b_=2;function R_(t,e,r,n){var i=r.length,a=i,s=!n;if(t==null)return!a;for(t=Object(t);i--;){var p=r[i];if(s&&p[2]?p[1]!==t[p[0]]:!(p[0]in t))return!1}for(;++i<a;){p=r[i];var c=p[0],l=t[c],u=p[1];if(s&&p[2]){if(l===void 0&&!(c in t))return!1}else{var m=new On;if(n)var f=n(l,u,c,t,e,m);if(!(f===void 0?Nn(u,l,v_|b_,n,m):f))return!1}}return!0}o(R_,"baseIsMatch");var yg=R_;function w_(t){return t===t&&!Ye(t)}o(w_,"isStrictComparable");var Ma=w_;function E_(t){for(var e=ir(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,Ma(i)]}return e}o(E_,"getMatchData");var Tg=E_;function __(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}o(__,"matchesStrictComparable");var Aa=__;function k_(t){var e=Tg(t);return e.length==1&&e[0][2]?Aa(e[0][0],e[0][1]):function(r){return r===t||yg(r,t,e)}}o(k_,"baseMatches");var xg=k_;function P_(t,e){return t!=null&&e in Object(t)}o(P_,"baseHasIn");var Sg=P_;function D_(t,e,r){e=va(e,t);for(var n=-1,i=e.length,a=!1;++n<i;){var s=cr(e[n]);if(!(a=t!=null&&r(t,s)))break;t=t[s]}return a||++n!=i?a:(i=t==null?0:t.length,!!i&&Rn(i)&&Sn(s,i)&&(X(t)||wn(t)))}o(D_,"hasPath");var vg=D_;function M_(t,e){return t!=null&&vg(t,e,Sg)}o(M_,"hasIn");var bg=M_;var A_=1,F_=2;function I_(t,e){return _n(t)&&Ma(e)?Aa(cr(t),e):function(r){var n=Wt(r,t);return n===void 0&&n===e?bg(r,t):Nn(e,n,A_|F_)}}o(I_,"baseMatchesProperty");var Rg=I_;function O_(t){return function(e){return e?.[t]}}o(O_,"baseProperty");var Fa=O_;function C_(t){return function(e){return Mn(e,t)}}o(C_,"basePropertyDeep");var wg=C_;function N_(t){return _n(t)?Fa(cr(t)):wg(t)}o(N_,"property");var Eg=N_;function L_(t){return typeof t=="function"?t:t==null?Pe:typeof t=="object"?X(t)?Rg(t[0],t[1]):xg(t):Eg(t)}o(L_,"baseIteratee");var Pt=L_;function U_(t,e,r,n){for(var i=-1,a=t==null?0:t.length;++i<a;){var s=t[i];e(n,s,r(s),t)}return n}o(U_,"arrayAggregator");var _g=U_;function H_(t){return function(e,r,n){for(var i=-1,a=Object(e),s=n(e),p=s.length;p--;){var c=s[t?p:++i];if(r(a[c],c,a)===!1)break}return e}}o(H_,"createBaseFor");var kg=H_;var V_=kg(),Pg=V_;function B_(t,e){return t&&Pg(t,e,ir)}o(B_,"baseForOwn");var Dg=B_;function W_(t,e){return function(r,n){if(r==null)return r;if(!kt(r))return t(r,n);for(var i=r.length,a=e?i:-1,s=Object(r);(e?a--:++a<i)&&n(s[a],a,s)!==!1;);return r}}o(W_,"createBaseEach");var Mg=W_;var j_=Mg(Dg),Ia=j_;function $_(t,e,r,n){return Ia(t,function(i,a,s){e(n,i,r(i),s)}),n}o($_,"baseAggregator");var Ag=$_;function q_(t,e){return function(r,n){var i=X(r)?_g:Ag,a=e?e():{};return i(r,t,Pt(n,2),a)}}o(q_,"createAggregator");var Fg=q_;function z_(t){return Oe(t)&&kt(t)}o(z_,"isArrayLikeObject");var Ig=z_;function G_(t,e,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(r(e,t[n]))return!0;return!1}o(G_,"arrayIncludesWith");var Og=G_;function K_(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}o(K_,"last");var Oa=K_;var Cg=/[\\^$.*+?()[\]{}|]/g,Q_=RegExp(Cg.source);function Z_(t){return t=St(t),t&&Q_.test(t)?t.replace(Cg,"\\$&"):t}o(Z_,"escapeRegExp");var Je=Z_;var Y_=Math.max,J_=Math.min;function X_(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var i=n-1;return r!==void 0&&(i=aa(r),i=r<0?Y_(n+i,0):J_(i,n-1)),ha(t,Pt(e,3),i,!0)}o(X_,"findLastIndex");var Li=X_;function ek(t,e){var r=-1,n=kt(t)?Array(t.length):[];return Ia(t,function(i,a,s){n[++r]=e(i,a,s)}),n}o(ek,"baseMap");var Ng=ek;var tk="Expected a function",rk=8,nk=32,ik=128,ok=256;function ak(t){return Wd(function(e){var r=e.length,n=r,i=rr.prototype.thru;for(t&&e.reverse();n--;){var a=e[n];if(typeof a!="function")throw new TypeError(tk);if(i&&!s&&Tn(a)=="wrapper")var s=new rr([],!0)}for(n=s?n:r;++n<r;){a=e[n];var p=Tn(a),c=p=="wrapper"?ma(a):void 0;c&&nu(c[0])&&c[1]==(ik|rk|nk|ok)&&!c[4].length&&c[9]==1?s=s[Tn(c[0])].apply(s,c[3]):s=a.length==1&&nu(a)?s[p]():s.thru(a)}return function(){var l=arguments,u=l[0];if(s&&l.length==1&&X(u))return s.plant(u).value();for(var m=0,f=r?e[m].apply(this,l):u;++m<r;)f=e[m].call(this,f);return f}})}o(ak,"createFlow");var Lg=ak;var sk=Lg(),du=sk;var pk=Object.prototype,ck=pk.hasOwnProperty,lk=Fg(function(t,e,r){ck.call(t,r)?t[r].push(e):ad(t,r,[e])}),gu=lk;function uk(t,e){return t>e}o(uk,"baseGt");var Ug=uk;function mk(t,e){return at(e,function(r){return t[r]})}o(mk,"baseValues");var Hg=mk;function fk(t){return t==null?[]:Hg(t,ir(t))}o(fk,"values");var Vg=fk;function dk(t,e){return Nn(t,e)}o(dk,"isEqual");var jt=dk;function gk(t,e){return t<e}o(gk,"baseLt");var Bg=gk;function hk(t,e,r){for(var n=-1,i=t.length;++n<i;){var a=t[n],s=e(a);if(s!=null&&(p===void 0?s===s&&!Ze(s):r(s,p)))var p=s,c=a}return c}o(hk,"baseExtremum");var Ca=hk;function yk(t,e){return t&&t.length?Ca(t,Pt(e,2),Ug):void 0}o(yk,"maxBy");var hu=yk;function Tk(t,e){for(var r,n=-1,i=t.length;++n<i;){var a=e(t[n]);a!==void 0&&(r=r===void 0?a:r+a)}return r}o(Tk,"baseSum");var Wg=Tk;function xk(t){return t&&t.length?Ca(t,Pe,Bg):void 0}o(xk,"min");var yu=xk;function Sk(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}o(Sk,"baseSortBy");var jg=Sk;function vk(t,e){if(t!==e){var r=t!==void 0,n=t===null,i=t===t,a=Ze(t),s=e!==void 0,p=e===null,c=e===e,l=Ze(e);if(!p&&!l&&!a&&t>e||a&&s&&c&&!p&&!l||n&&s&&c||!r&&c||!i)return 1;if(!n&&!a&&!l&&t<e||l&&r&&i&&!n&&!a||p&&r&&i||!s&&i||!c)return-1}return 0}o(vk,"compareAscending");var $g=vk;function bk(t,e,r){for(var n=-1,i=t.criteria,a=e.criteria,s=i.length,p=r.length;++n<s;){var c=$g(i[n],a[n]);if(c){if(n>=p)return c;var l=r[n];return c*(l=="desc"?-1:1)}}return t.index-e.index}o(bk,"compareMultiple");var qg=bk;function Rk(t,e,r){e.length?e=at(e,function(a){return X(a)?function(s){return Mn(s,a.length===1?a[0]:a)}:a}):e=[Pe];var n=-1;e=at(e,En(Pt));var i=Ng(t,function(a,s,p){var c=at(e,function(l){return l(a)});return{criteria:c,index:++n,value:a}});return jg(i,function(a,s){return qg(a,s,r)})}o(Rk,"baseOrderBy");var zg=Rk;var wk=9007199254740991,Ek=Math.floor;function _k(t,e){var r="";if(!t||e<1||e>wk)return r;do e%2&&(r+=t),e=Ek(e/2),e&&(t+=t);while(e);return r}o(_k,"baseRepeat");var Gg=_k;function kk(t,e,r,n){for(var i=r-1,a=t.length;++i<a;)if(n(t[i],e))return i;return-1}o(kk,"baseIndexOfWith");var Kg=kk;var Pk=Array.prototype,Qg=Pk.splice;function Dk(t,e,r,n){var i=n?Kg:ya,a=-1,s=e.length,p=t;for(t===e&&(e=nr(e)),r&&(p=at(t,En(r)));++a<s;)for(var c=0,l=e[a],u=r?r(l):l;(c=i(p,u,c,n))>-1;)p!==t&&Qg.call(p,c,1),Qg.call(t,c,1);return t}o(Dk,"basePullAll");var Zg=Dk;function Mk(t,e){return t&&t.length&&e&&e.length?Zg(t,e):t}o(Mk,"pullAll");var Yg=Mk;var Ak=bn(Yg),we=Ak;var Fk=Math.floor,Ik=Math.random;function Ok(t,e){return t+Fk(Ik()*(e-t+1))}o(Ok,"baseRandom");var Jg=Ok;var Ck=Math.ceil,Nk=Math.max;function Lk(t,e,r,n){for(var i=-1,a=Nk(Ck((e-t)/(r||1)),0),s=Array(a);a--;)s[n?a:++i]=t,t+=r;return s}o(Lk,"baseRange");var Xg=Lk;function Uk(t){return function(e,r,n){return n&&typeof n!="number"&&Nr(e,r,n)&&(r=n=void 0),e=gn(e),r===void 0?(r=e,e=0):r=gn(r),n=n===void 0?e<r?1:-1:gn(n),Xg(e,r,n,t)}}o(Uk,"createRange");var eh=Uk;var Hk=eh(),Tu=Hk;function Vk(t,e,r){return(r?Nr(t,e,r):e===void 0)?e=1:e=aa(e),Gg(St(t),e)}o(Vk,"repeat");var xu=Vk;function Bk(t,e){var r=-1,n=t.length,i=n-1;for(e=e===void 0?n:e;++r<e;){var a=Jg(r,i),s=t[a];t[a]=t[r],t[r]=s}return t.length=e,t}o(Bk,"shuffleSelf");var Na=Bk;function Wk(t){return Na(nr(t))}o(Wk,"arrayShuffle");var th=Wk;function jk(t){return Na(Vg(t))}o(jk,"baseShuffle");var rh=jk;function $k(t){var e=X(t)?th:rh;return e(t)}o($k,"shuffle");var Su=$k;var qk=bn(function(t,e){if(t==null)return[];var r=e.length;return r>1&&Nr(t,e[0],e[1])?e=[]:r>2&&Nr(e[0],e[1],e[2])&&(e=[e[0]]),zg(t,Fn(e,1),[])}),vu=qk;function zk(t,e){return t&&t.length?Wg(t,Pt(e,2)):0}o(zk,"sumBy");var La=zk;var Gk=1/0,Kk=lr&&1/Cn(new lr([,-0]))[1]==Gk?function(t){return new lr(t)}:ua,nh=Kk;var Qk=200;function Zk(t,e,r){var n=-1,i=od,a=t.length,s=!0,p=[],c=p;if(r)s=!1,i=Og;else if(a>=Qk){var l=e?null:nh(t);if(l)return Cn(l);s=!1,i=ka,c=new _a}else c=e?[]:p;e:for(;++n<a;){var u=t[n],m=e?e(u):u;if(u=r||u!==0?u:0,s&&m===m){for(var f=c.length;f--;)if(c[f]===m)continue e;e&&c.push(m),p.push(u)}else i(c,m,r)||(c!==p&&c.push(m),p.push(u))}return p}o(Zk,"baseUniq");var Ua=Zk;function Yk(t){return t&&t.length?Ua(t):[]}o(Yk,"uniq");var $t=Yk;function Jk(t,e){return e=typeof e=="function"?e:void 0,t&&t.length?Ua(t,void 0,e):[]}o(Jk,"uniqWith");var Ui=Jk;var Xk=Math.max;function e0(t){if(!(t&&t.length))return[];var e=0;return t=ba(t,function(r){if(Ig(r))return e=Xk(r.length,e),!0}),xa(e,function(r){return at(t,Fa(r))})}o(e0,"unzip");var ih=e0;var t0=bn(ih),ye=t0;var Ha=class{constructor(){this.commands={clipboardPaste:void 0,clipboardCopy:void 0,toggleLineComment:void 0,indentLine:void 0,outdentLine:void 0,rename:void 0,quickFix:void 0,revealDefinition:void 0,revealTypeDefinition:void 0,showHover:void 0,showDebugHover:void 0,extractVariable:void 0,fold:void 0,highlight:{acceptsLocation:!0},unfold:void 0,showReferences:void 0,insertLineAfter:void 0}}static{o(this,"FakeCapabilities")}};var Hi=class{constructor(){this.clipboardContents=""}static{o(this,"FakeClipboard")}async readText(){return this.clipboardContents}async writeText(e){this.clipboardContents=e}};var He=class{constructor(){this.listeners=[];this.notifyListeners=o((...e)=>{this.listeners.forEach(r=>r(...e))},"notifyListeners");this.registerListener=this.registerListener.bind(this)}static{o(this,"Notifier")}registerListener(e){return this.listeners.push(e),{dispose:o(()=>{we(this.listeners,e)},"dispose")}}};var ah={tokenHatSplittingMode:{preserveCase:!1,lettersToPreserve:[],symbolsToPreserve:[]},wordSeparators:["_"],decorationDebounceDelayMs:50,experimental:{snippetsDir:void 0,hatStability:"balanced",keyboardTargetFollowsSelection:!1},commandHistory:!1,debug:!1};var Vi=class{constructor(){this.notifier=new He;this.mocks={...ah};this.scopes=[];this.onDidChangeConfiguration=this.notifier.registerListener;this.onDidChangeConfiguration=this.onDidChangeConfiguration.bind(this)}static{o(this,"FakeConfiguration")}getOwnConfiguration(e,r){if(r!=null){for(let{scope:n,values:i}of this.scopes)if(r0(n,r))return Wt(i,e)??Wt(this.mocks,e)}return Wt(this.mocks,e)}mockConfiguration(e,r){this.mocks[e]=r,this.notifier.notifyListeners()}mockConfigurationScope(e,r,n=!1){this.scopes.push({scope:e,values:r}),n||this.notifier.notifyListeners()}};function r0(t,e){return t.languageId===e.languageId}o(r0,"scopeMatches");var sh={hideInferenceWarning:!1,tutorialProgress:{}};var Bi=class{constructor(){this.data={...sh}}static{o(this,"FakeKeyValueStore")}get(e){return this.data[e]}set(e,r){return this.data[e]=r,Promise.resolve()}};var Wi=class{static{o(this,"FakeMessages")}async showMessage(e,r,n,...i){}};var Va=class{constructor(){this.configuration=new Vi;this.messages=new Wi;this.keyValueStore=new Bi;this.clipboard=new Hi;this.capabilities=new Ha;this.runMode="test";this.cursorlessVersion="0.0.0";this.workspaceFolders=void 0;this.disposables=[];this.quickPickReturnValue=void 0;this.onDidOpenTextDocument=Ln;this.onDidCloseTextDocument=Ln;this.onDidChangeActiveTextEditor=Ln;this.onDidChangeVisibleTextEditors=Ln;this.onDidChangeTextEditorSelection=Ln;this.onDidChangeTextEditorVisibleRanges=Ln}static{o(this,"FakeIDE")}async flashRanges(e){}async setHighlightRanges(e,r,n){}mockAssetsRoot(e){this.assetsRoot_=e}get assetsRoot(){if(this.assetsRoot_==null)throw Error("Field `assetsRoot` has not yet been mocked");return this.assetsRoot_}get activeTextEditor(){throw Error("Not implemented")}get activeEditableTextEditor(){throw Error("Not implemented")}get visibleTextEditors(){throw Error("Not implemented")}getEditableTextEditor(e){throw Error("Not implemented")}findInDocument(e,r){throw Error("Not implemented")}findInWorkspace(e){throw Error("Not implemented")}openTextDocument(e){throw Error("Not implemented")}openUntitledTextDocument(e){throw Error("Not implemented")}setQuickPickReturnValue(e){this.quickPickReturnValue=e}async showQuickPick(e,r){return this.quickPickReturnValue}showInputBox(e){throw Error("Not implemented")}executeCommand(e,...r){throw new Error("Method not implemented.")}onDidChangeTextDocument(e){throw Error("Not implemented")}disposeOnExit(...e){return this.disposables.push(...e),()=>we(this.disposables,...e)}exit(){this.disposables.forEach(e=>e.dispose())}};function Ln(){return{dispose(){}}}o(Ln,"dummyEvent");var B=class t{static{o(this,"Position")}constructor(e,r){this.line=e,this.character=r}isEqual(e){return this.line===e.line&&this.character===e.character}isBefore(e){return this.line<e.line?!0:this.line>e.line?!1:this.character<e.character}isAfter(e){return this.line>e.line?!0:this.line<e.line?!1:this.character>e.character}isBeforeOrEqual(e){return this.isEqual(e)||this.isBefore(e)}isAfterOrEqual(e){return this.isEqual(e)||this.isAfter(e)}compareTo(e){return this.isBefore(e)?-1:this.isAfter(e)?1:0}with(e,r){return new t(e??this.line,r??this.character)}translate(e,r){return new t(this.line+(e??0),this.character+(r??0))}toEmptyRange(){return new b(this,this)}concise(){return`${this.line}:${this.character}`}toString(){return this.concise()}};function ph(t,e,r){return t.positionAt(t.offsetAt(e)+r)}o(ph,"adjustPosition");var b=class t{static{o(this,"Range")}constructor(...e){let[r,n]=e.length===2?e:[new B(e[0],e[1]),new B(e[2],e[3])];r.isBefore(n)?(this.start=r,this.end=n):(this.start=n,this.end=r)}get isEmpty(){return this.start.isEqual(this.end)}get isSingleLine(){return this.start.line===this.end.line}isRangeEqual(e){return this.start.isEqual(e.start)&&this.end.isEqual(e.end)}contains(e){let[r,n]=e instanceof B?[e,e]:[e.start,e.end];return r.isAfterOrEqual(this.start)&&n.isBeforeOrEqual(this.end)}intersection(e){let r=this.start.isAfter(e.start)?this.start:e.start,n=this.end.isBefore(e.end)?this.end:e.end;return r.isBeforeOrEqual(n)?new t(r,n):void 0}union(e){return new t(this.start.isBefore(e.start)?this.start:e.start,this.end.isAfter(e.end)?this.end:e.end)}with(e,r){return new t(e??this.start,r??this.end)}toSelection(e){return e?new q(this.end,this.start):new q(this.start,this.end)}concise(){return`${this.start.concise()}-${this.end.concise()}`}toString(){return this.concise()}};function n0(t){let{source:e,flags:r}=t;return new RegExp(`(${e})$`,r.replace("m",""))}o(n0,"_rightAnchored");function i0(t){let{source:e,flags:r}=t;return new RegExp(`^(${e})`,r.replace("m",""))}o(i0,"_leftAnchored");function ch(t){let e=new Map;function r(n){let i=e.get(n);return i==null&&(i=t(n),e.set(n,i)),i}return o(r,"wrapper"),r}o(ch,"makeCache");var Ba=ch(n0),Wa=ch(i0);function st(t,e,r){return e.lastIndex=0,Array.from(t.matchAll(e),r)}o(st,"matchAll");function ji(t,e){return t.lastIndex=0,t.test(e)}o(ji,"testRegex");function lh(t,e){return t.lastIndex=0,e.match(t)}o(lh,"matchRegex");function $i(t,e){return st(t,e,r=>({index:r.index,text:r[0]}))}o($i,"matchText");function uh(t){return t.match(/^\s+/)?.[0]??""}o(uh,"getLeadingWhitespace");function mh(t){return t.match(/\s+$/)?.[0]??""}o(mh,"getTrailingWhitespace");var ja=class{constructor(e,r,n,i){this.lineNumber=e;this.offset=r;this.text=n;this.isEmptyOrWhitespace=/^\s*$/.test(n),this.lengthIncludingEol=n.length+(i?.length??0);let a=new B(e,0),s=new B(e,n.length),p=i!=null?new B(e+1,0):s;this.range=new b(a,s),this.rangeIncludingLineBreak=new b(a,p),this.rangeTrimmed=this.isEmptyOrWhitespace?void 0:new b(a.translate(void 0,uh(n).length),s.translate(void 0,-mh(n).length))}static{o(this,"InMemoryTextLine")}};function dh(t,e){let r=o0(t,e),n=t.getText();for(let i of r){let{text:a,rangeOffset:s,rangeLength:p}=i;n=n.slice(0,s)+a+n.slice(s+p)}return{text:n,changes:r}}o(dh,"performEdits");function o0(t,e){let r=[],n=e.map((a,s)=>({edit:a,index:s})).sort((a,s)=>a.edit.range.start.isEqual(s.edit.range.start)?s.index-a.index:s.edit.range.start.compareTo(a.edit.range.start)).map(({edit:a})=>a),i=t.eol==="LF"?`
`:`\r
`;for(let a of n){let s=r[r.length-1],p=s?.range.intersection(a.range);if(p!=null&&!p.isEmpty){if(!s.text&&!a.text){r[r.length-1]=fh(t,s.range.union(a.range),"");continue}throw Error("Overlapping ranges are not allowed!")}let c=a.text.replace(/\r?\n/g,i);r.push(fh(t,a.range,c))}return r}o(o0,"createChangeEvents");function fh(t,e,r){let n=t.offsetAt(e.start),i=t.offsetAt(e.end);return{text:r,range:e,rangeOffset:n,rangeLength:i-n}}o(fh,"createChangeEvent");var $a=class{constructor(e,r,n){this.uri=e;this.languageId=r;this.filename=e.path.split(/\\|\//g).at(-1)??"",this._text="",this._eol="LF",this._version=-1,this._lines=[],this.setTextInternal(n)}static{o(this,"InMemoryTextDocument")}get version(){return this._version}get lineCount(){return this._lines.length}get eol(){return this._eol}get text(){return this._text}get range(){return new b(this._lines[0].range.start,this._lines.at(-1).range.end)}setTextInternal(e){this._text=e,this._eol=e.includes(`\r
`)?"CRLF":"LF",this._version++,this._lines=a0(e)}lineAt(e){let r=typeof e=="number"?e:e.line,n=gh(r,0,this.lineCount-1);return this._lines[n]}offsetAt(e){if(e.line<0)return 0;if(e.line>this._lines.length-1)return this._text.length;let r=this._lines[e.line];return r.offset+gh(e.character,0,r.text.length)}positionAt(e){if(e<=0)return this.range.start;if(e>=this._text.length)return this.range.end;let r=this._lines.find(n=>e<n.offset+n.lengthIncludingEol);if(r==null)throw Error(`Couldn't find line for offset ${e}`);return new B(r.lineNumber,Math.min(e-r.offset,r.text.length))}getText(e){if(e==null)return this.text;let r=this.offsetAt(e.start),n=this.offsetAt(e.end);return this.text.slice(r,n)}edit(e){let{text:r,changes:n}=dh(this,e);return this.setTextInternal(r),n}};function a0(t){let e=t.split(/(\r?\n)/g),r=[],n=0;for(let i=0;i<e.length;i+=2){let a=new ja(r.length,n,e[i],e[i+1]);r.push(a),n+=a.lengthIncludingEol}return r}o(a0,"createLines");function gh(t,e,r){return Math.min(Math.max(t,e),r)}o(gh,"clamp");var Un=class{constructor(e){this.original=e;this.configuration=e.configuration,this.keyValueStore=e.keyValueStore,this.clipboard=e.clipboard,this.messages=e.messages,this.capabilities=e.capabilities}static{o(this,"PassthroughIDEBase")}flashRanges(e){return this.original.flashRanges(e)}setHighlightRanges(e,r,n){return this.original.setHighlightRanges(e,r,n)}onDidOpenTextDocument(e,r,n){return this.original.onDidOpenTextDocument(e,r,n)}onDidCloseTextDocument(e,r,n){return this.original.onDidCloseTextDocument(e,r,n)}onDidChangeActiveTextEditor(e,r,n){return this.original.onDidChangeActiveTextEditor(e,r,n)}onDidChangeVisibleTextEditors(e,r,n){return this.original.onDidChangeVisibleTextEditors(e,r,n)}onDidChangeTextEditorSelection(e,r,n){return this.original.onDidChangeTextEditorSelection(e,r,n)}onDidChangeTextEditorVisibleRanges(e,r,n){return this.original.onDidChangeTextEditorVisibleRanges(e,r,n)}get activeTextEditor(){return this.original.activeTextEditor}get activeEditableTextEditor(){return this.original.activeEditableTextEditor}get visibleTextEditors(){return this.original.visibleTextEditors}get cursorlessVersion(){return this.original.cursorlessVersion}get assetsRoot(){return this.original.assetsRoot}get runMode(){return this.original.runMode}get workspaceFolders(){return this.original.workspaceFolders}findInDocument(e,r){return this.original.findInDocument(e,r)}findInWorkspace(e){return this.original.findInWorkspace(e)}openTextDocument(e){return this.original.openTextDocument(e)}openUntitledTextDocument(e){return this.original.openUntitledTextDocument(e)}showQuickPick(e,r){return this.original.showQuickPick(e,r)}showInputBox(e){return this.original.showInputBox(e)}getEditableTextEditor(e){return this.original.getEditableTextEditor(e)}executeCommand(e,...r){return this.original.executeCommand(e,...r)}onDidChangeTextDocument(e){return this.original.onDidChangeTextDocument(e)}disposeOnExit(...e){return this.original.disposeOnExit(...e)}};var qa=class extends Un{constructor(r,n,i,a){super(r);this.fakeIde=n;this.isSilent=i;this.cursorlessSnippetsDir=a;this.messages=i?n.messages:r.messages,this.configuration=n.configuration,this.keyValueStore=n.keyValueStore,this.initializeConfiguration()}static{o(this,"NormalizedIDE")}initializeConfiguration(){this.configuration.mockConfigurationScope({languageId:"css"},{wordSeparators:["_","-"]},!0),this.configuration.mockConfigurationScope({languageId:"scss"},{wordSeparators:["_","-"]},!0),this.configuration.mockConfigurationScope({languageId:"shellscript"},{wordSeparators:["_","-"]},!0),this.configuration.mockConfiguration("experimental",{hatStability:this.configuration.getOwnConfiguration("experimental.hatStability"),snippetsDir:this.cursorlessSnippetsDir,keyboardTargetFollowsSelection:!1})}flashRanges(r){return this.isSilent?this.fakeIde.flashRanges(r):super.flashRanges(r)}setHighlightRanges(r,n,i){return this.isSilent?this.fakeIde.setHighlightRanges(r,n,i):super.setHighlightRanges(r,n,i)}async showQuickPick(r,n){return this.isSilent?this.fakeIde.showQuickPick(r,n):super.showQuickPick(r,n)}};function qi(t,e,r,...n){return t.showMessage("warning",e,r,...n)}o(qi,"showWarning");function ce(t,e,r,...n){return t.showMessage("error",e,r,...n)}o(ce,"showError");var L=(i=>(i[i.supported=0]="supported",i[i.supportedLegacy=1]="supportedLegacy",i[i.unsupported=2]="unsupported",i[i.notApplicable=3]="notApplicable",i))(L||{});var{supported:ae,unsupported:WG,notApplicable:hh}=L,bu={ifStatement:ae,disqualifyDelimiter:ae,"comment.line":ae,"comment.block":ae,"string.singleLine":ae,"textFragment.comment.line":ae,"textFragment.comment.block":ae,"textFragment.string.singleLine":ae,class:ae,className:ae,namedFunction:ae,"name.function":ae,"name.class":ae,"name.field":ae,functionName:ae,"name.argument.formal":ae,"name.argument.formal.iteration":ae,"name.variable":ae,"value.variable":ae,"name.assignment":ae,"value.assignment":ae,"statement.class":ae,"type.class":ae,"type.field":ae,"value.argument.formal":hh,"value.argument.formal.iteration":hh};var{supported:qG,unsupported:zG,notApplicable:GG}=L;var{supported:yh,unsupported:YG,notApplicable:JG}=L,p0={...bu,"value.argument.formal":yh,"value.argument.formal.iteration":yh};var{supported:tK,unsupported:rK,notApplicable:nK}=L;var{supported:zi,unsupported:c0,notApplicable:aK}=L,Ru={"comment.block":zi,"string.singleLine":zi,"name.iteration.block":zi,"name.iteration.document":zi,disqualifyDelimiter:zi,"comment.line":c0};var{supported:cK,unsupported:lK,notApplicable:uK}=L;var{supported:dK,notApplicable:gK}=L;var{supported:TK,notApplicable:xK}=L;var{supported:E,unsupported:bK,notApplicable:pt}=L,wu={list:E,map:E,ifStatement:E,regularExpression:E,switchStatementSubject:E,fieldAccess:E,disqualifyDelimiter:E,"textFragment.string.singleLine":E,"textFragment.string.multiLine":E,"textFragment.comment.line":E,"textFragment.comment.block":E,statement:E,"statement.iteration.document":E,"statement.iteration.block":E,class:E,className:E,anonymousFunction:E,namedFunction:E,"namedFunction.iteration.document":E,"namedFunction.method":E,"namedFunction.method.iteration.class":E,"namedFunction.constructor":E,functionName:E,"functionName.iteration.document":E,"functionName.method":E,"functionName.method.iteration.class":E,"functionName.constructor":E,functionCall:E,"functionCall.constructor":E,functionCallee:E,"functionCallee.constructor":E,"argument.actual":E,"argument.actual.iteration":E,"argument.actual.method":E,"argument.actual.method.iteration":E,"argument.actual.constructor":E,"argument.actual.constructor.iteration":E,"argument.formal":E,"argument.formal.iteration":E,"argument.formal.method":E,"argument.formal.method.iteration":E,"argument.formal.constructor":E,"argument.formal.constructor.iteration":E,"comment.line":E,"comment.block":E,"string.singleLine":E,"string.multiLine":E,"branch.if":E,"branch.if.iteration":E,"branch.try":E,"branch.switchCase":E,"branch.switchCase.iteration":E,"branch.ternary":E,"condition.if":E,"condition.while":E,"condition.doWhile":E,"condition.for":E,"condition.ternary":E,"condition.switchCase":E,"name.argument.formal":E,"name.argument.formal.iteration":E,"name.argument.formal.method":E,"name.argument.formal.method.iteration":E,"name.argument.formal.constructor":E,"name.argument.formal.constructor.iteration":E,"name.foreach":E,"name.assignment":E,"name.assignment.pattern":E,"name.variable":E,"name.variable.pattern":E,"name.function":E,"name.method":E,"name.constructor":E,"name.class":E,"name.field":E,"key.mapPair":E,"key.mapPair.iteration":E,"value.argument.formal":E,"value.argument.formal.iteration":E,"value.argument.formal.method":E,"value.argument.formal.method.iteration":E,"value.argument.formal.constructor":E,"value.argument.formal.constructor.iteration":E,"value.mapPair":E,"value.mapPair.iteration":E,"value.assignment":E,"value.variable":E,"value.variable.pattern":E,"value.foreach":E,"value.return":E,"value.return.lambda":E,"value.field":E},Eu={element:E,tags:E,startTag:E,endTag:E,attribute:E,"key.attribute":E,"value.attribute":E},l0={...wu,...Eu,"type.variable":pt,"type.argument.formal":pt,"type.argument.formal.iteration":pt,"type.argument.formal.method":pt,"type.argument.formal.method.iteration":pt,"type.argument.formal.constructor":pt,"type.argument.formal.constructor.iteration":pt,"type.return":pt,"type.field":pt,"type.foreach":pt,"type.interface":pt,command:pt};var{supported:_u}=L,Gi={"comment.line":_u,"comment.block":_u,map:_u};var{supported:PK,unsupported:DK,notApplicable:MK}=L,u0={...Gi};var{supported:OK,unsupported:CK,notApplicable:NK}=L,m0={...Gi};var{supported:HK,unsupported:VK,notApplicable:BK}=L;var{supported:$K,notApplicable:qK}=L;var{supported:KK,unsupported:QK,notApplicable:ZK}=L;var{supported:XK,unsupported:e4,notApplicable:t4}=L;var{supported:i4,notApplicable:o4}=L;var{supported:p4,unsupported:c4,notApplicable:l4}=L;var{supported:f4,unsupported:d4,notApplicable:g4}=L;var{supported:T4,unsupported:x4,notApplicable:S4}=L;var{supported:R4,unsupported:w4,notApplicable:E4}=L;var{supported:Hn,unsupported:D4,notApplicable:M4}=L,f0={...Ru,"namedFunction.iteration":Hn,"namedFunction.iteration.document":Hn,"functionName.iteration":Hn,"functionName.iteration.document":Hn,"comment.line":Hn,disqualifyDelimiter:Hn};var{supported:I4}=L;var{supported:Ce}=L,ku={...wu,"name.field":Ce,"type.argument.formal":Ce,"type.argument.formal.iteration":Ce,"type.argument.formal.method":Ce,"type.argument.formal.method.iteration":Ce,"type.argument.formal.constructor":Ce,"type.argument.formal.constructor.iteration":Ce,"type.alias":Ce,"type.cast":Ce,"type.field":Ce,"type.interface":Ce,"type.return":Ce,"type.variable":Ce,"value.field":Ce,"value.typeAlias":Ce};var{supported:B4,unsupported:W4,notApplicable:j4}=L,d0={...ku,...Eu};var{supported:z4,unsupported:G4,notApplicable:K4}=L;var{supported:Y4,unsupported:J4,notApplicable:X4}=L;var Pu=["that","source","instanceReference","keyboard"];var q=class extends b{static{o(this,"Selection")}get isReversed(){return this.active.isBefore(this.anchor)}constructor(...e){let[r,n]=e.length===2?e:[new B(e[0],e[1]),new B(e[2],e[3])];super(r,n),this.anchor=r,this.active=n}isEqual(e){return this.anchor.isEqual(e.anchor)&&this.active.isEqual(e.active)}concise(){return`${this.anchor.concise()}->${this.active.concise()}`}toString(){return this.concise()}};function Th({line:t,character:e}){return new B(t,e)}o(Th,"plainObjectToPosition");function za({start:t,end:e}){return new b(Th(t),Th(e))}o(za,"plainObjectToRange");function vt({start:t,end:e}){return{type:"line",start:t.line,end:e.line}}o(vt,"toLineRange");function Te({start:t,end:e}){return{type:"character",start:t,end:e}}o(Te,"toCharacterRange");function Sh(t){return{start:xh(t.start),end:xh(t.end)}}o(Sh,"rangeToPlainObject");function xh({line:t,character:e}){return{line:t,character:e}}o(xh,"positionToPlainObject");function Nh(t){return typeof t>"u"||t===null}o(Nh,"isNothing");function h0(t){return typeof t=="object"&&t!==null}o(h0,"isObject");function y0(t){return Array.isArray(t)?t:Nh(t)?[]:[t]}o(y0,"toArray");function T0(t,e){var r,n,i,a;if(e)for(a=Object.keys(e),r=0,n=a.length;r<n;r+=1)i=a[r],t[i]=e[i];return t}o(T0,"extend");function x0(t,e){var r="",n;for(n=0;n<e;n+=1)r+=t;return r}o(x0,"repeat");function S0(t){return t===0&&Number.NEGATIVE_INFINITY===1/t}o(S0,"isNegativeZero");var v0=Nh,b0=h0,R0=y0,w0=x0,E0=S0,_0=T0,xe={isNothing:v0,isObject:b0,toArray:R0,repeat:w0,isNegativeZero:E0,extend:_0};function Lh(t,e){var r="",n=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(r+='in "'+t.mark.name+'" '),r+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!e&&t.mark.snippet&&(r+=`

`+t.mark.snippet),n+" "+r):n}o(Lh,"formatError");function Qi(t,e){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=e,this.message=Lh(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}o(Qi,"YAMLException$1");Qi.prototype=Object.create(Error.prototype);Qi.prototype.constructor=Qi;Qi.prototype.toString=o(function(e){return this.name+": "+Lh(this,e)},"toString");var Ve=Qi;function Du(t,e,r,n,i){var a="",s="",p=Math.floor(i/2)-1;return n-e>p&&(a=" ... ",e=n-p+a.length),r-n>p&&(s=" ...",r=n+p-s.length),{str:a+t.slice(e,r).replace(/\t/g,"\u2192")+s,pos:n-e+a.length}}o(Du,"getLine");function Mu(t,e){return xe.repeat(" ",e-t.length)+t}o(Mu,"padStart");function k0(t,e){if(e=Object.create(e||null),!t.buffer)return null;e.maxLength||(e.maxLength=79),typeof e.indent!="number"&&(e.indent=1),typeof e.linesBefore!="number"&&(e.linesBefore=3),typeof e.linesAfter!="number"&&(e.linesAfter=2);for(var r=/\r?\n|\r|\0/g,n=[0],i=[],a,s=-1;a=r.exec(t.buffer);)i.push(a.index),n.push(a.index+a[0].length),t.position<=a.index&&s<0&&(s=n.length-2);s<0&&(s=n.length-1);var p="",c,l,u=Math.min(t.line+e.linesAfter,i.length).toString().length,m=e.maxLength-(e.indent+u+3);for(c=1;c<=e.linesBefore&&!(s-c<0);c++)l=Du(t.buffer,n[s-c],i[s-c],t.position-(n[s]-n[s-c]),m),p=xe.repeat(" ",e.indent)+Mu((t.line-c+1).toString(),u)+" | "+l.str+`
`+p;for(l=Du(t.buffer,n[s],i[s],t.position,m),p+=xe.repeat(" ",e.indent)+Mu((t.line+1).toString(),u)+" | "+l.str+`
`,p+=xe.repeat("-",e.indent+u+3+l.pos)+`^
`,c=1;c<=e.linesAfter&&!(s+c>=i.length);c++)l=Du(t.buffer,n[s+c],i[s+c],t.position-(n[s]-n[s+c]),m),p+=xe.repeat(" ",e.indent)+Mu((t.line+c+1).toString(),u)+" | "+l.str+`
`;return p.replace(/\n$/,"")}o(k0,"makeSnippet");var P0=k0,D0=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],M0=["scalar","sequence","mapping"];function A0(t){var e={};return t!==null&&Object.keys(t).forEach(function(r){t[r].forEach(function(n){e[String(n)]=r})}),e}o(A0,"compileStyleAliases");function F0(t,e){if(e=e||{},Object.keys(e).forEach(function(r){if(D0.indexOf(r)===-1)throw new Ve('Unknown option "'+r+'" is met in definition of "'+t+'" YAML type.')}),this.options=e,this.tag=t,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(r){return r},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.representName=e.representName||null,this.defaultStyle=e.defaultStyle||null,this.multi=e.multi||!1,this.styleAliases=A0(e.styleAliases||null),M0.indexOf(this.kind)===-1)throw new Ve('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')}o(F0,"Type$1");var Ee=F0;function vh(t,e){var r=[];return t[e].forEach(function(n){var i=r.length;r.forEach(function(a,s){a.tag===n.tag&&a.kind===n.kind&&a.multi===n.multi&&(i=s)}),r[i]=n}),r}o(vh,"compileList");function I0(){var t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},e,r;function n(i){i.multi?(t.multi[i.kind].push(i),t.multi.fallback.push(i)):t[i.kind][i.tag]=t.fallback[i.tag]=i}for(o(n,"collectType"),e=0,r=arguments.length;e<r;e+=1)arguments[e].forEach(n);return t}o(I0,"compileMap");function Fu(t){return this.extend(t)}o(Fu,"Schema$1");Fu.prototype.extend=o(function(e){var r=[],n=[];if(e instanceof Ee)n.push(e);else if(Array.isArray(e))n=n.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(r=r.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit));else throw new Ve("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(a){if(!(a instanceof Ee))throw new Ve("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(a.loadKind&&a.loadKind!=="scalar")throw new Ve("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(a.multi)throw new Ve("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(a){if(!(a instanceof Ee))throw new Ve("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(Fu.prototype);return i.implicit=(this.implicit||[]).concat(r),i.explicit=(this.explicit||[]).concat(n),i.compiledImplicit=vh(i,"implicit"),i.compiledExplicit=vh(i,"explicit"),i.compiledTypeMap=I0(i.compiledImplicit,i.compiledExplicit),i},"extend");var O0=Fu,C0=new Ee("tag:yaml.org,2002:str",{kind:"scalar",construct:o(function(t){return t!==null?t:""},"construct")}),N0=new Ee("tag:yaml.org,2002:seq",{kind:"sequence",construct:o(function(t){return t!==null?t:[]},"construct")}),L0=new Ee("tag:yaml.org,2002:map",{kind:"mapping",construct:o(function(t){return t!==null?t:{}},"construct")}),U0=new O0({explicit:[C0,N0,L0]});function H0(t){if(t===null)return!0;var e=t.length;return e===1&&t==="~"||e===4&&(t==="null"||t==="Null"||t==="NULL")}o(H0,"resolveYamlNull");function V0(){return null}o(V0,"constructYamlNull");function B0(t){return t===null}o(B0,"isNull");var W0=new Ee("tag:yaml.org,2002:null",{kind:"scalar",resolve:H0,construct:V0,predicate:B0,represent:{canonical:o(function(){return"~"},"canonical"),lowercase:o(function(){return"null"},"lowercase"),uppercase:o(function(){return"NULL"},"uppercase"),camelcase:o(function(){return"Null"},"camelcase"),empty:o(function(){return""},"empty")},defaultStyle:"lowercase"});function j0(t){if(t===null)return!1;var e=t.length;return e===4&&(t==="true"||t==="True"||t==="TRUE")||e===5&&(t==="false"||t==="False"||t==="FALSE")}o(j0,"resolveYamlBoolean");function $0(t){return t==="true"||t==="True"||t==="TRUE"}o($0,"constructYamlBoolean");function q0(t){return Object.prototype.toString.call(t)==="[object Boolean]"}o(q0,"isBoolean");var z0=new Ee("tag:yaml.org,2002:bool",{kind:"scalar",resolve:j0,construct:$0,predicate:q0,represent:{lowercase:o(function(t){return t?"true":"false"},"lowercase"),uppercase:o(function(t){return t?"TRUE":"FALSE"},"uppercase"),camelcase:o(function(t){return t?"True":"False"},"camelcase")},defaultStyle:"lowercase"});function G0(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}o(G0,"isHexCode");function K0(t){return 48<=t&&t<=55}o(K0,"isOctCode");function Q0(t){return 48<=t&&t<=57}o(Q0,"isDecCode");function Z0(t){if(t===null)return!1;var e=t.length,r=0,n=!1,i;if(!e)return!1;if(i=t[r],(i==="-"||i==="+")&&(i=t[++r]),i==="0"){if(r+1===e)return!0;if(i=t[++r],i==="b"){for(r++;r<e;r++)if(i=t[r],i!=="_"){if(i!=="0"&&i!=="1")return!1;n=!0}return n&&i!=="_"}if(i==="x"){for(r++;r<e;r++)if(i=t[r],i!=="_"){if(!G0(t.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}if(i==="o"){for(r++;r<e;r++)if(i=t[r],i!=="_"){if(!K0(t.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}}if(i==="_")return!1;for(;r<e;r++)if(i=t[r],i!=="_"){if(!Q0(t.charCodeAt(r)))return!1;n=!0}return!(!n||i==="_")}o(Z0,"resolveYamlInteger");function Y0(t){var e=t,r=1,n;if(e.indexOf("_")!==-1&&(e=e.replace(/_/g,"")),n=e[0],(n==="-"||n==="+")&&(n==="-"&&(r=-1),e=e.slice(1),n=e[0]),e==="0")return 0;if(n==="0"){if(e[1]==="b")return r*parseInt(e.slice(2),2);if(e[1]==="x")return r*parseInt(e.slice(2),16);if(e[1]==="o")return r*parseInt(e.slice(2),8)}return r*parseInt(e,10)}o(Y0,"constructYamlInteger");function J0(t){return Object.prototype.toString.call(t)==="[object Number]"&&t%1===0&&!xe.isNegativeZero(t)}o(J0,"isInteger");var X0=new Ee("tag:yaml.org,2002:int",{kind:"scalar",resolve:Z0,construct:Y0,predicate:J0,represent:{binary:o(function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},"binary"),octal:o(function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},"octal"),decimal:o(function(t){return t.toString(10)},"decimal"),hexadecimal:o(function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)},"hexadecimal")},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),eP=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function tP(t){return!(t===null||!eP.test(t)||t[t.length-1]==="_")}o(tP,"resolveYamlFloat");function rP(t){var e,r;return e=t.replace(/_/g,"").toLowerCase(),r=e[0]==="-"?-1:1,"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:r*parseFloat(e,10)}o(rP,"constructYamlFloat");var nP=/^[-+]?[0-9]+e/;function iP(t,e){var r;if(isNaN(t))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(xe.isNegativeZero(t))return"-0.0";return r=t.toString(10),nP.test(r)?r.replace("e",".e"):r}o(iP,"representYamlFloat");function oP(t){return Object.prototype.toString.call(t)==="[object Number]"&&(t%1!==0||xe.isNegativeZero(t))}o(oP,"isFloat");var aP=new Ee("tag:yaml.org,2002:float",{kind:"scalar",resolve:tP,construct:rP,predicate:oP,represent:iP,defaultStyle:"lowercase"}),sP=U0.extend({implicit:[W0,z0,X0,aP]}),pP=sP,Uh=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Hh=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function cP(t){return t===null?!1:Uh.exec(t)!==null||Hh.exec(t)!==null}o(cP,"resolveYamlTimestamp");function lP(t){var e,r,n,i,a,s,p,c=0,l=null,u,m,f;if(e=Uh.exec(t),e===null&&(e=Hh.exec(t)),e===null)throw new Error("Date resolve error");if(r=+e[1],n=+e[2]-1,i=+e[3],!e[4])return new Date(Date.UTC(r,n,i));if(a=+e[4],s=+e[5],p=+e[6],e[7]){for(c=e[7].slice(0,3);c.length<3;)c+="0";c=+c}return e[9]&&(u=+e[10],m=+(e[11]||0),l=(u*60+m)*6e4,e[9]==="-"&&(l=-l)),f=new Date(Date.UTC(r,n,i,a,s,p,c)),l&&f.setTime(f.getTime()-l),f}o(lP,"constructYamlTimestamp");function uP(t){return t.toISOString()}o(uP,"representYamlTimestamp");var mP=new Ee("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:cP,construct:lP,instanceOf:Date,represent:uP});function fP(t){return t==="<<"||t===null}o(fP,"resolveYamlMerge");var dP=new Ee("tag:yaml.org,2002:merge",{kind:"scalar",resolve:fP}),Lu=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function gP(t){if(t===null)return!1;var e,r,n=0,i=t.length,a=Lu;for(r=0;r<i;r++)if(e=a.indexOf(t.charAt(r)),!(e>64)){if(e<0)return!1;n+=6}return n%8===0}o(gP,"resolveYamlBinary");function hP(t){var e,r,n=t.replace(/[\r\n=]/g,""),i=n.length,a=Lu,s=0,p=[];for(e=0;e<i;e++)e%4===0&&e&&(p.push(s>>16&255),p.push(s>>8&255),p.push(s&255)),s=s<<6|a.indexOf(n.charAt(e));return r=i%4*6,r===0?(p.push(s>>16&255),p.push(s>>8&255),p.push(s&255)):r===18?(p.push(s>>10&255),p.push(s>>2&255)):r===12&&p.push(s>>4&255),new Uint8Array(p)}o(hP,"constructYamlBinary");function yP(t){var e="",r=0,n,i,a=t.length,s=Lu;for(n=0;n<a;n++)n%3===0&&n&&(e+=s[r>>18&63],e+=s[r>>12&63],e+=s[r>>6&63],e+=s[r&63]),r=(r<<8)+t[n];return i=a%3,i===0?(e+=s[r>>18&63],e+=s[r>>12&63],e+=s[r>>6&63],e+=s[r&63]):i===2?(e+=s[r>>10&63],e+=s[r>>4&63],e+=s[r<<2&63],e+=s[64]):i===1&&(e+=s[r>>2&63],e+=s[r<<4&63],e+=s[64],e+=s[64]),e}o(yP,"representYamlBinary");function TP(t){return Object.prototype.toString.call(t)==="[object Uint8Array]"}o(TP,"isBinary");var xP=new Ee("tag:yaml.org,2002:binary",{kind:"scalar",resolve:gP,construct:hP,predicate:TP,represent:yP}),SP=Object.prototype.hasOwnProperty,vP=Object.prototype.toString;function bP(t){if(t===null)return!0;var e=[],r,n,i,a,s,p=t;for(r=0,n=p.length;r<n;r+=1){if(i=p[r],s=!1,vP.call(i)!=="[object Object]")return!1;for(a in i)if(SP.call(i,a))if(!s)s=!0;else return!1;if(!s)return!1;if(e.indexOf(a)===-1)e.push(a);else return!1}return!0}o(bP,"resolveYamlOmap");function RP(t){return t!==null?t:[]}o(RP,"constructYamlOmap");var wP=new Ee("tag:yaml.org,2002:omap",{kind:"sequence",resolve:bP,construct:RP}),EP=Object.prototype.toString;function _P(t){if(t===null)return!0;var e,r,n,i,a,s=t;for(a=new Array(s.length),e=0,r=s.length;e<r;e+=1){if(n=s[e],EP.call(n)!=="[object Object]"||(i=Object.keys(n),i.length!==1))return!1;a[e]=[i[0],n[i[0]]]}return!0}o(_P,"resolveYamlPairs");function kP(t){if(t===null)return[];var e,r,n,i,a,s=t;for(a=new Array(s.length),e=0,r=s.length;e<r;e+=1)n=s[e],i=Object.keys(n),a[e]=[i[0],n[i[0]]];return a}o(kP,"constructYamlPairs");var PP=new Ee("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:_P,construct:kP}),DP=Object.prototype.hasOwnProperty;function MP(t){if(t===null)return!0;var e,r=t;for(e in r)if(DP.call(r,e)&&r[e]!==null)return!1;return!0}o(MP,"resolveYamlSet");function AP(t){return t!==null?t:{}}o(AP,"constructYamlSet");var FP=new Ee("tag:yaml.org,2002:set",{kind:"mapping",resolve:MP,construct:AP}),Uu=pP.extend({implicit:[mP,dP],explicit:[xP,wP,PP,FP]}),mr=Object.prototype.hasOwnProperty,Ga=1,Vh=2,Bh=3,Ka=4,Au=1,IP=2,bh=3,OP=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,CP=/[\x85\u2028\u2029]/,NP=/[,\[\]\{\}]/,Wh=/^(?:!|!!|![a-z\-]+!)$/i,jh=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Rh(t){return Object.prototype.toString.call(t)}o(Rh,"_class");function Dt(t){return t===10||t===13}o(Dt,"is_EOL");function Vr(t){return t===9||t===32}o(Vr,"is_WHITE_SPACE");function Be(t){return t===9||t===32||t===10||t===13}o(Be,"is_WS_OR_EOL");function Bn(t){return t===44||t===91||t===93||t===123||t===125}o(Bn,"is_FLOW_INDICATOR");function LP(t){var e;return 48<=t&&t<=57?t-48:(e=t|32,97<=e&&e<=102?e-97+10:-1)}o(LP,"fromHexCode");function UP(t){return t===120?2:t===117?4:t===85?8:0}o(UP,"escapedHexLen");function HP(t){return 48<=t&&t<=57?t-48:-1}o(HP,"fromDecimalCode");function wh(t){return t===48?"\0":t===97?"\x07":t===98?"\b":t===116||t===9?"	":t===110?`
`:t===118?"\v":t===102?"\f":t===114?"\r":t===101?"\x1B":t===32?" ":t===34?'"':t===47?"/":t===92?"\\":t===78?"\x85":t===95?"\xA0":t===76?"\u2028":t===80?"\u2029":""}o(wh,"simpleEscapeSequence");function VP(t){return t<=65535?String.fromCharCode(t):String.fromCharCode((t-65536>>10)+55296,(t-65536&1023)+56320)}o(VP,"charFromCodepoint");var $h=new Array(256),qh=new Array(256);for(Hr=0;Hr<256;Hr++)$h[Hr]=wh(Hr)?1:0,qh[Hr]=wh(Hr);var Hr;function BP(t,e){this.input=t,this.filename=e.filename||null,this.schema=e.schema||Uu,this.onWarning=e.onWarning||null,this.legacy=e.legacy||!1,this.json=e.json||!1,this.listener=e.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}o(BP,"State$1");function zh(t,e){var r={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return r.snippet=P0(r),new Ve(e,r)}o(zh,"generateError");function C(t,e){throw zh(t,e)}o(C,"throwError");function Qa(t,e){t.onWarning&&t.onWarning.call(null,zh(t,e))}o(Qa,"throwWarning");var Eh={YAML:o(function(e,r,n){var i,a,s;e.version!==null&&C(e,"duplication of %YAML directive"),n.length!==1&&C(e,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),i===null&&C(e,"ill-formed argument of the YAML directive"),a=parseInt(i[1],10),s=parseInt(i[2],10),a!==1&&C(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=s<2,s!==1&&s!==2&&Qa(e,"unsupported YAML version of the document")},"handleYamlDirective"),TAG:o(function(e,r,n){var i,a;n.length!==2&&C(e,"TAG directive accepts exactly two arguments"),i=n[0],a=n[1],Wh.test(i)||C(e,"ill-formed tag handle (first argument) of the TAG directive"),mr.call(e.tagMap,i)&&C(e,'there is a previously declared suffix for "'+i+'" tag handle'),jh.test(a)||C(e,"ill-formed tag prefix (second argument) of the TAG directive");try{a=decodeURIComponent(a)}catch{C(e,"tag prefix is malformed: "+a)}e.tagMap[i]=a},"handleTagDirective")};function ur(t,e,r,n){var i,a,s,p;if(e<r){if(p=t.input.slice(e,r),n)for(i=0,a=p.length;i<a;i+=1)s=p.charCodeAt(i),s===9||32<=s&&s<=1114111||C(t,"expected valid JSON character");else OP.test(p)&&C(t,"the stream contains non-printable characters");t.result+=p}}o(ur,"captureSegment");function _h(t,e,r,n){var i,a,s,p;for(xe.isObject(r)||C(t,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(r),s=0,p=i.length;s<p;s+=1)a=i[s],mr.call(e,a)||(e[a]=r[a],n[a]=!0)}o(_h,"mergeMappings");function Wn(t,e,r,n,i,a,s,p,c){var l,u;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),l=0,u=i.length;l<u;l+=1)Array.isArray(i[l])&&C(t,"nested arrays are not supported inside keys"),typeof i=="object"&&Rh(i[l])==="[object Object]"&&(i[l]="[object Object]");if(typeof i=="object"&&Rh(i)==="[object Object]"&&(i="[object Object]"),i=String(i),e===null&&(e={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(a))for(l=0,u=a.length;l<u;l+=1)_h(t,e,a[l],r);else _h(t,e,a,r);else!t.json&&!mr.call(r,i)&&mr.call(e,i)&&(t.line=s||t.line,t.lineStart=p||t.lineStart,t.position=c||t.position,C(t,"duplicated mapping key")),i==="__proto__"?Object.defineProperty(e,i,{configurable:!0,enumerable:!0,writable:!0,value:a}):e[i]=a,delete r[i];return e}o(Wn,"storeMappingPair");function Hu(t){var e;e=t.input.charCodeAt(t.position),e===10?t.position++:e===13?(t.position++,t.input.charCodeAt(t.position)===10&&t.position++):C(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}o(Hu,"readLineBreak");function ge(t,e,r){for(var n=0,i=t.input.charCodeAt(t.position);i!==0;){for(;Vr(i);)i===9&&t.firstTabInLine===-1&&(t.firstTabInLine=t.position),i=t.input.charCodeAt(++t.position);if(e&&i===35)do i=t.input.charCodeAt(++t.position);while(i!==10&&i!==13&&i!==0);if(Dt(i))for(Hu(t),i=t.input.charCodeAt(t.position),n++,t.lineIndent=0;i===32;)t.lineIndent++,i=t.input.charCodeAt(++t.position);else break}return r!==-1&&n!==0&&t.lineIndent<r&&Qa(t,"deficient indentation"),n}o(ge,"skipSeparationSpace");function Ja(t){var e=t.position,r;return r=t.input.charCodeAt(e),!!((r===45||r===46)&&r===t.input.charCodeAt(e+1)&&r===t.input.charCodeAt(e+2)&&(e+=3,r=t.input.charCodeAt(e),r===0||Be(r)))}o(Ja,"testDocumentSeparator");function Vu(t,e){e===1?t.result+=" ":e>1&&(t.result+=xe.repeat(`
`,e-1))}o(Vu,"writeFoldedLines");function WP(t,e,r){var n,i,a,s,p,c,l,u,m=t.kind,f=t.result,d;if(d=t.input.charCodeAt(t.position),Be(d)||Bn(d)||d===35||d===38||d===42||d===33||d===124||d===62||d===39||d===34||d===37||d===64||d===96||(d===63||d===45)&&(i=t.input.charCodeAt(t.position+1),Be(i)||r&&Bn(i)))return!1;for(t.kind="scalar",t.result="",a=s=t.position,p=!1;d!==0;){if(d===58){if(i=t.input.charCodeAt(t.position+1),Be(i)||r&&Bn(i))break}else if(d===35){if(n=t.input.charCodeAt(t.position-1),Be(n))break}else{if(t.position===t.lineStart&&Ja(t)||r&&Bn(d))break;if(Dt(d))if(c=t.line,l=t.lineStart,u=t.lineIndent,ge(t,!1,-1),t.lineIndent>=e){p=!0,d=t.input.charCodeAt(t.position);continue}else{t.position=s,t.line=c,t.lineStart=l,t.lineIndent=u;break}}p&&(ur(t,a,s,!1),Vu(t,t.line-c),a=s=t.position,p=!1),Vr(d)||(s=t.position+1),d=t.input.charCodeAt(++t.position)}return ur(t,a,s,!1),t.result?!0:(t.kind=m,t.result=f,!1)}o(WP,"readPlainScalar");function jP(t,e){var r,n,i;if(r=t.input.charCodeAt(t.position),r!==39)return!1;for(t.kind="scalar",t.result="",t.position++,n=i=t.position;(r=t.input.charCodeAt(t.position))!==0;)if(r===39)if(ur(t,n,t.position,!0),r=t.input.charCodeAt(++t.position),r===39)n=t.position,t.position++,i=t.position;else return!0;else Dt(r)?(ur(t,n,i,!0),Vu(t,ge(t,!1,e)),n=i=t.position):t.position===t.lineStart&&Ja(t)?C(t,"unexpected end of the document within a single quoted scalar"):(t.position++,i=t.position);C(t,"unexpected end of the stream within a single quoted scalar")}o(jP,"readSingleQuotedScalar");function $P(t,e){var r,n,i,a,s,p;if(p=t.input.charCodeAt(t.position),p!==34)return!1;for(t.kind="scalar",t.result="",t.position++,r=n=t.position;(p=t.input.charCodeAt(t.position))!==0;){if(p===34)return ur(t,r,t.position,!0),t.position++,!0;if(p===92){if(ur(t,r,t.position,!0),p=t.input.charCodeAt(++t.position),Dt(p))ge(t,!1,e);else if(p<256&&$h[p])t.result+=qh[p],t.position++;else if((s=UP(p))>0){for(i=s,a=0;i>0;i--)p=t.input.charCodeAt(++t.position),(s=LP(p))>=0?a=(a<<4)+s:C(t,"expected hexadecimal character");t.result+=VP(a),t.position++}else C(t,"unknown escape sequence");r=n=t.position}else Dt(p)?(ur(t,r,n,!0),Vu(t,ge(t,!1,e)),r=n=t.position):t.position===t.lineStart&&Ja(t)?C(t,"unexpected end of the document within a double quoted scalar"):(t.position++,n=t.position)}C(t,"unexpected end of the stream within a double quoted scalar")}o($P,"readDoubleQuotedScalar");function qP(t,e){var r=!0,n,i,a,s=t.tag,p,c=t.anchor,l,u,m,f,d,y=Object.create(null),T,k,R,A;if(A=t.input.charCodeAt(t.position),A===91)u=93,d=!1,p=[];else if(A===123)u=125,d=!0,p={};else return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=p),A=t.input.charCodeAt(++t.position);A!==0;){if(ge(t,!0,e),A=t.input.charCodeAt(t.position),A===u)return t.position++,t.tag=s,t.anchor=c,t.kind=d?"mapping":"sequence",t.result=p,!0;r?A===44&&C(t,"expected the node content, but found ','"):C(t,"missed comma between flow collection entries"),k=T=R=null,m=f=!1,A===63&&(l=t.input.charCodeAt(t.position+1),Be(l)&&(m=f=!0,t.position++,ge(t,!0,e))),n=t.line,i=t.lineStart,a=t.position,jn(t,e,Ga,!1,!0),k=t.tag,T=t.result,ge(t,!0,e),A=t.input.charCodeAt(t.position),(f||t.line===n)&&A===58&&(m=!0,A=t.input.charCodeAt(++t.position),ge(t,!0,e),jn(t,e,Ga,!1,!0),R=t.result),d?Wn(t,p,y,k,T,R,n,i,a):m?p.push(Wn(t,null,y,k,T,R,n,i,a)):p.push(T),ge(t,!0,e),A=t.input.charCodeAt(t.position),A===44?(r=!0,A=t.input.charCodeAt(++t.position)):r=!1}C(t,"unexpected end of the stream within a flow collection")}o(qP,"readFlowCollection");function zP(t,e){var r,n,i=Au,a=!1,s=!1,p=e,c=0,l=!1,u,m;if(m=t.input.charCodeAt(t.position),m===124)n=!1;else if(m===62)n=!0;else return!1;for(t.kind="scalar",t.result="";m!==0;)if(m=t.input.charCodeAt(++t.position),m===43||m===45)Au===i?i=m===43?bh:IP:C(t,"repeat of a chomping mode identifier");else if((u=HP(m))>=0)u===0?C(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?C(t,"repeat of an indentation width identifier"):(p=e+u-1,s=!0);else break;if(Vr(m)){do m=t.input.charCodeAt(++t.position);while(Vr(m));if(m===35)do m=t.input.charCodeAt(++t.position);while(!Dt(m)&&m!==0)}for(;m!==0;){for(Hu(t),t.lineIndent=0,m=t.input.charCodeAt(t.position);(!s||t.lineIndent<p)&&m===32;)t.lineIndent++,m=t.input.charCodeAt(++t.position);if(!s&&t.lineIndent>p&&(p=t.lineIndent),Dt(m)){c++;continue}if(t.lineIndent<p){i===bh?t.result+=xe.repeat(`
`,a?1+c:c):i===Au&&a&&(t.result+=`
`);break}for(n?Vr(m)?(l=!0,t.result+=xe.repeat(`
`,a?1+c:c)):l?(l=!1,t.result+=xe.repeat(`
`,c+1)):c===0?a&&(t.result+=" "):t.result+=xe.repeat(`
`,c):t.result+=xe.repeat(`
`,a?1+c:c),a=!0,s=!0,c=0,r=t.position;!Dt(m)&&m!==0;)m=t.input.charCodeAt(++t.position);ur(t,r,t.position,!1)}return!0}o(zP,"readBlockScalar");function kh(t,e){var r,n=t.tag,i=t.anchor,a=[],s,p=!1,c;if(t.firstTabInLine!==-1)return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=a),c=t.input.charCodeAt(t.position);c!==0&&(t.firstTabInLine!==-1&&(t.position=t.firstTabInLine,C(t,"tab characters must not be used in indentation")),!(c!==45||(s=t.input.charCodeAt(t.position+1),!Be(s))));){if(p=!0,t.position++,ge(t,!0,-1)&&t.lineIndent<=e){a.push(null),c=t.input.charCodeAt(t.position);continue}if(r=t.line,jn(t,e,Bh,!1,!0),a.push(t.result),ge(t,!0,-1),c=t.input.charCodeAt(t.position),(t.line===r||t.lineIndent>e)&&c!==0)C(t,"bad indentation of a sequence entry");else if(t.lineIndent<e)break}return p?(t.tag=n,t.anchor=i,t.kind="sequence",t.result=a,!0):!1}o(kh,"readBlockSequence");function GP(t,e,r){var n,i,a,s,p,c,l=t.tag,u=t.anchor,m={},f=Object.create(null),d=null,y=null,T=null,k=!1,R=!1,A;if(t.firstTabInLine!==-1)return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=m),A=t.input.charCodeAt(t.position);A!==0;){if(!k&&t.firstTabInLine!==-1&&(t.position=t.firstTabInLine,C(t,"tab characters must not be used in indentation")),n=t.input.charCodeAt(t.position+1),a=t.line,(A===63||A===58)&&Be(n))A===63?(k&&(Wn(t,m,f,d,y,null,s,p,c),d=y=T=null),R=!0,k=!0,i=!0):k?(k=!1,i=!0):C(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,A=n;else{if(s=t.line,p=t.lineStart,c=t.position,!jn(t,r,Vh,!1,!0))break;if(t.line===a){for(A=t.input.charCodeAt(t.position);Vr(A);)A=t.input.charCodeAt(++t.position);if(A===58)A=t.input.charCodeAt(++t.position),Be(A)||C(t,"a whitespace character is expected after the key-value separator within a block mapping"),k&&(Wn(t,m,f,d,y,null,s,p,c),d=y=T=null),R=!0,k=!1,i=!1,d=t.tag,y=t.result;else if(R)C(t,"can not read an implicit mapping pair; a colon is missed");else return t.tag=l,t.anchor=u,!0}else if(R)C(t,"can not read a block mapping entry; a multiline key may not be an implicit key");else return t.tag=l,t.anchor=u,!0}if((t.line===a||t.lineIndent>e)&&(k&&(s=t.line,p=t.lineStart,c=t.position),jn(t,e,Ka,!0,i)&&(k?y=t.result:T=t.result),k||(Wn(t,m,f,d,y,T,s,p,c),d=y=T=null),ge(t,!0,-1),A=t.input.charCodeAt(t.position)),(t.line===a||t.lineIndent>e)&&A!==0)C(t,"bad indentation of a mapping entry");else if(t.lineIndent<e)break}return k&&Wn(t,m,f,d,y,null,s,p,c),R&&(t.tag=l,t.anchor=u,t.kind="mapping",t.result=m),R}o(GP,"readBlockMapping");function KP(t){var e,r=!1,n=!1,i,a,s;if(s=t.input.charCodeAt(t.position),s!==33)return!1;if(t.tag!==null&&C(t,"duplication of a tag property"),s=t.input.charCodeAt(++t.position),s===60?(r=!0,s=t.input.charCodeAt(++t.position)):s===33?(n=!0,i="!!",s=t.input.charCodeAt(++t.position)):i="!",e=t.position,r){do s=t.input.charCodeAt(++t.position);while(s!==0&&s!==62);t.position<t.length?(a=t.input.slice(e,t.position),s=t.input.charCodeAt(++t.position)):C(t,"unexpected end of the stream within a verbatim tag")}else{for(;s!==0&&!Be(s);)s===33&&(n?C(t,"tag suffix cannot contain exclamation marks"):(i=t.input.slice(e-1,t.position+1),Wh.test(i)||C(t,"named tag handle cannot contain such characters"),n=!0,e=t.position+1)),s=t.input.charCodeAt(++t.position);a=t.input.slice(e,t.position),NP.test(a)&&C(t,"tag suffix cannot contain flow indicator characters")}a&&!jh.test(a)&&C(t,"tag name cannot contain such characters: "+a);try{a=decodeURIComponent(a)}catch{C(t,"tag name is malformed: "+a)}return r?t.tag=a:mr.call(t.tagMap,i)?t.tag=t.tagMap[i]+a:i==="!"?t.tag="!"+a:i==="!!"?t.tag="tag:yaml.org,2002:"+a:C(t,'undeclared tag handle "'+i+'"'),!0}o(KP,"readTagProperty");function QP(t){var e,r;if(r=t.input.charCodeAt(t.position),r!==38)return!1;for(t.anchor!==null&&C(t,"duplication of an anchor property"),r=t.input.charCodeAt(++t.position),e=t.position;r!==0&&!Be(r)&&!Bn(r);)r=t.input.charCodeAt(++t.position);return t.position===e&&C(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(e,t.position),!0}o(QP,"readAnchorProperty");function ZP(t){var e,r,n;if(n=t.input.charCodeAt(t.position),n!==42)return!1;for(n=t.input.charCodeAt(++t.position),e=t.position;n!==0&&!Be(n)&&!Bn(n);)n=t.input.charCodeAt(++t.position);return t.position===e&&C(t,"name of an alias node must contain at least one character"),r=t.input.slice(e,t.position),mr.call(t.anchorMap,r)||C(t,'unidentified alias "'+r+'"'),t.result=t.anchorMap[r],ge(t,!0,-1),!0}o(ZP,"readAlias");function jn(t,e,r,n,i){var a,s,p,c=1,l=!1,u=!1,m,f,d,y,T,k;if(t.listener!==null&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,a=s=p=Ka===r||Bh===r,n&&ge(t,!0,-1)&&(l=!0,t.lineIndent>e?c=1:t.lineIndent===e?c=0:t.lineIndent<e&&(c=-1)),c===1)for(;KP(t)||QP(t);)ge(t,!0,-1)?(l=!0,p=a,t.lineIndent>e?c=1:t.lineIndent===e?c=0:t.lineIndent<e&&(c=-1)):p=!1;if(p&&(p=l||i),(c===1||Ka===r)&&(Ga===r||Vh===r?T=e:T=e+1,k=t.position-t.lineStart,c===1?p&&(kh(t,k)||GP(t,k,T))||qP(t,T)?u=!0:(s&&zP(t,T)||jP(t,T)||$P(t,T)?u=!0:ZP(t)?(u=!0,(t.tag!==null||t.anchor!==null)&&C(t,"alias node should not have any properties")):WP(t,T,Ga===r)&&(u=!0,t.tag===null&&(t.tag="?")),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):c===0&&(u=p&&kh(t,k))),t.tag===null)t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);else if(t.tag==="?"){for(t.result!==null&&t.kind!=="scalar"&&C(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),m=0,f=t.implicitTypes.length;m<f;m+=1)if(y=t.implicitTypes[m],y.resolve(t.result)){t.result=y.construct(t.result),t.tag=y.tag,t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);break}}else if(t.tag!=="!"){if(mr.call(t.typeMap[t.kind||"fallback"],t.tag))y=t.typeMap[t.kind||"fallback"][t.tag];else for(y=null,d=t.typeMap.multi[t.kind||"fallback"],m=0,f=d.length;m<f;m+=1)if(t.tag.slice(0,d[m].tag.length)===d[m].tag){y=d[m];break}y||C(t,"unknown tag !<"+t.tag+">"),t.result!==null&&y.kind!==t.kind&&C(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+y.kind+'", not "'+t.kind+'"'),y.resolve(t.result,t.tag)?(t.result=y.construct(t.result,t.tag),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):C(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return t.listener!==null&&t.listener("close",t),t.tag!==null||t.anchor!==null||u}o(jn,"composeNode");function YP(t){var e=t.position,r,n,i,a=!1,s;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);(s=t.input.charCodeAt(t.position))!==0&&(ge(t,!0,-1),s=t.input.charCodeAt(t.position),!(t.lineIndent>0||s!==37));){for(a=!0,s=t.input.charCodeAt(++t.position),r=t.position;s!==0&&!Be(s);)s=t.input.charCodeAt(++t.position);for(n=t.input.slice(r,t.position),i=[],n.length<1&&C(t,"directive name must not be less than one character in length");s!==0;){for(;Vr(s);)s=t.input.charCodeAt(++t.position);if(s===35){do s=t.input.charCodeAt(++t.position);while(s!==0&&!Dt(s));break}if(Dt(s))break;for(r=t.position;s!==0&&!Be(s);)s=t.input.charCodeAt(++t.position);i.push(t.input.slice(r,t.position))}s!==0&&Hu(t),mr.call(Eh,n)?Eh[n](t,n,i):Qa(t,'unknown document directive "'+n+'"')}if(ge(t,!0,-1),t.lineIndent===0&&t.input.charCodeAt(t.position)===45&&t.input.charCodeAt(t.position+1)===45&&t.input.charCodeAt(t.position+2)===45?(t.position+=3,ge(t,!0,-1)):a&&C(t,"directives end mark is expected"),jn(t,t.lineIndent-1,Ka,!1,!0),ge(t,!0,-1),t.checkLineBreaks&&CP.test(t.input.slice(e,t.position))&&Qa(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&Ja(t)){t.input.charCodeAt(t.position)===46&&(t.position+=3,ge(t,!0,-1));return}if(t.position<t.length-1)C(t,"end of the stream or a document separator is expected");else return}o(YP,"readDocument");function Gh(t,e){t=String(t),e=e||{},t.length!==0&&(t.charCodeAt(t.length-1)!==10&&t.charCodeAt(t.length-1)!==13&&(t+=`
`),t.charCodeAt(0)===65279&&(t=t.slice(1)));var r=new BP(t,e),n=t.indexOf("\0");for(n!==-1&&(r.position=n,C(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)YP(r);return r.documents}o(Gh,"loadDocuments");function JP(t,e,r){e!==null&&typeof e=="object"&&typeof r>"u"&&(r=e,e=null);var n=Gh(t,r);if(typeof e!="function")return n;for(var i=0,a=n.length;i<a;i+=1)e(n[i])}o(JP,"loadAll$1");function XP(t,e){var r=Gh(t,e);if(r.length!==0){if(r.length===1)return r[0];throw new Ve("expected a single document in the stream, but found more")}}o(XP,"load$1");var eD=JP,tD=XP,Kh={loadAll:eD,load:tD},Qh=Object.prototype.toString,Zh=Object.prototype.hasOwnProperty,Bu=65279,rD=9,Zi=10,nD=13,iD=32,oD=33,aD=34,Iu=35,sD=37,pD=38,cD=39,lD=42,Yh=44,uD=45,Za=58,mD=61,fD=62,dD=63,gD=64,Jh=91,Xh=93,hD=96,ey=123,yD=124,ty=125,De={};De[0]="\\0";De[7]="\\a";De[8]="\\b";De[9]="\\t";De[10]="\\n";De[11]="\\v";De[12]="\\f";De[13]="\\r";De[27]="\\e";De[34]='\\"';De[92]="\\\\";De[133]="\\N";De[160]="\\_";De[8232]="\\L";De[8233]="\\P";var TD=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],xD=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function SD(t,e){var r,n,i,a,s,p,c;if(e===null)return{};for(r={},n=Object.keys(e),i=0,a=n.length;i<a;i+=1)s=n[i],p=String(e[s]),s.slice(0,2)==="!!"&&(s="tag:yaml.org,2002:"+s.slice(2)),c=t.compiledTypeMap.fallback[s],c&&Zh.call(c.styleAliases,p)&&(p=c.styleAliases[p]),r[s]=p;return r}o(SD,"compileStyleMap");function vD(t){var e,r,n;if(e=t.toString(16).toUpperCase(),t<=255)r="x",n=2;else if(t<=65535)r="u",n=4;else if(t<=4294967295)r="U",n=8;else throw new Ve("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+xe.repeat("0",n-e.length)+e}o(vD,"encodeHex");var bD=1,Yi=2;function RD(t){this.schema=t.schema||Uu,this.indent=Math.max(1,t.indent||2),this.noArrayIndent=t.noArrayIndent||!1,this.skipInvalid=t.skipInvalid||!1,this.flowLevel=xe.isNothing(t.flowLevel)?-1:t.flowLevel,this.styleMap=SD(this.schema,t.styles||null),this.sortKeys=t.sortKeys||!1,this.lineWidth=t.lineWidth||80,this.noRefs=t.noRefs||!1,this.noCompatMode=t.noCompatMode||!1,this.condenseFlow=t.condenseFlow||!1,this.quotingType=t.quotingType==='"'?Yi:bD,this.forceQuotes=t.forceQuotes||!1,this.replacer=typeof t.replacer=="function"?t.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}o(RD,"State");function Ph(t,e){for(var r=xe.repeat(" ",e),n=0,i=-1,a="",s,p=t.length;n<p;)i=t.indexOf(`
`,n),i===-1?(s=t.slice(n),n=p):(s=t.slice(n,i+1),n=i+1),s.length&&s!==`
`&&(a+=r),a+=s;return a}o(Ph,"indentString");function Ou(t,e){return`
`+xe.repeat(" ",t.indent*e)}o(Ou,"generateNextLine");function wD(t,e){var r,n,i;for(r=0,n=t.implicitTypes.length;r<n;r+=1)if(i=t.implicitTypes[r],i.resolve(e))return!0;return!1}o(wD,"testImplicitResolving");function Ya(t){return t===iD||t===rD}o(Ya,"isWhitespace");function Ji(t){return 32<=t&&t<=126||161<=t&&t<=55295&&t!==8232&&t!==8233||57344<=t&&t<=65533&&t!==Bu||65536<=t&&t<=1114111}o(Ji,"isPrintable");function Dh(t){return Ji(t)&&t!==Bu&&t!==nD&&t!==Zi}o(Dh,"isNsCharOrWhitespace");function Mh(t,e,r){var n=Dh(t),i=n&&!Ya(t);return(r?n:n&&t!==Yh&&t!==Jh&&t!==Xh&&t!==ey&&t!==ty)&&t!==Iu&&!(e===Za&&!i)||Dh(e)&&!Ya(e)&&t===Iu||e===Za&&i}o(Mh,"isPlainSafe");function ED(t){return Ji(t)&&t!==Bu&&!Ya(t)&&t!==uD&&t!==dD&&t!==Za&&t!==Yh&&t!==Jh&&t!==Xh&&t!==ey&&t!==ty&&t!==Iu&&t!==pD&&t!==lD&&t!==oD&&t!==yD&&t!==mD&&t!==fD&&t!==cD&&t!==aD&&t!==sD&&t!==gD&&t!==hD}o(ED,"isPlainSafeFirst");function _D(t){return!Ya(t)&&t!==Za}o(_D,"isPlainSafeLast");function Ki(t,e){var r=t.charCodeAt(e),n;return r>=55296&&r<=56319&&e+1<t.length&&(n=t.charCodeAt(e+1),n>=56320&&n<=57343)?(r-55296)*1024+n-56320+65536:r}o(Ki,"codePointAt");function ry(t){var e=/^\n* /;return e.test(t)}o(ry,"needIndentIndicator");var ny=1,Cu=2,iy=3,oy=4,Vn=5;function kD(t,e,r,n,i,a,s,p){var c,l=0,u=null,m=!1,f=!1,d=n!==-1,y=-1,T=ED(Ki(t,0))&&_D(Ki(t,t.length-1));if(e||s)for(c=0;c<t.length;l>=65536?c+=2:c++){if(l=Ki(t,c),!Ji(l))return Vn;T=T&&Mh(l,u,p),u=l}else{for(c=0;c<t.length;l>=65536?c+=2:c++){if(l=Ki(t,c),l===Zi)m=!0,d&&(f=f||c-y-1>n&&t[y+1]!==" ",y=c);else if(!Ji(l))return Vn;T=T&&Mh(l,u,p),u=l}f=f||d&&c-y-1>n&&t[y+1]!==" "}return!m&&!f?T&&!s&&!i(t)?ny:a===Yi?Vn:Cu:r>9&&ry(t)?Vn:s?a===Yi?Vn:Cu:f?oy:iy}o(kD,"chooseScalarStyle");function PD(t,e,r,n,i){t.dump=function(){if(e.length===0)return t.quotingType===Yi?'""':"''";if(!t.noCompatMode&&(TD.indexOf(e)!==-1||xD.test(e)))return t.quotingType===Yi?'"'+e+'"':"'"+e+"'";var a=t.indent*Math.max(1,r),s=t.lineWidth===-1?-1:Math.max(Math.min(t.lineWidth,40),t.lineWidth-a),p=n||t.flowLevel>-1&&r>=t.flowLevel;function c(l){return wD(t,l)}switch(o(c,"testAmbiguity"),kD(e,p,t.indent,s,c,t.quotingType,t.forceQuotes&&!n,i)){case ny:return e;case Cu:return"'"+e.replace(/'/g,"''")+"'";case iy:return"|"+Ah(e,t.indent)+Fh(Ph(e,a));case oy:return">"+Ah(e,t.indent)+Fh(Ph(DD(e,s),a));case Vn:return'"'+MD(e)+'"';default:throw new Ve("impossible error: invalid scalar style")}}()}o(PD,"writeScalar");function Ah(t,e){var r=ry(t)?String(e):"",n=t[t.length-1]===`
`,i=n&&(t[t.length-2]===`
`||t===`
`),a=i?"+":n?"":"-";return r+a+`
`}o(Ah,"blockHeader");function Fh(t){return t[t.length-1]===`
`?t.slice(0,-1):t}o(Fh,"dropEndingNewline");function DD(t,e){for(var r=/(\n+)([^\n]*)/g,n=function(){var l=t.indexOf(`
`);return l=l!==-1?l:t.length,r.lastIndex=l,Ih(t.slice(0,l),e)}(),i=t[0]===`
`||t[0]===" ",a,s;s=r.exec(t);){var p=s[1],c=s[2];a=c[0]===" ",n+=p+(!i&&!a&&c!==""?`
`:"")+Ih(c,e),i=a}return n}o(DD,"foldString");function Ih(t,e){if(t===""||t[0]===" ")return t;for(var r=/ [^ ]/g,n,i=0,a,s=0,p=0,c="";n=r.exec(t);)p=n.index,p-i>e&&(a=s>i?s:p,c+=`
`+t.slice(i,a),i=a+1),s=p;return c+=`
`,t.length-i>e&&s>i?c+=t.slice(i,s)+`
`+t.slice(s+1):c+=t.slice(i),c.slice(1)}o(Ih,"foldLine");function MD(t){for(var e="",r=0,n,i=0;i<t.length;r>=65536?i+=2:i++)r=Ki(t,i),n=De[r],!n&&Ji(r)?(e+=t[i],r>=65536&&(e+=t[i+1])):e+=n||vD(r);return e}o(MD,"escapeString");function AD(t,e,r){var n="",i=t.tag,a,s,p;for(a=0,s=r.length;a<s;a+=1)p=r[a],t.replacer&&(p=t.replacer.call(r,String(a),p)),(qt(t,e,p,!1,!1)||typeof p>"u"&&qt(t,e,null,!1,!1))&&(n!==""&&(n+=","+(t.condenseFlow?"":" ")),n+=t.dump);t.tag=i,t.dump="["+n+"]"}o(AD,"writeFlowSequence");function Oh(t,e,r,n){var i="",a=t.tag,s,p,c;for(s=0,p=r.length;s<p;s+=1)c=r[s],t.replacer&&(c=t.replacer.call(r,String(s),c)),(qt(t,e+1,c,!0,!0,!1,!0)||typeof c>"u"&&qt(t,e+1,null,!0,!0,!1,!0))&&((!n||i!=="")&&(i+=Ou(t,e)),t.dump&&Zi===t.dump.charCodeAt(0)?i+="-":i+="- ",i+=t.dump);t.tag=a,t.dump=i||"[]"}o(Oh,"writeBlockSequence");function FD(t,e,r){var n="",i=t.tag,a=Object.keys(r),s,p,c,l,u;for(s=0,p=a.length;s<p;s+=1)u="",n!==""&&(u+=", "),t.condenseFlow&&(u+='"'),c=a[s],l=r[c],t.replacer&&(l=t.replacer.call(r,c,l)),qt(t,e,c,!1,!1)&&(t.dump.length>1024&&(u+="? "),u+=t.dump+(t.condenseFlow?'"':"")+":"+(t.condenseFlow?"":" "),qt(t,e,l,!1,!1)&&(u+=t.dump,n+=u));t.tag=i,t.dump="{"+n+"}"}o(FD,"writeFlowMapping");function ID(t,e,r,n){var i="",a=t.tag,s=Object.keys(r),p,c,l,u,m,f;if(t.sortKeys===!0)s.sort();else if(typeof t.sortKeys=="function")s.sort(t.sortKeys);else if(t.sortKeys)throw new Ve("sortKeys must be a boolean or a function");for(p=0,c=s.length;p<c;p+=1)f="",(!n||i!=="")&&(f+=Ou(t,e)),l=s[p],u=r[l],t.replacer&&(u=t.replacer.call(r,l,u)),qt(t,e+1,l,!0,!0,!0)&&(m=t.tag!==null&&t.tag!=="?"||t.dump&&t.dump.length>1024,m&&(t.dump&&Zi===t.dump.charCodeAt(0)?f+="?":f+="? "),f+=t.dump,m&&(f+=Ou(t,e)),qt(t,e+1,u,!0,m)&&(t.dump&&Zi===t.dump.charCodeAt(0)?f+=":":f+=": ",f+=t.dump,i+=f));t.tag=a,t.dump=i||"{}"}o(ID,"writeBlockMapping");function Ch(t,e,r){var n,i,a,s,p,c;for(i=r?t.explicitTypes:t.implicitTypes,a=0,s=i.length;a<s;a+=1)if(p=i[a],(p.instanceOf||p.predicate)&&(!p.instanceOf||typeof e=="object"&&e instanceof p.instanceOf)&&(!p.predicate||p.predicate(e))){if(r?p.multi&&p.representName?t.tag=p.representName(e):t.tag=p.tag:t.tag="?",p.represent){if(c=t.styleMap[p.tag]||p.defaultStyle,Qh.call(p.represent)==="[object Function]")n=p.represent(e,c);else if(Zh.call(p.represent,c))n=p.represent[c](e,c);else throw new Ve("!<"+p.tag+'> tag resolver accepts not "'+c+'" style');t.dump=n}return!0}return!1}o(Ch,"detectType");function qt(t,e,r,n,i,a,s){t.tag=null,t.dump=r,Ch(t,r,!1)||Ch(t,r,!0);var p=Qh.call(t.dump),c=n,l;n&&(n=t.flowLevel<0||t.flowLevel>e);var u=p==="[object Object]"||p==="[object Array]",m,f;if(u&&(m=t.duplicates.indexOf(r),f=m!==-1),(t.tag!==null&&t.tag!=="?"||f||t.indent!==2&&e>0)&&(i=!1),f&&t.usedDuplicates[m])t.dump="*ref_"+m;else{if(u&&f&&!t.usedDuplicates[m]&&(t.usedDuplicates[m]=!0),p==="[object Object]")n&&Object.keys(t.dump).length!==0?(ID(t,e,t.dump,i),f&&(t.dump="&ref_"+m+t.dump)):(FD(t,e,t.dump),f&&(t.dump="&ref_"+m+" "+t.dump));else if(p==="[object Array]")n&&t.dump.length!==0?(t.noArrayIndent&&!s&&e>0?Oh(t,e-1,t.dump,i):Oh(t,e,t.dump,i),f&&(t.dump="&ref_"+m+t.dump)):(AD(t,e,t.dump),f&&(t.dump="&ref_"+m+" "+t.dump));else if(p==="[object String]")t.tag!=="?"&&PD(t,t.dump,e,a,c);else{if(p==="[object Undefined]")return!1;if(t.skipInvalid)return!1;throw new Ve("unacceptable kind of an object to dump "+p)}t.tag!==null&&t.tag!=="?"&&(l=encodeURI(t.tag[0]==="!"?t.tag.slice(1):t.tag).replace(/!/g,"%21"),t.tag[0]==="!"?l="!"+l:l.slice(0,18)==="tag:yaml.org,2002:"?l="!!"+l.slice(18):l="!<"+l+">",t.dump=l+" "+t.dump)}return!0}o(qt,"writeNode");function OD(t,e){var r=[],n=[],i,a;for(Nu(t,r,n),i=0,a=n.length;i<a;i+=1)e.duplicates.push(r[n[i]]);e.usedDuplicates=new Array(a)}o(OD,"getDuplicateReferences");function Nu(t,e,r){var n,i,a;if(t!==null&&typeof t=="object")if(i=e.indexOf(t),i!==-1)r.indexOf(i)===-1&&r.push(i);else if(e.push(t),Array.isArray(t))for(i=0,a=t.length;i<a;i+=1)Nu(t[i],e,r);else for(n=Object.keys(t),i=0,a=n.length;i<a;i+=1)Nu(t[n[i]],e,r)}o(Nu,"inspectNode");function CD(t,e){e=e||{};var r=new RD(e);r.noRefs||OD(t,r);var n=t;return r.replacer&&(n=r.replacer.call({"":n},"",n)),qt(r,0,n,!0,!0)?r.dump+`
`:""}o(CD,"dump$1");var ND=CD,LD={dump:ND};function Wu(t,e){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+e+" instead, which is now safe by default.")}}o(Wu,"renamed");var ay=Ee;var sy=Uu,v5=Kh.load,b5=Kh.loadAll,py=LD.dump;var R5=Wu("safeLoad","load"),w5=Wu("safeLoadAll","loadAll"),E5=Wu("safeDump","dump");var Xa=class{constructor(e,r){this.data=e;this.opts=r}static{o(this,"CustomDump")}represent(){let e=py(this.data,Object.assign({replacer:WD,schema:VD},this.opts));return e=e.trim(),e.includes(`
`)&&(e=`
`+e),e}},HD=new ay("!format",{kind:"scalar",resolve:o(()=>!1,"resolve"),instanceOf:Xa,represent:o(t=>t.represent(),"represent")}),VD=sy.extend({implicit:[HD]}),ju=o(t=>typeof t=="object"&&t!=null,"isObject");function BD(t){if(ju(t))return Object.values(t).every(e=>!ju(e)&&!Array.isArray(e));if(Array.isArray(t))return t.every(e=>!ju(e)&&!Array.isArray(e))}o(BD,"hasSimpleChildren");function WD(t,e){return t===""?e:BD(e)?new Xa(e,{flowLevel:0}):e}o(WD,"replacer");var $u=["breakLine","clearAndSetSelection","copyToClipboard","cutToClipboard","decrement","deselect","editNewLineAfter","editNewLineBefore","experimental.setInstanceReference","extractVariable","findInDocument","findInWorkspace","foldRegion","followLink","followLinkAside","increment","indentLine","insertCopyAfter","insertCopyBefore","insertEmptyLineAfter","insertEmptyLineBefore","insertEmptyLinesAround","joinLines","outdentLine","randomizeTargets","remove","rename","revealDefinition","revealTypeDefinition","reverseTargets","scrollToBottom","scrollToCenter","scrollToTop","setSelection","setSelectionAfter","setSelectionBefore","showDebugHover","showHover","showQuickFix","showReferences","sortTargets","toggleLineBreakpoint","toggleLineComment","unfoldRegion","private.setKeyboardTarget","private.showParseTree","private.getTargets"],jD=["callAsFunction","editNew","executeCommand","generateSnippet","getText","highlight","insertSnippet","moveToTarget","pasteFromClipboard","replace","replaceWithTarget","rewrapWithPairedDelimiter","swapTargets","wrapWithPairedDelimiter","wrapWithSnippet","parsed"],cy=[...$u,...jD];var $D=["angleBrackets","backtickQuotes","curlyBrackets","doubleQuotes","escapedDoubleQuotes","escapedParentheses","escapedSingleQuotes","escapedSquareBrackets","parentheses","singleQuotes","squareBrackets","tripleDoubleQuotes","tripleSingleQuotes"],qD=["string","any","collectionBoundary"],es=[...$D,...qD],Br=["argumentOrParameter","anonymousFunction","attribute","branch","class","className","collectionItem","collectionKey","comment","private.fieldAccess","functionCall","functionCallee","functionName","ifStatement","instance","list","map","name","namedFunction","regularExpression","statement","string","type","value","condition","section","sectionLevelOne","sectionLevelTwo","sectionLevelThree","sectionLevelFour","sectionLevelFive","sectionLevelSix","selector","private.switchStatementSubject","unit","xmlBothTags","xmlElement","xmlEndTag","xmlStartTag","part","chapter","subSection","subSubSection","namedParagraph","subParagraph","environment","character","word","token","identifier","line","sentence","paragraph","boundedParagraph","document","nonWhitespaceSequence","boundedNonWhitespaceSequence","url","notebookCell","command","textFragment","disqualifyDelimiter"];function ly(t){return Br.includes(t.type)}o(ly,"isSimpleScopeType");var uy=["simpleScopeTypeType","complexScopeTypeType","customRegex","pairedDelimiter","action","customAction","grapheme"],ts=class extends Error{static{o(this,"NeedsInitialTalonUpdateError")}constructor(e){super(e),this.name="NeedsInitialTalonUpdateError"}},$n=class extends Error{static{o(this,"DisabledCustomSpokenFormsError")}constructor(){super("Custom spoken forms are not currently supported in this ide"),this.name="DisabledCustomSpokenFormsError"}};function Xi(t){return t.replace(/([A-Z])/g," $1").split(" ").map(e=>e.toLowerCase()).join(" ")}o(Xi,"camelCaseToAllDown");function rs(t){return t.version>=7}o(rs,"clientSupportsFallback");var fr=class{constructor(e){this.hashFunction=e;this.map={}}static{o(this,"CompositeKeyMap")}hash(e){return this.hashFunction(e).join("\0")}set(e,r){return this.map[this.hash(e)]=r,this}has(e){return this.hash(e)in this.map}get(e){return this.map[this.hash(e)]}delete(e){return delete this.map[this.hash(e)],this}clear(){return this.map={},this}};var dr=class extends Map{constructor(r){super();this.getDefaultValue=r}static{o(this,"DefaultMap")}get(r){let n=super.get(r);if(n!=null)return n;let i=this.getDefaultValue(r);return this.set(r,i),i}};function my(...t){return{dispose(){t.forEach(({dispose:e})=>{try{e()}catch(r){console.error(r)}})}}}o(my,"disposableFrom");function eo(t){return typeof t=="string"||t instanceof String}o(eo,"isString");function fy(t){let[e,...r]=t;return zD(e,r)}o(fy,"ensureCommandShape");function zD(t,e){let r;if(eo(t)){let n=t,[i,a,...s]=e;r={version:0,spokenForm:n,action:i,targets:a,extraArgs:s,usePrePhraseSnapshot:!1}}else r=t;return r}o(zD,"handleLegacyCommandShape");function ns(t,e){let r=new Map;return t.forEach(n=>{let i=e(n),a;r.has(i)?a=r.get(i):(a=[],r.set(i,a)),a.push(n)}),r}o(ns,"groupBy");function dy(t){for(let e of t)return!1;return!0}o(dy,"isEmptyIterable");function gr(t){return Object.keys(t)}o(gr,"unsafeKeys");function gy(t,e){return t.length===e.length&&t.every((r,n)=>r.isEqual(e[n]))}o(gy,"selectionsEqual");function is(t,e){return`${t}.${e}`}o(is,"getKey");var yy={camelCase(t){if(t.length===0)return"";let[e,...r]=t;return e+r.map(hy).join("")},snakeCase(t){return t.join("_")},upperSnakeCase(t){return t.map(e=>e.toUpperCase()).join("_")},pascalCase(t){return t.map(hy).join("")}};function hy(t){return t.length===0?"":t[0].toUpperCase()+t.substr(1)}o(hy,"capitalizeToken");function Ty(t,e,r){if(t.length<2)return[...t];if(t.length===2)return e(t[0],t[1])?[t[0]]:[...t];let n=[],i=t.reduce((a,s)=>{let p=r(s),c=a.get(p);return c==null?(a.set(p,[s]),a):(a.get(p).push(s),c.length===2&&n.push(p),a)},new Map);return n.length===0?[...t]:(n.forEach(a=>{i.set(a,Ui(i.get(a),e))}),t.flatMap(a=>{let s=r(a),p=i.get(s);if(p==null||p.length===0)return[];let c=p[0];return e(c,a)?(p.shift(),c):[]}))}o(Ty,"uniqWithHash");function Wr(t,e){if(t.length!==e.length)throw new Error("Lists must have the same length");return t.map((r,n)=>[r,e[n]])}o(Wr,"zipStrict");var wy=Symbol.for("immer-nothing"),xy=Symbol.for("immer-draftable"),Xe=Symbol.for("immer-state"),GD=process.env.NODE_ENV!=="production"?[function(t){return`The plugin for '${t}' has not been loaded into Immer. To enable the plugin, import and call \`enable${t}()\` when initializing your application.`},function(t){return`produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${t}'`},"This object has been frozen and should not be mutated",function(t){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+t},"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.","Immer forbids circular references","The first or second argument to `produce` must be a function","The third argument to `produce` must be a function or undefined","First argument to `createDraft` must be a plain object, an array, or an immerable object","First argument to `finishDraft` must be a draft returned by `createDraft`",function(t){return`'current' expects a draft, got: ${t}`},"Object.defineProperty() cannot be used on an Immer draft","Object.setPrototypeOf() cannot be used on an Immer draft","Immer only supports deleting array indices","Immer only supports setting array indices and the 'length' property",function(t){return`'original' expects a draft, got: ${t}`}]:[];function We(t,...e){if(process.env.NODE_ENV!=="production"){let r=GD[t],n=typeof r=="function"?r.apply(null,e):r;throw new Error(`[Immer] ${n}`)}throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}o(We,"die");var qn=Object.getPrototypeOf;function zn(t){return!!t&&!!t[Xe]}o(zn,"isDraft");function $r(t){return t?Ey(t)||Array.isArray(t)||!!t[xy]||!!t.constructor?.[xy]||cs(t)||ls(t):!1}o($r,"isDraftable");var KD=Object.prototype.constructor.toString();function Ey(t){if(!t||typeof t!="object")return!1;let e=qn(t);if(e===null)return!0;let r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===KD}o(Ey,"isPlainObject");function os(t,e){ps(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}o(os,"each");function ps(t){let e=t[Xe];return e?e.type_:Array.isArray(t)?1:cs(t)?2:ls(t)?3:0}o(ps,"getArchtype");function Gu(t,e){return ps(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}o(Gu,"has");function _y(t,e,r){let n=ps(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}o(_y,"set");function QD(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}o(QD,"is");function cs(t){return t instanceof Map}o(cs,"isMap");function ls(t){return t instanceof Set}o(ls,"isSet");function jr(t){return t.copy_||t.base_}o(jr,"latest");function Ku(t,e){if(cs(t))return new Map(t);if(ls(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);let r=Ey(t);if(e===!0||e==="class_only"&&!r){let n=Object.getOwnPropertyDescriptors(t);delete n[Xe];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){let s=i[a],p=n[s];p.writable===!1&&(p.writable=!0,p.configurable=!0),(p.get||p.set)&&(n[s]={configurable:!0,writable:!0,enumerable:p.enumerable,value:t[s]})}return Object.create(qn(t),n)}else{let n=qn(t);if(n!==null&&r)return{...t};let i=Object.create(n);return Object.assign(i,t)}}o(Ku,"shallowCopy");function Xu(t,e=!1){return us(t)||zn(t)||!$r(t)||(ps(t)>1&&(t.set=t.add=t.clear=t.delete=ZD),Object.freeze(t),e&&Object.entries(t).forEach(([r,n])=>Xu(n,!0))),t}o(Xu,"freeze");function ZD(){We(2)}o(ZD,"dontMutateFrozenCollections");function us(t){return Object.isFrozen(t)}o(us,"isFrozen");var YD={};function qr(t){let e=YD[t];return e||We(0,t),e}o(qr,"getPlugin");var to;function ky(){return to}o(ky,"getCurrentScope");function JD(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}o(JD,"createScope");function Sy(t,e){e&&(qr("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}o(Sy,"usePatchesInScope");function Qu(t){Zu(t),t.drafts_.forEach(XD),t.drafts_=null}o(Qu,"revokeScope");function Zu(t){t===to&&(to=t.parent_)}o(Zu,"leaveScope");function vy(t){return to=JD(to,t)}o(vy,"enterScope");function XD(t){let e=t[Xe];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}o(XD,"revokeDraft");function by(t,e){e.unfinalizedDrafts_=e.drafts_.length;let r=e.drafts_[0];return t!==void 0&&t!==r?(r[Xe].modified_&&(Qu(e),We(4)),$r(t)&&(t=as(e,t),e.parent_||ss(e,t)),e.patches_&&qr("Patches").generateReplacementPatches_(r[Xe].base_,t,e.patches_,e.inversePatches_)):t=as(e,r,[]),Qu(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==wy?t:void 0}o(by,"processResult");function as(t,e,r){if(us(e))return e;let n=e[Xe];if(!n)return os(e,(i,a)=>Ry(t,n,e,i,a,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return ss(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let i=n.copy_,a=i,s=!1;n.type_===3&&(a=new Set(i),i.clear(),s=!0),os(a,(p,c)=>Ry(t,n,i,p,c,r,s)),ss(t,i,!1),r&&t.patches_&&qr("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}o(as,"finalize");function Ry(t,e,r,n,i,a,s){if(process.env.NODE_ENV!=="production"&&i===r&&We(5),zn(i)){let p=a&&e&&e.type_!==3&&!Gu(e.assigned_,n)?a.concat(n):void 0,c=as(t,i,p);if(_y(r,n,c),zn(c))t.canAutoFreeze_=!1;else return}else s&&r.add(i);if($r(i)&&!us(i)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;as(t,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&ss(t,i)}}o(Ry,"finalizeProperty");function ss(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Xu(e,r)}o(ss,"maybeFreeze");function eM(t,e){let r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:ky(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1},i=n,a=em;r&&(i=[n],a=ro);let{revoke:s,proxy:p}=Proxy.revocable(i,a);return n.draft_=p,n.revoke_=s,p}o(eM,"createProxyProxy");var em={get(t,e){if(e===Xe)return t;let r=jr(t);if(!Gu(r,e))return tM(t,r,e);let n=r[e];return t.finalized_||!$r(n)?n:n===qu(t.base_,e)?(zu(t),t.copy_[e]=Ju(n,t)):n},has(t,e){return e in jr(t)},ownKeys(t){return Reflect.ownKeys(jr(t))},set(t,e,r){let n=Py(jr(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){let i=qu(jr(t),e),a=i?.[Xe];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(QD(r,i)&&(r!==void 0||Gu(t.base_,e)))return!0;zu(t),Yu(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return qu(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,zu(t),Yu(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){let r=jr(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){We(11)},getPrototypeOf(t){return qn(t.base_)},setPrototypeOf(){We(12)}},ro={};os(em,(t,e)=>{ro[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});ro.deleteProperty=function(t,e){return process.env.NODE_ENV!=="production"&&isNaN(parseInt(e))&&We(13),ro.set.call(this,t,e,void 0)};ro.set=function(t,e,r){return process.env.NODE_ENV!=="production"&&e!=="length"&&isNaN(parseInt(e))&&We(14),em.set.call(this,t[0],e,r,t[0])};function qu(t,e){let r=t[Xe];return(r?jr(r):t)[e]}o(qu,"peek");function tM(t,e,r){let n=Py(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}o(tM,"readPropFromProto");function Py(t,e){if(!(e in t))return;let r=qn(t);for(;r;){let n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=qn(r)}}o(Py,"getDescriptorFromProto");function Yu(t){t.modified_||(t.modified_=!0,t.parent_&&Yu(t.parent_))}o(Yu,"markChanged");function zu(t){t.copy_||(t.copy_=Ku(t.base_,t.scope_.immer_.useStrictShallowCopy_))}o(zu,"prepareCopy");var rM=class{static{o(this,"Immer2")}constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){let a=r;r=e;let s=this;return o(function(c=a,...l){return s.produce(c,u=>r.call(this,u,...l))},"curriedProduce")}typeof r!="function"&&We(6),n!==void 0&&typeof n!="function"&&We(7);let i;if($r(e)){let a=vy(this),s=Ju(e,void 0),p=!0;try{i=r(s),p=!1}finally{p?Qu(a):Zu(a)}return Sy(a,n),by(i,a)}else if(!e||typeof e!="object"){if(i=r(e),i===void 0&&(i=e),i===wy&&(i=void 0),this.autoFreeze_&&Xu(i,!0),n){let a=[],s=[];qr("Patches").generateReplacementPatches_(e,i,a,s),n(a,s)}return i}else We(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(s,...p)=>this.produceWithPatches(s,c=>e(c,...p));let n,i;return[this.produce(e,r,(s,p)=>{n=s,i=p}),n,i]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){$r(t)||We(8),zn(t)&&(t=nM(t));let e=vy(this),r=Ju(t,void 0);return r[Xe].isManual_=!0,Zu(e),r}finishDraft(t,e){let r=t&&t[Xe];(!r||!r.isManual_)&&We(9);let{scope_:n}=r;return Sy(n,e),by(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){let i=e[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(e=e.slice(r+1));let n=qr("Patches").applyPatches_;return zn(t)?n(t,e):this.produce(t,i=>n(i,e))}};function Ju(t,e){let r=cs(t)?qr("MapSet").proxyMap_(t,e):ls(t)?qr("MapSet").proxySet_(t,e):eM(t,e);return(e?e.scope_:ky()).drafts_.push(r),r}o(Ju,"createProxy");function nM(t){return zn(t)||We(10,t),Dy(t)}o(nM,"current");function Dy(t){if(!$r(t)||us(t))return t;let e=t[Xe],r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Ku(t,e.scope_.immer_.useStrictShallowCopy_)}else r=Ku(t,!0);return os(r,(n,i)=>{_y(r,n,Dy(i))}),e&&(e.finalized_=!1),r}o(Dy,"currentImpl");var et=new rM,ms=et.produce,Z7=et.produceWithPatches.bind(et),Y7=et.setAutoFreeze.bind(et),J7=et.setUseStrictShallowCopy.bind(et),X7=et.applyPatches.bind(et),eZ=et.createDraft.bind(et),tZ=et.finishDraft.bind(et);function My(t,e,r){if(e>=t.length)throw Error(`Expected at least ${e+1} ${r} but received only ${t.length}`);return t[e]}o(My,"indexArrayStrict");function fs(t,e){if(Array.isArray(t))return t.map(r=>fs(r,e));if(typeof t=="object"&&t!=null){if(iM(t))return My(e,t.index,"placeholder value");let r={};for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=fs(t[n],e));return r}return t}o(fs,"fillPlaceholders");function iM(t){return typeof t=="object"&&t!=null&&"type"in t&&t.type==="placeholder"}o(iM,"isPlaceholder");var Ss=Ai(Fy(),1);var oM={blue:"blue",green:"green",red:"red",pink:"pink",yellow:"yellow",userColor1:"navy",userColor2:"apricot",default:null},aM={ex:"ex",fox:"fox",wing:"wing",hole:"hole",frame:"frame",curve:"curve",eye:"eye",play:"play",crosshairs:"cross",bolt:"bolt",default:null},gs={cursor:"this",that:"that",source:"source",nothing:"nothing",keyboard:null,explicit:null,decoratedSymbol:null,lineNumber:null,range:null,target:null},hs={modulo100:"row",relativeUp:"up",relativeDown:"down"};function Iy(t){let e=oM[t];if(e==null)throw Error(`Unknown hat color '${t}'`);return e}o(Iy,"hatColorToSpokenForm");function Oy(t){let e=aM[t];if(e==null)throw Error(`Unknown hat shape '${t}'`);return e}o(Oy,"hatShapeToSpokenForm");function tm(t,e){return Object.fromEntries(Object.entries(t).map(([r,n])=>[r,Object.fromEntries(Object.entries(n).map(([i,a])=>[i,e(a,r,i)]))]))}o(tm,"mapSpokenForms");var sM=Object.fromEntries("air bat cap drum each fine gust harp sit jury crunch look made near odd pit quench red sun trap urge vest whale plex yank zip".split(" ").map((t,e)=>[String.fromCharCode(97+e),t])),pM=Object.fromEntries("zero one two three four five six seven eight nine".split(" ").map((t,e)=>[e.toString(),t])),cM={".":"dot",",":"comma",";":"semicolon",":":"colon","!":"bang","*":"asterisk","@":"at sign","&":"ampersand","?":"question","/":"slash","\\":"backslash","-":"dash","=":"equals","+":"plus","~":"tilde",_:"underscore","#":"hash","%":"percent","^":"caret","|":"pipe",$:"dollar","\xA3":"pound","'":"quote",'"':"double quote","`":"back tick","(":"paren",")":"right paren","{":"brace","}":"right brace","[":"square","]":"right square","<":"angle",">":"right angle","\uFFFD":"special"},Cy={...sM,...pM,...cM};function hr(...t){return{defaultSpokenForms:t,isDisabledByDefault:!0,isPrivate:!1}}o(hr,"isDisabledByDefault");function _e(...t){return{defaultSpokenForms:t,isDisabledByDefault:!0,isPrivate:!0}}o(_e,"isPrivate");var Ny={pairedDelimiter:{curlyBrackets:"curly",angleBrackets:"diamond",escapedDoubleQuotes:"escaped quad",escapedSingleQuotes:"escaped twin",escapedParentheses:"escaped round",escapedSquareBrackets:"escaped box",doubleQuotes:"quad",parentheses:"round",backtickQuotes:"skis",squareBrackets:"box",singleQuotes:"twin",tripleDoubleQuotes:_e("triple quad"),tripleSingleQuotes:_e("triple twin"),any:"pair",string:"string",whitespace:"void",collectionBoundary:_e("collection boundary")},simpleScopeTypeType:{argumentOrParameter:"arg",attribute:"attribute",functionCall:"call",functionCallee:"callee",className:"class name",class:"class",comment:"comment",functionName:"funk name",namedFunction:"funk",ifStatement:"if state",instance:"instance",collectionItem:"item",collectionKey:"key",anonymousFunction:"lambda",list:"list",map:"map",name:"name",regularExpression:"regex",section:"section",sectionLevelOne:hr("one section"),sectionLevelTwo:hr("two section"),sectionLevelThree:hr("three section"),sectionLevelFour:hr("four section"),sectionLevelFive:hr("five section"),sectionLevelSix:hr("six section"),selector:"selector",statement:"state",branch:"branch",type:"type",value:"value",condition:"condition",unit:"unit",xmlElement:"element",xmlBothTags:"tags",xmlStartTag:"start tag",xmlEndTag:"end tag",part:"part",chapter:"chapter",subSection:"subsection",subSubSection:"subsubsection",namedParagraph:"paragraph",subParagraph:"subparagraph",environment:"environment",command:"command",character:"char",word:"sub",token:"token",identifier:"identifier",line:"line",sentence:"sentence",paragraph:"block",boundedParagraph:"short block",document:"file",nonWhitespaceSequence:"paint",boundedNonWhitespaceSequence:"short paint",url:"link",notebookCell:"cell",string:_e("parse tree string"),textFragment:_e("text fragment"),disqualifyDelimiter:_e("disqualify delimiter"),"private.fieldAccess":_e("access"),"private.switchStatementSubject":_e("subject")},complexScopeTypeType:{glyph:"glyph"},surroundingPairForceDirection:{left:"left",right:"right"},simpleModifier:{excludeInterior:"bounds",toRawSelection:"just",leading:"leading",trailing:"trailing",keepContentFilter:"content",keepEmptyFilter:"empty",inferPreviousMark:"its",startOf:"start of",endOf:"end of",interiorOnly:"inside",visible:"visible",extendThroughStartOf:"head",extendThroughEndOf:"tail",everyScope:"every"},modifierExtra:{first:"first",last:"last",previous:"previous",next:"next",forward:"forward",backward:"backward",ancestor:"grand"},customRegex:{},action:{breakLine:"break",scrollToBottom:"bottom",toggleLineBreakpoint:"break point",cutToClipboard:"carve",scrollToCenter:"center",clearAndSetSelection:"change",remove:"chuck",insertCopyBefore:"clone up",insertCopyAfter:"clone",toggleLineComment:"comment",copyToClipboard:"copy",scrollToTop:"crown",outdentLine:"dedent",revealDefinition:"define",editNewLineBefore:"drink",insertEmptyLineBefore:"drop",extractVariable:"extract",insertEmptyLineAfter:"float",foldRegion:"fold",followLink:"follow",followLinkAside:"follow split",deselect:"give",highlight:"highlight",showHover:"hover",increment:"increment",decrement:"decrement",indentLine:"indent",showDebugHover:"inspect",setSelectionAfter:"post",editNewLineAfter:"pour",setSelectionBefore:"pre",insertEmptyLinesAround:"puff",showQuickFix:"quick fix",showReferences:"reference",rename:"rename",reverseTargets:"reverse",findInDocument:"scout",findInWorkspace:"scout all",randomizeTargets:"shuffle",generateSnippet:"snippet make",sortTargets:"sort",setSelection:"take",revealTypeDefinition:"type deaf",unfoldRegion:"unfold",callAsFunction:"call",swapTargets:"swap",replaceWithTarget:"bring",moveToTarget:"move",wrapWithPairedDelimiter:"wrap",wrapWithSnippet:"wrap",rewrapWithPairedDelimiter:"repack",insertSnippet:"snippet",pasteFromClipboard:"paste",joinLines:"join","private.showParseTree":_e("parse tree"),"experimental.setInstanceReference":hr("from"),editNew:_e("edit new"),executeCommand:_e("execute command"),parsed:_e("parsed"),getText:_e("get text"),replace:_e("replace"),"private.getTargets":_e("get targets"),"private.setKeyboardTarget":_e("set keyboard target")},customAction:{},grapheme:Cy};var rm=tm(Ny,t=>typeof t=="string"?{defaultSpokenForms:[t],isDisabledByDefault:!1,isPrivate:!1}:t),yr=tm(rm,({defaultSpokenForms:t,isDisabledByDefault:e,isPrivate:r})=>({spokenForms:e?[]:t,isCustom:!1,defaultSpokenForms:t,requiresTalonUpdate:!1,isPrivate:r}));var me={rangeExclusive:"between",rangeInclusive:"past",rangeExcludingStart:null,rangeExcludingEnd:"until",listConnective:"and",swapConnective:"with",sourceDestinationConnective:"to",before:"before",after:"after",verticalRange:"slice",previous:"previous",next:"next",forward:"forward",backward:"backward"};var Hy=Ai(Uy(),1);var Ts=class{static{o(this,"CommandLexer")}constructor(e){this.mooLexer=Hy.default.compile(e)}reset(e,r){let{mooState:n}=r??{};return this.mooLexer.reset(e,n),this}formatError(e,r){return this.mooLexer.formatError(e,r)}has(e){return this.mooLexer.has(e)}save(){return{mooState:this.mooLexer.save()}}next(){let e=this.mooLexer.next();return this.skipToken(e)?this.next():e}transform({value:e}){return e}skipToken(e){return e?.type==="ws"}};var zt={};for(let t of $u){let{spokenForms:e}=yr.action[t];for(let r of e)zt[r]={type:"simpleActionName",value:t}}var lM=["replaceWithTarget","moveToTarget"];for(let t of lM){let{spokenForms:e}=yr.action[t];for(let r of e)zt[r]={type:"bringMove",value:t}}var uM=["before","after","to"];for(let t of uM){let e=me[t==="to"?"sourceDestinationConnective":t];zt[e]={type:"insertionMode",value:t}}for(let t of Br){let{spokenForms:e}=yr.simpleScopeTypeType[t];for(let r of e)zt[r]={type:"simpleScopeTypeType",value:t}}for(let t of es){let{spokenForms:e}=yr.pairedDelimiter[t];for(let r of e)zt[r]={type:"pairedDelimiter",value:t}}for(let[t,e]of Object.entries(gs))e!=null&&(zt[e]={type:"simpleMarkType",value:t});var Gt=new Ts({ws:/[ \t]+/,placeholderTarget:{match:/<target\d*>/,value:o(t=>t.slice(7,-1),"value")},token:{match:Object.keys(zt),type:o(t=>zt[t].type,"type"),value:o(t=>zt[t].value,"value")}});function Vy(t,e){return{name:t,target:e}}o(Vy,"simpleActionDescriptor");function By(t,e,r){return{name:t,source:e,destination:r}}o(By,"bringMoveActionDescriptor");function xs(t,e){let r={type:"primitive"};return t!=null&&(r.modifiers=t),e!=null&&(r.mark=e),r}o(xs,"partialPrimitiveTargetDescriptor");function Wy(t,e){return{type:"primitive",insertionMode:t,target:e}}o(Wy,"primitiveDestinationDescriptor");function jy(t){return{type:"containingScope",scopeType:t}}o(jy,"containingScopeModifier");function $y(t){return{type:t}}o($y,"simpleScopeType");function qy(t){return{type:"surroundingPair",delimiter:t}}o(qy,"surroundingPairScopeType");function zy(t){return{type:t}}o(zy,"simplePartialMark");function Gy(t){return{type:"target",target:{type:"placeholder",index:t.length===0?0:parseInt(t)-1}}}o(Gy,"createPlaceholderTarget");function nm(t){return t[0]}o(nm,"id");var mM={Lexer:Gt,ParserRules:[{name:"main",symbols:["action"],postprocess:nm},{name:"action",symbols:[Gt.has("simpleActionName")?{type:"simpleActionName"}:simpleActionName,"target"],postprocess:o(([t,e])=>Vy(t,e),"postprocess")},{name:"action",symbols:[Gt.has("bringMove")?{type:"bringMove"}:bringMove,"target","destination"],postprocess:o(([t,e,r])=>By(t,e,r),"postprocess")},{name:"destination",symbols:["primitiveDestination"],postprocess:nm},{name:"destination",symbols:[Gt.has("insertionMode")?{type:"insertionMode"}:insertionMode,"target"],postprocess:o(([t,e])=>Wy(t,e),"postprocess")},{name:"target",symbols:["primitiveTarget"],postprocess:nm},{name:"primitiveTarget$ebnf$1",symbols:["modifier"]},{name:"primitiveTarget$ebnf$1",symbols:["primitiveTarget$ebnf$1","modifier"],postprocess:o(t=>t[0].concat([t[1]]),"postprocess")},{name:"primitiveTarget",symbols:["primitiveTarget$ebnf$1"],postprocess:o(([t])=>xs(t,void 0),"postprocess")},{name:"primitiveTarget",symbols:["mark"],postprocess:o(([t])=>xs(void 0,t),"postprocess")},{name:"primitiveTarget$ebnf$2",symbols:["modifier"]},{name:"primitiveTarget$ebnf$2",symbols:["primitiveTarget$ebnf$2","modifier"],postprocess:o(t=>t[0].concat([t[1]]),"postprocess")},{name:"primitiveTarget",symbols:["primitiveTarget$ebnf$2","mark"],postprocess:o(([t,e])=>xs(t,e),"postprocess")},{name:"modifier",symbols:["containingScopeModifier"],postprocess:o(([t])=>t,"postprocess")},{name:"containingScopeModifier",symbols:["scopeType"],postprocess:o(([t])=>jy(t),"postprocess")},{name:"scopeType",symbols:[Gt.has("simpleScopeTypeType")?{type:"simpleScopeTypeType"}:simpleScopeTypeType],postprocess:o(([t])=>$y(t),"postprocess")},{name:"scopeType",symbols:[Gt.has("pairedDelimiter")?{type:"pairedDelimiter"}:pairedDelimiter],postprocess:o(([t])=>qy(t),"postprocess")},{name:"mark",symbols:[Gt.has("simpleMarkType")?{type:"simpleMarkType"}:simpleMarkType],postprocess:o(([t])=>zy(t),"postprocess")},{name:"mark",symbols:[Gt.has("placeholderTarget")?{type:"placeholderTarget"}:placeholderTarget],postprocess:o(([t])=>Gy(t),"postprocess")}],ParserStart:"main"},Ky=mM;function fM(){return new Ss.Parser(Ss.Grammar.fromCompiled(Ky))}o(fM,"getActionParser");function Qy(t){let e=fM();if(e.feed(t),e.results.length!==1)throw new Error(`Expected exactly one result, got ${e.results.length}`);return e.results[0]}o(Qy,"parseAction");function vs(t,e){let r=Qy(t);return fs(r,e)}o(vs,"parseAndFillOutAction");function bs(t){switch(t.name){case"callAsFunction":return[t.callee,t.argument];case"replaceWithTarget":case"moveToTarget":return[t.source,...Zy(t.destination)];case"swapTargets":return[t.target1,t.target2];case"pasteFromClipboard":case"insertSnippet":case"replace":case"editNew":return Zy(t.destination);case"parsed":return bs(vs(t.content,t.arguments));default:return[t.target]}}o(bs,"getPartialTargetDescriptors");function Zy(t){switch(t.type){case"list":return t.destinations.map(({target:e})=>e);case"primitive":return[t.target];case"implicit":return[]}}o(Zy,"getPartialTargetDescriptorsFromDestination");function om(t){return t.flatMap(im)}o(om,"getPartialPrimitiveTargets");function im(t){switch(t.type){case"primitive":return[t];case"list":return t.elements.flatMap(im);case"range":return[t.anchor,t.active].flatMap(im);case"implicit":return[]}}o(im,"getPartialPrimitiveTargetsHelper");var dM={arrowFunction:"anonymousFunction",dictionary:"map",regex:"regularExpression"},gM={purple:"pink"};function hM(t){t.modifiers?.forEach(e=>{(e.type==="containingScope"||e.type==="everyScope")&&(e.scopeType.type=dM[e.scopeType.type]??e.scopeType.type)})}o(hM,"canonicalizeScopeTypesInPlace");function yM(t){t.mark?.type==="decoratedSymbol"&&(t.mark.symbolColor=gM[t.mark.symbolColor]??t.mark.symbolColor)}o(yM,"canonicalizeColorsInPlace");function am(t){om(t).forEach(e=>{hM(e),yM(e)})}o(am,"canonicalizeTargetsInPlace");function Yy(t){return{...t,version:1}}o(Yy,"upgradeV0ToV1");var TM={type:"primitive",mark:{type:"cursor"},selectionType:"token",position:"contents",modifier:{type:"identity"},insideOutsideType:"inside"},xM={type:"primitive",isImplicit:!0},Jy=o(t=>jt(t,TM)?xM:t,"upgradeStrictHere");function Xy(t){let e=t.action;return{spokenForm:t.spokenForm,action:{name:e,args:t.extraArgs},targets:vM(t.targets,e),usePrePhraseSnapshot:t.usePrePhraseSnapshot??!1,version:2}}o(Xy,"upgradeV1ToV2");function SM(t){switch(t.type){case"identity":return[];case"containingScope":{let{includeSiblings:e,scopeType:r,type:n,...i}=t;return[{type:e?"everyScope":"containingScope",scopeType:{type:r},...i}]}case"surroundingPair":{let{delimiterInclusion:e,...r}=t,n={type:"containingScope",scopeType:r};return e==="interiorOnly"||e==="excludeInterior"?n.scopeType.delimiter==="any"?[{type:e}]:[{type:e},n]:[n]}case"subpiece":{let{type:e,pieceType:r,...n}=t;return[{type:"ordinalRange",scopeType:{type:r},...n}]}case"head":return[{type:"extendThroughStartOf"}];case"tail":return[{type:"extendThroughEndOf"}];default:return[t]}}o(SM,"upgradeModifier");function sm(t,e){let{type:r,isImplicit:n,mark:i,insideOutsideType:a,modifier:s,selectionType:p,position:c}=t,l=[];if(c&&c!=="contents"&&(c==="before"?a==="inside"?l.push({type:"position",position:"start"}):e==="remove"?l.push({type:"leading"}):l.push({type:"position",position:"before"}):a==="inside"?l.push({type:"position",position:"end"}):e==="remove"?l.push({type:"trailing"}):l.push({type:"position",position:"after"})),p)switch(p){case"token":if(s?.type==="subpiece")break;case"line":if(i?.type==="lineNumber")break;default:l.push({type:"containingScope",scopeType:{type:p}})}return s&&l.push(...SM(s)),{type:r,isImplicit:n,modifiers:l.length>0?l:void 0,mark:i?.type==="cursorToken"?void 0:i}}o(sm,"upgradePrimitiveTarget");function eT(t,e){switch(t.type){case"list":return{...t,elements:t.elements.map(r=>eT(r,e))};case"range":{let{type:r,rangeType:n,start:i,end:a,excludeStart:s,excludeEnd:p}=t;return{type:r,rangeType:n,anchor:sm(i,e),active:sm(a,e),excludeAnchor:s??!1,excludeActive:p??!1}}case"primitive":return sm(t,e)}}o(eT,"upgradeTarget");function vM(t,e){return t.map(r=>eT(r,e)).map(r=>r.type==="primitive"?Jy(r):r)}o(vM,"upgradeTargets");function tT(t){return{...t,version:3,targets:t.targets.map(rT)}}o(tT,"upgradeV2ToV3");function rT(t){switch(t.type){case"list":return{...t,elements:t.elements.map(e=>rT(e))};case"range":{let{anchor:e,active:r,...n}=t;return{anchor:pm(e),active:pm(r),...n}}case"primitive":return pm(t)}}o(rT,"upgradeTarget");function pm(t){let e=t.modifiers!=null?t.modifiers.map(RM):void 0;if(t.mark?.type==="lineNumber"){let{anchor:r,active:n}=t.mark;if(r.type!==n.type||r.lineNumber<0!=n.lineNumber<0)return{type:"range",anchor:{type:"primitive",mark:io(r),modifiers:e},active:{type:"primitive",mark:io(n)},excludeAnchor:!1,excludeActive:!1}}return{...t,mark:t.mark!=null?bM(t.mark):void 0,modifiers:e}}o(pm,"upgradePrimitiveTarget");function bM(t){switch(t.type){case"lineNumber":return wM(t);default:return t}}o(bM,"updateMark");function RM(t){switch(t.type){case"ordinalRange":return EM(t);default:return t}}o(RM,"updateModifier");function wM(t){return jt(t.anchor,t.active)?io(t.anchor):{type:"range",anchor:io(t.anchor),active:io(t.active)}}o(wM,"createLineNumberMark");function EM(t){return t.anchor===t.active?no(t.scopeType,t.anchor):t.anchor===0&&t.active>t.anchor?no(t.scopeType,t.anchor,t.active-t.anchor+1):t.anchor<0&&t.active===-1?no(t.scopeType,t.anchor,-t.anchor):{type:"range",anchor:no(t.scopeType,t.anchor),active:no(t.scopeType,t.active),excludeAnchor:t.excludeAnchor,excludeActive:t.excludeActive}}o(EM,"createOrdinalModifier");function io(t){return{type:"lineNumber",lineNumberType:t.type,lineNumber:t.lineNumber}}o(io,"createLineNumberMarkFromPos");function no(t,e,r=1){return{type:"ordinalScope",scopeType:t,start:e,length:r}}o(no,"createAbsoluteOrdinalModifier");function iT(t){return{...t,version:4,targets:t.targets.map(oT)}}o(iT,"upgradeV3ToV4");function oT(t){switch(t.type){case"primitive":return nT(t);case"range":{let{anchor:e,...r}=t;return{...r,anchor:nT(e)}}case"list":{let{elements:e,...r}=t;return{...r,elements:e.map(oT)}}}}o(oT,"upgradeTarget");function nT(t){return t.mark==null&&t.modifiers==null||t.isImplicit?{type:"implicit"}:t}o(nT,"upgradePrimitiveTarget");function aT(t){return{...t,version:5,action:_M(t.action),targets:t.targets.map(Rs)}}o(aT,"upgradeV4ToV5");function _M(t){switch(t.name){case"wrapWithSnippet":{let[e,r]=kM(t.args[0]);return{name:"wrapWithSnippet",args:[{type:"named",name:e,variableName:r}]}}case"insertSnippet":{let[e,r]=t.args,n={type:"named",name:e};return r!=null&&(n.substitutions=r),{name:"insertSnippet",args:[n]}}default:return t}}o(_M,"upgradeAction");function kM(t){let[e,r]=t.split(".");if(e==null||r==null)throw new Error("Snippet location missing '.'");return[e,r]}o(kM,"parseSnippetLocation");function Rs(t){switch(t.type){case"implicit":return t;case"list":return{...t,elements:t.elements.map(Rs)};case"range":return{...t,anchor:Rs(t.anchor),active:Rs(t.active)};case"primitive":return{...t,mark:t.mark!=null?cm(t.mark):void 0,modifiers:t.modifiers!=null&&t.modifiers.length>0?t.modifiers.map(lm):void 0}}}o(Rs,"upgradeTarget");function cm(t){return t.type==="range"?{...t,anchor:cm(t.anchor),active:cm(t.active),excludeAnchor:t.excludeAnchor??!1,excludeActive:t.excludeActive??!1}:t}o(cm,"upgradeMark");function lm(t){return t.type==="range"?{...t,anchor:lm(t.anchor),active:lm(t.active),excludeAnchor:t.excludeAnchor??!1,excludeActive:t.excludeActive??!1}:t}o(lm,"upgradeModifier");var PM={bring:"replaceWithTarget",call:"callAsFunction",clear:"clearAndSetSelection",commentLines:"toggleLineComment",copy:"copyToClipboard",cut:"cutToClipboard",delete:"remove",editNewLineAbove:"editNewLineBefore",editNewLineBelow:"editNewLineAfter",findInFiles:"findInWorkspace",fold:"foldRegion",indentLines:"indentLine",insertEmptyLineAbove:"insertEmptyLineBefore",insertEmptyLineBelow:"insertEmptyLineAfter",insertLineAfter:"editNewLineAfter",insertLineBefore:"editNewLineBefore",move:"moveToTarget",outdentLines:"outdentLine",paste:"pasteFromClipboard",reverse:"reverseTargets",setBreakpoint:"toggleLineBreakpoint",sort:"sortTargets",swap:"swapTargets",unfold:"unfoldRegion",use:"replaceWithTarget",wrap:"wrapWithPairedDelimiter"};function um(t){let e=PM[t]??t;if(!cy.includes(e))throw new Error(`Unknown action name: ${e}`);return e}o(um,"canonicalizeActionName");function sT(t){return{version:6,spokenForm:t.spokenForm,usePrePhraseSnapshot:t.usePrePhraseSnapshot,action:DM(t.action,t.targets)}}o(sT,"upgradeV5ToV6");function DM(t,e){let r=um(t.name);switch(r){case"replaceWithTarget":case"moveToTarget":return{name:r,source:ct(e[0]),destination:oo(e[1])};case"swapTargets":return{name:r,target1:ct(e[0]),target2:ct(e[1])};case"callAsFunction":return{name:r,callee:ct(e[0]),argument:ct(e[1])};case"pasteFromClipboard":return{name:r,destination:oo(e[0])};case"wrapWithPairedDelimiter":case"rewrapWithPairedDelimiter":return{name:r,left:t.args[0],right:t.args[1],target:ct(e[0])};case"generateSnippet":return{name:r,snippetName:t.args?.[0],target:ct(e[0])};case"insertSnippet":return{name:r,snippetDescription:t.args[0],destination:oo(e[0])};case"wrapWithSnippet":return{name:r,snippetDescription:t.args[0],target:ct(e[0])};case"executeCommand":return{name:r,commandId:t.args[0],options:t.args?.[1],target:ct(e[0])};case"replace":return{name:r,replaceWith:t.args[0],destination:oo(e[0])};case"highlight":{let n={name:r,target:ct(e[0])};return t.args?.[0]!=null&&(n.highlightId=t.args?.[0]),n}case"editNew":return{name:r,destination:oo(e[0])};case"getText":return{name:r,options:t.args?.[0],target:ct(e[0])};case"parsed":throw Error("Parsed action should not be present in V5");default:return{name:r,target:ct(e[0])}}}o(DM,"upgradeAction");function ct(t){switch(t.type){case"list":case"range":case"primitive":return MM(t);case"implicit":return t}}o(ct,"upgradeTarget");function MM(t){switch(t.type){case"list":return AM(t);case"range":case"primitive":return ws(t)}}o(MM,"upgradeNonImplicitTarget");function AM(t){return{...t,elements:t.elements.map(ws)}}o(AM,"upgradeListTarget");function ws(t){switch(t.type){case"range":return pT(t);case"primitive":return Es(t)}}o(ws,"upgradeRangeOrPrimitiveTarget");function pT(t){let{anchor:e,active:r}=t,n={type:"range",anchor:e.type==="implicit"?e:Es(e),active:Es(r),excludeAnchor:t.excludeAnchor,excludeActive:t.excludeActive};return t.rangeType!=null&&(n.rangeType=t.rangeType),n}o(pT,"upgradeRangeTarget");function Es(t){let e={type:"primitive"},r=LM(t.modifiers);return r!=null&&(e.modifiers=r),t.mark!=null&&(e.mark=t.mark),e}o(Es,"upgradePrimitiveTarget");function oo(t){switch(t.type){case"list":return FM(t);case"range":return IM(t);case"primitive":return OM(t);case"implicit":return CM()}}o(oo,"targetToDestination");function FM(t){let e=[],r=[],n,i=o(()=>{r.length>0&&e.push({type:"primitive",insertionMode:n??"to",target:r.length===1?r[0]:{type:"list",elements:r}})},"potentiallyAddDestination");return t.elements.forEach(a=>{let s=_s(a);s!=null?(i(),r=[ws(a)],n=s):r.push(ws(a))}),i(),e.length>1?{type:"list",destinations:e}:e[0]}o(FM,"listTargetToDestination");function IM(t){return{type:"primitive",insertionMode:_s(t.anchor)??"to",target:pT(t)}}o(IM,"rangeTargetToDestination");function OM(t){return{type:"primitive",insertionMode:_s(t)??"to",target:Es(t)}}o(OM,"primitiveTargetToDestination");function CM(){return{type:"implicit"}}o(CM,"implicitTargetToDestination");function _s(t){switch(t.type){case"implicit":return"to";case"primitive":return NM(t);case"range":return _s(t.anchor)}}o(_s,"getInsertionMode");function NM(t){let e=t.modifiers?.find(r=>r.type==="position");if(e!=null){if(t.modifiers.indexOf(e)!==0)throw Error("Position modifier has to be at first index");if(e?.position==="before"||e?.position==="after")return e.position}}o(NM,"getInsertionModeFromPrimitive");function LM(t){let e=[];if(t!=null)for(let r of t)r.type==="position"?r.position==="start"?e.push({type:"startOf"}):r.position==="end"&&e.push({type:"endOf"}):e.push(r);return e.length>0?e:void 0}o(LM,"upgradeModifiers");function cT(t){return{...t,version:7}}o(cT,"upgradeV6ToV7");function fm(t){let e=UM(t,7),{action:r,usePrePhraseSnapshot:n=!1,spokenForm:i}=e;return{version:7,spokenForm:i,action:ms(r,a=>{let s=bs(a);am(s),r.name}),usePrePhraseSnapshot:n}}o(fm,"canonicalizeAndValidateCommand");function UM(t,e){if(t.version>7)throw new na;for(;t.version<e;)switch(t.version){case 0:t=Yy(t);break;case 1:t=Xy(t);break;case 2:t=tT(t);break;case 3:t=iT(t);break;case 4:t=aT(t);break;case 5:t=sT(t);break;case 6:t=cT(t);break;default:throw new Error(`Can't upgrade from unknown version ${t.version}`)}return t}o(UM,"upgradeCommand");var dm;function gm(t){dm=t}o(gm,"injectIde");function g(){if(dm==null)throw Error("Tried to access ide before it was injected");return dm}o(g,"ide");var ks=class{constructor(e){this.maxLength=e;this.stack=[];this.index=void 0}static{o(this,"UndoStack")}push(e){this.index!=null?this.stack.splice(this.index+1,this.stack.length-this.index-1,e):this.stack.push(e),this.stack.length>this.maxLength&&this.stack.shift(),this.index=this.stack.length-1}undo(){if(this.index!=null&&this.index>0)return this.index--,this.stack[this.index]}redo(){if(this.index!=null&&this.index<this.stack.length-1)return this.index++,this.stack[this.index]}};var HM=25,Ps=class{constructor(){this.targetMap=new Map;this.targetHistory=new dr(()=>new ks(HM));this.notifier=new He}static{o(this,"StoredTargetMap")}set(e,r,{history:n=!1}={}){this.targetMap.set(e,r),n&&r!=null&&this.targetHistory.get(e).push(r),this.notifier.notifyListeners(e,r)}get(e){return this.targetMap.get(e)}undo(e){let r=this.targetHistory.get(e).undo();r!=null&&this.set(e,r,{history:!1})}redo(e){let r=this.targetHistory.get(e).redo();r!=null&&this.set(e,r,{history:!1})}onStoredTargets(e){for(let r of Pu)e(r,this.get(r));return this.notifier.registerListener(e)}};function Tr(t,e){return new b(new B(e.start.line,0),t.document.lineAt(e.end).range.end)}o(Tr,"expandToFullLine");function hm(t,e){return e.isEmpty?0:t.document.offsetAt(e.end)-t.document.offsetAt(e.start)}o(hm,"getRangeLength");function lT(t,e){let[r,n]=e instanceof B?[e,e]:[e.start,e.end];return t.start.isBefore(r)&&t.end.isAfter(n)}o(lT,"strictlyContains");function zr(t,...e){for(let r of e)r!=null&&(t=t.union(r));return t}o(zr,"union");var Ds=class t{constructor(e,r,n){this.target=e;this.insertionMode=r;this.contentRange=BM(e.contentRange,r),this.isBefore=r==="before",this.isLineDelimiter=e.insertionDelimiter.includes(`
`),this.indentationString=n??this.isLineDelimiter?VM(e.editor,e.contentRange):"",this.insertionPrefix=e.prefixRange!=null?e.editor.document.getText(e.prefixRange):void 0}static{o(this,"DestinationImpl")}get contentSelection(){return this.contentRange.toSelection(this.target.isReversed)}get editor(){return this.target.editor}get insertionDelimiter(){return this.target.insertionDelimiter}get isRaw(){return this.target.isRaw}withTarget(e){return new t(e,this.insertionMode,this.indentationString)}getEditNewActionType(){return this.insertionMode==="after"&&this.target.contentRange.isSingleLine&&this.insertionDelimiter===`
`&&this.insertionPrefix==null?"insertLineAfter":"edit"}constructChangeEdit(e,r=!1){return this.insertionMode==="before"||this.insertionMode==="after"?this.constructEditWithDelimiters(e,r):this.constructEditWithoutDelimiters(e)}constructEditWithDelimiters(e,r){let n=this.getEditRange(),i=this.getEditText(e,r),a=o(s=>this.updateRange(s,e,r),"updateRange");return{range:n,text:i,isReplace:this.insertionMode==="after",updateRange:a}}constructEditWithoutDelimiters(e){return{range:this.contentRange,text:e,updateRange:o(r=>r,"updateRange")}}getEditRange(){let e=(()=>{let r=this.isBefore?zr(this.target.contentRange,this.target.prefixRange).start:this.target.contentRange.end;if(this.isLineDelimiter){let n=this.editor.document.lineAt(r),i=this.isBefore?n.rangeTrimmed?.start??n.range.start:n.rangeTrimmed?.end??n.range.end;if(r.isEqual(i))return this.isBefore?n.range.start:n.range.end}return r})();return new b(e,e)}getEditText(e,r){let i=(r?"":this.indentationString)+(this.insertionPrefix??"")+e;return this.isBefore?i+this.insertionDelimiter:this.insertionDelimiter+i}updateRange(e,r,n){let i=this.editor.document.offsetAt(e.start)+(n?0:this.indentationString.length)+(this.insertionPrefix?.length??0),a=this.isBefore?i:i+this.getLengthOfInsertionDelimiter(),s=a+r.length;return new b(this.editor.document.positionAt(a),this.editor.document.positionAt(s))}getLengthOfInsertionDelimiter(){if(this.editor.document.eol==="CRLF"){let e=this.insertionDelimiter.match(/\n/g);if(e!=null)return this.insertionDelimiter.length+e.length}return this.insertionDelimiter.length}};function VM(t,e){let r=Number.MAX_SAFE_INTEGER,n="";for(let i=e.start.line;i<=e.end.line;++i){let a=t.document.lineAt(i);if(a.range.isEmpty||a.isEmptyOrWhitespace&&!e.isSingleLine)continue;let s=a.rangeTrimmed?.start??a.range.end;s.character<r&&(r=s.character,n=a.text.slice(0,r))}return n}o(VM,"getIndentationString");function BM(t,e){switch(e){case"before":return t.start.toEmptyRange();case"after":return t.end.toEmptyRange();case"to":return t}}o(BM,"getContentRange");function xr(t,e,r,n){return ao(t.contentRange,e.contentRange,r,n)}o(xr,"createContinuousRange");function ao(t,e,r,n){return new b(r?t.start:t.end,n?e.end:e.start)}o(ao,"createContinuousRangeFromRanges");function Gn(t,e,r,n){let i=r?t.contentRange.start:new B(t.contentRange.end.line+1,0),a=n?e.contentRange.end:e.editor.document.lineAt(e.contentRange.start.line-1).range.end;return new b(i,a)}o(Gn,"createContinuousLineRange");var J=class t{constructor(e){this.isLine=!1;this.isToken=!0;this.hasExplicitScopeType=!0;this.hasExplicitRange=!0;this.isRaw=!1;this.isImplicit=!1;this.isNotebookCell=!1;this.isWord=!1;this.joinAs="line";this.state={editor:e.editor,isReversed:e.isReversed,contentRange:e.contentRange,thatTarget:e.thatTarget}}static{o(this,"BaseTarget")}get editor(){return this.state.editor}get isReversed(){return this.state.isReversed}get thatTarget(){return this.state.thatTarget!=null?this.state.thatTarget.thatTarget:this}get contentText(){return this.editor.document.getText(this.contentRange)}get contentSelection(){return this.contentRange.toSelection(this.isReversed)}get contentRange(){return this.state.contentRange}constructRemovalEdit(){return{range:this.getRemovalRange(),text:"",updateRange:o(e=>e,"updateRange")}}getRemovalHighlightRange(){return this.getRemovalRange()}withThatTarget(e){return this.cloneWith({thatTarget:e})}withContentRange(e){return this.cloneWith({contentRange:e})}getInterior(){}getBoundary(){}cloneWith(e){let r=Object.getPrototypeOf(this).constructor;return new r({...this.getCloneParameters(),...e})}maybeCreateRichRangeTarget(e,r){let{constructor:n}=Object.getPrototypeOf(this);return new n({...this.getCloneParameters(),isReversed:e,contentRange:xr(this,r,!0,!0)})}isEqual(e){return e instanceof t&&jt(this.getEqualityParameters(),e.getEqualityParameters())}getEqualityParameters(){let{thatTarget:e,...r}=this.getCloneParameters();return{...r}}toDestination(e){return new Ds(this,e)}toPlainObject(){return{type:this.type,contentRange:Sh(this.contentRange),isReversed:this.isReversed,hasExplicitRange:this.hasExplicitRange}}};function Ms(t,e){return WM(t,e.start,e.end)}o(Ms,"selectionWithEditorFromRange");function WM(t,e,r){return{editor:t.editor,selection:jM(t.selection,e,r)}}o(WM,"selectionWithEditorFromPositions");function jM(t,e,r){return t.isReversed?new q(r,e):new q(e,r)}o(jM,"selectionFromPositions");function As(t,e){let{document:r}=t,n=r.getText(e),i=n.length-n.trimStart().length,a=n.length-n.trimEnd().length,s=r.offsetAt(e.start)+i,p=r.offsetAt(e.end)-a,c=r.positionAt(s),l=r.positionAt(p);return new b(c,l)}o(As,"shrinkRangeToFitContent");function Fs(t,e,r,n){return r==null?void 0:new t({editor:e,isReversed:n,contentRange:r})}o(Fs,"tryConstructTarget");var ee=class extends J{constructor(r){super(r);this.type="PlainTarget";this.getLeadingDelimiterTarget=o(()=>{},"getLeadingDelimiterTarget");this.getTrailingDelimiterTarget=o(()=>{},"getTrailingDelimiterTarget");this.getRemovalRange=o(()=>this.contentRange,"getRemovalRange");this.isToken=r.isToken??!0,this.insertionDelimiter=r.insertionDelimiter??""}static{o(this,"PlainTarget")}getCloneParameters(){return{...this.state,isToken:this.isToken,insertionDelimiter:this.insertionDelimiter}}};function Kn(t,e,r){return Fs(ee,t,e,r)}o(Kn,"tryConstructPlainTarget");var Is=class extends J{constructor(r){super(r);this.type="DocumentTarget";this.insertionDelimiter=`
`;this.isLine=!0}static{o(this,"DocumentTarget")}getLeadingDelimiterTarget(){}getTrailingDelimiterTarget(){}getRemovalRange(){return this.contentRange}getInterior(){return[new ee({editor:this.editor,isReversed:this.isReversed,contentRange:As(this.editor,this.contentRange)})]}getCloneParameters(){return this.state}};var tt=class t extends J{constructor(){super(...arguments);this.type="LineTarget";this.insertionDelimiter=`
`;this.isLine=!0;this.getRemovalHighlightRange=o(()=>this.fullLineContentRange,"getRemovalHighlightRange")}static{o(this,"LineTarget")}get fullLineContentRange(){return Tr(this.editor,this.contentRange)}getLeadingDelimiterTarget(){return Kn(this.editor,$M(this.editor,this.fullLineContentRange),this.isReversed)}getTrailingDelimiterTarget(){return Kn(this.editor,qM(this.editor,this.fullLineContentRange),this.isReversed)}getRemovalRange(){let r=this.fullLineContentRange,n=this.getTrailingDelimiterTarget()??this.getLeadingDelimiterTarget();return n==null?r:r.union(n.contentRange)}maybeCreateRichRangeTarget(r,n){return new t({editor:this.editor,isReversed:r,contentRange:Gn(this,n,!0,!0)})}getCloneParameters(){return this.state}};function $M(t,e){let{start:r}=e;return r.line>0?new b(t.document.lineAt(r.line-1).range.end,e.start):void 0}o($M,"getLeadingDelimiterRange");function qM(t,e){let{end:r}=e;return r.line+1<t.document.lineCount?new b(e.end,new B(r.line+1,0)):void 0}o(qM,"getTrailingDelimiterRange");function ym(t,e,r){return Fs(tt,t,e,r)}o(ym,"constructLineTarget");var Os=class t{constructor(e,r){this.target=e;this.insertionMode=r}static{o(this,"NotebookCellDestination")}get editor(){return this.target.editor}get contentRange(){return this.target.contentRange}get contentSelection(){return this.target.contentSelection}get insertionDelimiter(){return this.target.insertionDelimiter}get isRaw(){return this.target.isRaw}withTarget(e){return new t(e,this.insertionMode)}getEditNewActionType(){throw new Error("Method not implemented.")}constructChangeEdit(e){throw new Error("Method not implemented.")}};var Cs=class extends J{constructor(r){super(r);this.type="NotebookCellTarget";this.insertionDelimiter=`
`;this.isNotebookCell=!0;this.getLeadingDelimiterTarget=o(()=>{},"getLeadingDelimiterTarget");this.getTrailingDelimiterTarget=o(()=>{},"getTrailingDelimiterTarget");this.getRemovalRange=o(()=>this.contentRange,"getRemovalRange")}static{o(this,"NotebookCellTarget")}getCloneParameters(){return this.state}toDestination(r){return new Os(this,r)}};var Qn=class t extends J{constructor(){super(...arguments);this.type="ParagraphTarget";this.insertionDelimiter=`

`;this.isLine=!0}static{o(this,"ParagraphTarget")}getLeadingDelimiterTarget(){return ym(this.editor,zM(this.editor,this.fullLineContentRange),this.isReversed)}getTrailingDelimiterTarget(){return ym(this.editor,GM(this.editor,this.fullLineContentRange),this.isReversed)}getRemovalRange(){let r=this.getTrailingDelimiterTarget()??this.getLeadingDelimiterTarget(),n=r!=null?this.contentRange.union(r.contentRange):this.contentRange;return new tt({contentRange:n,editor:this.editor,isReversed:this.isReversed}).getRemovalRange()}get fullLineContentRange(){return Tr(this.editor,this.contentRange)}getRemovalHighlightRange(){let r=this.getTrailingDelimiterTarget()??this.getLeadingDelimiterTarget();return r!=null?this.fullLineContentRange.union(r.contentRange):this.fullLineContentRange}maybeCreateRichRangeTarget(r,n){return new t({...this.getCloneParameters(),isReversed:r,contentRange:Gn(this,n,!0,!0)})}getCloneParameters(){return this.state}};function zM(t,e){let{document:r}=t,n=r.lineAt(e.start),i=KM(r,n);if(i!=null)return i.lineNumber+1===n.lineNumber?void 0:new b(new B(i.lineNumber+1,0),r.lineAt(n.lineNumber-1).range.end);if(n.lineNumber>0)return new b(new B(0,0),r.lineAt(n.lineNumber-1).range.end)}o(zM,"getLeadingDelimiterRange");function GM(t,e){let{document:r}=t,n=r.lineAt(e.end),i=QM(r,n);if(i!=null)return i.lineNumber-1===n.lineNumber?void 0:new b(new B(n.lineNumber+1,0),r.lineAt(i.lineNumber-1).range.end);if(n.lineNumber<r.lineCount-1)return new b(new B(n.lineNumber+1,0),r.lineAt(r.lineCount-1).range.end)}o(GM,"getTrailingDelimiterRange");function KM(t,e){for(;e.lineNumber>0;){let r=t.lineAt(e.lineNumber-1);if(!r.isEmptyOrWhitespace)return r;e=r}return null}o(KM,"getPreviousNonEmptyLine");function QM(t,e){for(;e.lineNumber+1<t.lineCount;){let r=t.lineAt(e.lineNumber+1);if(!r.isEmptyOrWhitespace)return r;e=r}return null}o(QM,"getNextNonEmptyLine");var Sr=class extends J{constructor(){super(...arguments);this.type="RawSelectionTarget";this.insertionDelimiter="";this.isRaw=!0;this.isToken=!1;this.getLeadingDelimiterTarget=o(()=>{},"getLeadingDelimiterTarget");this.getTrailingDelimiterTarget=o(()=>{},"getTrailingDelimiterTarget");this.getRemovalRange=o(()=>this.contentRange,"getRemovalRange");this.getCloneParameters=o(()=>this.state,"getCloneParameters")}static{o(this,"RawSelectionTarget")}};var Zn=class t extends J{constructor(r){super({...r,contentRange:As(r.editor,r.fullInteriorRange)});this.type="InteriorTarget";this.insertionDelimiter=" ";this.getLeadingDelimiterTarget=o(()=>{},"getLeadingDelimiterTarget");this.getTrailingDelimiterTarget=o(()=>{},"getTrailingDelimiterTarget");this.getRemovalRange=o(()=>this.fullInteriorRange,"getRemovalRange");this.fullInteriorRange=r.fullInteriorRange}static{o(this,"InteriorTarget")}getCloneParameters(){return{...this.state,fullInteriorRange:this.fullInteriorRange}}maybeCreateRichRangeTarget(r,n){return new t({...this.getCloneParameters(),isReversed:r,fullInteriorRange:ao(this.fullInteriorRange,n.fullInteriorRange,!0,!0)})}};function Ns(t){let e=zr(t.contentRange,t.prefixRange),r=t.getTrailingDelimiterTarget()??t.getLeadingDelimiterTarget();return r!=null?e.union(r.contentRange):e}o(Ns,"getDelimitedSequenceRemovalRange");var ZM=['"',"'","(","[","{","<"],YM=['"',"'",")","]","}",">",",",";",":"];function Mt(t){let{editor:e}=t,{start:r}=zr(t.contentRange,t.prefixRange),a=e.document.lineAt(r).text.slice(0,r.character).match(/\s+$/);return a==null?void 0:new ee({contentRange:new b(r.line,r.character-a[0].length,r.line,r.character),editor:e,isReversed:t.isReversed})}o(Mt,"getTokenLeadingDelimiterTarget");function At(t){let{editor:e}=t,{end:r}=t.contentRange,a=e.document.lineAt(r).text.slice(r.character).match(/^\s+/);return a==null?void 0:new ee({contentRange:new b(r.line,r.character,r.line,r.character+a[0].length),editor:e,isReversed:t.isReversed})}o(At,"getTokenTrailingDelimiterTarget");function Ft(t){let{editor:e}=t,r=zr(t.contentRange,t.prefixRange),{start:n,end:i}=r,a=t.getLeadingDelimiterTarget()?.contentRange??n.toEmptyRange(),s=t.getTrailingDelimiterTarget()?.contentRange??i.toEmptyRange(),p=Tr(e,r);return a.union(s).isRangeEqual(p)?p:!s.isEmpty&&(!a.isEmpty||r.start.isEqual(p.start)||ZM.includes(JM(e,r)))?r.union(s):!a.isEmpty&&(r.end.isEqual(p.end)||YM.includes(XM(e,r)))?r.union(a):r}o(Ft,"getTokenRemovalRange");function JM(t,e){let{start:r}=e,n=t.document.lineAt(r);return r.isAfter(n.range.start)?t.document.getText(new b(r.translate(void 0,-1),r)):""}o(JM,"getLeadingCharacter");function XM(t,e){let{end:r}=e,n=t.document.lineAt(r);return r.isBefore(n.range.end)?t.document.getText(new b(r.translate(void 0,1),r)):""}o(XM,"getTrailingCharacter");var vr=class t extends J{constructor(r){super(r);this.type="ScopeTypeTarget";this.scopeTypeType_=r.scopeTypeType,this.removalRange_=r.removalRange,this.interiorRange_=r.interiorRange,this.leadingDelimiterRange_=r.leadingDelimiterRange,this.trailingDelimiterRange_=r.trailingDelimiterRange,this.prefixRange=r.prefixRange,this.insertionDelimiter=r.insertionDelimiter??eA(r.scopeTypeType),this.hasDelimiterRange_=!!this.leadingDelimiterRange_||!!this.trailingDelimiterRange_}static{o(this,"ScopeTypeTarget")}getLeadingDelimiterTarget(){if(this.leadingDelimiterRange_!=null)return new ee({editor:this.editor,isReversed:this.isReversed,contentRange:this.leadingDelimiterRange_});if(!this.hasDelimiterRange_)return Mt(this)}getTrailingDelimiterTarget(){if(this.trailingDelimiterRange_!=null)return new ee({editor:this.editor,isReversed:this.isReversed,contentRange:this.trailingDelimiterRange_});if(!this.hasDelimiterRange_)return At(this)}getInterior(){return this.interiorRange_==null?super.getInterior():[new Zn({editor:this.editor,isReversed:this.isReversed,fullInteriorRange:this.interiorRange_})]}getRemovalRange(){return this.removalRange_!=null?this.removalRange_:this.hasDelimiterRange_?Ns(this):Ft(this)}maybeCreateRichRangeTarget(r,n){if(this.scopeTypeType_!==n.scopeTypeType_)return null;let i=this.removalRange_!=null||n.removalRange_!=null?ao(this.removalRange_??this.contentRange,n.removalRange_??n.contentRange,!0,!0):void 0;return new t({...this.getCloneParameters(),isReversed:r,leadingDelimiterRange:this.leadingDelimiterRange_,trailingDelimiterRange:n.trailingDelimiterRange_,removalRange:i,contentRange:xr(this,n,!0,!0)})}getCloneParameters(){return{...this.state,insertionDelimiter:this.insertionDelimiter,prefixRange:this.prefixRange,removalRange:void 0,interiorRange:void 0,scopeTypeType:this.scopeTypeType_,leadingDelimiterRange:this.leadingDelimiterRange_,trailingDelimiterRange:this.trailingDelimiterRange_}}};function eA(t){switch(t){case"class":case"namedFunction":case"section":case"sectionLevelOne":case"sectionLevelTwo":case"sectionLevelThree":case"sectionLevelFour":case"sectionLevelFive":case"sectionLevelSix":case"part":case"chapter":case"subSection":case"subSubSection":case"namedParagraph":case"subParagraph":return`

`;case"anonymousFunction":case"statement":case"ifStatement":case"comment":case"xmlElement":case"collectionItem":case"branch":case"environment":return`
`;default:return" "}}o(eA,"getInsertionDelimiter");var Ls=class t extends J{constructor(r){super(r);this.type="SubTokenWordTarget";this.isToken=!1;this.isWord=!0;this.leadingDelimiterRange_=r.leadingDelimiterRange,this.trailingDelimiterRange_=r.trailingDelimiterRange,this.insertionDelimiter=r.insertionDelimiter}static{o(this,"SubTokenWordTarget")}getLeadingDelimiterTarget(){return Kn(this.editor,this.leadingDelimiterRange_,this.isReversed)}getTrailingDelimiterTarget(){return Kn(this.editor,this.trailingDelimiterRange_,this.isReversed)}getRemovalRange(){return Ns(this)}maybeCreateRichRangeTarget(r,n){return new t({...this.getCloneParameters(),isReversed:r,contentRange:xr(this,n,!0,!0),trailingDelimiterRange:n.trailingDelimiterRange_})}getCloneParameters(){return{...this.state,leadingDelimiterRange:this.leadingDelimiterRange_,trailingDelimiterRange:this.trailingDelimiterRange_,insertionDelimiter:this.insertionDelimiter}}};var je=class extends J{constructor(){super(...arguments);this.type="TokenTarget";this.insertionDelimiter=" ";this.joinAs="token"}static{o(this,"TokenTarget")}getLeadingDelimiterTarget(){return Mt(this)}getTrailingDelimiterTarget(){return At(this)}getRemovalRange(){return Ft(this)}getCloneParameters(){return this.state}};var Us=class extends J{constructor(r){super(r);this.type="SurroundingPairTarget";this.insertionDelimiter=" ";this.boundary_=r.boundary,this.interiorRange_=r.interiorRange}static{o(this,"SurroundingPairTarget")}getLeadingDelimiterTarget(){return Mt(this)}getTrailingDelimiterTarget(){return At(this)}getRemovalRange(){return Ft(this)}getInterior(){return[new Zn({editor:this.editor,isReversed:this.isReversed,fullInteriorRange:this.interiorRange_})]}getBoundary(){return this.boundary_.map(r=>new je({editor:this.editor,isReversed:this.isReversed,contentRange:r}))}getCloneParameters(){return{...this.state,interiorRange:this.interiorRange_,boundary:this.boundary_}}};var Re=class extends J{constructor(r){super(r);this.type="UntypedTarget";this.insertionDelimiter=" ";this.hasExplicitScopeType=!1;this.hasExplicitRange=r.hasExplicitRange,this.isToken=r.isToken??!0}static{o(this,"UntypedTarget")}getLeadingDelimiterTarget(){return Mt(this)}getTrailingDelimiterTarget(){return At(this)}getRemovalRange(){return this.editor.document.getText(this.contentRange).trim().length===0?this.contentRange:Ft(this)}maybeCreateRichRangeTarget(){return null}getCloneParameters(){return{...this.state,isToken:this.isToken,hasExplicitRange:this.hasExplicitRange}}};var Hs=class extends J{constructor(){super(...arguments);this.type="ImplicitTarget";this.insertionDelimiter="";this.isRaw=!0;this.hasExplicitScopeType=!1;this.isImplicit=!0;this.isToken=!1;this.getLeadingDelimiterTarget=o(()=>{},"getLeadingDelimiterTarget");this.getTrailingDelimiterTarget=o(()=>{},"getTrailingDelimiterTarget");this.getRemovalRange=o(()=>this.contentRange,"getRemovalRange");this.getCloneParameters=o(()=>this.state,"getCloneParameters")}static{o(this,"ImplicitTarget")}};var Vs=class extends J{constructor(r){let{inputTarget:n,modifiedTarget:i,isHead:a}=r;super({...r,contentRange:uT(n.contentRange,i.contentRange,a)});this.type="HeadTailTarget";this.insertionDelimiter=" ";this.inputTarget=n,this.modifiedTarget=i,this.isHead=a}static{o(this,"HeadTailTarget")}getLeadingDelimiterTarget(){return Mt(this)}getTrailingDelimiterTarget(){return At(this)}getRemovalRange(){return Ft(this)}getInterior(){let r=this.modifiedTarget.getInterior();if(r!=null)return r.map(n=>new ee({editor:this.editor,contentRange:uT(this.inputTarget.contentRange,n.contentRange,this.isHead),isReversed:this.isReversed}))}getCloneParameters(){return{...this.state,inputTarget:this.inputTarget,modifiedTarget:this.modifiedTarget,isHead:this.isHead}}};function uT(t,e,r){return r?new b(e.start,t.end):new b(t.start,e.end)}o(uT,"constructRange");var Bs=class t extends J{constructor(r){super({...r,contentRange:tA(r.paragraphTarget.contentRange,r.containingInterior.contentRange)});this.type="BoundedParagraphTarget";this.insertionDelimiter=`

`;this.isLine=!0;this.containingInterior=r.containingInterior,this.paragraphTarget=r.paragraphTarget,this.startLineGap=this.contentRange.start.line-this.containingInterior.fullInteriorRange.start.line,this.endLineGap=this.containingInterior.fullInteriorRange.end.line-this.contentRange.end.line}static{o(this,"BoundedParagraphTarget")}getLeadingDelimiterTarget(){return this.startLineGap>1?this.paragraphTarget.getLeadingDelimiterTarget():void 0}getTrailingDelimiterTarget(){return this.endLineGap>1?this.paragraphTarget.getTrailingDelimiterTarget():void 0}getRemovalRange(){let r=this.getTrailingDelimiterTarget()??this.getLeadingDelimiterTarget(),n=r!=null?this.contentRange.union(r.contentRange):this.contentRange;return this.startLineGap<=0||this.endLineGap<=0?n:new tt({contentRange:n,editor:this.editor,isReversed:this.isReversed}).getRemovalRange()}get fullLineContentRange(){return Tr(this.editor,this.contentRange)}getRemovalHighlightRange(){if(this.startLineGap<1||this.endLineGap<1)return this.getRemovalRange();let r=this.getTrailingDelimiterTarget()??this.getLeadingDelimiterTarget();return r!=null?this.fullLineContentRange.union(r.contentRange):this.fullLineContentRange}maybeCreateRichRangeTarget(r,n){return new t({...this.getCloneParameters(),isReversed:r,containingInterior:this.containingInterior.maybeCreateRichRangeTarget(r,n.containingInterior),paragraphTarget:this.paragraphTarget.maybeCreateRichRangeTarget(r,n.paragraphTarget)})}getCloneParameters(){return{...this.state,paragraphTarget:this.paragraphTarget,containingInterior:this.containingInterior}}};function tA(t,e){let r=t.intersection(e);if(r==null||r.isEmpty)throw new Error("Ranges do not intersect");return r}o(tA,"getIntersectionStrict");function Ws(t){return t.activeTextEditor?.selections.map(e=>({selection:e,editor:t.activeTextEditor}))??[]}o(Ws,"getActiveSelections");var Yn=class{static{o(this,"CursorStage")}run(){return Ws(g()).map(e=>new Re({editor:e.editor,isReversed:e.selection.isReversed,contentRange:e.selection,hasExplicitRange:!e.selection.isEmpty,isToken:!1}))}};var It=class{static{o(this,"DecorationDebouncer")}constructor(e,r){this.debouncer=new ta(r,e.getOwnConfiguration("decorationDebounceDelayMs")),this.run=this.run.bind(this)}run(){this.debouncer.run()}dispose(){this.debouncer.dispose()}};var js=class{constructor(e,r){this.ide=e;this.storedTargets=r;this.disposables=[];this.debouncer=new It(e.configuration,()=>this.updateKeyboardTarget()),this.disposables.push(e.configuration.onDidChangeConfiguration(()=>this.maybeActivate()),this.debouncer),this.maybeActivate()}static{o(this,"KeyboardTargetUpdater")}maybeActivate(){if(this.ide.configuration.getOwnConfiguration("experimental.keyboardTargetFollowsSelection")){this.selectionWatcherDisposable==null&&(this.selectionWatcherDisposable=this.ide.onDidChangeTextEditorSelection(this.debouncer.run));return}this.selectionWatcherDisposable!=null&&(this.selectionWatcherDisposable.dispose(),this.selectionWatcherDisposable=void 0)}updateKeyboardTarget(){this.ide.activeTextEditor==null||this.storedTargets.get("keyboard")==null||this.storedTargets.set("keyboard",new Yn().run())}dispose(){this.disposables.forEach(e=>e.dispose()),this.selectionWatcherDisposable?.dispose()}};var $s=class{constructor(e){this.ide=e;switch(e.disposeOnExit(this),this.evaluateSetting=this.evaluateSetting.bind(this),this.active=!0,e.runMode){case"development":this.enableDebugLog();break;case"test":this.disableDebugLog();break;case"production":this.evaluateSetting(),this.disposableConfiguration=e.configuration.onDidChangeConfiguration(this.evaluateSetting);break}}static{o(this,"Debug")}log(...e){this.active&&console.log(...e)}dispose(){this.disposableConfiguration&&this.disposableConfiguration.dispose()}enableDebugLog(){this.active=!0}disableDebugLog(){this.active=!1}evaluateSetting(){this.ide.configuration.getOwnConfiguration("debug")?this.enableDebugLog():this.disableDebugLog()}};var rA=["!","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_","`","{","|","}","~","\xA3",'"'],nA=rA.map(Je).join("|"),iA=["[a-zA-Z0-9]",nA].join("|"),oA=new RegExp(`^(${iA})$`,"u"),aA="[unk]",sA=/\p{L}\p{M}*|[\p{N}\p{P}\p{S}]/gu,qs=class{constructor(){this.disposables=[];this.algorithmChangeNotifier=new He;this.getTokenGraphemes=o(e=>st(e,sA,r=>({text:this.normalizeGrapheme(r[0]),tokenStartOffset:r.index,tokenEndOffset:r.index+r[0].length})),"getTokenGraphemes");this.registerAlgorithmChangeListener=this.algorithmChangeNotifier.registerListener;g().disposeOnExit(this),this.updateTokenHatSplittingMode=this.updateTokenHatSplittingMode.bind(this),this.getTokenGraphemes=this.getTokenGraphemes.bind(this),this.updateTokenHatSplittingMode(),this.disposables.push(g().configuration.onDidChangeConfiguration(this.updateTokenHatSplittingMode))}static{o(this,"TokenGraphemeSplitter")}updateTokenHatSplittingMode(){let{lettersToPreserve:e,symbolsToPreserve:r,...n}=g().configuration.getOwnConfiguration("tokenHatSplittingMode");this.tokenHatSplittingMode={lettersToPreserve:e.map(i=>i.toLowerCase().normalize("NFC")),symbolsToPreserve:r.map(i=>i.normalize("NFC")),...n},this.algorithmChangeNotifier.notifyListeners()}normalizeGrapheme(e){let{preserveCase:r,lettersToPreserve:n,symbolsToPreserve:i}=this.tokenHatSplittingMode,a=e.normalize("NFC");return i.includes(a)||(r||(a=a.toLowerCase()),n.includes(a.toLowerCase()))||(a=cu(a),oA.test(a)||(a=aA)),a}dispose(){this.disposables.forEach(({dispose:e})=>e())}};function Gr(){return Tm==null&&(Tm=new qs),Tm}o(Gr,"tokenGraphemeSplitter");var Tm;var mT=o(({penalty:t})=>-t,"negativePenalty");function fT(t){return({grapheme:{text:e},style:r})=>{let n=t.get({grapheme:e,hatStyle:r});return n==null?1/0:-n}}o(fT,"hatOldTokenRank");function dT(t,e){let r=Ci(n=>yu(e[n].filter(i=>i>t))??1/0);return({grapheme:{text:n}})=>r(n)}o(dT,"minimumTokenRankContainingGrapheme");function xm(t){return e=>e.grapheme.text===t?.grapheme&&e.style===t?.hatStyle?1:0}o(xm,"isOldTokenHat");function gT(t){switch(t){case"greedy":return({penalty:e})=>-e;case"balanced":return({penalty:e})=>-(e<2?0:1);case"stable":return e=>0}}o(gT,"penaltyEquivalenceClass");function hT(t,e){if(t.length===0)return;let r=t;for(let n of e){if(r.length===1)return r[0];r=pA(r,n)}return r[0]}o(hT,"maxByFirstDiffering");function pA(t,e){let r=-1/0,n=[];for(let i of t){let a=e(i);a<r||(a>r&&(r=a,n.length=0),n.push(i))}return n}o(pA,"maxByAllowingTies");function yT({hatOldTokenRanks:t,graphemeTokenRanks:e},r,n,i,a,s){return hT(s,[xm(i),gT(r),xm(a),fT(t),mT,dT(n,e)])}o(yT,"chooseTokenHat");function TT(t,e,r){let n={},i=new fr(({grapheme:a,hatStyle:s})=>[a,s]);return t.forEach(({token:a,rank:s})=>{let p=e.get(a);p!=null&&i.set(p,s),r.getTokenGraphemes(a.text).forEach(({text:c})=>{let l;c in n?l=n[c]:(l=[],n[c]=l),l.push(s)})}),{hatOldTokenRanks:i,graphemeTokenRanks:n}}o(TT,"getHatRankingContext");function xT(t,e=[]){return new Map(du(oe,$t)(Ni([e],t.visibleRanges.map(r=>Tu(r.start.line,r.end.line+1)))).sort((r,n)=>r-n).map((r,n)=>[r,n]))}o(xT,"getDisplayLineMap");function ST(t,e){return(r,n)=>{let i=Math.abs(r.displayLine-t),a=Math.abs(n.displayLine-t);if(i<a)return-1;if(i>a)return 1;let s=Math.abs(r.range.start.character-e),p=Math.abs(n.range.start.character-e);return s-p}}o(ST,"getTokenComparator");var cA=["-","+","*","/","=","<",">","_","#",".","|","&",":"],lA=["!==","!=","+=","-=","*=","/=","%=","<=",">=","=>","->","??",'"""',"```","/*","*/","<!--","-->"],uA=["\\p{L}","\\p{M}","\\p{N}"],mA="[^\\s\\w]",fA="(?<![.\\d])\\d+\\.\\d+(?![.\\d])";function dA(t){let{fixedTokens:e,repeatableSymbols:r,identifierWordRegexes:n,identifierWordDelimiters:i,numbersRegex:a,singleSymbolsRegex:s}=t,p=r.map(Je).map(d=>`${d}+`).join("|"),c=e.map(Je).join("|"),u=`(${n.concat(i.map(Je)).join("|")})+`,m=`(${n.join("|")})+`,f=[c,a,u,p,s].join("|");return{identifierMatcher:new RegExp(u,"gu"),wordMatcher:new RegExp(m,"gu"),tokenMatcher:new RegExp(f,"gu")}}o(dA,"generateMatcher");var Sm=new Map;function $e(t){let e=g().configuration.getOwnConfiguration("wordSeparators",{languageId:t}),r=e.join("\0");if(!Sm.has(r)){let n={fixedTokens:lA,repeatableSymbols:cA,identifierWordRegexes:uA,identifierWordDelimiters:e,numbersRegex:fA,singleSymbolsRegex:mA};Sm.set(r,dA(n))}return Sm.get(r)}o($e,"getMatcher");function vT(t,e,r){return st(t,$e(e).tokenMatcher,r)}o(vT,"tokenize");function bT(t,e){let r=t.document.languageId,n=t.document.getText(e),i=t.document.offsetAt(e.start);return vT(n,r,a=>{let s=i+a.index,p=i+a.index+a[0].length,c=new b(t.document.positionAt(s),t.document.positionAt(p));return{editor:t,text:a[0],range:c,offsets:{start:s,end:p}}})}o(bT,"getTokensInRange");function RT(t,e,r){let i=hA(t,e).flatMap(a=>{let s=a.selections[0].active,p=xT(a,[s.line]),c=oe(a.visibleRanges.map(l=>bT(a,l).map(u=>({...u,displayLine:p.get(u.range.start.line)}))));return c.sort(ST(p.get(s.line),s.character)),c});return gA(r,i).map((a,s)=>({token:a,rank:-s}))}o(RT,"getRankedTokens");function gA(t,e){return t==null?e:e.sort((r,n)=>{let i=t.has(r),a=t.has(n);return i&&!a?-1:!i&&a?1:0})}o(gA,"moveForcedHatsToFront");function hA(t,e){let r;return t==null?r=e:r=[t,...e.filter(n=>n!==t)],r}o(hA,"getRankedEditors");function vm({tokenGraphemeSplitter:t,enabledHatStyles:e,forceTokenHats:r,oldTokenHats:n,hatStability:i,activeTextEditor:a,visibleTextEditors:s}){let p=r==null?void 0:wT(r),c=wT(n),l=RT(a,s,p),u=TT(l,c,t),m=Object.keys(e),f=new dr(()=>[...m]);return l.map(({token:d,rank:y})=>{let T=yA(t,d,f,e),k=yT(u,i,y,p?.get(d),c.get(d),T);if(k!=null)return f.set(k.grapheme.text,f.get(k.grapheme.text).filter(R=>R!==k.style)),TA(d,k)}).filter(d=>d!=null)}o(vm,"allocateHats");function wT(t){let e=new fr(({editor:r,offsets:n})=>[r.id,n.start,n.end]);return t.forEach(r=>e.set(r.token,r)),e}o(wT,"getTokenOldHatMap");function yA(t,e,r,n){let i=[],a=t.getTokenGraphemes(e.text);for(let s of a)for(let p of r.get(s.text))i.push({grapheme:s,style:p,penalty:n[p].penalty});return i}o(yA,"getTokenRemainingHatCandidates");function TA(t,e){return{hatStyle:e.style,grapheme:e.grapheme.text,token:t,hatRange:new b(t.range.start.translate(void 0,e.grapheme.tokenStartOffset),t.range.start.translate(void 0,e.grapheme.tokenEndOffset))}}o(TA,"constructHatRangeDescriptor");var zs=class{constructor(e,r){this.hats=e;this.context=r;this.disposables=[];g().disposeOnExit(this);let n=new It(g().configuration,()=>this.allocateHats());this.disposables.push(this.hats.onDidChangeEnabledHatStyles(n.run),this.hats.onDidChangeIsEnabled(n.run),g().onDidOpenTextDocument(n.run),g().onDidCloseTextDocument(n.run),g().onDidChangeActiveTextEditor(n.run),g().onDidChangeVisibleTextEditors(n.run),g().onDidChangeTextDocument(n.run),g().onDidChangeTextEditorSelection(n.run),g().onDidChangeTextEditorVisibleRanges(n.run),Gr().registerAlgorithmChangeListener(n.run),n)}static{o(this,"HatAllocator")}async allocateHats(e){let r=await this.context.getActiveMap();e=e?.map(i=>({...i,grapheme:Gr().normalizeGrapheme(i.grapheme)}));let n=this.hats.isEnabled?vm({tokenGraphemeSplitter:Gr(),enabledHatStyles:this.hats.enabledHatStyles,forceTokenHats:e,oldTokenHats:r.tokenHats,hatStability:g().configuration.getOwnConfiguration("experimental.hatStability"),activeTextEditor:g().activeTextEditor,visibleTextEditors:g().visibleTextEditors}):[];r.setTokenHats(n),await this.hats.setHatRanges(n.map(({hatStyle:i,hatRange:a,token:{editor:s}})=>({editor:s,range:a,styleName:i})))}dispose(){this.disposables.forEach(({dispose:e})=>e())}};var Gs=class t{constructor(e){this.rangeUpdater=e;this.isExpired=!1;this.documentTokenLists=new Map;this.deregisterFunctions=[];this.map={};this._tokenHats=[]}static{o(this,"IndividualHatMap")}get tokenHats(){return this._tokenHats}getDocumentTokenList(e){let r=e.uri.toString(),n=this.documentTokenLists.get(r);return n==null&&(n=[],this.documentTokenLists.set(r,n),this.deregisterFunctions.push(this.rangeUpdater.registerRangeInfoList(e,n))),n}clone(){let e=new t(this.rangeUpdater);return e.setTokenHats(this._tokenHats),e}setTokenHats(e){this.map={},this.documentTokenLists=new Map,this.deregisterFunctions.forEach(n=>n());let r=e.map(n=>{let{hatStyle:i,grapheme:a,token:s}=n,p=this.makeTokenLive(s);return this.map[is(i,a)]=p,{...n,token:p}});this._tokenHats=r}makeTokenLive(e){let{tokenMatcher:r}=$e(e.editor.document.languageId),n={...e,expansionBehavior:{start:{type:"regex",regex:r},end:{type:"regex",regex:r}}};return this.getDocumentTokenList(e.editor.document).push(n),n}getEntries(){return this.checkExpired(),Object.entries(this.map)}getToken(e,r){return this.checkExpired(),this.map[is(e,Gr().normalizeGrapheme(r))]}checkExpired(){if(this.isExpired)throw Error("Map snapshot has expired")}dispose(){this.isExpired=!0,this.deregisterFunctions.forEach(e=>e())}};var xA=6e4,Ks=class{constructor(e,r,n,i){this.debug=r;this.commandServerApi=i;this.prePhraseMapsSnapshotTimestamp=null;this.lastSignalVersion=null;g().disposeOnExit(this),this.activeMap=new Gs(e),this.getActiveMap=this.getActiveMap.bind(this),this.allocateHats=this.allocateHats.bind(this),this.hatAllocator=new zs(n,{getActiveMap:this.getActiveMap})}static{o(this,"HatTokenMapImpl")}allocateHats(e){return this.hatAllocator.allocateHats(e)}async getActiveMap(){return await this.maybeTakePrePhraseSnapshot(),this.activeMap}async getReadableMap(e){return await this.maybeTakePrePhraseSnapshot(),e?this.lastSignalVersion==null?(console.error("Pre phrase snapshot requested but no signal was present; please upgrade command client"),this.activeMap):this.prePhraseMapSnapshot==null?(console.error("Navigation map pre-phrase snapshot requested, but no snapshot has been taken"),this.activeMap):performance.now()-this.prePhraseMapsSnapshotTimestamp>xA?(console.error("Navigation map pre-phrase snapshot requested, but snapshot is more than a minute old"),this.activeMap):this.prePhraseMapSnapshot:this.activeMap}dispose(){this.activeMap.dispose(),this.prePhraseMapSnapshot!=null&&this.prePhraseMapSnapshot.dispose()}async maybeTakePrePhraseSnapshot(){let e=await this.commandServerApi.signals.prePhrase.getVersion();e!==this.lastSignalVersion&&(this.debug.log("taking snapshot"),this.lastSignalVersion=e,e!=null&&this.takePrePhraseSnapshot())}takePrePhraseSnapshot(){this.prePhraseMapSnapshot!=null&&this.prePhraseMapSnapshot.dispose(),this.prePhraseMapSnapshot=this.activeMap.clone(),this.prePhraseMapsSnapshotTimestamp=performance.now()}};function bm(t,e,r){let n=t.get(e);return n==null&&(n=r(),t.set(e,n)),n}o(bm,"getDefault");var _m=Ai(Zs(),1);function km(t,e){let{originalOffsets:{start:r,end:n},finalOffsets:{end:i},displacement:a}=t,{offsets:{start:s,end:p}}=e;return(0,_m.invariant)(n>r,()=>"Change range expected to be nonempty"),(0,_m.invariant)(n>=s&&r<=p,()=>"Change range expected to intersect with selection range"),{start:n<=s?s+a:Math.min(s,i),end:n<=p?p+a:Math.min(p,i)}}o(km,"getOffsetsForDeleteOrReplace");var MT=Ai(Zs(),1);function Pm(t,e){let{event:{text:r,isReplace:n},finalOffsets:{start:i,end:a}}=t;if((0,MT.invariant)(i===t.originalOffsets.end&&i===e.offsets.start&&i===e.offsets.end,()=>"Selection range and change range expected to be same empty range"),n){let s=e.expansionBehavior.end;switch(s.type){case"closed":return{start:i,end:i};case"open":return{start:i,end:a};case"regex":{let p=r.match(Wa(s.regex));return p==null?{start:i,end:i}:{start:i,end:i+p[0].length}}}}else{let s=e.expansionBehavior.start;switch(s.type){case"closed":return{start:a,end:a};case"open":return{start:i,end:a};case"regex":{let p=r.search(Ba(s.regex));return p===-1?{start:a,end:a}:{start:i+p,end:a}}}}}o(Pm,"getOffsetsForEmptyRangeInsert");var Dm=Ai(Zs(),1);function Mm(t,e){let{event:{text:r},originalOffsets:{start:n},displacement:i}=t,{offsets:{start:a,end:s},text:p}=e;if((0,Dm.invariant)(s>a,()=>"Selection range expected to be nonempty"),(0,Dm.invariant)(n>=a&&n<=s,()=>"Insertion offset expected to intersect with selection range"),n>a&&n<s)return{start:a,end:s+i};if(n===a){let c=e.expansionBehavior.start,l=s+i;switch(c.type){case"closed":return{start:a+i,end:l};case"open":return{start:a,end:l};case"regex":{let u=r+p,m=Ba(c.regex),f=u.search(m);for(;f>r.length;)u=u.slice(0,f),f=u.search(m);return f===-1?{start:a,end:l}:{start:a+f,end:l}}}}else{let c=e.expansionBehavior.end,l=a;switch(c.type){case"closed":return{start:l,end:s};case"open":return{start:l,end:s+i};case"regex":{let u=p+r,m=Wa(c.regex),f=u.match(m),d=f==null?0:f[0].length;for(;d!==0&&d<p.length;)u=p.slice(d)+r,f=u.match(m),d=f==null?0:d+f[0].length;return d===0?{start:l,end:s}:{start:l,end:a+d}}}}}o(Mm,"getOffsetsForNonEmptyRangeInsert");function AT(t,e,r){let{start:n,end:i}=t.originalOffsets,{start:a,end:s}=e.offsets,p=Math.min(n,a),c="";return a<n&&(c+=e.text.substring(0,n-a)),c+=t.event.text,i<s&&(c+=e.text.substring(s-i,e.text.length)),c.substring(r.start-p,r.end-p)}o(AT,"getUpdatedText");function FT(t,e){let{document:r,contentChanges:n}=t,i=n.map(a=>{let s=a.text.length-a.rangeLength,p=a.rangeOffset,c=p+a.rangeLength,l=p,u=c+s;return{displacement:s,event:a,originalOffsets:{start:p,end:c},finalOffsets:{start:l,end:u}}});for(let a of e){let s=a.offsets,p=i.map(l=>{let u;return l.originalOffsets.start>s.end?{start:0,end:0}:l.originalOffsets.end<s.start?{start:l.displacement,end:l.displacement}:(l.event.rangeLength===0?a.range.isEmpty?u=Pm(l,a):u=Mm(l,a):u=km(l,a),a.text=AT(l,a,u),{start:u.start-s.start,end:u.end-s.end})}),c={start:s.start+La(p,({start:l})=>l),end:s.end+La(p,({end:l})=>l)};a.range=a.range.with(r.positionAt(c.start),r.positionAt(c.end)),a.offsets=c}}o(FT,"updateRangeInfos");var Ys=class{constructor(){this.rangeInfoLists=new Map;this.replaceEditLists=new Map;this.listenForDocumentChanges()}static{o(this,"RangeUpdater")}getDocumentRangeInfoLists(e){return bm(this.rangeInfoLists,e.uri.toString(),()=>[])}getDocumentReplaceEditLists(e){return bm(this.replaceEditLists,e.uri.toString(),()=>[])}registerRangeInfoList(e,r){let n=this.getDocumentRangeInfoLists(e);return n.push(r),()=>we(n,r)}registerReplaceEditList(e,r){let n=this.getDocumentReplaceEditLists(e);return n.push(r),()=>we(n,r)}*documentRangeInfoGenerator(e){let r=this.getDocumentRangeInfoLists(e);for(let n of r)for(let i of n)yield i}listenForDocumentChanges(){this.disposable=g().onDidChangeTextDocument(e=>{let r=this.getDocumentReplaceEditLists(e.document),n={...e,contentChanges:e.contentChanges.map(i=>PA(r,i)?{...i,isReplace:!0}:i)};FT(n,this.documentRangeInfoGenerator(e.document))})}dispose(){this.disposable.dispose()}};function PA(t,e){for(let r of t)for(let n of r)if(n.range.isRangeEqual(e.range)&&n.text===e.text)return!0;return!1}o(PA,"isReplace");var Js=class{constructor(){this.signals={prePhrase:{getVersion(){return Promise.resolve(null)}}}}static{o(this,"DisabledCommandServerApi")}getFocusedElementType(){return Promise.resolve(void 0)}};var Xs=class{static{o(this,"DisabledHatTokenMap")}async allocateHats(){}async getReadableMap(){return{getEntries(){return[]},getToken(){throw new Error("Hat map is disabled")}}}dispose(){}};var ep=class{static{o(this,"DisabledLanguageDefinitions")}onDidChangeDefinition(e){return{dispose:o(()=>{},"dispose")}}loadLanguage(e){return Promise.resolve()}get(e){}getNodeAtLocation(e,r){}dispose(){}};var tp=class{static{o(this,"DisabledSnippets")}updateUserSnippets(){throw new Error("Snippets are not implemented.")}registerThirdPartySnippets(e,r){throw new Error("Snippets are not implemented.")}getSnippetStrict(e){throw new Error("Snippets are not implemented.")}openNewSnippetFile(e){throw new Error("Snippets are not implemented.")}};var rp=class{static{o(this,"DisabledTalonSpokenForms")}getSpokenFormEntries(){throw new $n}onDidChange(){return{dispose:o(()=>{},"dispose")}}};var np=class{static{o(this,"DisabledTreeSitter")}getTree(e){throw new Error("Tree sitter not provided")}loadLanguage(e){return Promise.resolve(!1)}getLanguage(e){throw new Error("Tree sitter not provided")}getNodeAtLocation(e,r){throw new Error("Tree sitter not provided")}};var re=class extends Error{constructor(r,n=!1,i=!1){super(`No spoken form for: ${r}`);this.reason=r;this.requiresTalonUpdate=n;this.isPrivate=i}static{o(this,"NoSpokenFormError")}};var IT={curlyBrackets:["{","}"],angleBrackets:["<",">"],escapedDoubleQuotes:['\\"','\\"'],escapedSingleQuotes:["\\'","\\'"],escapedParentheses:["\\(","\\)"],escapedSquareBrackets:["\\[","\\]"],doubleQuotes:['"','"'],parentheses:["(",")"],backtickQuotes:["`","`"],squareBrackets:["[","]"],singleQuotes:["'","'"],tripleDoubleQuotes:['"""','"""'],tripleSingleQuotes:["'''","'''"],whitespace:[" "," "],any:null,string:null,collectionBoundary:null};var OT=new fr(t=>t);for(let[t,e]of Object.entries(IT))e!=null&&OT.set(e,t);function CT(t,e,r){let n=OT.get([e,r]);if(n==null)throw Error(`Unknown surrounding pair delimiters '${e} ${r}'`);return t.pairedDelimiter[n]}o(CT,"surroundingPairDelimitersToSpokenForm");var DA={ifStatement:"if",ifElseStatement:"if else",tryCatchStatement:"try",functionDeclaration:"funk",link:"link"},MA={"ifElseStatement.alternative":"else","functionDeclaration.body":"funk","ifElseStatement.consequence":"if else","ifStatement.consequence":"if","tryCatchStatement.body":"try","link.text":"link"};function NT(t){if(t.type==="custom")throw new re("Custom insertion snippet");let e=DA[t.name];if(e==null)throw new re(`Named insertion snippet '${t.name}'`);if(t.substitutions!=null){let r=Object.values(t.substitutions);return`${e} ${r.join(" ")}`}return e}o(NT,"insertionSnippetToSpokenForm");function LT(t){if(t.type==="custom")throw new re("Custom wrap with snippet");let e=`${t.name}.${t.variableName}`,r=MA[e];if(r==null)throw new re(`Named wrap with snippet '${e}'`);return r}o(LT,"wrapperSnippetToSpokenForm");function po(t,e,r){let n=r==="vertical"?`${me.verticalRange} `:"";if(t&&e)return n+me.rangeExclusive;if(t)throw new re("Range exclude anchor");return e?n+me.rangeExcludingEnd:r==="vertical"?me.verticalRange:me.rangeInclusive}o(po,"getRangeConnective");function UT(t){return Object.fromEntries(Object.entries(t).map(([e,r])=>[e,Object.fromEntries(Object.entries(r).map(([n,i])=>[n,{type:"customizable",spokenForms:i,spokenFormType:e,id:n}]))]))}o(UT,"getSpokenFormComponentMap");var AA=["zero","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen","twenty","twenty one","twenty two","twenty three","twenty four","twenty five","twenty six","twenty seven","twenty eight","twenty nine","thirty","thirty one","thirty two","thirty three","thirty four","thirty five","thirty six","thirty seven","thirty eight","thirty nine","forty","forty one","forty two","forty three","forty four","forty five","forty six","forty seven","forty eight","forty nine","fifty","fifty one","fifty two","fifty three","fifty four","fifty five","fifty six","fifty seven","fifty eight","fifty nine","sixty","sixty one","sixty two","sixty three","sixty four","sixty five","sixty six","sixty seven","sixty eight","sixty nine","seventy","seventy one","seventy two","seventy three","seventy four","seventy five","seventy six","seventy seven","seventy eight","seventy nine","eighty","eighty one","eighty two","eighty three","eighty four","eighty five","eighty six","eighty seven","eighty eight","eighty nine","ninety","ninety one","ninety two","ninety three","ninety four","ninety five","ninety six","ninety seven","ninety eight","ninety nine"],FA=["zeroth","first","second","third","fourth","fifth","sixth","seventh","eighth","ninth","tenth","eleventh","twelfth","thirteenth","fourteenth","fifteenth","sixteenth","seventeenth","eighteenth","nineteenth","twentieth"];function Jn(t){let e=AA[t];if(e==null)throw Error(`Unknown number '${t}'`);return e}o(Jn,"numberToSpokenForm");function co(t){let e=FA[t];if(e==null)throw Error(`Unknown ordinal '${t}'`);return e}o(co,"ordinalToSpokenForm");var ip=class{constructor(e){this.spokenFormMap=e;this.handleModifier=this.handleModifier.bind(this)}static{o(this,"PrimitiveTargetSpokenFormGenerator")}handlePrimitiveTarget(e){let r=[];return e.modifiers!=null&&r.push(e.modifiers.map(this.handleModifier)),e.mark!=null&&r.push(this.handleMark(e.mark)),r}handleModifier(e){switch(e.type){case"cascading":case"modifyIfUntyped":case"preferredScope":throw new re(`Modifier '${e.type}'`);case"containingScope":if(e.ancestorIndex==null||e.ancestorIndex===0)return this.handleScopeType(e.scopeType);if(e.ancestorIndex===1)return[this.spokenFormMap.modifierExtra.ancestor,this.handleScopeType(e.scopeType)];throw new re(`Modifier '${e.type}' with ancestor index ${e.ancestorIndex}`);case"everyScope":return[this.spokenFormMap.simpleModifier.everyScope,this.handleScopeType(e.scopeType)];case"extendThroughStartOf":case"extendThroughEndOf":{let r=this.spokenFormMap.simpleModifier[e.type];return e.modifiers!=null?[r,e.modifiers.map(this.handleModifier)]:[r]}case"relativeScope":return e.offset===0?this.handleRelativeScopeInclusive(e):this.handleRelativeScopeExclusive(e);case"ordinalScope":{let r=this.handleScopeType(e.scopeType),n=e.isEvery?this.spokenFormMap.simpleModifier.everyScope:[];if(e.length===1)return e.start===-1?[n,this.spokenFormMap.modifierExtra.last,r]:e.start===0?[n,this.spokenFormMap.modifierExtra.first,r]:e.start<0?[n,co(Math.abs(e.start)),this.spokenFormMap.modifierExtra.last,r]:[n,co(e.start+1),r];let i=Jn(e.length);if(e.start===0)return[n,this.spokenFormMap.modifierExtra.first,i,lo(r)];if(e.start===-e.length)return[n,this.spokenFormMap.modifierExtra.last,i,lo(r)];throw new re(`'${e.type}' with count > 1 and offset away from start / end`)}case"range":{if(e.anchor.type==="ordinalScope"&&e.active.type==="ordinalScope"&&e.anchor.length===1&&e.active.length===1&&e.anchor.scopeType.type===e.active.scopeType.type){let r=e.anchor.start===-1?this.spokenFormMap.modifierExtra.last:co(e.anchor.start+1),n=this.handleModifier(e.active),i=po(e.excludeAnchor,e.excludeActive);return[r,i,n]}throw Error(`Modifier '${e.type}' is not fully implemented`)}default:return[this.spokenFormMap.simpleModifier[e.type]]}}handleRelativeScopeInclusive(e){let r=this.handleScopeType(e.scopeType),n=e.isEvery?this.spokenFormMap.simpleModifier.everyScope:[];if(e.length===1){let s=e.direction==="forward"?me.forward:me.backward;return[n,r,s]}let i=Jn(e.length),a=lo(r);return e.direction==="forward"?[n,i,a]:[n,i,a,me.backward]}handleRelativeScopeExclusive(e){let r=this.handleScopeType(e.scopeType),n=e.direction==="forward"?me.next:me.previous,i=e.isEvery?this.spokenFormMap.simpleModifier.everyScope:[];if(e.offset===1){let a=Jn(e.length);if(e.length===1)return[i,n,r];let s=lo(r);return[i,n,a,s]}if(e.length===1){let a=co(e.offset);return[i,a,n,r]}throw new re(`${e.type} modifier with offset > 1 and length > 1`)}handleScopeType(e){switch(e.type){case"oneOf":case"surroundingPairInterior":throw new re(`Scope type '${e.type}'`);case"glyph":return[this.spokenFormMap.complexScopeTypeType.glyph,VT(this.spokenFormMap.grapheme,"grapheme",e.character)];case"surroundingPair":{let r=this.spokenFormMap.pairedDelimiter[e.delimiter];return e.forceDirection!=null?[this.spokenFormMap.surroundingPairForceDirection[e.forceDirection],r]:r}case"customRegex":return this.spokenFormMap.customRegex[e.regex]??{type:"customizable",spokenForms:{spokenForms:[],isCustom:!0,defaultSpokenForms:[],requiresTalonUpdate:!1,isPrivate:!1},spokenFormType:"customRegex",id:e.regex};default:return this.spokenFormMap.simpleScopeTypeType[e.type]}}handleMark(e){switch(e.type){case"decoratedSymbol":{let[r,n]=e.symbolColor.split("-"),i=[];return r!=="default"&&i.push(Iy(r)),n!=null&&i.push(Oy(n)),i.push(VT(this.spokenFormMap.grapheme,"grapheme",e.character)),i}case"lineNumber":return this.handleLineNumberMark(e);case"range":{if(e.anchor.type==="lineNumber"&&e.active.type==="lineNumber"){let[r,n]=this.handleLineNumberMark(e.anchor),[i,a]=this.handleLineNumberMark(e.active);if(r===i){let s=po(e.excludeAnchor,e.excludeActive);return[r,n,s,a]}}throw Error(`Mark '${e.type}' is not fully implemented`)}case"explicit":case"keyboard":case"target":throw new re(`Mark '${e.type}'`);default:return[gs[e.type]]}}handleLineNumberMark(e){switch(e.lineNumberType){case"absolute":throw new re("Absolute line numbers");case"modulo100":return[hs.modulo100,Jn(e.lineNumber+1)];case"relative":return[e.lineNumber<0?hs.relativeUp:hs.relativeDown,Jn(Math.abs(e.lineNumber))]}}};function lo(t){if(typeof t=="string")return HT(t);if(Array.isArray(t)){if(t.length===0)return t;let e=t[t.length-1];return[...t.slice(0,-1),lo(e)]}return{...t,spokenForms:{...t.spokenForms,spokenForms:t.spokenForms.spokenForms.map(HT)}}}o(lo,"pluralize");function HT(t){return`${t}s`}o(HT,"pluralizeString");function VT(t,e,r){let n=t[r];if(n==null)throw new re(`${e} '${r}'`);return n}o(VT,"getSpokenFormStrict");var uo=class{static{o(this,"SpokenFormGenerator")}constructor(e){this.spokenFormMap=UT(e),this.primitiveGenerator=new ip(this.spokenFormMap)}getSpokenFormForSingleTerm(e,r){return this.componentsToSpokenForm(()=>{let n=this.spokenFormMap[e][r];if(n==null)throw new re(`${e} with id ${r}`);return n})}processCommand(e){return this.componentsToSpokenForm(()=>this.handleAction(e.action))}processScopeType(e){return this.componentsToSpokenForm(()=>[this.primitiveGenerator.handleScopeType(e)])}componentsToSpokenForm(e){try{return{type:"success",spokenForms:BT(e())}}catch(r){if(r instanceof re)return{type:"error",reason:r.reason,requiresTalonUpdate:r.requiresTalonUpdate,isPrivate:r.isPrivate};throw r}}handleAction(e){switch(e.name){case"editNew":case"getText":case"replace":case"executeCommand":case"parsed":case"private.getTargets":case"private.setKeyboardTarget":throw new re(`Action '${e.name}'`);case"replaceWithTarget":case"moveToTarget":return[this.spokenFormMap.action[e.name],this.handleTarget(e.source),this.handleDestination(e.destination)];case"swapTargets":return[this.spokenFormMap.action[e.name],this.handleTarget(e.target1),me.swapConnective,this.handleTarget(e.target2)];case"callAsFunction":return e.argument.type==="implicit"?[this.spokenFormMap.action[e.name],this.handleTarget(e.callee)]:[this.spokenFormMap.action[e.name],this.handleTarget(e.callee),"on",this.handleTarget(e.argument)];case"wrapWithPairedDelimiter":case"rewrapWithPairedDelimiter":return[CT(this.spokenFormMap,e.left,e.right),this.spokenFormMap.action[e.name],this.handleTarget(e.target)];case"pasteFromClipboard":return[this.spokenFormMap.action[e.name],this.handleDestination(e.destination)];case"insertSnippet":return[this.spokenFormMap.action[e.name],NT(e.snippetDescription),this.handleDestination(e.destination)];case"generateSnippet":if(e.snippetName!=null)throw new re(`${e.name}.snippetName`);return[this.spokenFormMap.action[e.name],this.handleTarget(e.target)];case"wrapWithSnippet":return[LT(e.snippetDescription),this.spokenFormMap.action[e.name],this.handleTarget(e.target)];case"highlight":{if(e.highlightId!=null)throw new re(`${e.name}.highlightId`);return[this.spokenFormMap.action[e.name],this.handleTarget(e.target)]}default:return[this.spokenFormMap.action[e.name],this.handleTarget(e.target)]}}handleTarget(e){switch(e.type){case"list":if(e.elements.length<2)throw new re("List target with < 2 elements");return e.elements.map((r,n)=>n===0?this.handleTarget(r):[me.listConnective,this.handleTarget(r)]);case"range":{let r=this.handleTarget(e.anchor),n=this.handleTarget(e.active),i=po(e.excludeAnchor,e.excludeActive,e.rangeType);return[r,i,n]}case"primitive":return this.primitiveGenerator.handlePrimitiveTarget(e);case"implicit":return[]}}handleDestination(e){switch(e.type){case"list":if(e.destinations.length<2)throw new re("List destination with < 2 elements");return e.destinations.map((r,n)=>n===0?this.handleDestination(r):[me.listConnective,this.handleDestination(r)]);case"primitive":return[this.handleInsertionMode(e.insertionMode),this.handleTarget(e.target)];case"implicit":return[]}}handleInsertionMode(e){switch(e){case"to":return me.sourceDestinationConnective;case"before":return me.before;case"after":return me.after}}};function BT(t){if(typeof t=="string")return[t];if(Array.isArray(t))return t.length===0?[""]:WT(t.map(BT)).map(e=>e.filter(r=>r.length!==0).join(" "));if(t.spokenForms.spokenForms.length===0){let e=`${Xi(t.spokenFormType)} with id ${t.id}`,r;throw t.spokenForms.isPrivate?r="this is a private spoken form currently only for internal experimentation":t.spokenForms.requiresTalonUpdate?r="please update talon to the latest version (see https://www.cursorless.org/docs/user/updating/)":r="please see https://www.cursorless.org/docs/user/customization/ for more information",new re(`${e}; ${r}`,t.spokenForms.requiresTalonUpdate,t.spokenForms.isPrivate)}return t.spokenForms.spokenForms}o(BT,"constructSpokenForms");function WT(t){if(t.length===0)return[];if(t.length===1)return t[0].map(i=>[i]);let[e,...r]=t,n=WT(r);return e.flatMap(i=>n.map(a=>[i,...a]))}o(WT,"cartesianProduct");var op=class{constructor(e){this.talonSpokenForms=e;this.notifier=new He;this.spokenFormMap_={...yr};this.onDidChangeCustomSpokenForms=this.notifier.registerListener;this.disposable=e.onDidChange(()=>this.updateSpokenFormMaps().catch(()=>{})),this.customSpokenFormsInitialized=this.updateSpokenFormMaps(),this.customSpokenFormsInitialized.catch(()=>{})}static{o(this,"CustomSpokenForms")}get spokenFormMap(){return this.spokenFormMap_}get needsInitialTalonUpdate(){return this.needsInitialTalonUpdate_}async updateSpokenFormMaps(){let e;try{if(e=await this.talonSpokenForms.getSpokenFormEntries(),e.length===0)throw new Error("Custom spoken forms list empty")}catch(r){if(r instanceof ts)this.needsInitialTalonUpdate_=!0;else if(!(r instanceof $n)){console.error("Error loading custom spoken forms",r);let n=r.message.replace(/\.$/,"");ce(g().messages,"CustomSpokenForms.updateSpokenFormMaps",`Error loading custom spoken forms: ${n}. Falling back to default spoken forms.`)}throw this.spokenFormMap_={...yr},this.notifier.notifyListeners(),r}for(let r of uy)IA(this.spokenFormMap_,r,rm[r],Object.fromEntries(e.filter(n=>n.type===r).map(({id:n,spokenForms:i})=>[n,i])));this.notifier.notifyListeners()}getCustomRegexScopeTypes(){return Object.keys(this.spokenFormMap_.customRegex).map(e=>({type:"customRegex",regex:e}))}dispose(){this.disposable.dispose()}};function IA(t,e,r,n){let i=Array.from(new Set([...Object.keys(r),...Object.keys(n)])),a={};for(let s of i){let{defaultSpokenForms:p=[],isPrivate:c=!1}=r[s]??{},l=n[s];a[s]=l==null?{defaultSpokenForms:p,spokenForms:[],requiresTalonUpdate:!c,isCustom:!1,isPrivate:c}:{defaultSpokenForms:p,spokenForms:l,requiresTalonUpdate:!1,isCustom:!jt(p,l),isPrivate:c}}t[e]=a}o(IA,"updateEntriesForType");var ap=class{static{o(this,"CustomSpokenFormGeneratorImpl")}constructor(e){this.customSpokenForms=new op(e),this.customSpokenFormsInitialized=this.customSpokenForms.customSpokenFormsInitialized,this.spokenFormGenerator=new uo(this.customSpokenForms.spokenFormMap),this.disposable=this.customSpokenForms.onDidChangeCustomSpokenForms(()=>{this.spokenFormGenerator=new uo(this.customSpokenForms.spokenFormMap)})}onDidChangeCustomSpokenForms(e){return this.customSpokenForms.onDidChangeCustomSpokenForms(e)}commandToSpokenForm(e){return this.spokenFormGenerator.processCommand(e)}scopeTypeToSpokenForm(e){return this.spokenFormGenerator.processScopeType(e)}actionIdToSpokenForm(e){return this.spokenFormGenerator.getSpokenFormForSingleTerm("action",e)}graphemeToSpokenForm(e){return this.spokenFormGenerator.getSpokenFormForSingleTerm("grapheme",e)}getCustomRegexScopeTypes(){return this.customSpokenForms.getCustomRegexScopeTypes()}get needsInitialTalonUpdate(){return this.customSpokenForms.needsInitialTalonUpdate}dispose(){this.disposable.dispose()}};function*OA(t){for(let e of t)for(let r of e)yield r}o(OA,"flatten");function*mo(t,e){let r=sp(e),n=t;for(;n-- >0;){let i=r.next();if(!i.done)yield i.value;else return}}o(mo,"itake");function*Am(t){let e=sp(t),r=e.next();if(r.done)return;let n=r.value;for(let i of e)yield[n,i],n=i}o(Am,"pairwise");var Kre=Symbol();function*CA(t=0,e=1){let r=t;for(;;)yield r,r+=e}o(CA,"count");function*$T(t,e){for(let r of t)e(r)&&(yield r)}o($T,"ifilter");function*ke(t,e){for(let r of t)yield e(r)}o(ke,"imap");function*qT(t,e,r,n=1){let i,a;if(r!==void 0?(i=e,a=r):(i=0,a=e),i<0)throw new Error("start cannot be negative");if(a!==null&&a<0)throw new Error("stop cannot be negative");if(n<=0)throw new Error("step cannot be negative");let s=-1,p=sp(t),c;for(;;){if(s++,a!==null&&s>=a||(c=p.next(),c.done))return;s<i||(s-i)%n===0&&(yield c.value)}}o(qT,"islice");function*NA(t,e){let r=sp(t),n;for(;!(n=r.next()).done;){let i=n.value;if(!e(i))return;yield i}}o(NA,"takewhile");function sp(t){return t[Symbol.iterator]()}o(sp,"iter");function Xn(t,e){return Array.from(ke(t,e))}o(Xn,"map");function jT(t,e,r){let n=CA(t,r),i=r>=0?a=>a<e:a=>a>e;return NA(n,i)}o(jT,"range_");function zT(t,e,r=1){return e!==void 0?jT(t,e,r):jT(0,t,r)}o(zT,"range");function pp(t,e){return OA(ke(t,e))}o(pp,"flatmap");function Rt(t,e,{domain:r},{domain:n}){return t==="forward"?LA(e,r,n):UA(e,r,n)}o(Rt,"compareTargetScopes");function LA(t,e,r){let n=e.start.isAfterOrEqual(t),i=r.start.isAfterOrEqual(t);if(n&&i){let s=e.start.compareTo(r.start);return s===0?e.end.compareTo(r.end):s}if(!n&&!i){let s=e.end.compareTo(r.end);return s===0?-e.start.compareTo(r.start):s}if(!n&&i){let s=e.end.compareTo(r.start);return s!==0?s:r.isEmpty?1:-1}let a=e.start.compareTo(r.end);return a!==0?a:e.isEmpty?-1:1}o(LA,"compareTargetScopesForward");function UA(t,e,r){let n=e.end.isBeforeOrEqual(t),i=r.end.isBeforeOrEqual(t);if(n&&i){let s=-e.end.compareTo(r.end);return s===0?-e.start.compareTo(r.start):s}if(!n&&!i){let s=-e.start.compareTo(r.start);return s===0?e.end.compareTo(r.end):s}if(!n&&i){let s=-e.start.compareTo(r.end);return s!==0?s:r.isEmpty?1:-1}let a=-e.end.compareTo(r.start);return a!==0?a:e.isEmpty?-1:1}o(UA,"compareTargetScopesBackward");function GT(t,e,r,n,i,a){return HA(t,n,i,a)&&(i==null||Rt(r,n.includeDescendantScopes?t:e,i,a)<0)}o(GT,"shouldYieldScope");function HA(t,e,r,n){let{containment:i,distalPosition:a,allowAdjacentScopes:s,skipAncestorScopes:p}=e,{domain:c}=n;switch(i){case"disallowed":if(c.contains(t))return!1;break;case"disallowedIfStrict":if(lT(c,t))return!1;break;case"required":if(!c.contains(t))return!1;break}return p&&r!=null&&c.contains(r.domain)?!1:VA(new b(t,a),c,s)}o(HA,"checkRequirements");function VA(t,e,r){let n=t.intersection(e);return n==null?!1:!n.isEmpty||r||e.isEmpty}o(VA,"partiallyContains");var BA={containment:null,allowAdjacentScopes:!1,skipAncestorScopes:!1,includeDescendantScopes:!1},he=class{constructor(){this.includeAdjacentInEvery=!1}static{o(this,"BaseScopeHandler")}*generateScopes(e,r,n,i={}){let a={...BA,...i,distalPosition:i.distalPosition??(n==="forward"?e.document.range.end:e.document.range.start)},s,p=r;for(let c of this.generateScopeCandidates(e,r,n,a))if(GT(r,p,n,a,s,c)&&(yield c,s=c,p=n==="forward"?c.domain.end:c.domain.start),this.canStopEarly(r,n,a,s,c))return}canStopEarly(e,r,n,i,a){let{containment:s,distalPosition:p,skipAncestorScopes:c}=n;if(this.isHierarchical&&!c)return!1;let l=this.isHierarchical&&c?i:a;return l==null?!1:!!(s==="required"&&(r==="forward"?l.domain.end.isAfter(e):l.domain.start.isBefore(e))||(r==="forward"?l.domain.end.isAfterOrEqual(p):l.domain.start.isBeforeOrEqual(p)))}};var qe=class extends he{constructor(r,n,i){super();this.scopeHandlerFactory=r;this.scopeType=n;this.languageId=i;this.isHierarchical=!1}static{o(this,"NestedScopeHandler")}get searchScopeType(){return this.iterationScopeType}get searchScopeHandler(){return this._searchScopeHandler==null&&(this._searchScopeHandler=this.scopeHandlerFactory.create(this.searchScopeType,this.languageId)),this._searchScopeHandler}generateScopeCandidates(r,n,i,a){let{containment:s,...p}=a,c=this.searchScopeHandler.generateScopes(r,n,i,{containment:s==="required"?"required":void 0,...p});return pp(c,l=>this.generateScopesInSearchScope(i,l))}};var cp=class extends he{constructor(r,n){super();this.scopeType={type:"line"};this.iterationScopeType={type:"paragraph"};this.isHierarchical=!1;this.includeAdjacentInEvery=!0}static{o(this,"LineScopeHandler")}*generateScopeCandidates(r,n,i){if(i==="forward")for(let a=n.line;a<r.document.lineCount;a++)yield KT(r,a);else for(let a=n.line;a>=0;a--)yield KT(r,a)}};function KT(t,e){let{range:r}=t.document.lineAt(e);return{editor:t,domain:r,getTargets:o(n=>[Fm(t,n,r)],"getTargets")}}o(KT,"lineNumberToScope");function Fm(t,e,r){return new tt({editor:t,isReversed:e,contentRange:fo(t,r)})}o(Fm,"createLineTarget");function fo(t,e){let r=t.document.lineAt(e.start),n=t.document.lineAt(e.end);return new b(r.rangeTrimmed?.start??r.range.start,n.rangeTrimmed?.end??n.range.end)}o(fo,"fitRangeToLineContent");function ut(t,e,r,n){let i=e.document.offsetAt(r.start),a=e.document.getText(r),s=o(p=>new b(e.document.positionAt(i+p.index),e.document.positionAt(i+p.index+p[0].length)),"matchToRange");return t.lastIndex=0,n==="forward"?ke(a.matchAll(t),s):Array.from(a.matchAll(t),s).reverse()}o(ut,"generateMatchesInRange");var lp=class extends qe{constructor(){super(...arguments);this.scopeType={type:"identifier"};this.iterationScopeType={type:"line"};this.regex=$e(this.languageId).identifierMatcher}static{o(this,"IdentifierScopeHandler")}generateScopesInSearchScope(r,{editor:n,domain:i}){return ke(ut(this.regex,n,i,r),a=>({editor:n,domain:a,getTargets:o(s=>[new je({editor:n,contentRange:a,isReversed:s})],"getTargets")}))}};function up(t,e,r){let n=t.editor.document.getText(t.domain),i=e.editor.document.getText(e.domain);for(let a of r){let s=ji(a,n),p=ji(a,i);if(s&&!p)return!0;if(p&&!s)return!1}}o(up,"isPreferredOverHelper");var WA=/\p{L}\p{M}*|[\p{N}\p{P}\p{S}\p{Z}\p{C}]/gu,jA=/[$]/g,$A=/\p{L}\p{M}*|[\p{N}\p{P}\p{S}]/gu,mp=class extends qe{constructor(){super(...arguments);this.scopeType={type:"character"};this.iterationScopeType={type:"token"}}static{o(this,"CharacterScopeHandler")}get searchScopeType(){return{type:"line"}}generateScopesInSearchScope(r,{editor:n,domain:i}){return ke(ut(WA,n,i,r),a=>({editor:n,domain:a,getTargets:o(s=>[new ee({editor:n,contentRange:a,isReversed:s,isToken:!1})],"getTargets")}))}isPreferredOver(r,n){let{identifierMatcher:i}=$e(this.languageId);return up(r,n,[i,jA,$A])}};var qA=/\p{Lu}?\p{Ll}+|\p{Lu}+(?!\p{Ll})|\p{N}+/gu,fp=class{static{o(this,"WordTokenizer")}constructor(e){this.wordRegex=$e(e).wordMatcher}splitIdentifier(e){let r=$i(e,this.wordRegex);return r.length>1?r:$i(e,qA)}};var dp=class extends qe{constructor(){super(...arguments);this.scopeType={type:"word"};this.iterationScopeType={type:"identifier"};this.wordTokenizer=new fp(this.languageId)}static{o(this,"WordScopeHandler")}getScopesInSearchScope({editor:r,domain:n}){let{document:i}=r,a=i.offsetAt(n.start),p=this.wordTokenizer.splitIdentifier(i.getText(n)).map(c=>new b(i.positionAt(a+c.index),i.positionAt(a+c.index+c.text.length)));return p.map((c,l)=>({editor:r,domain:c,getTargets:o(u=>{let m=l>0?p[l-1]:null,f=l+1<p.length?p[l+1]:null;return[zA(u,r,m,c,f)]},"getTargets")}))}generateScopesInSearchScope(r,n){let i=this.getScopesInSearchScope(n);return r==="backward"&&i.reverse(),i}};function zA(t,e,r,n,i){let a=r!=null&&n.start.isAfter(r.end)?new b(r.end,n.start):void 0,s=i!=null&&i.start.isAfter(n.end)?new b(n.end,i.start):void 0,c=a!=null||s!=null?e.document.getText(a??s):"";return new Ls({editor:e,isReversed:t,contentRange:n,insertionDelimiter:c,leadingDelimiterRange:a,trailingDelimiterRange:s})}o(zA,"constructTarget");var GA=/[$]/g,gp=class extends qe{constructor(){super(...arguments);this.scopeType={type:"token"};this.iterationScopeType={type:"line"};this.regex=$e(this.languageId).tokenMatcher}static{o(this,"TokenScopeHandler")}generateScopesInSearchScope(r,{editor:n,domain:i}){return ke(ut(this.regex,n,i,r),a=>({editor:n,domain:a,getTargets:o(s=>[new je({editor:n,contentRange:a,isReversed:s})],"getTargets")}))}isPreferredOver(r,n){let{identifierMatcher:i}=$e(this.languageId);return up(r,n,[i,GA])}};var hp=class extends he{constructor(r,n){super();this.scopeType={type:"document"};this.iterationScopeType={type:"document"};this.isHierarchical=!1}static{o(this,"DocumentScopeHandler")}*generateScopeCandidates(r,n,i){let a=r.document.range;yield{editor:r,domain:a,getTargets:o(s=>[new Is({editor:r,isReversed:s,contentRange:a})],"getTargets")}}};function QT(t,e,r){let n=[],i=[];for(let a of t)i.length===0||e(i[i.length-1],a)?i.push(a):(n.push(r(i)),i=[a]);return i.length>0&&n.push(r(i)),n}o(QT,"mergeAdjacentBy");var ei=class extends he{constructor(r){super();this.query=r}static{o(this,"BaseTreeSitterScopeHandler")}*generateScopeCandidates(r,n,i,a){let{document:s}=r,p=this.query.matches(s).map(c=>this.matchToScope(r,c)).filter(c=>c!=null).sort((c,l)=>Rt(i,n,c,l));yield*QT(p,(c,l)=>c.domain.isRangeEqual(l.domain),c=>c.length===1?c[0]:{...c[0],getTargets(l){let u=Ui(c.flatMap(m=>m.getTargets(l)),(m,f)=>m.isEqual(f));if(u.length>1&&!c.every(m=>m.allowMultiple)){let m="Please use #allow-multiple! predicate in your query to allow multiple matches for this scope type";if(ce(g().messages,"BaseTreeSitterScopeHandler.allow-multiple",m),g().runMode==="test")throw Error(m)}return u}})}};function Im(t,e,r,n){return n?ti(t,`${e}.${r}`,`_.${r}`):ti(t,`${e}.${r}`)??(ti(t,e)!=null?ti(t,`_.${r}`):void 0)}o(Im,"getRelatedCapture");function Kt(t,e,r,n){return Im(t,e,r,n)?.range}o(Kt,"getRelatedRange");function ti(t,...e){return t.captures.find(r=>e.some(n=>r.name===n))}o(ti,"findCaptureByName");var yp=class extends ei{constructor(r,n){super(r);this.iterateeScopeType=n;this.isHierarchical=!0;this.scopeType=void 0}static{o(this,"TreeSitterIterationScopeHandler")}get iterationScopeType(){throw Error("Not implemented")}matchToScope(r,n){let i=this.iterateeScopeType.type,a=Im(n,i,"iteration",!1);if(a==null)return;let{range:s,allowMultiple:p}=a,c=Kt(n,i,"iteration.domain",!1)??s;return{editor:r,domain:c,allowMultiple:p,getTargets:o(l=>[new ee({editor:r,isReversed:l,contentRange:s})],"getTargets")}}};var Tp=class extends ei{constructor(r,n){super(r);this.scopeType=n;this.isHierarchical=!0}static{o(this,"TreeSitterScopeHandler")}get iterationScopeType(){return{type:"custom",scopeHandler:new yp(this.query,this.scopeType)}}matchToScope(r,n){let i=this.scopeType.type,a=ti(n,i);if(a==null)return;let{range:s,allowMultiple:p,insertionDelimiter:c}=a,l=Kt(n,i,"domain",!0)??s,u=Kt(n,i,"removal",!0),m=Kt(n,i,"interior",!0),f=Kt(n,i,"prefix",!0)?.with(void 0,s.start),d=Kt(n,i,"leading",!0)?.with(void 0,f?.start??s.start),y=Kt(n,i,"trailing",!0)?.with(s.end);return{editor:r,domain:l,allowMultiple:p,getTargets:o(T=>[new vr({scopeTypeType:i,editor:r,isReversed:T,contentRange:s,prefixRange:f,removalRange:u,leadingDelimiterRange:d,trailingDelimiterRange:y,interiorRange:m,insertionDelimiter:c})],"getTargets")}}};function ZT(t){return t.flatMap(e=>{let{value:r,done:n}=e.next();return n?[]:[{iterator:e,value:r}]})}o(ZT,"getInitialIteratorInfos");function YT(t,e){return t.flatMap(r=>{let{iterator:n}=r,{value:i}=r,a=!1;for(;!a&&!e(i);)({value:i,done:a}=n.next());return a?[]:[{iterator:n,value:i}]})}o(YT,"advanceIteratorsUntil");var xp=class t extends he{constructor(r,n,i){super();this.scopeType=r;this.scopeHandlers=n;this.getIterationScopeType=i;this.isHierarchical=!0}static{o(this,"OneOfScopeHandler")}static create(r,n,i){let a=n.scopeTypes.map(p=>{let c=r.create(p,i);if(c==null)throw new Error(`No available scope handler for '${p.type}'`);return c}),s=o(()=>({type:"custom",scopeHandler:new t(void 0,a.map(p=>r.create(p.iterationScopeType,i)),()=>{throw new Error("Not implemented")})}),"iterationScopeType");return new t(n,a,s)}get iterationScopeType(){return this.getIterationScopeType()}*generateScopeCandidates(r,n,i,a){let s=this.scopeHandlers.map(c=>c.generateScopes(r,n,i,a)[Symbol.iterator]()),p=ZT(s);for(;p.length>0;){p.sort((l,u)=>Rt(i,n,l.value,u.value));let c=p[0].value;yield c,p=YT(p,l=>Rt(i,n,c,l)<0)}}};var Sp=class extends he{constructor(r,n){super();this.scopeType={type:"paragraph"};this.iterationScopeType={type:"document"};this.isHierarchical=!1}static{o(this,"ParagraphScopeHandler")}*generateScopeCandidates(r,n,i){let{document:a}=r,s=i==="forward"?1:-1,p=i==="forward"?a.lineCount:-1,c=KA(a,n,i),l=r.document.lineAt(n);for(let u=n.line+s;u!==p;u+=s){let m=r.document.lineAt(u);m.isEmptyOrWhitespace?c!=null&&(yield JT(r,c.range.union(l.range)),c=void 0):c==null&&(c=m),l=m}c!=null&&(yield JT(r,c.range.union(l.range)))}};function KA(t,e,r){let n=r==="forward"?-1:1,i=r==="forward"?-1:t.lineCount,a=t.lineAt(e);if(!a.isEmptyOrWhitespace){for(let s=e.line+n;s!==i;s+=n){let p=t.lineAt(s);if(p.isEmptyOrWhitespace)break;a=p}return a}}o(KA,"getStartLine");function JT(t,e){return{editor:t,domain:e,getTargets:o(r=>[new Qn({editor:t,isReversed:r,contentRange:fo(t,e)})],"getTargets")}}o(JT,"createScope");function go(t,e){return e.length>1?e.indexOf(t.slice(-1))>-1:t.slice(-1)===e}o(go,"endsWithChar");function XT(t,e){return t.slice(t.length-e.length)===e}o(XT,"endsWith");var Om,ZA=["al","adj","assn","Ave","BSc","MSc","Cell","Ch","Co","cc","Corp","Dem","Dept","ed","eg","Eq","Eqs","est","est","etc","Ex","ext","Fig","fig","Figs","figs","i.e","ie","Inc","inc","Jan","Feb","Mar","Apr","Jun","Jul","Aug","Sep","Sept","Oct","Nov","Dec","jr","mi","Miss","Mrs","Mr","Ms","Mol","mt","mts","no","Nos","PhD","MD","BA","MA","MM","pl","pop","pp","Prof","Dr","pt","Ref","Refs","Rep","repr","rev","Sec","Secs","Sgt","Col","Gen","Rep","Sen","Gov","Lt","Maj","Capt","St","Sr","sr","Jr","jr","Rev","Sun","Mon","Tu","Tue","Tues","Wed","Th","Thu","Thur","Thurs","Fri","Sat","trans","Univ","Viz","Vol","vs","v"];function ex(t){t?Om=t:Om=ZA}o(ex,"setAbbreviations");function Cm(t){return/^[A-Z][a-z].*/.test(t)||vp(t)}o(Cm,"isCapitalized");function tx(t){return Cm(t)||/``|"|'/.test(t.substring(0,2))}o(tx,"isSentenceStarter");function rx(t){let e=t.replace(/[-'`~!@#$%^&*()_|+=?;:'",.<>{}[\]\\/]/gi,"");return~Om.indexOf(e)}o(rx,"isCommonAbbreviation");function nx(t,e){return(t==="a.m."||t==="p.m.")&&e.replace(/\W+/g,"").slice(-3).toLowerCase()==="day"}o(nx,"isTimeAbbreviation");function Nm(t){let e=t.replace(/[()[]{}]/g,"").match(/(.\.)*/);return e&&e[0].length>0}o(Nm,"isDottedAbbreviation");function ix(t){return t.length<=3?!0:Cm(t)}o(ix,"isCustomAbbreviation");function Lm(t,e){return e.length>0?t<5&&e[0].length<6&&Cm(e[0])?!0:e.filter(function(n){return/[A-Z]/.test(n.charAt(0))}).length>=3:!1}o(Lm,"isNameAbbreviation");function vp(t,e){return e&&(t=t.slice(e-1,e+2)),!isNaN(t)}o(vp,"isNumber");function ox(t){return t.match(/^(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?$/)}o(ox,"isPhoneNr");function ax(t){return t.match(/[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/)}o(ax,"isURL");function sx(t){let e=0;return((e=t.indexOf("."))>-1||(e=t.indexOf("!"))>-1||(e=t.indexOf("?"))>-1)&&t.charAt(e+1).match(/[a-zA-Z].*/)?[t.slice(0,e),t.slice(e+1)]:!1}o(sx,"isConcatenated");function px(t){return t==="."||t==="!"||t==="?"}o(px,"isBoundaryChar");var lx=" @~@ ",cx=lx.trim(),JA=new RegExp("\\S",""),XA=new RegExp("\\n+|[-#=_+*]{4,}","g"),eF=new RegExp("\\S+|\\n","g"),tF={newlineBoundaries:!1,preserveWhitespace:!1,abbreviations:void 0};function ux(t,e){if(!t)return[];if(!JA.test(t))return[];let r={...tF,...e};ex(r.abbreviations),r.newlineBoundaries&&(t=t.replace(XA,lx));let n,i;r.preserveWhitespace?(i=t.split(/(<br\s*\/?>|\S+|\n+)/),n=i.filter(function(m,f){return f%2})):n=t.trim().match(eF)??[];let a=0,s=0,p=[],c=[],l=[];if(!n||!n.length)return[];for(let m=0,f=n.length;m<f;m++){if(a++,l.push(n[m]),~n[m].indexOf(",")&&(a=0),px(n[m])||go(n[m],"?!")||n[m]===cx){r.newlineBoundaries&&n[m]===cx&&l.pop(),c.push(l),a=0,l=[];continue}if((go(n[m],'"')||go(n[m],"\u201D"))&&(n[m]=n[m].slice(0,-1)),go(n[m],".")){if(m+1<f){if(n[m].length===2&&isNaN(n[m].charAt(0))||rx(n[m]))continue;if(tx(n[m+1])){if(nx(n[m],n[m+1])||Lm(a,n.slice(m,6))||vp(n[m+1])&&ix(n[m]))continue}else if(XT(n[m],"..")||Nm(n[m])||Lm(a,n.slice(m,5)))continue}c.push(l),l=[],a=0;continue}(s=n[m].indexOf("."))>-1&&(vp(n[m],s)||Nm(n[m])||ax(n[m])||ox(n[m]))||(p=sx(n[m]))&&(l.pop(),l.push(p[0]),c.push(l),l=[],a=0,l.push(p[1]))}return l.length&&c.push(l),c=c.filter(function(m){return m.length>0}),c.slice(1).reduce(function(m,f){let d=m[m.length-1];return d.length===1&&/^.{1,2}[.]$/.test(d[0])&&!/[.]/.test(f[0])?(m.pop(),m.push(d.concat(f)),m):(m.push(f),m)},[c[0]]).map(function(m,f){if(r.preserveWhitespace&&!r.newlineBoundaries){let d=m.length*2;return f===0&&(d+=1),i.splice(0,d).join("")}return m.join(" ")})}o(ux,"getSentences");var rF=/\S*\p{L}/u,mx=/(\r?\n[^\p{L}]*\r?\n)|(?<=[.!?])(\s*\r?\n)/gu,nF={newlineBoundaries:!1,preserveWhitespace:!0},bp=class{static{o(this,"SentenceSegmenter")}*segment(e){let r=ux(e,nF),n=0;for(let i of r){let a=i.split(mx).filter(s=>s!=null);for(let s of a){if(!oF(s)){let p=iF(s,n);p!=null&&(yield p)}n+=s.length}}}};function iF(t,e){let r=lh(rF,t);if(r==null)return;let n=r.index;return n!==0&&(e+=n,t=t.slice(n)),{text:t.trimEnd(),index:e}}o(iF,"createSegment");function oF(t){return ji(mx,t)}o(oF,"skipPart");var Rp=class extends qe{constructor(){super(...arguments);this.scopeType={type:"sentence"};this.iterationScopeType={type:"paragraph"};this.segmenter=new bp}static{o(this,"SentenceScopeHandler")}generateScopesInSearchScope(r,{editor:n,domain:i}){let a=n.document.offsetAt(i.start),s=n.document.getText(i),p=o(l=>{let u=new b(n.document.positionAt(a+l.index),n.document.positionAt(a+l.index+l.text.length));return{editor:n,domain:u,getTargets:o(m=>[new je({editor:n,contentRange:u,isReversed:m})],"getTargets")}},"sentenceToScope"),c=this.segmenter.segment(s);return r==="forward"?ke(c,p):Array.from(c,p).reverse()}};var ri=class extends qe{constructor(){super(...arguments);this.iterationScopeType={type:"line"}}static{o(this,"RegexStageBase")}generateScopesInSearchScope(r,{editor:n,domain:i}){return ke(ut(this.regex,n,i,r),a=>({editor:n,domain:a,getTargets:o(s=>[new je({editor:n,contentRange:a,isReversed:s})],"getTargets")}))}},wp=class extends ri{constructor(){super(...arguments);this.regex=/\S+/g}static{o(this,"NonWhitespaceSequenceScopeHandler")}},Ep=class extends ri{constructor(r,n,i){super(r,n,i);this.scopeType=n;this.regex=/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/g}static{o(this,"UrlScopeHandler")}},_p=class extends ri{constructor(r,n,i){super(r,n,i);this.scopeType=n}static{o(this,"CustomRegexScopeHandler")}get regex(){return new RegExp(this.scopeType.regex,this.scopeType.flags??"gu")}},kp=class extends ri{constructor(r,n,i){super(r,n,i);this.scopeType=n}static{o(this,"GlyphScopeHandler")}get regex(){return new RegExp(Je(this.scopeType.character),"gui")}};var Pp=class extends he{constructor(r,n,i){super();this.scopeHandlerFactory=r;this.languageId=n;this.targetScopeType=i;this.isHierarchical=!0;this.targetScopeHandler=this.scopeHandlerFactory.create(this.targetScopeType,this.languageId),this.surroundingPairInteriorScopeHandler=this.scopeHandlerFactory.create({type:"surroundingPairInterior",delimiter:"any"},this.languageId)}static{o(this,"BoundedBaseScopeHandler")}get iterationScopeType(){if(this.targetScopeHandler.iterationScopeType.type==="custom")throw Error("Iteration scope type can't be custom for BoundedBaseScopeHandler");return{type:"oneOf",scopeTypes:[this.targetScopeHandler.iterationScopeType,{type:"surroundingPairInterior",delimiter:"any"}]}}*generateScopeCandidates(r,n,i,a){let s=this.targetScopeHandler.generateScopes(r,n,i,{...a,containment:a.containment!=="disallowed"?a.containment:void 0}),p=Array.from(this.surroundingPairInteriorScopeHandler.generateScopes(r,n,i,{...a,containment:a.containment==null&&a.skipAncestorScopes?"required":a.containment}));for(let c of s){let l=[];for(let u of p){let m=c.domain.intersection(u.domain);m!=null&&!m.isEmpty&&l.push({editor:r,domain:m,getTargets:o(f=>[this.getTargets(fx(c,f),fx(u,f))],"getTargets")})}l.push(c),l.sort((u,m)=>Rt(i,n,u,m)),yield*l}}};function fx(t,e){let r=t.getTargets(e);if(r.length!==1)throw Error(`Expected one target but got ${r.length}`);return r[0]}o(fx,"ensureSingleTarget");var Dp=class extends Pp{constructor(r,n,i){super(r,i,{type:"nonWhitespaceSequence"});this.scopeType={type:"boundedNonWhitespaceSequence"}}static{o(this,"BoundedNonWhitespaceSequenceScopeHandler")}getTargets(r,n){let i=r.contentRange.intersection(n.contentRange);if(i==null||i.isEmpty)throw Error("Expected non empty intersection");return new je({editor:r.editor,isReversed:r.isReversed,contentRange:i})}},Mp=class extends Pp{constructor(r,n,i){super(r,i,{type:"paragraph"});this.scopeType={type:"boundedParagraph"}}static{o(this,"BoundedParagraphScopeHandler")}getTargets(r,n){if(!(r instanceof Qn))throw Error("Expected ParagraphTarget");return new Bs({editor:r.editor,isReversed:r.isReversed,paragraphTarget:r,containingInterior:n})}};var Ap=class extends he{constructor(r,n,i){super();this.scopeHandlerFactory=r;this.scopeType=n;this.languageId=i;this.isHierarchical=!0;this.surroundingPairScopeHandler=this.scopeHandlerFactory.create({type:"surroundingPair",delimiter:this.scopeType.delimiter,requireStrongContainment:!0},this.languageId)}static{o(this,"SurroundingPairInteriorScopeHandler")}get iterationScopeType(){return this.surroundingPairScopeHandler.iterationScopeType}*generateScopeCandidates(r,n,i,a){let s=this.surroundingPairScopeHandler.generateScopes(r,n,i,a);for(let p of s)this.scopeType.requireSingleLine&&!p.domain.isSingleLine||(yield{editor:r,domain:p.domain,getTargets(c){return p.getTargets(c).flatMap(l=>l.getInterior())}})}};function dx(t,{openingDelimiterRange:e,closingDelimiterRange:r},n){let i=e.union(r),a=new b(e.end,r.start);return{editor:t,domain:n?a:i,getTargets:o(s=>[new Us({editor:t,isReversed:s,contentRange:i,interiorRange:a,boundary:[e,r]})],"getTargets")}}o(dx,"createTargetScope");function gx(t){let e=$t(t.map(({text:r})=>r)).map(Je).join("|");return new RegExp(`(?<!\\\\)(${e})`,"gu")}o(gx,"getDelimiterRegex");function hx(t,e,r){if(r.length===0)return[];let n=gx(r),i=t?.getCaptures(e,"disqualifyDelimiter")??[],a=t?.getCaptures(e,"textFragment")??[],s=Object.fromEntries(r.map(c=>[c.text,c])),p=e.getText();return st(p,n,c=>{let l=c[0],u=new b(e.positionAt(c.index),e.positionAt(c.index+l.length)),m=i.some(d=>d.range.contains(u)&&!d.hasError()),f=a.find(d=>d.range.contains(u))?.range;return{delimiterInfo:s[l],isDisqualified:m,textFragmentRange:f,range:u}})}o(hx,"getDelimiterOccurrences");var Ip=Object.freeze({angleBrackets:[["</","<"],[">","/>"]],backtickQuotes:["`","`"],curlyBrackets:[["{","${"],"}"],tripleDoubleQuotes:[[],[]],tripleSingleQuotes:[[],[]],doubleQuotes:['"','"',{isSingleLine:!0}],escapedDoubleQuotes:['\\"','\\"',{isSingleLine:!0}],escapedParentheses:["\\(","\\)"],escapedSquareBrackets:["\\[","\\]"],escapedSingleQuotes:["\\'","\\'",{isSingleLine:!0}],parentheses:[["(","$("],")"],singleQuotes:["'","'",{isSingleLine:!0}],squareBrackets:["[","]"]}),Fp=["","r","u","R","U","f","F","fr","Fr","fR","FR","rf","rF","Rf","RF","b","B","br","Br","bR","BR","rb","rB","Rb","RB"],yx={nix:{singleQuotes:["''","''"]},lua:{doubleQuotes:[['"',"[["],['"',"]]"]]},python:{singleQuotes:[Fp.map(t=>`${t}'`),"'",{isSingleLine:!0,isUnknownSide:!0}],doubleQuotes:[Fp.map(t=>`${t}"`),'"',{isSingleLine:!0,isUnknownSide:!0}],tripleSingleQuotes:[Fp.map(t=>`${t}'''`),"'''",{isUnknownSide:!0}],tripleDoubleQuotes:[Fp.map(t=>`${t}"""`),'"""',{isUnknownSide:!0}]},ruby:{tripleDoubleQuotes:["%Q(",")"]}},Ioe=Object.fromEntries(Object.values(Ip)),Tx={any:gr(Ip),string:["tripleDoubleQuotes","tripleSingleQuotes","doubleQuotes","singleQuotes","backtickQuotes"],collectionBoundary:["parentheses","squareBrackets","curlyBrackets","angleBrackets"]};function xx(t){return t!=null&&t in yx?{...Ip,...yx[t]}:Ip}o(xx,"getSimpleDelimiterMap");function Sx(t,e){let r=Tx[t]??[t];return aF(e,r)}o(Sx,"getIndividualDelimiters");function aF(t,e){let r=xx(t);return e.flatMap(n=>{let[i,a,s]=r[n],{isSingleLine:p=!1,isUnknownSide:c=!1}=s??{},l=eo(i)?[i]:i,u=eo(a)?[a]:a;return $t(Ni(l,u)).map(f=>{let d=l.includes(f),y=u.includes(f);return{text:f,side:c?"unknown":d&&!y?"left":!d&&y?"right":"unknown",delimiterName:n,isSingleLine:p}})})}o(aF,"getSimpleIndividualDelimiters");function vx(t){let e=[],r=new dr(()=>[]);for(let n of t){let{delimiterInfo:{delimiterName:i,side:a,isSingleLine:s},isDisqualified:p,textFragmentRange:c,range:l}=n;if(p)continue;let u=r.get(i);s&&(u=u.filter(f=>f.range.start.line===l.start.line),r.set(i,u));let m=u.filter(f=>c==null&&f.textFragmentRange==null||c!=null&&f.textFragmentRange!=null&&f.textFragmentRange.isRangeEqual(c));if(a==="left"||a==="unknown"&&m.length%2===0)u.push(n);else{let f=m.at(-1);if(f==null)continue;u.splice(u.lastIndexOf(f),1),e.push({delimiterName:i,openingDelimiterRange:f.range,closingDelimiterRange:l})}}return e}o(vx,"getSurroundingPairOccurrences");var Op=class extends he{constructor(r,n,i){super();this.languageDefinitions=r;this.scopeType=n;this.languageId=i;this.iterationScopeType={type:"line"};this.isHierarchical=!0}static{o(this,"SurroundingPairScopeHandler")}*generateScopeCandidates(r,n,i,a){if(this.scopeType.forceDirection!=null){ce(g().messages,"deprecatedForceDirection","forceDirection is deprecated. If this is important to you please file an issue on the cursorless repo.");return}let s=hx(this.languageDefinitions.get(this.languageId),r.document,Sx(this.scopeType.delimiter,this.languageId)),p=vx(s);p=sF(i,a,n,p),yield*p.map(c=>dx(r,c,this.scopeType.requireStrongContainment??!1)).sort((c,l)=>Rt(i,n,c,l))}};function sF(t,e,r,n){return t==="forward"&&e.containment==="required"&&e.allowAdjacentScopes&&e.skipAncestorScopes?n.filter((i,a)=>!(i.closingDelimiterRange.end.isEqual(r)&&n[a+1]?.closingDelimiterRange.start.isEqual(r))):n}o(sF,"maybeApplyEmptyTargetHack");var ni=class{constructor(e){this.languageDefinitions=e;this.create=this.create.bind(this)}static{o(this,"ScopeHandlerFactoryImpl")}create(e,r){switch(e.type){case"character":return new mp(this,e,r);case"word":return new dp(this,e,r);case"token":return new gp(this,e,r);case"identifier":return new lp(this,e,r);case"line":return new cp(e,r);case"sentence":return new Rp(this,e,r);case"paragraph":return new Sp(e,r);case"boundedParagraph":return new Mp(this,e,r);case"document":return new hp(e,r);case"oneOf":return xp.create(this,e,r);case"nonWhitespaceSequence":return new wp(this,e,r);case"boundedNonWhitespaceSequence":return new Dp(this,e,r);case"url":return new Ep(this,e,r);case"customRegex":return new _p(this,e,r);case"glyph":return new kp(this,e,r);case"surroundingPair":return new Op(this.languageDefinitions,e,r);case"surroundingPairInterior":return new Ap(this,e,r);case"custom":return e.scopeHandler;case"instance":throw Error("Unexpected scope type 'instance'");default:return this.languageDefinitions.get(r)?.getScopeHandler(e)}}};function mt(t,e){return new b(t.row,t.column,e.row,e.column)}o(mt,"makeRangeFromPositions");function Um(t){return new B(t.row,t.column)}o(Um,"positionFromPoint");function bx(t){return new b(t.startPosition.row,t.startPosition.column,t.endPosition.row,t.endPosition.column)}o(bx,"getNodeRange");function Rx(t,e){return new q(t.startPosition.row,t.startPosition.column,e.endPosition.row,e.endPosition.column)}o(Rx,"makeNodePairSelection");function Ct(t,e){return{selection:new q(new B(e.startPosition.row,e.startPosition.column),new B(e.endPosition.row,e.endPosition.column)),context:{}}}o(Ct,"simpleSelectionExtractor");function pF(t,e,r){let n=e.startIndex<r.startIndex,i=n?e:r,a=n?r:e;return{selection:new q(new B(i.startPosition.row,i.startPosition.column),new B(a.endPosition.row,a.endPosition.column)),context:{}}}o(pF,"pairSelectionExtractor");function wx(){return ho(t=>t.type===","||t.type==="("||t.type===")"||t.type==="["||t.type==="]"||t.type===">"||t.type==="<"||t.type==="}"||t.type==="{",", ")}o(wx,"argumentSelectionExtractor");function Ex(t,e){let r=e.startIndex,n=e.endIndex;return e.text.startsWith("(")&&e.text.endsWith(")")?(r+=1,n-=1):e.text.endsWith(";")&&(n-=1),{selection:new q(t.document.positionAt(r),t.document.positionAt(n)),context:{}}}o(Ex,"unwrapSelectionExtractor");function _x(...t){return function(e,r){let n=r.previousSibling,i=n?.previousSibling,a;return n&&(t.includes(n.type)?i?a=mt(i.endPosition,r.startPosition):a=mt(n.startPosition,r.startPosition):a=mt(n.endPosition,r.startPosition)),{...Ct(e,r),context:{leadingDelimiterRange:a}}}}o(_x,"selectWithLeadingDelimiter");function Nt(t=[],e=[],{includeUnnamedChildren:r=!1}={}){return function(n,i){if(t.length>0&&e.length>0)throw new Error("Cannot have both exclusions and inclusions.");let a=r?i.children:i.namedChildren,s=new Set(t),p=new Set(e);return a=a.filter(c=>s.size>0?!s.has(c.type):p.size>0?p.has(c.type):!0),pF(n,a[0],a[a.length-1])}}o(Nt,"childRangeSelector");function kx(...t){return function(e,r){let n=r.nextSibling,i=n?.nextSibling,a;return n&&(t.includes(n.type)?i?a=mt(r.endPosition,i.startPosition):a=mt(r.endPosition,n.endPosition):a=mt(r.endPosition,n.startPosition)),{...Ct(e,r),context:{trailingDelimiterRange:a}}}}o(kx,"selectWithTrailingDelimiter");function cF(t,e){let r=t.nextSibling;for(;r!=null;){if(!e(r))return r;r=r.nextSibling}return r}o(cF,"getNextNonDelimiterNode");function lF(t,e){let r=t.previousSibling;for(;r!=null;){if(!e(r))return r;r=r.previousSibling}return r}o(lF,"getPreviousNonDelimiterNode");function ho(t,e,r=Pe,n=Pe){return(i,a)=>{let s,p,c=r(a),l=n(a),u=lF(c,t),m=cF(l,t);u!=null&&(s=mt(u.endPosition,c.startPosition)),m!=null&&(p=mt(l.endPosition,m.startPosition));let f=uF(i,s,p,e);return{selection:new q(new B(c.startPosition.row,c.startPosition.column),new B(l.endPosition.row,l.endPosition.column)),context:{containingListDelimiter:f,leadingDelimiterRange:s,trailingDelimiterRange:p}}}}o(ho,"delimitedSelector");function uF(t,e,r,n){let{document:i}=t,a=[r!=null?i.getText(r):n,e!=null?i.getText(e):n];return hu(a,"length")}o(uF,"getInsertionDelimiter");function Px(t,e){if(t.length===1)return!0;let r=!1,n=t.filter(({name:c})=>c.endsWith(".start")).map(({range:{end:c}})=>c).sort((c,l)=>c.compareTo(l)).at(-1),i=t.filter(({name:c})=>c.endsWith(".end")).map(({range:{start:c}})=>c).sort((c,l)=>c.compareTo(l)).at(0);n!=null&&i!=null&&n.isAfter(i)&&(ce(e,"TreeSitterQuery.checkCaptures.badOrder",`Start capture must be before end capture: ${t}`),r=!0);let a=t.filter(({name:c})=>c.endsWith(".start")).length,s=t.filter(({name:c})=>c.endsWith(".end")).length,p=t.length-a-s;return p>0&&(a>0||s>0)&&(ce(e,"TreeSitterQuery.checkCaptures.mixRegularStartEnd",`Please do not mix regular captures and start/end captures: ${t.map(({name:c,range:l})=>c+" "+l.toString())}`),r=!0),p>1&&(ce(e,"TreeSitterQuery.checkCaptures.duplicate",`A capture with the same name may only appear once in a single pattern: ${t.map(({name:c,range:l})=>c+" "+l.toString())}`),r=!0),!r}o(Px,"checkCaptureStartEnd");function Dx(t){let e=t;for(;e!=null;){if(e.hasError)return!0;e=e.parent}return!1}o(Dx,"isContainedInErrorNode");var Q;(function(t){t.assertEqual=i=>i;function e(i){}o(e,"assertIs"),t.assertIs=e;function r(i){throw new Error}o(r,"assertNever"),t.assertNever=r,t.arrayToEnum=i=>{let a={};for(let s of i)a[s]=s;return a},t.getValidEnumValues=i=>{let a=t.objectKeys(i).filter(p=>typeof i[i[p]]!="number"),s={};for(let p of a)s[p]=i[p];return t.objectValues(s)},t.objectValues=i=>t.objectKeys(i).map(function(a){return i[a]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{let a=[];for(let s in i)Object.prototype.hasOwnProperty.call(i,s)&&a.push(s);return a},t.find=(i,a)=>{for(let s of i)if(a(s))return s},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function n(i,a=" | "){return i.map(s=>typeof s=="string"?`'${s}'`:s).join(a)}o(n,"joinValues"),t.joinValues=n,t.jsonStringifyReplacer=(i,a)=>typeof a=="bigint"?a.toString():a})(Q||(Q={}));var Vm;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(Vm||(Vm={}));var F=Q.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Rr=o(t=>{switch(typeof t){case"undefined":return F.undefined;case"string":return F.string;case"number":return isNaN(t)?F.nan:F.number;case"boolean":return F.boolean;case"function":return F.function;case"bigint":return F.bigint;case"symbol":return F.symbol;case"object":return Array.isArray(t)?F.array:t===null?F.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?F.promise:typeof Map<"u"&&t instanceof Map?F.map:typeof Set<"u"&&t instanceof Set?F.set:typeof Date<"u"&&t instanceof Date?F.date:F.object;default:return F.unknown}},"getParsedType"),_=Q.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),mF=o(t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),"quotelessJson"),rt=class t extends Error{static{o(this,"ZodError")}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let r=e||function(a){return a.message},n={_errors:[]},i=o(a=>{for(let s of a.issues)if(s.code==="invalid_union")s.unionErrors.map(i);else if(s.code==="invalid_return_type")i(s.returnTypeError);else if(s.code==="invalid_arguments")i(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let p=n,c=0;for(;c<s.path.length;){let l=s.path[c];c===s.path.length-1?(p[l]=p[l]||{_errors:[]},p[l]._errors.push(r(s))):p[l]=p[l]||{_errors:[]},p=p[l],c++}}},"processError");return i(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Q.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let i of this.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};rt.create=t=>new rt(t);var ai=o((t,e)=>{let r;switch(t.code){case _.invalid_type:t.received===F.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case _.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,Q.jsonStringifyReplacer)}`;break;case _.unrecognized_keys:r=`Unrecognized key(s) in object: ${Q.joinValues(t.keys,", ")}`;break;case _.invalid_union:r="Invalid input";break;case _.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Q.joinValues(t.options)}`;break;case _.invalid_enum_value:r=`Invalid enum value. Expected ${Q.joinValues(t.options)}, received '${t.received}'`;break;case _.invalid_arguments:r="Invalid function arguments";break;case _.invalid_return_type:r="Invalid function return type";break;case _.invalid_date:r="Invalid date";break;case _.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:Q.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case _.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case _.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case _.custom:r="Invalid input";break;case _.invalid_intersection_types:r="Intersection results could not be merged";break;case _.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case _.not_finite:r="Number must be finite";break;default:r=e.defaultError,Q.assertNever(t)}return{message:r}},"errorMap"),Fx=ai;function fF(t){Fx=t}o(fF,"setErrorMap");function Cp(){return Fx}o(Cp,"getErrorMap");var Np=o(t=>{let{data:e,path:r,errorMaps:n,issueData:i}=t,a=[...r,...i.path||[]],s={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let p="",c=n.filter(l=>!!l).slice().reverse();for(let l of c)p=l(s,{data:e,defaultError:p}).message;return{...i,path:a,message:p}},"makeIssue"),dF=[];function M(t,e){let r=Cp(),n=Np({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===ai?void 0:ai].filter(i=>!!i)});t.common.issues.push(n)}o(M,"addIssueToContext");var Me=class t{static{o(this,"ParseStatus")}constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let n=[];for(let i of r){if(i.status==="aborted")return H;i.status==="dirty"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let i of r){let a=await i.key,s=await i.value;n.push({key:a,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let i of r){let{key:a,value:s}=i;if(a.status==="aborted"||s.status==="aborted")return H;a.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof s.value<"u"||i.alwaysSet)&&(n[a.value]=s.value)}return{status:e.value,value:n}}},H=Object.freeze({status:"aborted"}),oi=o(t=>({status:"dirty",value:t}),"DIRTY"),Ne=o(t=>({status:"valid",value:t}),"OK"),Bm=o(t=>t.status==="aborted","isAborted"),Wm=o(t=>t.status==="dirty","isDirty"),xo=o(t=>t.status==="valid","isValid"),So=o(t=>typeof Promise<"u"&&t instanceof Promise,"isAsync");function Lp(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)}o(Lp,"__classPrivateFieldGet");function Ix(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r}o(Ix,"__classPrivateFieldSet");var O;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(O||(O={}));var yo,To,dt=class{static{o(this,"ParseInputLazyPath")}constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Mx=o((t,e)=>{if(xo(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new rt(t.common.issues);return this._error=r,this._error}}},"handleResult");function W(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:o((s,p)=>{var c,l;let{message:u}=t;return s.code==="invalid_enum_value"?{message:u??p.defaultError}:typeof p.data>"u"?{message:(c=u??n)!==null&&c!==void 0?c:p.defaultError}:s.code!=="invalid_type"?{message:p.defaultError}:{message:(l=u??r)!==null&&l!==void 0?l:p.defaultError}},"customMap"),description:i}}o(W,"processCreateParams");var j=class{static{o(this,"ZodType")}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Rr(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Rr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Me,ctx:{common:e.parent.common,data:e.data,parsedType:Rr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(So(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){var n;let i={common:{issues:[],async:(n=r?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Rr(e)},a=this._parseSync({data:e,path:i.path,parent:i});return Mx(i,a)}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Rr(e)},i=this._parse({data:e,path:n.path,parent:n}),a=await(So(i)?i:Promise.resolve(i));return Mx(n,a)}refine(e,r){let n=o(i=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(i):r,"getIssueProperties");return this._refinement((i,a)=>{let s=e(i),p=o(()=>a.addIssue({code:_.custom,...n(i)}),"setError");return typeof Promise<"u"&&s instanceof Promise?s.then(c=>c?!0:(p(),!1)):s?!0:(p(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r=="function"?r(n,i):r),!1))}_refinement(e){return new nt({schema:this,typeName:U.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return ft.create(this,this._def)}nullable(){return Ut.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Yt.create(this,this._def)}promise(){return _r.create(this,this._def)}or(e){return tn.create([this,e],this._def)}and(e){return rn.create(this,e,this._def)}transform(e){return new nt({...W(this._def),schema:this,typeName:U.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new pn({...W(this._def),innerType:this,defaultValue:r,typeName:U.ZodDefault})}brand(){return new vo({typeName:U.ZodBranded,type:this,...W(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new cn({...W(this._def),innerType:this,catchValue:r,typeName:U.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return bo.create(this,e)}readonly(){return ln.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},gF=/^c[^\s-]{8,}$/i,hF=/^[0-9a-z]+$/,yF=/^[0-9A-HJKMNP-TV-Z]{26}$/,TF=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,xF=/^[a-z0-9_-]{21}$/i,SF=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,vF=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,bF="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Hm,RF=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,wF=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,EF=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Ox="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",_F=new RegExp(`^${Ox}$`);function Cx(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}o(Cx,"timeRegexSource");function kF(t){return new RegExp(`^${Cx(t)}$`)}o(kF,"timeRegex");function Nx(t){let e=`${Ox}T${Cx(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}o(Nx,"datetimeRegex");function PF(t,e){return!!((e==="v4"||!e)&&RF.test(t)||(e==="v6"||!e)&&wF.test(t))}o(PF,"isValidIP");var wr=class t extends j{static{o(this,"ZodString")}_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==F.string){let a=this._getOrReturnCtx(e);return M(a,{code:_.invalid_type,expected:F.string,received:a.parsedType}),H}let n=new Me,i;for(let a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(i=this._getOrReturnCtx(e,i),M(i,{code:_.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="max")e.data.length>a.value&&(i=this._getOrReturnCtx(e,i),M(i,{code:_.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="length"){let s=e.data.length>a.value,p=e.data.length<a.value;(s||p)&&(i=this._getOrReturnCtx(e,i),s?M(i,{code:_.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):p&&M(i,{code:_.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind==="email")vF.test(e.data)||(i=this._getOrReturnCtx(e,i),M(i,{validation:"email",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind==="emoji")Hm||(Hm=new RegExp(bF,"u")),Hm.test(e.data)||(i=this._getOrReturnCtx(e,i),M(i,{validation:"emoji",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind==="uuid")TF.test(e.data)||(i=this._getOrReturnCtx(e,i),M(i,{validation:"uuid",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind==="nanoid")xF.test(e.data)||(i=this._getOrReturnCtx(e,i),M(i,{validation:"nanoid",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid")gF.test(e.data)||(i=this._getOrReturnCtx(e,i),M(i,{validation:"cuid",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid2")hF.test(e.data)||(i=this._getOrReturnCtx(e,i),M(i,{validation:"cuid2",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind==="ulid")yF.test(e.data)||(i=this._getOrReturnCtx(e,i),M(i,{validation:"ulid",code:_.invalid_string,message:a.message}),n.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),M(i,{validation:"url",code:_.invalid_string,message:a.message}),n.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),M(i,{validation:"regex",code:_.invalid_string,message:a.message}),n.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(e,i),M(i,{code:_.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(i=this._getOrReturnCtx(e,i),M(i,{code:_.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(i=this._getOrReturnCtx(e,i),M(i,{code:_.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind==="datetime"?Nx(a).test(e.data)||(i=this._getOrReturnCtx(e,i),M(i,{code:_.invalid_string,validation:"datetime",message:a.message}),n.dirty()):a.kind==="date"?_F.test(e.data)||(i=this._getOrReturnCtx(e,i),M(i,{code:_.invalid_string,validation:"date",message:a.message}),n.dirty()):a.kind==="time"?kF(a).test(e.data)||(i=this._getOrReturnCtx(e,i),M(i,{code:_.invalid_string,validation:"time",message:a.message}),n.dirty()):a.kind==="duration"?SF.test(e.data)||(i=this._getOrReturnCtx(e,i),M(i,{validation:"duration",code:_.invalid_string,message:a.message}),n.dirty()):a.kind==="ip"?PF(e.data,a.version)||(i=this._getOrReturnCtx(e,i),M(i,{validation:"ip",code:_.invalid_string,message:a.message}),n.dirty()):a.kind==="base64"?EF.test(e.data)||(i=this._getOrReturnCtx(e,i),M(i,{validation:"base64",code:_.invalid_string,message:a.message}),n.dirty()):Q.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:_.invalid_string,...O.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...O.errToObj(e)})}url(e){return this._addCheck({kind:"url",...O.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...O.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...O.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...O.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...O.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...O.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...O.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...O.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...O.errToObj(e)})}datetime(e){var r,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(r=e?.offset)!==null&&r!==void 0?r:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...O.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...O.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...O.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...O.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...O.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...O.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...O.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...O.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...O.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...O.errToObj(r)})}nonempty(e){return this.min(1,O.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};wr.create=t=>{var e;return new wr({checks:[],typeName:U.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...W(t)})};function DF(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=r>n?r:n,a=parseInt(t.toFixed(i).replace(".","")),s=parseInt(e.toFixed(i).replace(".",""));return a%s/Math.pow(10,i)}o(DF,"floatSafeRemainder");var Qr=class t extends j{static{o(this,"ZodNumber")}constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==F.number){let a=this._getOrReturnCtx(e);return M(a,{code:_.invalid_type,expected:F.number,received:a.parsedType}),H}let n,i=new Me;for(let a of this._def.checks)a.kind==="int"?Q.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),M(n,{code:_.invalid_type,expected:"integer",received:"float",message:a.message}),i.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),M(n,{code:_.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),M(n,{code:_.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="multipleOf"?DF(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),M(n,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),M(n,{code:_.not_finite,message:a.message}),i.dirty()):Q.assertNever(a);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,O.toString(r))}gt(e,r){return this.setLimit("min",e,!1,O.toString(r))}lte(e,r){return this.setLimit("max",e,!0,O.toString(r))}lt(e,r){return this.setLimit("max",e,!1,O.toString(r))}setLimit(e,r,n,i){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:O.toString(i)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:O.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:O.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:O.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:O.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:O.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:O.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:O.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:O.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:O.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Q.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}};Qr.create=t=>new Qr({checks:[],typeName:U.ZodNumber,coerce:t?.coerce||!1,...W(t)});var Zr=class t extends j{static{o(this,"ZodBigInt")}constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==F.bigint){let a=this._getOrReturnCtx(e);return M(a,{code:_.invalid_type,expected:F.bigint,received:a.parsedType}),H}let n,i=new Me;for(let a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),M(n,{code:_.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),M(n,{code:_.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),M(n,{code:_.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):Q.assertNever(a);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,O.toString(r))}gt(e,r){return this.setLimit("min",e,!1,O.toString(r))}lte(e,r){return this.setLimit("max",e,!0,O.toString(r))}lt(e,r){return this.setLimit("max",e,!1,O.toString(r))}setLimit(e,r,n,i){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:O.toString(i)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:O.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:O.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:O.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:O.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:O.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Zr.create=t=>{var e;return new Zr({checks:[],typeName:U.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...W(t)})};var Yr=class extends j{static{o(this,"ZodBoolean")}_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==F.boolean){let n=this._getOrReturnCtx(e);return M(n,{code:_.invalid_type,expected:F.boolean,received:n.parsedType}),H}return Ne(e.data)}};Yr.create=t=>new Yr({typeName:U.ZodBoolean,coerce:t?.coerce||!1,...W(t)});var Jr=class t extends j{static{o(this,"ZodDate")}_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==F.date){let a=this._getOrReturnCtx(e);return M(a,{code:_.invalid_type,expected:F.date,received:a.parsedType}),H}if(isNaN(e.data.getTime())){let a=this._getOrReturnCtx(e);return M(a,{code:_.invalid_date}),H}let n=new Me,i;for(let a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(i=this._getOrReturnCtx(e,i),M(i,{code:_.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),n.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(i=this._getOrReturnCtx(e,i),M(i,{code:_.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),n.dirty()):Q.assertNever(a);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:O.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:O.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};Jr.create=t=>new Jr({checks:[],coerce:t?.coerce||!1,typeName:U.ZodDate,...W(t)});var si=class extends j{static{o(this,"ZodSymbol")}_parse(e){if(this._getType(e)!==F.symbol){let n=this._getOrReturnCtx(e);return M(n,{code:_.invalid_type,expected:F.symbol,received:n.parsedType}),H}return Ne(e.data)}};si.create=t=>new si({typeName:U.ZodSymbol,...W(t)});var Xr=class extends j{static{o(this,"ZodUndefined")}_parse(e){if(this._getType(e)!==F.undefined){let n=this._getOrReturnCtx(e);return M(n,{code:_.invalid_type,expected:F.undefined,received:n.parsedType}),H}return Ne(e.data)}};Xr.create=t=>new Xr({typeName:U.ZodUndefined,...W(t)});var en=class extends j{static{o(this,"ZodNull")}_parse(e){if(this._getType(e)!==F.null){let n=this._getOrReturnCtx(e);return M(n,{code:_.invalid_type,expected:F.null,received:n.parsedType}),H}return Ne(e.data)}};en.create=t=>new en({typeName:U.ZodNull,...W(t)});var Er=class extends j{static{o(this,"ZodAny")}constructor(){super(...arguments),this._any=!0}_parse(e){return Ne(e.data)}};Er.create=t=>new Er({typeName:U.ZodAny,...W(t)});var Zt=class extends j{static{o(this,"ZodUnknown")}constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ne(e.data)}};Zt.create=t=>new Zt({typeName:U.ZodUnknown,...W(t)});var wt=class extends j{static{o(this,"ZodNever")}_parse(e){let r=this._getOrReturnCtx(e);return M(r,{code:_.invalid_type,expected:F.never,received:r.parsedType}),H}};wt.create=t=>new wt({typeName:U.ZodNever,...W(t)});var pi=class extends j{static{o(this,"ZodVoid")}_parse(e){if(this._getType(e)!==F.undefined){let n=this._getOrReturnCtx(e);return M(n,{code:_.invalid_type,expected:F.void,received:n.parsedType}),H}return Ne(e.data)}};pi.create=t=>new pi({typeName:U.ZodVoid,...W(t)});var Yt=class t extends j{static{o(this,"ZodArray")}_parse(e){let{ctx:r,status:n}=this._processInputParams(e),i=this._def;if(r.parsedType!==F.array)return M(r,{code:_.invalid_type,expected:F.array,received:r.parsedType}),H;if(i.exactLength!==null){let s=r.data.length>i.exactLength.value,p=r.data.length<i.exactLength.value;(s||p)&&(M(r,{code:s?_.too_big:_.too_small,minimum:p?i.exactLength.value:void 0,maximum:s?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(i.minLength!==null&&r.data.length<i.minLength.value&&(M(r,{code:_.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),i.maxLength!==null&&r.data.length>i.maxLength.value&&(M(r,{code:_.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((s,p)=>i.type._parseAsync(new dt(r,s,r.path,p)))).then(s=>Me.mergeArray(n,s));let a=[...r.data].map((s,p)=>i.type._parseSync(new dt(r,s,r.path,p)));return Me.mergeArray(n,a)}get element(){return this._def.type}min(e,r){return new t({...this._def,minLength:{value:e,message:O.toString(r)}})}max(e,r){return new t({...this._def,maxLength:{value:e,message:O.toString(r)}})}length(e,r){return new t({...this._def,exactLength:{value:e,message:O.toString(r)}})}nonempty(e){return this.min(1,e)}};Yt.create=(t,e)=>new Yt({type:t,minLength:null,maxLength:null,exactLength:null,typeName:U.ZodArray,...W(e)});function ii(t){if(t instanceof ze){let e={};for(let r in t.shape){let n=t.shape[r];e[r]=ft.create(ii(n))}return new ze({...t._def,shape:o(()=>e,"shape")})}else return t instanceof Yt?new Yt({...t._def,type:ii(t.element)}):t instanceof ft?ft.create(ii(t.unwrap())):t instanceof Ut?Ut.create(ii(t.unwrap())):t instanceof Lt?Lt.create(t.items.map(e=>ii(e))):t}o(ii,"deepPartialify");var ze=class t extends j{static{o(this,"ZodObject")}constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=Q.objectKeys(e);return this._cached={shape:e,keys:r}}_parse(e){if(this._getType(e)!==F.object){let l=this._getOrReturnCtx(e);return M(l,{code:_.invalid_type,expected:F.object,received:l.parsedType}),H}let{status:n,ctx:i}=this._processInputParams(e),{shape:a,keys:s}=this._getCached(),p=[];if(!(this._def.catchall instanceof wt&&this._def.unknownKeys==="strip"))for(let l in i.data)s.includes(l)||p.push(l);let c=[];for(let l of s){let u=a[l],m=i.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new dt(i,m,i.path,l)),alwaysSet:l in i.data})}if(this._def.catchall instanceof wt){let l=this._def.unknownKeys;if(l==="passthrough")for(let u of p)c.push({key:{status:"valid",value:u},value:{status:"valid",value:i.data[u]}});else if(l==="strict")p.length>0&&(M(i,{code:_.unrecognized_keys,keys:p}),n.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let l=this._def.catchall;for(let u of p){let m=i.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new dt(i,m,i.path,u)),alwaysSet:u in i.data})}}return i.common.async?Promise.resolve().then(async()=>{let l=[];for(let u of c){let m=await u.key,f=await u.value;l.push({key:m,value:f,alwaysSet:u.alwaysSet})}return l}).then(l=>Me.mergeObjectSync(n,l)):Me.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return O.errToObj,new t({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:o((r,n)=>{var i,a,s,p;let c=(s=(a=(i=this._def).errorMap)===null||a===void 0?void 0:a.call(i,r,n).message)!==null&&s!==void 0?s:n.defaultError;return r.code==="unrecognized_keys"?{message:(p=O.errToObj(e).message)!==null&&p!==void 0?p:c}:{message:c}},"errorMap")}:{}})}strip(){return new t({...this._def,unknownKeys:"strip"})}passthrough(){return new t({...this._def,unknownKeys:"passthrough"})}extend(e){return new t({...this._def,shape:o(()=>({...this._def.shape(),...e}),"shape")})}merge(e){return new t({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:o(()=>({...this._def.shape(),...e._def.shape()}),"shape"),typeName:U.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new t({...this._def,catchall:e})}pick(e){let r={};return Q.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new t({...this._def,shape:o(()=>r,"shape")})}omit(e){let r={};return Q.objectKeys(this.shape).forEach(n=>{e[n]||(r[n]=this.shape[n])}),new t({...this._def,shape:o(()=>r,"shape")})}deepPartial(){return ii(this)}partial(e){let r={};return Q.objectKeys(this.shape).forEach(n=>{let i=this.shape[n];e&&!e[n]?r[n]=i:r[n]=i.optional()}),new t({...this._def,shape:o(()=>r,"shape")})}required(e){let r={};return Q.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])r[n]=this.shape[n];else{let a=this.shape[n];for(;a instanceof ft;)a=a._def.innerType;r[n]=a}}),new t({...this._def,shape:o(()=>r,"shape")})}keyof(){return Lx(Q.objectKeys(this.shape))}};ze.create=(t,e)=>new ze({shape:o(()=>t,"shape"),unknownKeys:"strip",catchall:wt.create(),typeName:U.ZodObject,...W(e)});ze.strictCreate=(t,e)=>new ze({shape:o(()=>t,"shape"),unknownKeys:"strict",catchall:wt.create(),typeName:U.ZodObject,...W(e)});ze.lazycreate=(t,e)=>new ze({shape:t,unknownKeys:"strip",catchall:wt.create(),typeName:U.ZodObject,...W(e)});var tn=class extends j{static{o(this,"ZodUnion")}_parse(e){let{ctx:r}=this._processInputParams(e),n=this._def.options;function i(a){for(let p of a)if(p.result.status==="valid")return p.result;for(let p of a)if(p.result.status==="dirty")return r.common.issues.push(...p.ctx.common.issues),p.result;let s=a.map(p=>new rt(p.ctx.common.issues));return M(r,{code:_.invalid_union,unionErrors:s}),H}if(o(i,"handleResults"),r.common.async)return Promise.all(n.map(async a=>{let s={...r,common:{...r.common,issues:[]},parent:null};return{result:await a._parseAsync({data:r.data,path:r.path,parent:s}),ctx:s}})).then(i);{let a,s=[];for(let c of n){let l={...r,common:{...r.common,issues:[]},parent:null},u=c._parseSync({data:r.data,path:r.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!a&&(a={result:u,ctx:l}),l.common.issues.length&&s.push(l.common.issues)}if(a)return r.common.issues.push(...a.ctx.common.issues),a.result;let p=s.map(c=>new rt(c));return M(r,{code:_.invalid_union,unionErrors:p}),H}}get options(){return this._def.options}};tn.create=(t,e)=>new tn({options:t,typeName:U.ZodUnion,...W(e)});var Qt=o(t=>t instanceof nn?Qt(t.schema):t instanceof nt?Qt(t.innerType()):t instanceof on?[t.value]:t instanceof an?t.options:t instanceof sn?Q.objectValues(t.enum):t instanceof pn?Qt(t._def.innerType):t instanceof Xr?[void 0]:t instanceof en?[null]:t instanceof ft?[void 0,...Qt(t.unwrap())]:t instanceof Ut?[null,...Qt(t.unwrap())]:t instanceof vo||t instanceof ln?Qt(t.unwrap()):t instanceof cn?Qt(t._def.innerType):[],"getDiscriminator"),Up=class t extends j{static{o(this,"ZodDiscriminatedUnion")}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==F.object)return M(r,{code:_.invalid_type,expected:F.object,received:r.parsedType}),H;let n=this.discriminator,i=r.data[n],a=this.optionsMap.get(i);return a?r.common.async?a._parseAsync({data:r.data,path:r.path,parent:r}):a._parseSync({data:r.data,path:r.path,parent:r}):(M(r,{code:_.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),H)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){let i=new Map;for(let a of r){let s=Qt(a.shape[e]);if(!s.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let p of s){if(i.has(p))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(p)}`);i.set(p,a)}}return new t({typeName:U.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:i,...W(n)})}};function jm(t,e){let r=Rr(t),n=Rr(e);if(t===e)return{valid:!0,data:t};if(r===F.object&&n===F.object){let i=Q.objectKeys(e),a=Q.objectKeys(t).filter(p=>i.indexOf(p)!==-1),s={...t,...e};for(let p of a){let c=jm(t[p],e[p]);if(!c.valid)return{valid:!1};s[p]=c.data}return{valid:!0,data:s}}else if(r===F.array&&n===F.array){if(t.length!==e.length)return{valid:!1};let i=[];for(let a=0;a<t.length;a++){let s=t[a],p=e[a],c=jm(s,p);if(!c.valid)return{valid:!1};i.push(c.data)}return{valid:!0,data:i}}else return r===F.date&&n===F.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}o(jm,"mergeValues");var rn=class extends j{static{o(this,"ZodIntersection")}_parse(e){let{status:r,ctx:n}=this._processInputParams(e),i=o((a,s)=>{if(Bm(a)||Bm(s))return H;let p=jm(a.value,s.value);return p.valid?((Wm(a)||Wm(s))&&r.dirty(),{status:r.value,value:p.data}):(M(n,{code:_.invalid_intersection_types}),H)},"handleParsed");return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([a,s])=>i(a,s)):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};rn.create=(t,e,r)=>new rn({left:t,right:e,typeName:U.ZodIntersection,...W(r)});var Lt=class t extends j{static{o(this,"ZodTuple")}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==F.array)return M(n,{code:_.invalid_type,expected:F.array,received:n.parsedType}),H;if(n.data.length<this._def.items.length)return M(n,{code:_.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),H;!this._def.rest&&n.data.length>this._def.items.length&&(M(n,{code:_.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let a=[...n.data].map((s,p)=>{let c=this._def.items[p]||this._def.rest;return c?c._parse(new dt(n,s,n.path,p)):null}).filter(s=>!!s);return n.common.async?Promise.all(a).then(s=>Me.mergeArray(r,s)):Me.mergeArray(r,a)}get items(){return this._def.items}rest(e){return new t({...this._def,rest:e})}};Lt.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Lt({items:t,typeName:U.ZodTuple,rest:null,...W(e)})};var Hp=class t extends j{static{o(this,"ZodRecord")}get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==F.object)return M(n,{code:_.invalid_type,expected:F.object,received:n.parsedType}),H;let i=[],a=this._def.keyType,s=this._def.valueType;for(let p in n.data)i.push({key:a._parse(new dt(n,p,n.path,p)),value:s._parse(new dt(n,n.data[p],n.path,p)),alwaysSet:p in n.data});return n.common.async?Me.mergeObjectAsync(r,i):Me.mergeObjectSync(r,i)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof j?new t({keyType:e,valueType:r,typeName:U.ZodRecord,...W(n)}):new t({keyType:wr.create(),valueType:e,typeName:U.ZodRecord,...W(r)})}},ci=class extends j{static{o(this,"ZodMap")}get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==F.map)return M(n,{code:_.invalid_type,expected:F.map,received:n.parsedType}),H;let i=this._def.keyType,a=this._def.valueType,s=[...n.data.entries()].map(([p,c],l)=>({key:i._parse(new dt(n,p,n.path,[l,"key"])),value:a._parse(new dt(n,c,n.path,[l,"value"]))}));if(n.common.async){let p=new Map;return Promise.resolve().then(async()=>{for(let c of s){let l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return H;(l.status==="dirty"||u.status==="dirty")&&r.dirty(),p.set(l.value,u.value)}return{status:r.value,value:p}})}else{let p=new Map;for(let c of s){let l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return H;(l.status==="dirty"||u.status==="dirty")&&r.dirty(),p.set(l.value,u.value)}return{status:r.value,value:p}}}};ci.create=(t,e,r)=>new ci({valueType:e,keyType:t,typeName:U.ZodMap,...W(r)});var li=class t extends j{static{o(this,"ZodSet")}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==F.set)return M(n,{code:_.invalid_type,expected:F.set,received:n.parsedType}),H;let i=this._def;i.minSize!==null&&n.data.size<i.minSize.value&&(M(n,{code:_.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),r.dirty()),i.maxSize!==null&&n.data.size>i.maxSize.value&&(M(n,{code:_.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),r.dirty());let a=this._def.valueType;function s(c){let l=new Set;for(let u of c){if(u.status==="aborted")return H;u.status==="dirty"&&r.dirty(),l.add(u.value)}return{status:r.value,value:l}}o(s,"finalizeSet");let p=[...n.data.values()].map((c,l)=>a._parse(new dt(n,c,n.path,l)));return n.common.async?Promise.all(p).then(c=>s(c)):s(p)}min(e,r){return new t({...this._def,minSize:{value:e,message:O.toString(r)}})}max(e,r){return new t({...this._def,maxSize:{value:e,message:O.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};li.create=(t,e)=>new li({valueType:t,minSize:null,maxSize:null,typeName:U.ZodSet,...W(e)});var Vp=class t extends j{static{o(this,"ZodFunction")}constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==F.function)return M(r,{code:_.invalid_type,expected:F.function,received:r.parsedType}),H;function n(p,c){return Np({data:p,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Cp(),ai].filter(l=>!!l),issueData:{code:_.invalid_arguments,argumentsError:c}})}o(n,"makeArgsIssue");function i(p,c){return Np({data:p,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Cp(),ai].filter(l=>!!l),issueData:{code:_.invalid_return_type,returnTypeError:c}})}o(i,"makeReturnsIssue");let a={errorMap:r.common.contextualErrorMap},s=r.data;if(this._def.returns instanceof _r){let p=this;return Ne(async function(...c){let l=new rt([]),u=await p._def.args.parseAsync(c,a).catch(d=>{throw l.addIssue(n(c,d)),l}),m=await Reflect.apply(s,this,u);return await p._def.returns._def.type.parseAsync(m,a).catch(d=>{throw l.addIssue(i(m,d)),l})})}else{let p=this;return Ne(function(...c){let l=p._def.args.safeParse(c,a);if(!l.success)throw new rt([n(c,l.error)]);let u=Reflect.apply(s,this,l.data),m=p._def.returns.safeParse(u,a);if(!m.success)throw new rt([i(u,m.error)]);return m.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new t({...this._def,args:Lt.create(e).rest(Zt.create())})}returns(e){return new t({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new t({args:e||Lt.create([]).rest(Zt.create()),returns:r||Zt.create(),typeName:U.ZodFunction,...W(n)})}},nn=class extends j{static{o(this,"ZodLazy")}get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};nn.create=(t,e)=>new nn({getter:t,typeName:U.ZodLazy,...W(e)});var on=class extends j{static{o(this,"ZodLiteral")}_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return M(r,{received:r.data,code:_.invalid_literal,expected:this._def.value}),H}return{status:"valid",value:e.data}}get value(){return this._def.value}};on.create=(t,e)=>new on({value:t,typeName:U.ZodLiteral,...W(e)});function Lx(t,e){return new an({values:t,typeName:U.ZodEnum,...W(e)})}o(Lx,"createZodEnum");var an=class t extends j{static{o(this,"ZodEnum")}constructor(){super(...arguments),yo.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),n=this._def.values;return M(r,{expected:Q.joinValues(n),received:r.parsedType,code:_.invalid_type}),H}if(Lp(this,yo,"f")||Ix(this,yo,new Set(this._def.values),"f"),!Lp(this,yo,"f").has(e.data)){let r=this._getOrReturnCtx(e),n=this._def.values;return M(r,{received:r.data,code:_.invalid_enum_value,options:n}),H}return Ne(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return t.create(e,{...this._def,...r})}exclude(e,r=this._def){return t.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}};yo=new WeakMap;an.create=Lx;var sn=class extends j{static{o(this,"ZodNativeEnum")}constructor(){super(...arguments),To.set(this,void 0)}_parse(e){let r=Q.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==F.string&&n.parsedType!==F.number){let i=Q.objectValues(r);return M(n,{expected:Q.joinValues(i),received:n.parsedType,code:_.invalid_type}),H}if(Lp(this,To,"f")||Ix(this,To,new Set(Q.getValidEnumValues(this._def.values)),"f"),!Lp(this,To,"f").has(e.data)){let i=Q.objectValues(r);return M(n,{received:n.data,code:_.invalid_enum_value,options:i}),H}return Ne(e.data)}get enum(){return this._def.values}};To=new WeakMap;sn.create=(t,e)=>new sn({values:t,typeName:U.ZodNativeEnum,...W(e)});var _r=class extends j{static{o(this,"ZodPromise")}unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==F.promise&&r.common.async===!1)return M(r,{code:_.invalid_type,expected:F.promise,received:r.parsedType}),H;let n=r.parsedType===F.promise?r.data:Promise.resolve(r.data);return Ne(n.then(i=>this._def.type.parseAsync(i,{path:r.path,errorMap:r.common.contextualErrorMap})))}};_r.create=(t,e)=>new _r({type:t,typeName:U.ZodPromise,...W(e)});var nt=class extends j{static{o(this,"ZodEffects")}innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===U.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:n}=this._processInputParams(e),i=this._def.effect||null,a={addIssue:o(s=>{M(n,s),s.fatal?r.abort():r.dirty()},"addIssue"),get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),i.type==="preprocess"){let s=i.transform(n.data,a);if(n.common.async)return Promise.resolve(s).then(async p=>{if(r.value==="aborted")return H;let c=await this._def.schema._parseAsync({data:p,path:n.path,parent:n});return c.status==="aborted"?H:c.status==="dirty"||r.value==="dirty"?oi(c.value):c});{if(r.value==="aborted")return H;let p=this._def.schema._parseSync({data:s,path:n.path,parent:n});return p.status==="aborted"?H:p.status==="dirty"||r.value==="dirty"?oi(p.value):p}}if(i.type==="refinement"){let s=o(p=>{let c=i.refinement(p,a);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return p},"executeRefinement");if(n.common.async===!1){let p=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return p.status==="aborted"?H:(p.status==="dirty"&&r.dirty(),s(p.value),{status:r.value,value:p.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(p=>p.status==="aborted"?H:(p.status==="dirty"&&r.dirty(),s(p.value).then(()=>({status:r.value,value:p.value}))))}if(i.type==="transform")if(n.common.async===!1){let s=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!xo(s))return s;let p=i.transform(s.value,a);if(p instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:p}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(s=>xo(s)?Promise.resolve(i.transform(s.value,a)).then(p=>({status:r.value,value:p})):s);Q.assertNever(i)}};nt.create=(t,e,r)=>new nt({schema:t,typeName:U.ZodEffects,effect:e,...W(r)});nt.createWithPreprocess=(t,e,r)=>new nt({schema:e,effect:{type:"preprocess",transform:t},typeName:U.ZodEffects,...W(r)});var ft=class extends j{static{o(this,"ZodOptional")}_parse(e){return this._getType(e)===F.undefined?Ne(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ft.create=(t,e)=>new ft({innerType:t,typeName:U.ZodOptional,...W(e)});var Ut=class extends j{static{o(this,"ZodNullable")}_parse(e){return this._getType(e)===F.null?Ne(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Ut.create=(t,e)=>new Ut({innerType:t,typeName:U.ZodNullable,...W(e)});var pn=class extends j{static{o(this,"ZodDefault")}_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return r.parsedType===F.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};pn.create=(t,e)=>new pn({innerType:t,typeName:U.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...W(e)});var cn=class extends j{static{o(this,"ZodCatch")}_parse(e){let{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return So(i)?i.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new rt(n.common.issues)},input:n.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new rt(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};cn.create=(t,e)=>new cn({innerType:t,typeName:U.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...W(e)});var ui=class extends j{static{o(this,"ZodNaN")}_parse(e){if(this._getType(e)!==F.nan){let n=this._getOrReturnCtx(e);return M(n,{code:_.invalid_type,expected:F.nan,received:n.parsedType}),H}return{status:"valid",value:e.data}}};ui.create=t=>new ui({typeName:U.ZodNaN,...W(t)});var MF=Symbol("zod_brand"),vo=class extends j{static{o(this,"ZodBranded")}_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}},bo=class t extends j{static{o(this,"ZodPipeline")}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return o(async()=>{let a=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?H:a.status==="dirty"?(r.dirty(),oi(a.value)):this._def.out._parseAsync({data:a.value,path:n.path,parent:n})},"handleAsync")();{let i=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?H:i.status==="dirty"?(r.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:n.path,parent:n})}}static create(e,r){return new t({in:e,out:r,typeName:U.ZodPipeline})}},ln=class extends j{static{o(this,"ZodReadonly")}_parse(e){let r=this._def.innerType._parse(e),n=o(i=>(xo(i)&&(i.value=Object.freeze(i.value)),i),"freeze");return So(r)?r.then(i=>n(i)):n(r)}unwrap(){return this._def.innerType}};ln.create=(t,e)=>new ln({innerType:t,typeName:U.ZodReadonly,...W(e)});function Ux(t,e={},r){return t?Er.create().superRefine((n,i)=>{var a,s;if(!t(n)){let p=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,c=(s=(a=p.fatal)!==null&&a!==void 0?a:r)!==null&&s!==void 0?s:!0,l=typeof p=="string"?{message:p}:p;i.addIssue({code:"custom",...l,fatal:c})}}):Er.create()}o(Ux,"custom");var AF={object:ze.lazycreate},U;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(U||(U={}));var FF=o((t,e={message:`Input not instance of ${t.name}`})=>Ux(r=>r instanceof t,e),"instanceOfType"),Hx=wr.create,Vx=Qr.create,IF=ui.create,OF=Zr.create,Bx=Yr.create,CF=Jr.create,NF=si.create,LF=Xr.create,UF=en.create,HF=Er.create,VF=Zt.create,BF=wt.create,WF=pi.create,jF=Yt.create,$F=ze.create,qF=ze.strictCreate,zF=tn.create,GF=Up.create,KF=rn.create,QF=Lt.create,ZF=Hp.create,YF=ci.create,JF=li.create,XF=Vp.create,eI=nn.create,tI=on.create,rI=an.create,nI=sn.create,iI=_r.create,Ax=nt.create,oI=ft.create,aI=Ut.create,sI=nt.createWithPreprocess,pI=bo.create,cI=o(()=>Hx().optional(),"ostring"),lI=o(()=>Vx().optional(),"onumber"),uI=o(()=>Bx().optional(),"oboolean"),mI={string:o(t=>wr.create({...t,coerce:!0}),"string"),number:o(t=>Qr.create({...t,coerce:!0}),"number"),boolean:o(t=>Yr.create({...t,coerce:!0}),"boolean"),bigint:o(t=>Zr.create({...t,coerce:!0}),"bigint"),date:o(t=>Jr.create({...t,coerce:!0}),"date")},fI=H,te=Object.freeze({__proto__:null,defaultErrorMap:ai,setErrorMap:fF,getErrorMap:Cp,makeIssue:Np,EMPTY_PATH:dF,addIssueToContext:M,ParseStatus:Me,INVALID:H,DIRTY:oi,OK:Ne,isAborted:Bm,isDirty:Wm,isValid:xo,isAsync:So,get util(){return Q},get objectUtil(){return Vm},ZodParsedType:F,getParsedType:Rr,ZodType:j,datetimeRegex:Nx,ZodString:wr,ZodNumber:Qr,ZodBigInt:Zr,ZodBoolean:Yr,ZodDate:Jr,ZodSymbol:si,ZodUndefined:Xr,ZodNull:en,ZodAny:Er,ZodUnknown:Zt,ZodNever:wt,ZodVoid:pi,ZodArray:Yt,ZodObject:ze,ZodUnion:tn,ZodDiscriminatedUnion:Up,ZodIntersection:rn,ZodTuple:Lt,ZodRecord:Hp,ZodMap:ci,ZodSet:li,ZodFunction:Vp,ZodLazy:nn,ZodLiteral:on,ZodEnum:an,ZodNativeEnum:sn,ZodPromise:_r,ZodEffects:nt,ZodTransformer:nt,ZodOptional:ft,ZodNullable:Ut,ZodDefault:pn,ZodCatch:cn,ZodNaN:ui,BRAND:MF,ZodBranded:vo,ZodPipeline:bo,ZodReadonly:ln,custom:Ux,Schema:j,ZodSchema:j,late:AF,get ZodFirstPartyTypeKind(){return U},coerce:mI,any:HF,array:jF,bigint:OF,boolean:Bx,date:CF,discriminatedUnion:GF,effect:Ax,enum:rI,function:XF,instanceof:FF,intersection:KF,lazy:eI,literal:tI,map:YF,nan:IF,nativeEnum:nI,never:BF,null:UF,nullable:aI,number:Vx,object:$F,oboolean:uI,onumber:lI,optional:oI,ostring:cI,pipeline:pI,preprocess:sI,promise:iI,record:ZF,set:JF,strictObject:qF,string:Hx,symbol:NF,transformer:Ax,tuple:QF,undefined:LF,union:zF,unknown:VF,void:WF,NEVER:fI,ZodIssueCode:_,quotelessJson:mF,ZodError:rt});function Wx(t){let e=t.operands.map($m).join(" ");return`(#${t.operator} ${e})`}o(Wx,"predicateToString");function $m(t){return t.type==="capture"?`@${t.name}`:t.value}o($m,"operandToString");function jx(t,e){return e.errors.filter(r=>!(r.code==="invalid_type"&&r.path.length===2&&(r.path[1]==="name"||r.path[1]==="value"))).map(r=>dI(t,r))}o(jx,"constructZodErrorMessages");function dI(t,e){if(e.path.length===0)return e.code==="too_small"?"Too few arguments":e.code==="too_big"?"Too many arguments":e.message;let r=e.message;e.code==="invalid_literal"&&e.path[1]==="type"&&(r=e.expected==="capture"?"Capture names must be prefixed with @":"Expected string, but received capture");let n=e.path[0],i=$m(t[n]);return`Error on argument ${n} (\`${i}\`): ${r}`}o(dI,"getErrorMessage");var Le=class{static{o(this,"QueryPredicateOperator")}allowMissingNode(){return!1}createPredicate(e){let r=this.schema.safeParse(e);return r.success?{success:!0,predicate:o(n=>{try{let i=this.constructAcceptArgs(r.data,n);return this.run(...i)}catch(i){if(i instanceof Bp&&this.allowMissingNode())return!0;throw i}},"predicate")}:{success:!1,errors:jx(e,r.error)}}constructAcceptArgs(e,r){return e.map(n=>{if(n.type==="capture"){let i=r.captures.find(a=>a.name===n.name);if(i==null)throw new Bp(n.name);return i}else return n.value})}},Bp=class extends Error{static{o(this,"CaptureNotFoundError")}constructor(e){super(`Could not find capture ${e}`)}};var qm=te.object({type:te.literal("string"),value:te.string()}),$={node:te.object({type:te.literal("capture"),name:te.string()}),string:qm,integer:qm.transform((t,e)=>{let r=parseInt(t.value);return isNaN(r)?(e.addIssue({code:te.ZodIssueCode.custom,message:"Expected an integer"}),te.NEVER):{type:"integer",value:r}}),boolean:qm.transform((t,e)=>t.value==="true"?{type:"boolean",value:!0}:t.value==="false"?{type:"boolean",value:!1}:(e.addIssue({code:te.ZodIssueCode.custom,message:"Expected true or false"}),te.NEVER))};var zm=class extends Le{constructor(){super(...arguments);this.name="not-type?";this.schema=te.tuple([$.node,$.string]).rest($.string)}static{o(this,"NotType")}run({node:r},...n){return!n.includes(r.type)}},Gm=class extends Le{constructor(){super(...arguments);this.name="not-parent-type?";this.schema=te.tuple([$.node,$.string]).rest($.string)}static{o(this,"NotParentType")}run({node:r},...n){return r.parent==null||!n.includes(r.parent.type)}},Km=class extends Le{constructor(){super(...arguments);this.name="is-nth-child?";this.schema=te.tuple([$.node,$.integer])}static{o(this,"IsNthChild")}run({node:r},n){return r.parent?.children.findIndex(i=>i.id===r.id)===n}},Qm=class extends Le{constructor(){super(...arguments);this.name="has-multiple-children-of-type?";this.schema=te.tuple([$.node,$.string])}static{o(this,"HasMultipleChildrenOfType")}run({node:r},n){return r.children.filter(a=>a.type===n).length>1}},Zm=class extends Le{constructor(){super(...arguments);this.name="child-range!";this.schema=te.union([te.tuple([$.node,$.integer]),te.tuple([$.node,$.integer,$.integer]),te.tuple([$.node,$.integer,$.integer,$.boolean]),te.tuple([$.node,$.integer,$.integer,$.boolean,$.boolean])])}static{o(this,"ChildRange")}run(r,n,i,a,s){let{node:{children:p}}=r;n=n<0?p.length+n:n,i=i??-1,i=i<0?p.length+i:i;let c=p[n],l=p[i];return r.range=mt(a?c.endPosition:c.startPosition,s?l.startPosition:l.endPosition),!0}},Ym=class extends Le{constructor(){super(...arguments);this.name="character-range!";this.schema=te.union([te.tuple([$.node,$.integer]),te.tuple([$.node,$.integer,$.integer])])}static{o(this,"CharacterRange")}run(r,n,i){return r.range=new b(r.range.start.translate(void 0,n),r.range.end.translate(void 0,i??0)),!0}},Jm=class extends Le{constructor(){super(...arguments);this.name="shrink-to-match!";this.schema=te.tuple([$.node,$.string])}static{o(this,"ShrinkToMatch")}run(r,n){let{document:i,range:a}=r,p=i.getText(a).match(new RegExp(n,"ds"));if(p?.index==null)throw Error(`No match for pattern '${n}'`);let[c,l]=p.indices?.groups?.keep??p.indices[0],u=i.offsetAt(a.start);return r.range=new b(i.positionAt(u+c),i.positionAt(u+l)),!0}},Xm=class extends Le{constructor(){super(...arguments);this.name="trim-end!";this.schema=te.tuple([$.node])}static{o(this,"TrimEnd")}run(r){let{document:n,range:i}=r,a=n.getText(i),s=a.length-a.trimEnd().length;return s>0&&(r.range=new b(i.start,ph(n,i.end,-s))),!0}},ef=class extends Le{constructor(){super(...arguments);this.name="allow-multiple!";this.schema=te.tuple([$.node])}static{o(this,"AllowMultiple")}allowMissingNode(){return!0}run(r){return r.allowMultiple=!0,!0}},tf=class extends Le{constructor(){super(...arguments);this.name="log!";this.schema=te.tuple([$.node])}static{o(this,"Log")}run(r){return console.log(`#log!: ${r.name}@${r.range}`),!0}},rf=class extends Le{constructor(){super(...arguments);this.name="insertion-delimiter!";this.schema=te.tuple([$.node,$.string])}static{o(this,"InsertionDelimiter")}run(r,n){return r.insertionDelimiter=n,!0}},nf=class extends Le{constructor(){super(...arguments);this.name="single-or-multi-line-delimiter!";this.schema=te.tuple([$.node,$.node,$.string,$.string])}static{o(this,"SingleOrMultilineDelimiter")}run(r,n,i,a){return r.insertionDelimiter=n.range.isSingleLine?i:a,!0}},$x=[new tf,new zm,new Xm,new Gm,new Km,new Zm,new Ym,new Jm,new ef,new rf,new nf,new Qm];function qx(t){let e=[],r=[];return t.forEach((n,i)=>{let a=[];n.forEach((s,p)=>{let c=$x.find(({name:u})=>u===s.operator);if(c==null){e.push({patternIdx:i,predicateIdx:p,error:`Unknown predicate operator "${s.operator}"`});return}let l=c.createPredicate(s.operands);if(!l.success){e.push(...l.errors.map(u=>({patternIdx:i,predicateIdx:p,error:u})));return}a.push(l.predicate)}),r.push(a)}),{errors:e,predicates:r}}o(qx,"parsePredicates");function zx(t){return t.map(e=>e.name.endsWith(".startOf")?{...e,name:e.name.replace(/\.startOf$/,""),range:e.range.start.toEmptyRange()}:e.name.endsWith(".endOf")?{...e,name:e.name.replace(/\.endOf$/,""),range:e.range.end.toEmptyRange()}:e)}o(zx,"rewriteStartOfEndOf");var Ro=class t{constructor(e,r,n){this.treeSitter=e;this.query=r;this.patternPredicates=n}static{o(this,"TreeSitterQuery")}static create(e,r,n){let{errors:i,predicates:a}=qx(n.predicates);if(i.length>0){for(let s of i){let p=[`language ${e}`,`pattern ${s.patternIdx}`,`predicate \`${Wx(n.predicates[s.patternIdx][s.predicateIdx])}\``].join(", ");ce(g().messages,"TreeSitterQuery.parsePredicates",`Error parsing predicate for ${p}: ${s.error}`)}if(g().runMode==="test")throw new Error("Invalid predicates")}return new t(r,n,a)}matches(e,r,n){return this.query.matches(this.treeSitter.getTree(e).rootNode,{startPosition:r==null?void 0:Kx(r),endPosition:n==null?void 0:Kx(n)}).map(({pattern:i,captures:a})=>({patternIdx:i,captures:a.map(({name:s,node:p})=>({name:s,node:p,document:e,range:bx(p),insertionDelimiter:void 0,allowMultiple:!1,hasError:o(()=>Dx(p),"hasError")}))})).filter(i=>this.patternPredicates[i.patternIdx].every(a=>a(i))).map(i=>{let a=Object.entries(gu(i.captures,({name:s})=>Gx(s))).map(([s,p])=>{if(p=zx(p),!Px(p,g().messages)&&g().runMode==="test")throw new Error("Invalid captures");return{name:s,range:p.map(({range:l})=>l).reduce((l,u)=>u.union(l)),allowMultiple:p.some(l=>l.allowMultiple),insertionDelimiter:p.find(l=>l.insertionDelimiter!=null)?.insertionDelimiter,hasError:o(()=>p.some(l=>l.hasError()),"hasError")}});return{...i,captures:a}})}get captureNames(){return $t(this.query.captureNames.map(Gx))}};function Gx(t){return t.replace(/(\.(start|end))?(\.(startOf|endOf))?$/,"")}o(Gx,"normalizeCaptureName");function Kx(t){return{row:t.line,column:t.character}}o(Kx,"positionToPoint");var Zx="_",gI=[Zx,...Br],hI=["prefix","leading","trailing"],yI=["startOf","endOf"],TI=["domain","removal","interior","iteration","iteration.domain"],Qx=["start","end","start.startOf","start.endOf","end.startOf","end.endOf"],un=new Set;for(let t of gI){if(t!==Zx){un.add(t);for(let e of Qx)un.add(`${t}.${e}`)}for(let e of hI){un.add(`${t}.${e}`);for(let r of yI)un.add(`${t}.${e}.${r}`)}for(let e of TI){un.add(`${t}.${e}`);for(let r of Qx)un.add(`${t}.${e}.${r}`)}}var xI=new RegExp("^(?!;;).*@([\\w.]*)","gm");function Yx(t,e){let r=e.matchAll(xI),n=[];for(let a of r){let s=a[1];if(!(s.length>1&&!s.includes(".")&&s.startsWith("_"))&&!un.has(s)){let p=a.input.slice(0,a.index).split(`
`).length;n.push(`${t}(${p}) invalid capture '@${s}'.`)}}if(n.length===0)return;let i=n.join(`
`);if(ce(g().messages,"validateQueryCaptures.invalidCaptureName",i),g().runMode==="test")throw new Error(i)}o(Yx,"validateQueryCaptures");var Wp=class t{constructor(e){this.query=e}static{o(this,"LanguageDefinition")}static async create(e,r,n,i){let a=await SI(e,r,`${i}.scm`);if(a==null||!await n.loadLanguage(i))return;let s=n.getLanguage(i).query(a),p=Ro.create(i,n,s);return new t(p)}getScopeHandler(e){if(this.query.captureNames.includes(e.type))return new Tp(this.query,e)}getCaptures(e,r){return this.query.matches(e).map(n=>n.captures.find(({name:i})=>i===r)).filter(n=>n!=null)}};async function SI(t,e,r){let n={[r]:null},i=t.runMode!=="production";for(;Object.values(n).some(a=>a==null);)for(let[a,s]of Object.entries(n)){if(s!=null)continue;let p=await e.readQuery(a);if(p==null){if(a===r)return;if(ce(t.messages,"LanguageDefinition.readQueryFileAndImports.queryNotFound",`Could not find imported query file ${a}`),t.runMode==="test")throw new Error("Invalid import statement");p=""}i&&Yx(a,p),n[a]=p,st(p,/^[^\S\r\n]*;;?[^\S\r\n]*(?:import|include)[^\S\r\n]+['"]?([\w|/\\.]+)['"]?[^\S\r\n]*$/gm,c=>{let l=c[1];i&&vI(t,a,l,c[0]),n[l]=n[l]??null})}return Object.values(n).join(`
`)}o(SI,"readQueryFileAndImports");function vI(t,e,r,n){let i=!1;/[/\\]/g.test(r)&&(ce(t.messages,"LanguageDefinition.readQueryFileAndImports.invalidImport",`Invalid import statement in ${e}: "${n}". Relative import paths not supported`),i=!0);let a=`;; import ${r}`;if(n!==a&&(ce(t.messages,"LanguageDefinition.readQueryFileAndImports.malformedImport",`Malformed import statement in ${e}: "${n}". Import statements must be of the form "${a}"`),i=!0),i&&t.runMode==="test")throw new Error("Invalid import statement")}o(vI,"validateImportSyntax");var Jx=Symbol("LANGUAGE_UNDEFINED"),jp=class t{constructor(e,r,n){this.ide=e;this.treeSitter=r;this.treeSitterQueryProvider=n;this.notifier=new He;this.languageDefinitions=new Map;this.disposables=[];this.onDidChangeDefinition=this.notifier.registerListener;e.onDidOpenTextDocument(i=>{this.loadLanguage(i.languageId)}),e.onDidChangeVisibleTextEditors(i=>{i.forEach(({document:a})=>this.loadLanguage(a.languageId))}),this.disposables.push(n.onChanges(()=>this.reloadLanguageDefinitions()))}static{o(this,"LanguageDefinitionsImpl")}static async create(e,r,n){let i=new t(e,r,n);return await i.loadAllLanguages(),i}async loadAllLanguages(){let e=this.ide.visibleTextEditors.map(({document:r})=>r.languageId);try{await Promise.all(e.map(r=>this.loadLanguage(r)))}catch(r){if(ce(this.ide.messages,"Failed to load language definitions",St(r)),this.ide.runMode==="test")throw r}}async loadLanguage(e){if(this.languageDefinitions.has(e))return;let r=await Wp.create(this.ide,this.treeSitterQueryProvider,this.treeSitter,e)??Jx;this.languageDefinitions.set(e,r)}async reloadLanguageDefinitions(){this.languageDefinitions.clear(),await this.loadAllLanguages(),this.notifier.notifyListeners()}get(e){let r=this.languageDefinitions.get(e);if(r==null)throw new Error("Expected language definition entry is missing for languageId "+e);return r===Jx?void 0:r}getNodeAtLocation(e,r){return this.treeSitter.getNodeAtLocation(e,r)}dispose(){this.disposables.forEach(e=>e.dispose())}};var $p=class{constructor(e,r){this.modifierStageFactory=e;this.modifier=r}static{o(this,"CascadingStage")}get nestedStages(){return this.nestedStages_==null&&(this.nestedStages_=this.modifier.modifiers.map(this.modifierStageFactory.create)),this.nestedStages_}run(e){for(let r of this.nestedStages)try{return r.run(e)}catch{continue}throw new Error("No modifier could be applied")}};var mi=class{constructor(e,r){this.modifierStageFactory=e;this.nestedModifier=r;this.suppressErrors=!1}static{o(this,"ConditionalModifierBaseStage")}run(e){if(this.shouldModify(e))try{return this.nestedStage.run(e).map(r=>r.withThatTarget(e))}catch(r){if(!this.suppressErrors)throw r}return[e]}get nestedStage(){return this.nestedStage_==null&&(this.nestedStage_=this.modifierStageFactory.create(this.nestedModifier)),this.nestedStage_}},fi=class extends mi{static{o(this,"ModifyIfUntypedStage")}constructor(e,r){super(e,r.modifier)}shouldModify(e){return!e.hasExplicitScopeType}},wo=class extends mi{constructor(r,n,i){super(r,n);this.modificationCondition=i}static{o(this,"ModifyIfConditionStage")}shouldModify(r){return this.modificationCondition(r)}},qp=class extends mi{static{o(this,"ModifyIfUntypedExplicitStage")}shouldModify(e){return!e.hasExplicitScopeType&&!e.isImplicit}},di=class extends mi{constructor(r){super(r,{type:"containingScope",scopeType:{type:"token"}});this.suppressErrors=!0}static{o(this,"ContainingTokenIfUntypedEmptyStage")}shouldModify(r){return!r.hasExplicitScopeType&&!r.hasExplicitRange&&r.contentRange.isEmpty}};function Xx(t,e){return Object.getPrototypeOf(t).constructor===Object.getPrototypeOf(e).constructor}o(Xx,"isSameType");function gi(t,e,r,n,i){if(n&&i&&Xx(e,r)){let a=e.maybeCreateRichRangeTarget(t,r);if(a!=null)return a}return e.isLine&&r.isLine?new tt({editor:e.editor,isReversed:t,contentRange:Gn(e,r,n,i)}):new Re({editor:e.editor,isReversed:t,hasExplicitRange:!0,contentRange:xr(e,r,n,i),isToken:n&&i&&e.isToken&&r.isToken})}o(gi,"createContinuousRangeTarget");function zp(t,e,r){if(e===r)return e.getTargets(t);let n=e.getTargets(t),i=r.getTargets(t);if(n.length!==1||i.length!==1)throw Error("Scope range targets must be single-target");let[a]=n,[s]=i,p=s.contentRange.start.isAfterOrEqual(a.contentRange.start),[c,l]=p?[a,s]:[s,a];return[gi(t,c,l,!0,!0)]}o(zp,"constructScopeRangeTarget");function Gp(t,e,r,n){let i=Array.from(t.generateScopes(e,r,"forward",{containment:"required",allowAdjacentScopes:!0,skipAncestorScopes:!0}));switch(i.length){case 0:return;case 1:return i[0];case 2:{let[a,s]=i;return n==="forward"?s:n==="backward"||(t.isPreferredOver?.(a,s)??!1)?a:s}default:throw new Error("Expected no more than 2 scope candidates")}}o(Gp,"getPreferredScopeTouchingPosition");function Kp(t,e,r=0){let{isReversed:n,editor:i,contentRange:{start:a,end:s}}=t;if(s.isEqual(a)){let l=Gp(e,i,a);return l==null||(r>0&&(l=of(e,i,l.domain.end,"forward",r,!0)),l==null)?void 0:l.getTargets(n)}let p=of(e,i,a,"forward",r);if(p==null)return;if(p.domain.contains(s))return p.getTargets(n);let c=of(e,i,s,"backward",r);if(c!=null)return zp(n,p,c)}o(Kp,"getContainingScopeTarget");function of(t,e,r,n,i,a=!1){let s=0;for(let p of t.generateScopes(e,r,n,{containment:"required",allowAdjacentScopes:a})){if(s===i)return p;s+=1}}o(of,"expandFromPosition");var hi=class{constructor(e,r,n){this.modifierStageFactory=e;this.scopeHandlerFactory=r;this.modifier=n}static{o(this,"ContainingScopeStage")}run(e){let{scopeType:r,ancestorIndex:n=0}=this.modifier,i=this.scopeHandlerFactory.create(r,e.editor.document.languageId);if(i==null)return this.modifierStageFactory.getLegacyScopeStage(this.modifier).run(e);let a=Kp(e,i,n);if(a==null){if(r.type==="collectionItem")return this.modifierStageFactory.getLegacyScopeStage(this.modifier).run(e);throw new ve(this.modifier.scopeType.type)}return a}};var Qp=class{constructor(e,r,n){this.modifierStageFactory=e;this.scopeHandlerFactory=r;this.modifier=n}static{o(this,"EveryScopeStage")}run(e){let{scopeType:r}=this.modifier,{editor:n,isReversed:i}=e,a=this.scopeHandlerFactory.create(r,n.document.languageId);if(a==null)return this.modifierStageFactory.getLegacyScopeStage(this.modifier).run(e);let s;if(e.hasExplicitRange&&(s=eS(a,n,e.contentRange),s.length===1&&s[0].domain.contains(e.contentRange)&&(s=void 0)),s==null)try{s=this.getDefaultIterationRange(a,this.scopeHandlerFactory,e).flatMap(p=>eS(a,n,p))}catch(p){if(!(p instanceof ve))throw p;s=[]}if(s.length===0){if(r.type==="collectionItem")return this.modifierStageFactory.getLegacyScopeStage(this.modifier).run(e);throw new ve(r.type)}return s.flatMap(p=>p.getTargets(i))}getDefaultIterationRange(e,r,n){let i=r.create(e.iterationScopeType,n.editor.document.languageId);if(i==null)throw Error("Could not find iteration scope handler");let a=Kp(n,i);if(a==null)throw new ve(`iteration scope for ${e.scopeType.type}`);return a.map(s=>s.contentRange)}};function eS(t,e,{start:r,end:n}){return Array.from(t.generateScopes(e,r,"forward",{distalPosition:n,skipAncestorScopes:!0,allowAdjacentScopes:t.includeAdjacentInEvery}))}o(eS,"getScopesOverlappingRange");var Zp=class{constructor(e){this.modifier=e}static{o(this,"KeepContentFilterStage")}run(e){return e.contentText.trim()!==""?[e]:[]}},Yp=class{constructor(e){this.modifier=e}static{o(this,"KeepEmptyFilterStage")}run(e){return e.contentText.trim()===""?[e]:[]}};var Jp=class{static{o(this,"ImplicitStage")}run(){return Ws(g()).map(e=>new Hs({editor:e.editor,isReversed:e.selection.isReversed,contentRange:e.selection}))}};var Xp=class{constructor(e,r){this.modifierStageFactory=e;this.markStageFactory=r}static{o(this,"TargetPipelineRunner")}run(e,{actionFinalStages:r=[],noAutomaticTokenExpansion:n=!1}={}){return new af(this.modifierStageFactory,this.markStageFactory,e,{actionFinalStages:r,noAutomaticTokenExpansion:n}).run()}},af=class{constructor(e,r,n,i){this.modifierStageFactory=e;this.markStageFactory=r;this.target=n;this.opts=i}static{o(this,"TargetPipeline")}run(){return bI(this.processTarget(this.target))}processTarget(e){switch(e.type){case"list":return e.elements.flatMap(r=>this.processTarget(r));case"range":return this.processRangeTarget(e);case"primitive":case"implicit":return this.processPrimitiveTarget(e)}}processRangeTarget(e){let r=this.processPrimitiveTarget(e.anchor),n=this.processPrimitiveTarget(e.active);return ye(r,n).flatMap(([i,a])=>{if(i==null||a==null)throw new Error("AnchorTargets and activeTargets lengths don't match");switch(e.rangeType){case"continuous":return this.processContinuousRangeTarget(i,a,e);case"vertical":return RI(i,a,e.excludeAnchor,e.excludeActive)}})}processContinuousRangeTarget(e,r,{excludeAnchor:n,excludeActive:i,exclusionScopeType:a}){if(a==null)return[kr(e,r,n,i)];let s=cf(e,r);return[kr(n?tS(this.modifierStageFactory,e,a,s?"backward":"forward"):e,i?tS(this.modifierStageFactory,r,a,s?"forward":"backward"):r,!1,!1)]}processPrimitiveTarget(e){let r,n;e.type==="implicit"?(r=new Jp,n=[]):(r=this.markStageFactory.create(e.mark),n=sf(this.modifierStageFactory,e.modifiers));let i=r.run(),a=[...n,...this.opts.actionFinalStages,...this.opts.noAutomaticTokenExpansion?[]:[new di(this.modifierStageFactory)]];return pf(a,i)}};function sf(t,e){return e.map(t.create).reverse()}o(sf,"getModifierStagesFromTargetModifiers");function pf(t,e){return t.forEach(r=>{e=e.flatMap(n=>r.run(n))}),e}o(pf,"processModifierStages");function tS(t,e,r,n){return t.create({type:"relativeScope",scopeType:r,direction:n,length:1,offset:1}).run(e)[0]}o(tS,"getExcludedScope");function cf(t,e){return t.contentRange.start.isAfter(e.contentRange.start)?!0:t.contentRange.start.isBefore(e.contentRange.start)?!1:t.contentRange.end.isAfter(e.contentRange.end)}o(cf,"calcIsReversed");function bI(t){return Ty(t,(e,r)=>e.isEqual(r),e=>e.contentRange.concise())}o(bI,"uniqTargets");function rS(t,e){if(t.editor!==e.editor)throw new Error("Cannot form range between targets in different editors")}o(rS,"ensureSingleEditor");function kr(t,e,r=!1,n=!1){rS(t,e);let i=cf(t,e);return gi(i,i?e:t,i?t:e,!(i?n:r),!(i?r:n))}o(kr,"targetsToContinuousTarget");function RI(t,e,r,n){rS(t,e);let i=cf(t,e),a=i?-1:1,p=(i?t.contentRange.start:t.contentRange.end).line+(r?a:0),l=(i?e.contentRange.start:e.contentRange.end).line-(n?a:0),u=[];for(let m=p;;m+=a){let f=new b(m,t.contentRange.start.character,m,t.contentRange.end.character);if(u.push(new ee({editor:t.editor,isReversed:t.isReversed,contentRange:f,insertionDelimiter:t.insertionDelimiter})),m===l)return u}}o(RI,"targetsToVerticalTarget");var ec=class{constructor(e,r){this.modifierStageFactory=e;this.modifier=r}static{o(this,"HeadTailStage")}run(e){let r=this.modifier.modifiers??[{type:"containingScope",scopeType:{type:"oneOf",scopeTypes:[{type:"line"},{type:"surroundingPairInterior",delimiter:"any",requireSingleLine:!0}]}}],n=sf(this.modifierStageFactory,r);return pf(n,[e]).map(a=>{let s=this.modifier.type==="extendThroughStartOf";return new Vs({editor:e.editor,isReversed:s,inputTarget:e,modifiedTarget:a,isHead:s})})}};var Jt=class extends Error{static{o(this,"OutOfRangeError")}constructor(){super("Scope index out of range"),this.name="OutOfRangeError"}};function nS(t,e,r){return lf(t,e,r),t.slice(e,r+1)}o(nS,"sliceStrict");function lf(t,e,r){if(e<0||r>=t.length)throw new Jt}o(lf,"assertIndices");var yi=class{constructor(e,r,n){this.modifierStageFactory=e;this.storedTargets=r;this.modifier=n}static{o(this,"InstanceStage")}run(e){let r=new di(this.modifierStageFactory).run(e)[0];switch(this.modifier.type){case"everyScope":return this.handleEveryScope(r);case"ordinalScope":return this.handleOrdinalScope(r,this.modifier);case"relativeScope":return this.handleRelativeScope(r,this.modifier);default:throw Error(`${this.modifier.type} instance scope not supported`)}}handleEveryScope(e){return Array.from(pp(this.getEveryRanges(e),([r,n])=>this.getTargetIterable(e,r,n,"forward")))}handleOrdinalScope(e,{start:r,length:n}){return this.getEveryRanges(e).flatMap(([i,a])=>iS(this.getTargetIterable(e,i,a,r>=0?"forward":"backward"),r>=0?r:-(n+r),n))}handleRelativeScope(e,{direction:r,offset:n,length:i}){return(this.storedTargets.get("instanceReference")??[e]).flatMap(s=>{let{editor:p}=s,c=r==="forward"?new b(n===0?s.contentRange.start:s.contentRange.end,p.document.range.end):new b(p.document.range.start,n===0?s.contentRange.end:s.contentRange.start);return iS(this.getTargetIterable(e,p,c,r),n===0?0:n-1,i)})}getEveryRanges({editor:e}){return this.storedTargets.get("instanceReference")?.map(({editor:r,contentRange:n})=>[r,n])??[[e,e.document.range]]}getTargetIterable(e,r,n,i){let a=ke(ut(new RegExp(Je(e.contentText),"g"),r,n,i),p=>new ee({contentRange:p,editor:r,isReversed:!1,isToken:!1})),s=wI(e);if(s!=null){let p=this.modifierStageFactory.create({type:"containingScope",scopeType:s});return $T(ke(a,c=>{try{let l=p.run(c);return l.length===1&&l[0].contentRange.isRangeEqual(c.contentRange)?l[0]:null}catch{return null}}),c=>c!=null)}return a}};function wI(t){return t.isLine?{type:"line"}:t.isToken?{type:"token"}:t.isWord?{type:"word"}:null}o(wI,"getFilterScopeType");function iS(t,e,r){Array.from(mo(e,t));let n=Array.from(mo(r,t));if(n.length<r)throw new Jt;return n}o(iS,"takeFromOffset");var tc=class{constructor(e,r){this.modifierStageFactory=e;this.modifier=r;this.containingSurroundingPairIfNoInteriorStage=EI(this.modifierStageFactory)}static{o(this,"InteriorOnlyStage")}run(e){return this.containingSurroundingPairIfNoInteriorStage.run(e).flatMap(r=>r.getInterior())}},rc=class{constructor(e,r){this.modifierStageFactory=e;this.modifier=r;this.containingSurroundingPairIfNoBoundaryStage=uf(this.modifierStageFactory)}static{o(this,"ExcludeInteriorStage")}run(e){return this.containingSurroundingPairIfNoBoundaryStage.run(e).flatMap(r=>r.getBoundary())}};function EI(t){return new wo(t,{type:"containingScope",scopeType:{type:"surroundingPair",delimiter:"any"}},e=>e.getInterior()==null)}o(EI,"getContainingSurroundingPairIfNoInteriorStage");function uf(t){return new wo(t,{type:"containingScope",scopeType:{type:"surroundingPair",delimiter:"any"}},e=>e.getBoundary()==null)}o(uf,"getContainingSurroundingPairIfNoBoundaryStage");function oS(...t){return e=>{let r=e;for(let n of t)if(r=n(r),r==null)return null;return r}}o(oS,"chainedNodeFinder");function aS(t,...e){return r=>{let n=r,i=[],a=[...e].reverse();for(let s of a){if(n==null||(n=s(n),n==null))return null;i.push(n),n=n.parent??null}return i.reverse()[t]}}o(aS,"ancestorChainNodeFinder");var mf=o(t=>new B(t.row,t.column),"toPosition"),sS=o((...t)=>{let e=["(","{","[","<"],r=[")","}","]",">"],n=e.concat(r),i=o((s,p)=>s!=null&&p.includes(s.type),"isType"),a=o(s=>s!=null&&!i(s,n),"isOk");return(s,p)=>{let c,{start:l,end:u}=p;if(i(s.parent,t))return i(s,e)?c=s.nextNamedSibling:i(s,r)?c=s.previousNamedSibling:s.type===","?c=u.isBeforeOrEqual(mf(s.startPosition))?s.previousNamedSibling:s.nextNamedSibling:c=s,a(c)?c:null;if(i(s,t)){let m=[...s.children],f=m.find(({startPosition:y})=>mf(y).isAfterOrEqual(u))??null;if(a(f))return f;m.reverse();let d=m.find(({endPosition:y})=>mf(y).isBeforeOrEqual(l))??null;if(a(d))return d}return null}},"argumentNodeFinder");function Z(...t){let e=_I(t);return r=>{for(let n of e){let i=kI(r,n);if(i!=null)return i}return null}}o(Z,"patternFinder");function _I(t){return t.map(e=>e.split(".").map(r=>new ff(r)))}o(_I,"parsePatternStrings");function kI(t,e){let r=PI(t,e);!r&&e.length>1&&(r=DI(t,e));let n=null,i;return r!=null&&([n,i]=r),n!=null&&i!=null&&i.fields!=null&&i.fields.forEach(a=>{n=(a.isIndex?n?.namedChild(a.value):n?.childForFieldName(a.value))??null}),n}o(kI,"tryPatternMatch");function PI(t,e){let r=null,n=t;for(let i=e.length-1;i>-1;--i){let a=e[i];if(n==null||!a.typeEquals(n)){if(a.isOptional)continue;return null}(!r||!r[1].isImportant)&&(r=[n,a]),n=n.parent}return r}o(PI,"searchNodeAscending");function DI(t,e){let r=null,n=t;for(let i=0;i<e.length;++i){let a=e[i];if(n==null||!a.typeEquals(n)){if(a.isOptional)continue;return null}if((!r||a.isImportant)&&(r=[n,a]),i+1<e.length){let s=n.namedChildren.filter(p=>e[i+1].typeEquals(p));n=s.length===1?s[0]:null}}return r}o(DI,"searchNodeDescending");var ff=class{constructor(e){this.anyType=!1;this.notType=!1;this.type=e.match(/^[\w*~]+/)[0],this.type==="*"?this.anyType=!0:this.type.startsWith("~")&&(this.type=this.type.slice(1),this.notType=!0),this.isImportant=e.indexOf("!")>-1,this.isOptional=e.indexOf("?")>-1,this.fields=[...e.matchAll(/(?<=\[).+?(?=\])/g)].map(r=>r[0]).map(r=>/\d+/.test(r)?{isIndex:!0,value:Number(r)}:{isIndex:!1,value:r})}static{o(this,"Pattern")}typeEquals(e){return this.anyType?!0:this.notType?this.type!==e.type:this.type===e.type}};function G(t,e=Ct){return function(r,n){let i=t(n,r.selection);return i!=null?[{node:i,selection:e(r.editor,i)}]:null}}o(G,"matcher");function nc(t,e=Ct){let r=oS(...t);return function(n,i){let a=r(i);return a==null?null:[{node:a,selection:e(n.editor,a)}]}}o(nc,"chainedMatcher");function Ti(t,e=0,r=Ct){return G(aS(e,...t),r)}o(Ti,"ancestorChainNodeMatcher");function Se(...t){return G(Z(...t))}o(Se,"patternMatcher");function Pr(...t){return G(sS(...t),wx())}o(Pr,"argumentMatcher");function xi(...t){return G(Z(...t),Ex)}o(xi,"conditionMatcher");function Et(t,e=[]){return G(Z(...t),_x(...e))}o(Et,"leadingMatcher");function Dr(t,e=[]){return G(Z(...t),kx(...e))}o(Dr,"trailingMatcher");function le(...t){return(e,r)=>{for(let n of t){let i=n(e,r);if(i!=null)return i}return null}}o(le,"cascadingMatcher");function pS(t){return(e,r)=>{throw new Error(`Node type '${t}' not supported`)}}o(pS,"notSupported");function gt(t){return Object.freeze(Object.fromEntries(gr(t).map(e=>{let r=t[e];return Array.isArray(r)?[e,Se(...r)]:typeof r=="string"?[e,Se(r)]:[e,r]})))}o(gt,"createPatternMatchers");function cS(t,e){let r=t.walk();r.gotoFirstChild();let n=[],i=!0;for(;i;)r.currentFieldName===e&&n.push(r.currentNode),i=r.gotoNextSibling();return n}o(cS,"getChildNodesForFieldName");function MI(t,e){return gf(t,r=>Math.floor(r/2)*2+e)}o(MI,"parityNodeFinder");function ic(t){return MI(Z("map_lit"),t)}o(ic,"mapParityNodeFinder");function gf(t,e){return r=>{let n=r.parent;if(n==null||t(n)==null)return null;let i=Eo(n),a=i.findIndex(({id:p})=>p===r.id);if(a===-1)return null;let s=e(a);return s===-1?null:i[s]}}o(gf,"indexNodeFinder");function AI(){return gf(t=>t,t=>t)}o(AI,"itemFinder");var Eo=o(t=>cS(t,"value"),"getValueNodes"),df="~quoting_lit.list_lit!",uS=Z(df);function hf(...t){return e=>{let r=uS(e);if(r==null)return null;let n=Eo(r)[0];return t.includes(n?.text)?r:null}}o(hf,"functionNameBasedFinder");function FI(...t){return G(hf(...t))}o(FI,"functionNameBasedMatcher");var mS=hf("defn","defmacro"),lS=nc([mS,t=>Eo(t)[1]]),fS=hf("if","if-let","when","when-let"),II=G(fS),OI={collectionKey:G(ic(0)),collectionItem:le(G(ic(0),ho(t=>t.type==="{"||t.type==="}",", ",Pe,ic(1))),G(AI())),value:G(ic(1)),argumentOrParameter:G(gf(Z(df),t=>t!==0?t:-1)),functionCall:df,functionCallee:nc([uS,t=>Eo(t)[0]]),namedFunction:G(mS),functionName:lS,name:lS,anonymousFunction:le(FI("fn"),Se("anon_fn_lit")),ifStatement:II,condition:nc([fS,t=>Eo(t)[1]])},dS=gt(OI);var gS=["command","displayed_equation","inline_formula","math_set","block_comment","package_include","class_include","latex_include","biblatex_include","bibtex_include","graphics_include","svg_include","inkscape_include","verbatim_include","import_include","caption","citation","label_definition","label_reference","label_reference_range","label_number","new_command_definition","old_command_definition","let_command_definition","environment_definition","glossary_entry_definition","glossary_entry_reference","acronym_definition","acronym_reference","theorem_definition","color_definition","color_set_definition","color_reference","tikz_library_import"],CI=["curly_group","curly_group_text","curly_group_text_list","curly_group_path","curly_group_path_list","curly_group_command_name","curly_group_key_value","curly_group_glob_pattern","curly_group_impl","brack_group","brack_group_text","brack_group_argc","brack_group_key_value","mixed_group"],yS=["subparagraph","paragraph","subsubsection","subsection","section","chapter","part"],hS=yS.map(t=>`${t}[text]`),NI=yS.map(t=>`${t}[command]`);function yf(t,e){return{selection:new q(t.document.positionAt(e.startIndex+1),t.document.positionAt(e.endIndex-1)),context:{removalRange:new q(t.document.positionAt(e.startIndex),t.document.positionAt(e.endIndex))}}}o(yf,"unwrapGroupParens");function LI(t,e){let r=e.startIndex,n=e.endIndex,i=e.nextNamedSibling;return i!=null&&i.isNamed&&(n=i.endIndex),{selection:new q(t.document.positionAt(r),t.document.positionAt(n)),context:{}}}o(LI,"extendToNamedSiblingIfExists");function UI(t,e){let r=e.startIndex,n=e.childForFieldName("label");if(n==null){let i=e.childForFieldName("command");i!=null&&(r=i.endIndex+1)}else r=n.endIndex+1;return{selection:new q(t.document.positionAt(r),t.document.positionAt(e.endIndex)),context:{leadingDelimiterRange:new b(t.document.positionAt(e.startIndex),t.document.positionAt(r-1))}}}o(UI,"extractItemContent");var HI={argumentOrParameter:le(Ti([Z(...gS),Z(...CI)],1,yf),G(Z("begin[name]","end[name]",...hS),yf)),functionCall:le(G(Z(...gS,"begin","end")),G(Z(...NI),LI)),name:le(G(Z(...hS),yf),Se("begin[name][text]","end[name][text]")),collectionItem:G(Z("enum_item"),UI)},TS=gt(HI);var VI=["alias","begin_block","end_block","if_modifier","rescue_modifier","undef","unless_modifier","until_modifier","while_modifier"],BI=["array","assignment","begin","binary","break","call","case","case_match","chained_string","character","class","class_variable","complex","conditional","constant","delimited_symbol","element_reference","false","float","for","global_variable","hash","heredoc_beginning","identifier","if","instance_variable","integer","lambda","method","module","next","nil","operator_assignment","parenthesized_statements","range","rational","redo","regex","retry","return","scope_resolution","self","simple_symbol","singleton_class","singleton_method","string","string_array","subshell","super","symbol_array","true","unary","unless","until","while","yield"],WI=["begin_block","begin","block_body","block","body_statement","do_block","do","else","end_block","ensure","heredoc_beginning","interpolation","lambda","method","parenthesized_statements","program","singleton_class","singleton_method","then"],jI=["hash"],$I=["array","string_array","symbol_array"],qI=["=","+=","-=","*=","**=","/=","||=","|=","&&=","&=","%=",">>=","<<=","^="],zI=[":","=>"];function GI(t){if(t.type!=="call")return null;let e=t.childForFieldName("receiver"),r=t.childForFieldName("method"),n=t.childForFieldName("block");return e?.text==="Proc"&&r?.text==="new"||e==null&&r?.text==="lambda"?t:n}o(GI,"blockFinder");var KI={statement:le(Se(...VI),Ti([Z(...WI),Z(...BI)],1)),anonymousFunction:le(Se("lambda","do_block"),G(GI)),condition:xi("*[condition]"),argumentOrParameter:Pr("lambda_parameters","method_parameters","block_parameters","argument_list"),collectionKey:Dr(["pair[key]"],[":"]),value:Et(["pair[value]","assignment[right]","operator_assignment[right]","return.argument_list!"],qI.concat(zI)),collectionItem:Pr(...jI,...$I)},xS=gt(KI);function Tf(){let t=Nt(["else_clause"],[],{includeUnnamedChildren:!0});return function(e,r){let n=t(e,r),i=r.parent;if(i?.type!=="else_clause"){let s=r.childForFieldName("alternative");if(s==null)return n;let{selection:p}=n;return{selection:p,context:{removalRange:new q(p.start,Um(s.namedChild(0).startPosition))}}}let{selection:a}=n;return{selection:new q(Um(i.child(0).startPosition),a.end),context:{}}}}o(Tf,"elseIfExtractor");function SS(t){let e=Tf();return function(r,n){return n.namedChild(0).type===t?e(r,n.namedChild(0)):Ct(r,n)}}o(SS,"elseExtractor");var vS=["associated_type","attribute_item","const_item","empty_statement","enum_item","extern_crate_declaration","foreign_mod_item","impl_item","inner_attribute_item","let_declaration","macro_definition","macro_invocation","function_item","function_signature_item","mod_item","static_item","struct_item","trait_item","type_item","union_item","use_declaration","expression_statement"],QI=["source_file","block","declaration_list"];function ZI(t){return t.parent?.type==="impl_item"&&t.parent?.childForFieldName("type")?.equals(t)?t:null}o(ZI,"implItemTypeFinder");function YI(t,e){return{selection:Rx(e.children[1],e.lastNamedChild),context:{leadingDelimiterRange:mt(e.children[0].startPosition,e.children[1].startPosition)}}}o(YI,"traitBoundExtractor");function JI(t){if(t.type!=="block")return null;let{lastNamedChild:e}=t;if(e==null)return null;if(e.type==="expression_statement"){let r=e.child(0);return r.type==="return_expression"?r.child(1):null}return vS.includes(e.type)?null:e.type==="return_expression"?e.child(1):e}o(JI,"returnValueFinder");var XI={statement:Ti([Z(...QI),Z(...vS)],1),condition:le(Se("while_expression[condition]","if_expression[condition]"),G(Z("while_let_expression","if_let_expression"),Nt(["while","if","block"],[],{includeUnnamedChildren:!0})),Et(["*.match_pattern![condition]"],["if"])),collectionItem:Pr("array_expression","tuple_expression","tuple_type"),type:le(Et(["let_declaration[type]","parameter[type]","field_declaration[type]","const_item[type]"],[":"]),G(Z("constrained_type_parameter[bounds]","where_predicate[bounds]"),YI),Et(["function_item[return_type]"],["->"]),G(ZI),Se("struct_item","trait_item","impl_item","array_type[element]")),argumentOrParameter:Pr("arguments","parameters","meta_arguments","type_parameters","ordered_field_declaration_list"),collectionKey:le(Dr(["field_initializer[name]","field_pattern[name]"],[":"])),name:le(Se("let_declaration.identifier!","parameter.identifier!","function_item[name]","struct_item[name]","enum_item[name]","enum_variant[name]","trait_item[name]","const_item[name]","meta_item.identifier!","let_declaration[pattern]","constrained_type_parameter[left]","where_predicate[left]","field_declaration[name]"),Dr(["field_initializer[name]","field_pattern[name]"],[":"])),value:le(Et(["let_declaration[value]"],["="]),Et(["field_initializer[value]","field_pattern[pattern]"],[":"]),Se("meta_item[value]","const_item[value]"),G(JI)),attribute:Dr(["mutable_specifier","attribute_item"]),branch:le(Se("match_arm"),G(Z("else_clause"),SS("if_expression")),G(Z("if_expression"),Tf()))},bS=gt(XI);var eO={argumentOrParameter:Pr("arguments","parameters","class_parameters","bindings"),branch:G(Z("case_clause"),Nt([],[],{includeUnnamedChildren:!0})),type:Et(["upper_bound[type]","lower_bound[type]","view_bound[type]","context_bound[type]","val_definition[type]","val_declaration[type]","var_definition[type]","var_declaration[type]","type_definition","extends_clause[type]","class_parameter[type]","parameter[type]","function_definition[return_type]","typed_pattern[type]","binding[type]"],[":"]),value:Et(["*[value]","*[default_value]","type_definition[type]"],["="]),condition:xi("*[condition]")},RS=gt(eO);var tO=["apply_statement","at_rule","charset_statement","debug_statement","each_statement","error_statement","for_statement","forward_statement","function_statement","if_statement","import_statement","include_statement","keyframes_statement","media_statement","mixin_statement","namespace_statement","placeholder","rule_set","supports_statement","use_statement","warn_statement","while_statement"];function ES(t){return[",","(",")"].includes(t.type)||_S(t)}o(ES,"isArgumentListDelimiter");function _S(t){return t.type==="plain_value"&&t.text==="at"}o(_S,"isAtDelimiter");function wS(t){return e=>{(_S(e)||e.type===",")&&(e=e.previousSibling);let r=t(e);for(;r&&!ES(r);)e=r,r=t(r);return e}}o(wS,"findAdjacentArgValues");function rO(t,e){return e.type!=="declaration"?null:e.descendantsOfType("unit").map(r=>({node:r,selection:Ct(t.editor,r)}))}o(rO,"unitMatcher");var nO={condition:xi("condition"),statement:le(Se(...tO),G(Z("attribute_selector"),Nt([],["attribute_name","string_value"]))),argumentOrParameter:le(G(Z("arguments.*!","parameters.*!"),ho(t=>ES(t),", ",wS(t=>t.previousSibling),wS(t=>t.nextSibling)))),collectionKey:Dr(["declaration.property_name!"],[":"]),value:le(G(Z("declaration"),Nt(["property_name","variable_name"])),G(Z("include_statement","namespace_statement"),Nt()),Se("return_statement.*!","import_statement.*!","attribute_selector.plain_value!","attribute_selector.string_value!","parameter.default_value!")),unit:le(Se("integer_value.unit!"),rO)},xf=gt(nO);function kS(t,e,r){let n=_o[t];if(n==null)throw new ra(t);let i=n[e];return i==null?pS(e):r?iO(i):i}o(kS,"getNodeMatcher");var _o={clojure:dS,css:xf,latex:TS,ruby:xS,rust:bS,scala:RS,scss:xf};function iO(t){return(e,r)=>{let n=t(e,r);return n==null?null:(n=n.flatMap(i=>oO(i.node,Ms(e,i.selection.selection),t)),n.length>0?n:null)}}o(iO,"matcherIncludeSiblings");function oO(t,e,r){let n=t.parent;for(;n!=null;){let i=n.namedChildren.flatMap(a=>r(e,a)).filter(a=>a!=null);if(i.length>0)return i;n=n.parent}return[]}o(oO,"iterateNearestIterableAncestor");var Si=class{constructor(e,r){this.languageDefinitions=e;this.modifier=r}static{o(this,"LegacyContainingSyntaxScopeStage")}run(e){let r=kS(e.editor.document.languageId,this.modifier.scopeType.type,this.modifier.type==="everyScope"),n=this.languageDefinitions.getNodeAtLocation(e.editor.document,e.contentRange);if(n==null)throw new ve(this.modifier.scopeType.type);let i=aO(n,r,{editor:e.editor,selection:new q(e.contentRange.start,e.contentRange.end)});if(i==null)throw new ve(this.modifier.scopeType.type);return i.map(a=>{let{containingListDelimiter:s,leadingDelimiterRange:p,trailingDelimiterRange:c,removalRange:l,interiorRange:u}=a.context;if(l!=null&&(p!=null||c!=null))throw Error("Removal range is mutually exclusive with leading or trailing delimiter range");let{editor:m,selection:f}=a.selection;return new vr({scopeTypeType:this.modifier.scopeType.type,editor:m,isReversed:e.isReversed,contentRange:f,removalRange:l,interiorRange:u,insertionDelimiter:s,leadingDelimiterRange:p,trailingDelimiterRange:c})})}};function aO(t,e,r){let n=t;for(;n!=null;){let i=e(r,n);if(i!=null)return i.map(a=>a.selection).map(a=>({selection:Ms(r,a.selection),context:a.context}));n=n.parent}return null}o(aO,"findNearestContainingAncestorNode");function DS(t,e){let r=MS(t,e);for(;r!=null;){if(sO(t,e,r))return{range:r.getInterior()[0].contentRange,boundary:Sf(r)};r=pO(t,e.editor,r)}return{range:fo(e.editor,e.contentRange)}}o(DS,"getIterationScope");function sO(t,e,r){let{contentRange:n}=e;if(n.isEmpty){let[a,s]=Sf(r),p=n.start;if(p.isEqual(a.start)||p.isEqual(s.end))return!1;let c=e.editor.document.lineAt(p);if(p.isEqual(a.end)&&PS(c,p.character)||p.isEqual(s.start)&&PS(c,p.character-1))return!1}else{if(n.isRangeEqual(r.contentRange))return!1;let[a,s]=Sf(r);if(n.isRangeEqual(a)||n.isRangeEqual(s))return!1}let i=cO(t,r);return!(i!=null&&r.contentRange.start.isBeforeOrEqual(i.contentRange.start))}o(sO,"useInteriorOfSurroundingTarget");function Sf(t){return t.getBoundary().map(e=>e.contentRange)}o(Sf,"getBoundary");function PS(t,e){return e<t.range.start.character||e>=t.range.end.character||t.text[e].trim()===""}o(PS,"characterIsWhitespaceOrMissing");function pO(t,e,r){let n=e.document.offsetAt(r.contentRange.start);if(n===0)return;let i=e.document.positionAt(n-1);return MS(t,new ee({editor:e,contentRange:new b(i,i),isReversed:!1}))}o(pO,"getParentSurroundingPair");function MS(t,e){return AS(t,e,{type:"surroundingPair",delimiter:"collectionBoundary",requireStrongContainment:!0})}o(MS,"getBoundarySurroundingPair");function cO(t,e){return AS(t,e,{type:"surroundingPair",delimiter:"string",requireStrongContainment:!0})}o(cO,"getStringSurroundingPair");function AS(t,e,r){let n=t.create({type:"containingScope",scopeType:r}),i=(()=>{try{return n.run(e)}catch{return[]}})();if(i.length>1)throw Error("Expected only one surrounding pair target");return i[0]}o(AS,"getSurroundingPair");function FS(t,e,r){let{document:n}=t,a=n.getText(e).split(/([,(){}<>[\]"'`])|(?<!\\)(\\"|\\'|\\`)/g).filter(l=>l!=null&&l.length>0),s=lO(a),p=[],c=n.offsetAt(e.start);return s.forEach(l=>{if(l.trim().length===0){c+=l.length;return}if(l===IS)p.push({type:"separator",range:new b(n.positionAt(c),n.positionAt(c+l.length))});else{let u=c+(l.length-l.trimStart().length);p.push({type:"item",range:new b(n.positionAt(u),n.positionAt(u+l.trim().length))})}c+=l.length}),r!=null?[{type:"boundary",range:r[0]},...p,{type:"boundary",range:r[1]}]:p}o(FS,"tokenizeRange");function lO(t){let e=[],r=0,n=null,i=null,a=-1;return t.forEach((s,p)=>{r>0?s===i?--r:s===n&&++r:(vf[s]!=null&&t.indexOf(vf[s],p+1)>-1&&(n=s,i=vf[s],r=1),a<0&&(a=p));let c=s===IS&&r===0;if(c||p===t.length-1){let l=c?p:p+1;e.push(t.slice(a,l).join("")),a=-1,c&&e.push(s)}}),e}o(lO,"joinLexemesBySkippingMatchingPairs");var IS=",",vf={"(":")","{":"}","<":">","[":"]",'"':'"',"'":"'","`":"`"};var oc=class{constructor(e,r,n){this.languageDefinitions=e;this.modifierStageFactory=r;this.modifier=n}static{o(this,"ItemStage")}run(e){try{return new Si(this.languageDefinitions,this.modifier).run(e)}catch{}return this.modifier.type==="everyScope"?this.getEveryTarget(this.modifierStageFactory,e):[this.getSingleTarget(this.modifierStageFactory,e)]}getEveryTarget(e,r){let n=CS(e,r),i=r.hasExplicitRange?OS(r,n):n;if(i.length===0)throw new ve(this.modifier.scopeType.type);return i.map(a=>this.itemInfoToTarget(r,a))}getSingleTarget(e,r){let n=CS(e,r),i=OS(r,n);if(i.length===0)throw new ve(this.modifier.scopeType.type);let a=i[0],s=i[i.length-1],p={contentRange:a.contentRange.union(s.contentRange),domain:a.domain.union(s.domain),leadingDelimiterRange:a.leadingDelimiterRange,trailingDelimiterRange:s.trailingDelimiterRange},c=p.leadingDelimiterRange!=null&&p.trailingDelimiterRange!=null&&hm(r.editor,p.leadingDelimiterRange)>hm(r.editor,p.trailingDelimiterRange)?p.contentRange.union(p.leadingDelimiterRange):void 0;return this.itemInfoToTarget(r,p,c)}itemInfoToTarget(e,r,n){let i=uO(r.leadingDelimiterRange,r.trailingDelimiterRange);return new vr({scopeTypeType:this.modifier.scopeType.type,editor:e.editor,isReversed:e.isReversed,contentRange:r.contentRange,insertionDelimiter:i,leadingDelimiterRange:r.leadingDelimiterRange,trailingDelimiterRange:r.trailingDelimiterRange,removalRange:n})}};function uO(t,e){return t!=null&&!t.isSingleLine||e!=null&&!e.isSingleLine?`,
`:", "}o(uO,"getInsertionDelimiter");function OS(t,e){return e.filter(r=>r.domain.intersection(t.contentRange)!=null)}o(OS,"filterItemInfos");function CS(t,e){let{range:r,boundary:n}=DS(t,e);return mO(e.editor,r,n)}o(CS,"getItemInfosForIterationScope");function mO(t,e,r){let n=FS(t,e,r),i=[];return n.forEach((a,s)=>{if(a.type==="separator"||a.type==="boundary")return;let p=(()=>{if(n[s-2]?.type==="item")return new b(n[s-2].range.end,a.range.start);if(n[s-1]?.type==="separator")return new b(n[s-1].range.start,a.range.start)})(),c=(()=>{if(n[s+2]?.type==="item")return new b(a.range.end,n[s+2].range.start);if(n[s+1]?.type==="separator")return new b(a.range.end,n[s+1].range.end)})(),l=n[s-1]?.type==="boundary"||n[s-1]?.type==="separator"?n[s-1].range.end:a.range.start,u=n[s+1]?.type==="boundary"||n[s+1]?.type==="separator"?n[s+1].range.start:a.range.end;i.push({contentRange:a.range,leadingDelimiterRange:p,trailingDelimiterRange:c,domain:new b(l,u)})}),i}o(mO,"getItemsInRange");var Ht={type:"modifyIfUntyped",modifier:{type:"containingScope",scopeType:{type:"line"}}},bf={type:"modifyIfUntyped",modifier:{type:"containingScope",scopeType:{type:"token"}}};var ac=class extends Error{static{o(this,"NoDelimiterError")}constructor(e){super(`Target has no ${e} delimiter.`),this.name="NoDelimiterError"}},sc=class{constructor(e,r){this.modifierStageFactory=e;this.modifier=r}static{o(this,"LeadingStage")}run(e){return this.modifierStageFactory.create(bf).run(e).map(r=>{let n=r.getLeadingDelimiterTarget();if(n==null)throw new ac("leading");return n})}},pc=class{constructor(e,r){this.modifierStageFactory=e;this.modifier=r}static{o(this,"TrailingStage")}run(e){return this.modifierStageFactory.create(bf).run(e).map(r=>{let n=r.getTrailingDelimiterTarget();if(n==null)throw new ac("trailing");return n})}};function cc(t,e,r,n){return lf(e,r,n),r===n?e[r]:gi(t,e[r],e[n],!0,!0)}o(cc,"createRangeTargetFromIndices");function lc(t,e,r){return t.create({type:"everyScope",scopeType:r}).run(e)}o(lc,"getEveryScopeTargets");var uc=class{constructor(e,r){this.modifierStageFactory=e;this.modifier=r}static{o(this,"OrdinalScopeStage")}run(e){let r=lc(this.modifierStageFactory,e,this.modifier.scopeType),n=this.modifier.start+(this.modifier.start<0?r.length:0),i=n+this.modifier.length-1;return this.modifier.isEvery?nS(r,n,i):[cc(e.isReversed,r,n,i)]}};var mc=class{static{o(this,"PositionStage")}run(e){let r={editor:e.editor,isReversed:e.isReversed,contentRange:this.getContentRange(e.contentRange)};return[e.isRaw?new Sr(r):new ee({...r,isToken:!1})]}},fc=class extends mc{static{o(this,"StartOfStage")}getContentRange(e){return e.start.toEmptyRange()}},dc=class extends mc{static{o(this,"EndOfStage")}getContentRange(e){return e.end.toEmptyRange()}};var gc=class{constructor(e,r,n){this.modifierStageFactory=e;this.scopeHandlerFactory=r;this.modifier=n}static{o(this,"PreferredScopeStage")}run(e){let{scopeType:r}=this.modifier,n=new hi(this.modifierStageFactory,this.scopeHandlerFactory,{type:"containingScope",scopeType:r});try{return n.run(e)}catch(s){if(!(s instanceof ve))throw s}let i=this.scopeHandlerFactory.create(this.modifier.scopeType,e.editor.document.languageId);if(i==null)throw Error(`Couldn't create scope handler for: ${r.type}`);let a=fO(e,i);if(a==null)throw Error(`No scopes found for scope type: ${r.type}`);return a}};function fO(t,e){let r=e.generateScopes(t.editor,t.contentRange.start,"backward"),n=e.generateScopes(t.editor,t.contentRange.end,"forward"),{active:i}=t.contentSelection,a=NS(r,i),s=NS(n,i),p=a.distance<s.distance?a.scope:s.scope;return p?.getTargets(t.isReversed)}o(fO,"getClosestScopeTargets");function NS(t,e){let r,n=1/0;for(let i of t){let a=Math.min(LS(e,i.domain.start),LS(e,i.domain.end));if(a<n)r=i,n=a;else break}return{scope:r,distance:n}}o(NS,"getClosestScope");function LS(t,e){return Math.abs(t.line-e.line)*1e4+Math.abs(t.character-e.character)}o(LS,"distanceBetweenPositions");var hc=class{constructor(e,r){this.modifierStageFactory=e;this.modifier=r}static{o(this,"RangeModifierStage")}run(e){let r=this.modifierStageFactory.create(this.modifier.anchor),n=this.modifierStageFactory.create(this.modifier.active),i=r.run(e),a=n.run(e);if(i.length!==1||a.length!==1)throw new Error("Expected single anchor and active target");return[kr(i[0],a[0],this.modifier.excludeAnchor,this.modifier.excludeActive)]}};var yc=class{constructor(e){this.modifier=e}static{o(this,"RawSelectionStage")}run(e){return[new Sr({editor:e.editor,contentRange:e.contentRange,isReversed:e.isReversed})]}};var Tc=class extends Error{static{o(this,"TooFewScopesError")}constructor(e,r,n){super(`Requested ${e} ${n}s, but ${r} are already selected.`),this.name="TooFewScopesError"}};function US(t,e,r){let n=lc(t,yO(r),e.scopeType),i=hO(r.contentRange,n);return dO(e,r,n,i)}o(US,"runLegacy");function dO(t,e,r,n){let i=t.direction==="forward",a=gO(t,e.contentRange,r,i,n),s=i?a+t.length-1:a-t.length+1,p=Math.min(a,s),c=Math.max(a,s);return[cc(e.isReversed,r,p,c)]}o(dO,"calculateIndicesAndCreateTarget");function gO(t,e,r,n,i){let a=t.offset===0;if(i==null){let c=n?r.findIndex(l=>l.contentRange.start.isAfter(e.start)):Li(r,l=>l.contentRange.start.isBefore(e.start));if(c===-1)throw new Jt;return a?c:n?c+t.offset-1:c-t.offset+1}let s=i.start,p=i.end;if(a){let c=p-s+1;if(c>t.length)throw new Tc(t.length,c,t.scopeType.type);return n?s:p}return n?p+t.offset:s-t.offset}o(gO,"computeProximalIndex");function hO(t,e){let r=e.map((i,a)=>({index:a,intersection:i.contentRange.intersection(t)})).filter(i=>i.intersection!=null);if(t.isEmpty){if(r.length===0)return;let i=r.at(-1).index;return{start:i,end:i}}let n=r.filter(i=>!i.intersection.isEmpty).map(i=>i.index);if(n.length!==0)return{start:n[0],end:n.at(-1)}}o(hO,"getContainingIndices");function yO(t){return new Re({editor:t.editor,isReversed:t.isReversed,contentRange:t.contentRange,hasExplicitRange:!1})}o(yO,"createTargetWithoutExplicitRange");var xc=class{constructor(e,r,n){this.modifierStageFactory=e;this.scopeHandlerFactory=r;this.modifier=n}static{o(this,"RelativeScopeStage")}run(e){let r=this.scopeHandlerFactory.create(this.modifier.scopeType,e.editor.document.languageId);if(r==null)return US(this.modifierStageFactory,this.modifier,e);let n=Array.from(this.modifier.offset===0?TO(r,e,this.modifier):xO(r,e,this.modifier));if(n.length<this.modifier.length)throw new Jt;let{isReversed:i}=e;return this.modifier.isEvery?n.flatMap(a=>a.getTargets(i)):zp(i,n[0],n[n.length-1])}};function TO(t,e,r){let{editor:n,contentRange:i}=e,{length:a,direction:s}=r,p=Gp(t,n,s==="forward"?i.start:i.end,s)?.domain;if(p==null)throw new ve(r.scopeType.type);return mo(a,t.generateScopes(n,s==="forward"?p.start:p.end,s,{skipAncestorScopes:!0}))}o(TO,"generateScopesInclusive");function xO(t,e,r){let{editor:n,contentRange:i}=e,{length:a,direction:s,offset:p}=r,c=s==="forward"?i.end:i.start,l=i.isEmpty?"disallowed":"disallowedIfStrict";return qT(t.generateScopes(n,c,s,{containment:l,skipAncestorScopes:!0}),p-1,p+a-1)}o(xO,"generateScopesExclusive");var Sc=class{constructor(e){this.modifier=e}static{o(this,"VisibleStage")}run(e){return e.editor.visibleRanges.map(r=>new ee({editor:e.editor,isReversed:e.isReversed,contentRange:r}))}};var vc=class{constructor(e){this.modifier=e}static{o(this,"NotebookCellStage")}run(e){if(this.modifier.type==="everyScope")throw new Error(`Every ${this.modifier.type} not yet implemented`);return[new Cs({editor:e.editor,isReversed:e.isReversed,contentRange:e.contentRange})]}};var vi=class{constructor(e,r,n){this.languageDefinitions=e;this.storedTargets=r;this.scopeHandlerFactory=n;this.create=this.create.bind(this)}static{o(this,"ModifierStageFactoryImpl")}create(e){switch(e.type){case"startOf":return new fc;case"endOf":return new dc;case"extendThroughStartOf":case"extendThroughEndOf":return new ec(this,e);case"toRawSelection":return new yc(e);case"interiorOnly":return new tc(this,e);case"excludeInterior":return new rc(this,e);case"leading":return new sc(this,e);case"trailing":return new pc(this,e);case"visible":return new Sc(e);case"containingScope":return new hi(this,this.scopeHandlerFactory,e);case"preferredScope":return new gc(this,this.scopeHandlerFactory,e);case"everyScope":return e.scopeType.type==="instance"?new yi(this,this.storedTargets,e):new Qp(this,this.scopeHandlerFactory,e);case"ordinalScope":return e.scopeType.type==="instance"?new yi(this,this.storedTargets,e):new uc(this,e);case"relativeScope":return e.scopeType.type==="instance"?new yi(this,this.storedTargets,e):new xc(this,this.scopeHandlerFactory,e);case"keepContentFilter":return new Zp(e);case"keepEmptyFilter":return new Yp(e);case"cascading":return new $p(this,e);case"modifyIfUntyped":return new fi(this,e);case"range":return new hc(this,e);case"inferPreviousMark":throw Error(`Unexpected modifier '${e.type}'; it should have been removed during inference`)}}getLegacyScopeStage(e){switch(e.scopeType.type){case"notebookCell":return new vc(e);case"collectionItem":return new oc(this.languageDefinitions,this,e);default:return new Si(this.languageDefinitions,e)}}};async function HS(t,e,r){let n=t.registerReplaceEditList(e.document,r.filter(a=>a.isReplace)),i=await e.edit(r);return n(),i}o(HS,"performDocumentEdits");async function K({rangeUpdater:t,editor:e,selections:r,preserveCursorSelections:n,...i}){let a=gr(r),s=a.map(l=>{let u=r[l],m=SO(u);return VS(e.document,m.selections,m.behavior)});n||s.push(VS(e.document,e.selections,1));let p=await("edits"in i?RO(t,e,i.edits,s):BS(t,i.callback,e.document,s));return n||await e.setSelections(p.pop()),Object.fromEntries(a.map((l,u)=>[l,p[u]]))}o(K,"performEditsAndUpdateSelections");function VS(t,e,r){return e.map(n=>vO(t,n,n instanceof q?!n.isReversed:!0,r))}o(VS,"getFullSelectionInfos");function SO(t){return"selections"in t?t:{selections:t,behavior:1}}o(SO,"getSelectionsWithBehavior");function vO(t,e,r,n){return{range:e,isForward:r,expansionBehavior:{start:{type:n===1||n===3?"closed":"open"},end:{type:n===1||n===2?"closed":"open"}},offsets:{start:t.offsetAt(e.start),end:t.offsetAt(e.end)},text:t.getText(e)}}o(vO,"getSelectionInfoInternal");function bO(t){return t.map(e=>e.map(({range:{start:r,end:n},isForward:i})=>i?new q(r,n):new q(n,r)))}o(bO,"selectionInfosToSelections");async function BS(t,e,r,n){let i=t.registerRangeInfoList(r,oe(n));return await e(),i(),bO(n)}o(BS,"callFunctionAndUpdateFullSelectionInfos");async function RO(t,e,r,n){return await BS(t,o(async()=>{if(!await HS(t,e,r))throw new Error("Could not apply edits")},"func"),e.document,n)}o(RO,"performEditsAndUpdateFullSelectionInfos");function Ge(t){if(t.length===0)throw new Error("Require at least one target with this action");let e=t.map(r=>r.editor);if(new Set(e).size>1)throw new Error("Can only have one editor with this action");return e[0]}o(Ge,"ensureSingleEditor");function Ke(t){if(t.length!==1)throw new Error("Can only have one target with this action");return t[0]}o(Ke,"ensureSingleTarget");async function er(t,e,r){return Promise.all(Rf(t,e).map(([n,i])=>r(n,i)))}o(er,"runForEachEditor");async function se(t,e){return er(t,r=>r.editor,e)}o(se,"runOnTargetsForEachEditor");async function WS(t,e){let r=Rf(t,i=>i.editor),n=[];for(let[i,a]of r)n.push(await e(i,a));return n}o(WS,"runOnTargetsForEachEditorSequentially");function jS(t){return Rf(t,e=>e.editor)}o(jS,"groupTargetsForEachEditor");function Rf(t,e){let n=ns(t,o(i=>e(i).document.uri,"getDocumentUri"));return Array.from(n.values(),i=>[e(i[0]),i])}o(Rf,"groupForEachEditor");function bc(t){return t.contentRange}o(bc,"getContentRange");function ht(t,e){return e!=null?ye(t,e).map(([n,i])=>({editor:n.editor,selection:n?.isReversed?new q(i.end,i.start):new q(i.start,i.end)})):t.map(n=>({editor:n.editor,selection:n.contentSelection}))}o(ht,"createThatMark");function $S(t){let e=t.contentRange;return t.isLine?vt(e):Te(e)}o($S,"toGeneralizedRange");function Y(t,e,r,n=bc){return t.flashRanges(e.map(i=>{let a=n(i);return a==null?null:{editor:i.editor,range:i.isLine?vt(a):Te(a),style:r}}).filter(i=>i!=null))}o(Y,"flashTargets");var Rc=class{constructor(e){this.rangeUpdater=e;this.run=this.run.bind(this)}static{o(this,"BreakLine")}async run(e){return await Y(g(),e,"pendingModification0"),{thatSelections:oe(await se(e,async(n,i)=>{let a=i.map(({contentRange:l})=>l),s=wO(n,a),p=g().getEditableTextEditor(n),{contentRanges:c}=await K({rangeUpdater:this.rangeUpdater,editor:p,edits:s,selections:{contentRanges:a}});return ye(i,c).map(([l,u])=>({editor:l.editor,selection:u.toSelection(l.isReversed)}))}))}}};function wO(t,e){let{document:r}=t,n=[];for(let i of e){let a=i.start,s=r.lineAt(a),p=s.text.slice(0,s.rangeTrimmed?.start?.character??s.range.start.character),c=s.text.slice(0,a.character).search(/\s+$/),l=c>-1?new b(new B(s.lineNumber,c),a):a.toEmptyRange();n.push({range:l,text:`
`+p,isReplace:!l.isEmpty})}return n}o(wO,"getEdits");function wc(t){return t.length<2?t:jS(t).flatMap(([e,r])=>{if(r.length<2)return r;let n=[...r];n.sort((a,s)=>a.contentRange.start.compareTo(s.contentRange.start));let i=!0;for(;i;)[n,i]=EO(n);return n})}o(wc,"unifyRemovalTargets");function EO(t){if(t.length<2)return[t,!1];let e=[],r=[];return t.forEach(n=>{r.length&&!_O(r[r.length-1],n)?(e.push(qS(r)),r=[n]):r.push(n)}),e.push(qS(r)),[e,e.length!==t.length]}o(EO,"unifyTargetsOnePass");function qS(t){if(t.length===1)return t[0];let e=t[0],r=t[t.length-1];return kr(e,r)}o(qS,"mergeTargets");function _O(t,e){return!!t.getRemovalRange().intersection(e.getRemovalRange())}o(_O,"intersects");var ko=class{constructor(e,r){this.rangeUpdater=e;this.type=r}static{o(this,"BringMoveSwap")}async decorateTargets(e,r){await Promise.all([Y(g(),e,this.decoration.sourceStyle,this.decoration.getSourceRangeCallback),Y(g(),r,this.decoration.destinationStyle)])}getEditsBringMove(e,r){let n=[],i=[],a=e.length!==r.length&&r.length===1;return e.forEach((s,p)=>{let c=r[p];if((s==null||c==null)&&!a)throw new Error("Targets must have same number of args");if(c!=null){let l;a?l=e.map((u,m)=>{let f=u.contentText,d=(c.isRaw?null:c.insertionDelimiter)??(u.isRaw?null:u.insertionDelimiter);return m>0&&d!=null?d+f:f}).join(""):l=s.contentText,i.push({edit:c.constructChangeEdit(l),editor:c.editor,originalTarget:c.target,isSource:!1})}else c=r[0];n.includes(s)||(n.push(s),this.type==="bring"&&i.push({edit:s.toDestination("to").constructChangeEdit(c.target.contentText),editor:s.editor,originalTarget:s,isSource:!0}))}),this.type==="move"&&wc(n).forEach(s=>{i.push({edit:s.constructRemovalEdit(),editor:s.editor,originalTarget:s,isSource:!0})}),i}async performEditsAndComputeThatMark(e){return oe(await er(e,r=>r.editor,async(r,n)=>{let i=this.type!=="bring"?n:n.filter(({isSource:d})=>!d),a=this.type==="swap"?[]:n.filter(({isSource:d})=>d),s=this.type==="swap"?n:n.filter(({isSource:d})=>!d),p=a.map(({edit:d})=>d.range),c=s.map(({edit:d})=>d.range),l=g().getEditableTextEditor(r),{sourceEditRanges:u,destinationEditRanges:m}=await K({rangeUpdater:this.rangeUpdater,editor:l,edits:i.map(({edit:d})=>d),selections:{sourceEditRanges:p,destinationEditRanges:{selections:c,behavior:0}}}),f=[...this.getMarks(a,u),...this.getMarks(s,m)];return f.sort((d,y)=>n.findIndex(T=>T.originalTarget===d.target)-n.findIndex(T=>T.originalTarget===y.target)),f}))}getMarks(e,r){return e.map((n,i)=>{let a=r[i],s=n.edit.updateRange(a),p=n.originalTarget;return{editor:n.editor,selection:s.toSelection(p.isReversed),isSource:n.isSource,target:p}})}async decorateThatMark(e){let r=o(n=>e.find(i=>i.target===n).selection,"getRange");return Promise.all([Y(g(),e.filter(({isSource:n})=>n).map(({target:n})=>n),this.decoration.sourceStyle,r),Y(g(),e.filter(({isSource:n})=>!n).map(({target:n})=>n),this.decoration.destinationStyle,r)])}calculateMarksBringMove(e){return{thatMark:e.filter(({isSource:r})=>!r),sourceMark:e.filter(({isSource:r})=>r)}}};function zS(t,e){return t.length===1?Array(e.length).fill(t[0]):t}o(zS,"broadcastSource");var Ec=class extends ko{constructor(r){super(r,"bring");this.decoration={sourceStyle:"referenced",destinationStyle:"pendingModification0",getSourceRangeCallback:bc};this.run=this.run.bind(this)}static{o(this,"Bring")}async run(r,n){r=zS(r,n),await this.decorateTargets(r,n.map(c=>c.target));let i=this.getEditsBringMove(r,n),a=await this.performEditsAndComputeThatMark(i),{thatMark:s,sourceMark:p}=this.calculateMarksBringMove(a);return await this.decorateThatMark(s),{thatSelections:s,sourceSelections:p}}},_c=class extends ko{constructor(r){super(r,"move");this.decoration={sourceStyle:"pendingDelete",destinationStyle:"pendingModification0",getSourceRangeCallback:kO};this.run=this.run.bind(this)}static{o(this,"Move")}async run(r,n){r=zS(r,n),await this.decorateTargets(r,n.map(c=>c.target));let i=this.getEditsBringMove(r,n),a=await this.performEditsAndComputeThatMark(i),{thatMark:s,sourceMark:p}=this.calculateMarksBringMove(a);return await this.decorateThatMark(s),{thatSelections:s,sourceSelections:p}}},kc=class extends ko{constructor(r){super(r,"swap");this.decoration={sourceStyle:"pendingModification1",destinationStyle:"pendingModification0",getSourceRangeCallback:bc};this.run=this.run.bind(this)}static{o(this,"Swap")}async run(r,n){await this.decorateTargets(r,n);let i=this.getEditsSwap(r,n),a=await this.performEditsAndComputeThatMark(i);return await this.decorateThatMark(a),{thatSelections:a,sourceSelections:[]}}getEditsSwap(r,n){let i=[];return r.forEach((a,s)=>{let p=n[s];if(a==null||p==null)throw new Error("Targets must have same number of args");i.push({edit:p.toDestination("to").constructChangeEdit(a.contentText),editor:p.editor,originalTarget:p,isSource:!1}),i.push({edit:a.toDestination("to").constructChangeEdit(p.contentText),editor:a.editor,originalTarget:a,isSource:!0})}),i}};function kO(t){return t.getRemovalHighlightRange()}o(kO,"getRemovalHighlightRange");var Po=class{constructor(e){this.actions=e;this.run=this.run.bind(this)}static{o(this,"Call")}async run(e,r){Ke(e);let{returnValue:n}=await this.actions.getText.run(e,{showDecorations:!1}),{thatSelections:i}=await this.actions.wrapWithPairedDelimiter.run(r,n[0]+"(",")");return{thatSelections:i}}};var Do=class{constructor(e){this.actions=e;this.run=this.run.bind(this)}static{o(this,"Clear")}async run(e){let r=Ge(e),n=e.map(a=>new ee({editor:a.editor,isReversed:a.isReversed,contentRange:a.contentRange})),{thatTargets:i}=await this.actions.remove.run(n);return i!=null&&await g().getEditableTextEditor(r).setSelections(i.map(({contentSelection:a})=>a),{focusEditor:!0}),{thatTargets:i}}};var bi=o(t=>new Re({editor:t.editor,isReversed:t.selection.isReversed,contentRange:t.selection,hasExplicitRange:!0}),"selectionToStoredTarget");var Ri=class{constructor(e){this.rangeUpdater=e;this.run=this.run.bind(this)}static{o(this,"CallbackAction")}async run(e,r){r.showDecorations&&await Y(g(),e,"referenced"),r.ensureSingleEditor&&Ge(e),r.ensureSingleTarget&&Ke(e);let n=g().activeEditableTextEditor,i=r.setSelection?WS:se,a=oe(await i(e,(s,p)=>this.runForEditor(r,s,p)));return r.setSelection&&r.restoreSelection&&n!=null&&!n.isActive&&await n.focus(),{thatTargets:a}}async runForEditor(e,r,n){let i=g().getEditableTextEditor(r),a=r.selections,s=r.document.version,p=n.map(u=>u.contentSelection);e.setSelection&&await i.setSelections(p,{focusEditor:!0,revealRange:!1});let{originalSelections:c,targetSelections:l}=await K({rangeUpdater:this.rangeUpdater,editor:i,callback:o(()=>e.callback(i,n),"callback"),preserveCursorSelections:!0,selections:{originalSelections:a,targetSelections:p}});return e.setSelection&&e.restoreSelection&&await i.setSelections(c),r.document.version===s?n:l.map(u=>bi({editor:r,selection:u}))}};var Ae=class{constructor(e){this.ensureSingleEditor=!1;this.ensureSingleTarget=!1;this.restoreSelection=!0;this.showDecorations=!0;this.callbackAction=new Ri(e),this.run=this.run.bind(this)}static{o(this,"SimpleIdeCommandAction")}async run(e,{showDecorations:r}={}){let n=g().capabilities.commands[this.command];if(n==null)throw Error(`Action ${this.command} is not supported by your ide`);let{acceptsLocation:i}=n;return this.callbackAction.run(e,{callback:o((a,s)=>PO(a,i?s.map(p=>p.contentRange):void 0,this.command),"callback"),setSelection:!i,ensureSingleEditor:this.ensureSingleEditor,ensureSingleTarget:this.ensureSingleTarget,restoreSelection:this.restoreSelection,showDecorations:r??this.showDecorations})}},Pc=class extends Ae{constructor(){super(...arguments);this.command="clipboardCopy";this.ensureSingleEditor=!0}static{o(this,"CopyToClipboardSimple")}},Dc=class extends Ae{constructor(){super(...arguments);this.command="toggleLineComment"}static{o(this,"ToggleLineComment")}},Mc=class extends Ae{constructor(){super(...arguments);this.command="indentLine"}static{o(this,"IndentLineSimpleAction")}},Ac=class extends Ae{constructor(){super(...arguments);this.command="outdentLine"}static{o(this,"OutdentLineSimpleAction")}},Fc=class extends Ae{constructor(){super(...arguments);this.command="fold"}static{o(this,"Fold")}},Ic=class extends Ae{constructor(){super(...arguments);this.command="unfold"}static{o(this,"Unfold")}},Oc=class extends Ae{constructor(){super(...arguments);this.command="rename";this.ensureSingleTarget=!0}static{o(this,"Rename")}},Cc=class extends Ae{constructor(){super(...arguments);this.command="showReferences";this.ensureSingleTarget=!0}static{o(this,"ShowReferences")}},Nc=class extends Ae{constructor(){super(...arguments);this.command="quickFix";this.ensureSingleTarget=!0}static{o(this,"ShowQuickFix")}},Lc=class extends Ae{constructor(){super(...arguments);this.command="revealDefinition";this.ensureSingleTarget=!0;this.restoreSelection=!1}static{o(this,"RevealDefinition")}},Uc=class extends Ae{constructor(){super(...arguments);this.command="revealTypeDefinition";this.ensureSingleTarget=!0;this.restoreSelection=!1}static{o(this,"RevealTypeDefinition")}},Hc=class extends Ae{constructor(){super(...arguments);this.command="showHover";this.ensureSingleTarget=!0;this.restoreSelection=!1}static{o(this,"ShowHover")}},Vc=class extends Ae{constructor(){super(...arguments);this.command="showDebugHover";this.ensureSingleTarget=!0;this.restoreSelection=!1}static{o(this,"ShowDebugHover")}},Bc=class extends Ae{constructor(){super(...arguments);this.command="extractVariable";this.ensureSingleTarget=!0;this.restoreSelection=!1}static{o(this,"ExtractVariable")}};function PO(t,e,r){switch(r){case"toggleLineComment":return t.toggleLineComment(e);case"indentLine":return t.indentLine(e);case"outdentLine":return t.outdentLine(e);case"clipboardCopy":return t.clipboardCopy(e);case"fold":return t.fold(e);case"unfold":return t.unfold(e);case"insertLineAfter":return t.insertLineAfter(e);case"rename":return t.rename(e?.[0]);case"showReferences":return t.showReferences(e?.[0]);case"quickFix":return t.quickFix(e?.[0]);case"revealDefinition":return t.revealDefinition(e?.[0]);case"revealTypeDefinition":return t.revealTypeDefinition(e?.[0]);case"showHover":return t.showHover(e?.[0]);case"showDebugHover":return t.showDebugHover(e?.[0]);case"extractVariable":return t.extractVariable(e?.[0]);case"highlight":throw Error("Highlight command not supported as simple action")}}o(PO,"callback");var Wc=class{constructor(e,r){this.actions=e;this.rangeUpdater=r;this.run=this.run.bind(this)}static{o(this,"CopyToClipboard")}async run(e,r={showDecorations:!0}){if(g().capabilities.commands.clipboardCopy!=null)return new Pc(this.rangeUpdater).run(e,r);r.showDecorations&&await Y(g(),e,"referenced",i=>i.contentRange);let n=e.map(i=>i.contentText).join(`
`);return await g().clipboard.writeText(n),{thatTargets:e}}};var jc=class{constructor(e){this.actions=e;this.run=this.run.bind(this)}static{o(this,"CutToClipboard")}async run(e){await g().flashRanges(e.flatMap(i=>{let{editor:a,contentRange:s}=i,p=i.getRemovalHighlightRange();return i.isLine?[{editor:a,range:Te(s),style:"referenced"},{editor:a,range:vt(p),style:"pendingDelete"}]:[{editor:a,range:Te(s),style:"referenced"},...DO(s,p).map(c=>({editor:a,range:Te(c),style:"pendingDelete"}))]}));let r={showDecorations:!1};await this.actions.copyToClipboard.run(e,r);let{thatTargets:n}=await this.actions.remove.run(e,r);return{thatTargets:n}}};function DO(t,e){let{start:r,end:n}=t,{start:i,end:a}=e,s=[];return i.isBefore(r)&&s.push(new b(i,r)),a.isAfter(n)&&s.push(new b(n,a)),s}o(DO,"getOutsideOverflow");var Mo=class{static{o(this,"Deselect")}constructor(){this.run=this.run.bind(this)}async run(e){return await se(e,async(r,n)=>{let i=r.selections.filter(a=>!n.some(s=>{let p=s.contentRange.intersection(a);return p&&(!p.isEmpty||a.isEmpty)}));if(i.length===0)throw new wf;await g().getEditableTextEditor(r).setSelections(i)}),{thatTargets:e}}},wf=class extends Error{static{o(this,"SelectionRequiredError")}constructor(){super("Can't deselect every selection. At least one is required"),this.name="SelectionRequiredError"}};async function GS(t,e,r,n){let i=r.destinations.map((y,T)=>{if(n||y.getEditNewActionType()==="edit")return{destination:y,index:T}}).filter(y=>!!y);if(i.length===0)return r;let a=i.map(y=>y.destination.constructChangeEdit("")),s=r.cursorRanges.map((y,T)=>({range:y,index:T})).filter(({range:y})=>y!=null),p=s.map(({index:y})=>y),c=s.map(({range:y})=>y),l=a.map(y=>y.range),{thatRanges:u,cursorRanges:m,editRanges:f}=await K({rangeUpdater:t,editor:e,edits:a,preserveCursorSelections:!0,selections:{thatRanges:r.thatRanges,cursorRanges:c,editRanges:{selections:l,behavior:0}}}),d=[...r.cursorRanges];return ye(p,m).forEach(([y,T])=>{d[y]=T}),i.forEach((y,T)=>{let R=a[T].updateRange(f[T]);d[y.index]=R}),{destinations:r.destinations,thatRanges:u,cursorRanges:d}}o(GS,"runEditTargets");async function KS({acceptsLocation:t},e,r,n){let i=n.destinations.map((m,f)=>{if(m.getEditNewActionType()==="insertLineAfter")return{destination:m,index:f}}).filter(m=>!!m);if(i.length===0)return n;let a=i.map(({destination:m})=>m.contentRange),s=n.destinations.map(({contentRange:m})=>m),p=o(async()=>{t?await r.insertLineAfter(a):(await r.setSelections(a.map(m=>m.toSelection(!1))),await r.focus(),await r.insertLineAfter())},"callback"),{targetRanges:c,thatRanges:l}=await K({rangeUpdater:e,editor:r,callback:p,preserveCursorSelections:!0,selections:{targetRanges:s,thatRanges:n.thatRanges}}),u=[...n.cursorRanges];return i.forEach((m,f)=>{u[m.index]=r.selections[f]}),{destinations:n.destinations.map((m,f)=>m.withTarget(m.target.withContentRange(c[f]))),thatRanges:l,cursorRanges:u}}o(KS,"runInsertLineAfterTargets");async function QS(t,e){let r=Ke(e),n=g().getEditableTextEditor(r.editor),i=r.insertionMode==="before";if(r.insertionMode==="to")throw Error(`Unsupported insertion mode '${r.insertionMode}' for notebookcapell`);await t.setSelection.run([r.target]);let a=o(p=>p,"modifyThatMark");i?a=await n.editNewNotebookCellAbove():await n.editNewNotebookCellBelow();let s=ht([r.target.thatTarget]);return s[0].selection=a(s[0].selection),{thatSelections:s}}o(QS,"runEditNewNotebookCellTargets");var $c=class{constructor(e,r){this.rangeUpdater=e;this.actions=r;this.run=this.run.bind(this)}static{o(this,"EditNew")}async run(e){if(e.some(({target:p})=>p.isNotebookCell))return QS(this.actions,e);let r=g().getEditableTextEditor(Ge(e)),n={destinations:e,thatRanges:e.map(({target:p})=>p.thatTarget.contentRange),cursorRanges:new Array(e.length).fill(void 0)},i=g().capabilities.commands.insertLineAfter,a=i!=null;a&&(n=await KS(i,this.rangeUpdater,r,n)),n=await GS(this.rangeUpdater,r,n,!a);let s=n.destinations.map((p,c)=>n.cursorRanges[c].toSelection(p.target.isReversed));return await r.setSelections(s,{focusEditor:!0}),{thatSelections:ht(n.destinations.map(p=>p.target),n.thatRanges)}}};var qc=class{constructor(e,r){this.actions=e;this.modifierStageFactory=r;this.run=this.run.bind(this)}static{o(this,"EditNewLineAction")}getFinalStages(){return[this.modifierStageFactory.create(Ht)]}run(e){return this.actions.editNew.run(e.map(r=>r.toDestination(this.insertionMode)))}},zc=class extends qc{constructor(){super(...arguments);this.insertionMode="before"}static{o(this,"EditNewBefore")}},Gc=class extends qc{constructor(){super(...arguments);this.insertionMode="after"}static{o(this,"EditNewAfter")}};var Ao=class{static{o(this,"ExecuteCommand")}constructor(e){this.callbackAction=new Ri(e),this.run=this.run.bind(this)}async run(e,r,{commandArgs:n,ensureSingleEditor:i,ensureSingleTarget:a,restoreSelection:s,showDecorations:p}={}){let c=n??[];return this.callbackAction.run(e,{callback:o(()=>g().executeCommand(r,...c),"callback"),setSelection:!0,ensureSingleEditor:i??!1,ensureSingleTarget:a??!1,restoreSelection:s??!0,showDecorations:p??!0})}};var Kc=class{constructor(e){this.actions=e;this.run=this.run.bind(this)}static{o(this,"Find")}async run(e){Ke(e);let{returnValue:r,thatTargets:n}=await this.actions.getText.run(e),[i]=r,a;return i.length>200?(a=i.substring(0,200),qi(g().messages,"truncatedSearchText","Search text is longer than 200 characters; truncating")):a=i,await this.find(a),{thatTargets:n}}},Qc=class extends Kc{static{o(this,"FindInDocument")}find(e){return g().findInDocument(e)}},Zc=class extends Kc{static{o(this,"FindInWorkspace")}find(e){return g().findInWorkspace(e)}};var wi=class{constructor(e){this.options=e;this.run=this.run.bind(this)}static{o(this,"FollowLink")}async run(e){let r=Ke(e);return await Y(g(),e,"referenced"),await g().getEditableTextEditor(r.editor).openLink(r.contentRange,this.options),{thatSelections:ht(e)}}};function ZS(t,e){let r=[],n=0,i=null,[a,...s]=t.split(/\r?\n/);return[{text:e+a,startIndex:e.length},...s.map(c=>({text:c,startIndex:0}))].forEach(({text:c,startIndex:l})=>{let u=c.match(/^\s*/)?.[0]??"",m=u.length;i!=null&&(u.length>i.length?n++:u.length<i.length&&n--),i=u;let f=Math.max(m,l),d=xu("	",n),y=c.slice(f);r.push(d+y)}),r}o(ZS,"constructSnippetBody");function YS(t,e){let r=vu(e,a=>a.offsets.start),n="",i=0;for(let a of r)n+=t.slice(i,a.offsets.start)+a.text,i=a.offsets.end;return n+=t.slice(i),n}o(YS,"editText");var Fo=class{constructor(){this.substitutions=[]}static{o(this,"Substituter")}addSubstitution(e,r=!1){let n=MO(10);return this.substitutions.push({to:e,randomId:n,isQuoted:r}),n}makeSubstitutions(e){return this.substitutions.forEach(({to:r,randomId:n,isQuoted:i})=>{let a=i?`"${n}"`:n;e=e.split(a).join(r)}),e}};function MO(t){let e="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=r.length;for(let i=0;i<t;i++)e+=r.charAt(Math.floor(Math.random()*n));return e}o(MO,"makeid");var Ei=class{constructor(e){this.snippets=e;this.run=this.run.bind(this)}static{o(this,"GenerateSnippet")}async run(e,r){let n=Ke(e),i=n.editor;if(Y(g(),e,"referenced"),r==null&&(r=await g().showInputBox({prompt:"Name of snippet",placeHolder:"helloWorld"})),r==null)return{};let a=1,s=i.document.offsetAt(n.contentRange.start),p=i.selections.filter(R=>n.contentRange.contains(R)).map((R,A)=>({offsets:{start:i.document.offsetAt(R.start)-s,end:i.document.offsetAt(R.end)-s},defaultName:`variable${A+1}`,placeholderIndex:a++})),c=new Fo,l=i.document.getText(new b(n.contentRange.start.with(void 0,0),n.contentRange.start)),u=i.document.getText(n.contentRange),m=YS(u,[...st(u,/\$|\\/g,R=>({offsets:{start:R.index,end:R.index+R[0].length},text:R[0]==="\\"?`\\${R[0]}`:`\\\\${R[0]}`})),...p.map(({offsets:R,defaultName:A,placeholderIndex:ne})=>({offsets:R,text:c.addSubstitution(["\\$","${",ne,":",A,"}"].join(""))}))]),f=ZS(m,l),d=o(({placeholderIndex:R})=>{let A="$"+R,ne=c.addSubstitution("{$"+a+++"}",!0);return[A,ne]},"constructVariableDescriptionEntry"),y={[r]:{definitions:[{scope:{langIds:[i.document.languageId]},body:f}],description:"$"+a++,variables:p.length===0?void 0:Object.fromEntries(p.map(d))}},T=c.makeSubstitutions(JSON.stringify(y,null,2)),k=g().getEditableTextEditor(i);return g().runMode==="test"?await k.setSelections([i.document.range.toSelection(!1)]):await this.snippets.openNewSnippetFile(r),await k.insertSnippet(T),{thatSelections:e.map(({editor:R,contentSelection:A})=>({editor:R,selection:A}))}}};var Io=class{static{o(this,"GetTargets")}constructor(){this.run=this.run.bind(this)}async run(e){return{returnValue:e.map(({contentRange:r})=>({contentRange:r})),thatTargets:e}}};var Oo=class{static{o(this,"GetText")}constructor(){this.run=this.run.bind(this)}async run(e,{showDecorations:r=!0,ensureSingleTarget:n=!1}={}){return r&&await Y(g(),e,"referenced"),n&&Ke(e),{returnValue:e.map(i=>i.contentText),thatTargets:e}}};var Co=class{static{o(this,"Highlight")}constructor(){this.run=this.run.bind(this)}async run(e,r){if(g().capabilities.commands.highlight==null)throw Error("The highlight action is not supported by your ide");return e.length===0?await Promise.all(g().visibleTextEditors.map(n=>g().setHighlightRanges(r,n,[]))):await se(e,(n,i)=>g().setHighlightRanges(r,n,i.map($S))),{thatTargets:e}}};var Yc=class{constructor(e,r,n){this.rangeUpdater=e;this.modifierStageFactory=r;this.isBefore=n;this.getFinalStages=o(()=>[this.modifierStageFactory.create(Ht)],"getFinalStages");this.run=this.run.bind(this),this.runForEditor=this.runForEditor.bind(this)}static{o(this,"InsertCopy")}async run(e){let r=oe(await se(e,this.runForEditor));return await g().flashRanges(r.flatMap(n=>n.thatMark.map(i=>({editor:i.editor,range:Te(i.selection),style:"justAdded"})))),{sourceSelections:r.flatMap(({sourceMark:n})=>n),thatSelections:r.flatMap(({thatMark:n})=>n)}}async runForEditor(e,r){let n=this.isBefore?"after":"before",i=r.flatMap(f=>f.toDestination(n).constructChangeEdit(f.contentText)),a=r.map(({contentSelection:f})=>f),s=i.map(({range:f})=>f),p=g().getEditableTextEditor(e),{contentSelections:c,editRanges:l}=await K({rangeUpdater:this.rangeUpdater,editor:p,edits:i,selections:{contentSelections:a,editRanges:{selections:s,behavior:0}}}),u=ye(i,l).map(([f,d])=>f.updateRange(d)),m=e.selections[0];return c.some(f=>f.intersection(m)!=null)&&await p.revealRange(m),{sourceMark:ht(r,u),thatMark:ht(r,c)}}},Jc=class extends Yc{static{o(this,"CopyContentBefore")}constructor(e,r){super(e,r,!0)}},Xc=class extends Yc{static{o(this,"CopyContentAfter")}constructor(e,r){super(e,r,!1)}};var No=class{constructor(e,r){this.rangeUpdater=e;this.modifierStageFactory=r;this.run=this.run.bind(this)}static{o(this,"InsertEmptyLines")}getFinalStages(){return[this.modifierStageFactory.create(Ht)]}async run(e){let r=await se(e,async(i,a)=>{let s=this.getEdits(a),p=a.map(u=>u.thatTarget.contentSelection),{contentSelections:c,editRanges:l}=await K({rangeUpdater:this.rangeUpdater,editor:g().getEditableTextEditor(i),edits:s,selections:{contentSelections:p,editRanges:{selections:s.map(u=>u.range),behavior:0}}});return{thatMark:c.map(u=>({editor:i,selection:u})),flashRanges:Wr(s,l).map(([u,m])=>({editor:i,range:u.isLine?u.updateRange(m):m,isLine:u.isLine}))}});return await g().flashRanges(r.flatMap(i=>i.flashRanges.map(({editor:a,range:s,isLine:p})=>({editor:a,range:p?vt(s):Te(s),style:"justAdded"})))),{thatSelections:r.flatMap(i=>i.thatMark)}}},el=class extends No{static{o(this,"InsertEmptyLinesAround")}constructor(e,r){super(e,r)}getEdits(e){return e.flatMap(r=>[nl(r,"before"),nl(r,"after")])}},tl=class extends No{static{o(this,"InsertEmptyLineAbove")}constructor(e,r){super(e,r)}getEdits(e){return e.map(r=>nl(r,"before"))}},rl=class extends No{static{o(this,"InsertEmptyLineBelow")}constructor(e,r){super(e,r)}getEdits(e){return e.map(r=>nl(r,"after"))}};function nl(t,e){return{...t.toDestination(e).constructChangeEdit("",!0),isLine:t.isLine}}o(nl,"constructChangeEdit");var Ef=class t{constructor(){this.value="";this.pos=0}static{o(this,"Scanner")}static{this._table={36:0,58:1,44:2,123:3,125:4,92:5,47:6,124:7,43:11,45:12,63:13}}static isDigitCharacter(e){return e>=48&&e<=57}static isVariableCharacter(e){return e===95||e>=97&&e<=122||e>=65&&e<=90}text(e){this.value=e,this.pos=0}tokenText(e){return this.value.substr(e.pos,e.len)}next(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};let e=this.pos,r=0,n=this.value.charCodeAt(e),i;if(i=t._table[n],typeof i=="number")return this.pos+=1,{type:i,pos:e,len:1};if(t.isDigitCharacter(n)){i=8;do r+=1,n=this.value.charCodeAt(e+r);while(t.isDigitCharacter(n));return this.pos+=r,{type:i,pos:e,len:r}}if(t.isVariableCharacter(n)){i=9;do n=this.value.charCodeAt(e+ ++r);while(t.isVariableCharacter(n)||t.isDigitCharacter(n));return this.pos+=r,{type:i,pos:e,len:r}}i=10;do r+=1,n=this.value.charCodeAt(e+r);while(!isNaN(n)&&typeof t._table[n]>"u"&&!t.isDigitCharacter(n)&&!t.isVariableCharacter(n));return this.pos+=r,{type:i,pos:e,len:r}}},Mr=class{constructor(){this._children=[]}static{o(this,"Marker")}appendChild(e){return e instanceof Qe&&this._children[this._children.length-1]instanceof Qe?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this}replace(e,r){let{parent:n}=e,i=n.children.indexOf(e),a=n.children.slice(0);a.splice(i,1,...r),n._children=a,o(function s(p,c){for(let l of p)l.parent=c,s(l.children,l)},"_fixParent")(r,n)}get children(){return this._children}get snippet(){let e=this;for(;;){if(!e)return;if(e instanceof al)return e;e=e.parent}}toString(){return this.children.reduce((e,r)=>e+r.toString(),"")}len(){return 0}},Qe=class t extends Mr{constructor(r){super();this.value=r}static{o(this,"Text")}static escape(r){return r.replace(/\$|}|\\/g,"\\$&")}toString(){return this.value}toTextmateString(){return t.escape(this.value)}len(){return this.value.length}clone(){return new t(this.value)}},il=class extends Mr{static{o(this,"TransformableMarker")}},it=class t extends il{constructor(r){super();this.index=r}static{o(this,"Placeholder")}static compareByIndex(r,n){return r.index===n.index?0:r.isFinalTabstop?1:n.isFinalTabstop||r.index<n.index?-1:r.index>n.index?1:0}get isFinalTabstop(){return this.index===0}get choice(){return this._children.length===1&&this._children[0]instanceof ol?this._children[0]:void 0}toTextmateString(){let r="";return this.transform&&(r=this.transform.toTextmateString()),this.children.length===0&&!this.transform?`$${this.index}`:this.children.length===0?`\${${this.index}${r}}`:this.choice?`\${${this.index}|${this.choice.toTextmateString()}|${r}}`:`\${${this.index}:${this.children.map(n=>n.toTextmateString()).join("")}${r}}`}clone(){let r=new t(this.index);return this.transform&&(r.transform=this.transform.clone()),r._children=this.children.map(n=>n.clone()),r}},ol=class t extends Mr{constructor(){super(...arguments);this.options=[]}static{o(this,"Choice")}appendChild(r){return r instanceof Qe&&(r.parent=this,this.options.push(r)),this}toString(){return this.options[0].value}toTextmateString(){return this.options.map(r=>r.value.replace(/\||,|\\/g,"\\$&")).join(",")}len(){return this.options[0].len()}clone(){let r=new t;return this.options.forEach(r.appendChild,r),r}},_f=class t extends Mr{constructor(){super(...arguments);this.regexp=new RegExp("")}static{o(this,"Transform")}resolve(r){let n=this,i=!1,a=r.replace(this.regexp,function(){return i=!0,n._replace(Array.prototype.slice.call(arguments,0,-2))});return!i&&this._children.some(s=>s instanceof _t&&!!s.elseValue)&&(a=this._replace([])),a}_replace(r){let n="";for(let i of this._children)if(i instanceof _t){let a=r[i.index]||"";a=i.resolve(a),n+=a}else n+=i.toString();return n}toString(){return""}toTextmateString(){return`/${this.regexp.source}/${this.children.map(r=>r.toTextmateString())}/${(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")}`}clone(){let r=new t;return r.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),r._children=this.children.map(n=>n.clone()),r}},_t=class t extends Mr{constructor(r,n,i,a){super();this.index=r;this.shorthandName=n;this.ifValue=i;this.elseValue=a}static{o(this,"FormatString")}resolve(r){return this.shorthandName==="upcase"?r?r.toLocaleUpperCase():"":this.shorthandName==="downcase"?r?r.toLocaleLowerCase():"":this.shorthandName==="capitalize"?r?r[0].toLocaleUpperCase()+r.substr(1):"":this.shorthandName==="pascalcase"?r?this._toPascalCase(r):"":this.shorthandName==="camelcase"?r?this._toCamelCase(r):"":r&&typeof this.ifValue=="string"?this.ifValue:!r&&typeof this.elseValue=="string"?this.elseValue:r||""}_toPascalCase(r){let n=r.match(/[a-z0-9]+/gi);return n?n.map(i=>i.charAt(0).toUpperCase()+i.substr(1).toLowerCase()).join(""):r}_toCamelCase(r){let n=r.match(/[a-z0-9]+/gi);return n?n.map((i,a)=>a===0?i.toLowerCase():i.charAt(0).toUpperCase()+i.substr(1).toLowerCase()).join(""):r}toTextmateString(){let r="${";return r+=this.index,this.shorthandName?r+=`:/${this.shorthandName}`:this.ifValue&&this.elseValue?r+=`:?${this.ifValue}:${this.elseValue}`:this.ifValue?r+=`:+${this.ifValue}`:this.elseValue&&(r+=`:-${this.elseValue}`),r+="}",r}clone(){return new t(this.index,this.shorthandName,this.ifValue,this.elseValue)}},Ar=class t extends il{constructor(r){super();this.name=r}static{o(this,"Variable")}resolve(r){let n=r.resolve(this);return this.transform&&(n=this.transform.resolve(n||"")),n!==void 0?(this._children=[new Qe(n)],!0):!1}toTextmateString(){let r="";return this.transform&&(r=this.transform.toTextmateString()),this.children.length===0?`\${${this.name}${r}}`:`\${${this.name}:${this.children.map(n=>n.toTextmateString()).join("")}${r}}`}clone(){let r=new t(this.name);return this.transform&&(r.transform=this.transform.clone()),r._children=this.children.map(n=>n.clone()),r}};function JS(t,e){let r=[...t];for(;r.length>0;){let n=r.shift();if(!e(n))break;r.unshift(...n.children)}}o(JS,"walk");var al=class t extends Mr{static{o(this,"TextmateSnippet")}get placeholderInfo(){if(!this._placeholders){let e=[],r;this.walk(function(n){return n instanceof it&&(e.push(n),r=!r||r.index<n.index?n:r),!0}),this._placeholders={all:e,last:r}}return this._placeholders}get placeholders(){let{all:e}=this.placeholderInfo;return e}offset(e){let r=0,n=!1;return this.walk(i=>i===e?(n=!0,!1):(r+=i.len(),!0)),n?r:-1}fullLen(e){let r=0;return JS([e],n=>(r+=n.len(),!0)),r}enclosingPlaceholders(e){let r=[],{parent:n}=e;for(;n;)n instanceof it&&r.push(n),n=n.parent;return r}resolveVariables(e){return this.walk(r=>(r instanceof Ar&&r.resolve(e)&&(this._placeholders=void 0),!0)),this}appendChild(e){return this._placeholders=void 0,super.appendChild(e)}replace(e,r){return this._placeholders=void 0,super.replace(e,r)}toTextmateString(){return this.children.reduce((e,r)=>e+r.toTextmateString(),"")}clone(){let e=new t;return this._children=this.children.map(r=>r.clone()),e}walk(e){JS(this.children,e)}},_i=class{constructor(){this._scanner=new Ef;this._token={type:14,pos:0,len:0}}static{o(this,"SnippetParser")}static escape(e){return e.replace(/\$|}|\\/g,"\\$&")}static guessNeedsClipboard(e){return/\${?CLIPBOARD/.test(e)}text(e){return this.parse(e).toString()}parse(e,r,n){this._scanner.text(e),this._token=this._scanner.next();let i=new al;for(;this._parse(i););let a=new Map,s=[],p=0;i.walk(c=>(c instanceof it&&(p+=1,c.isFinalTabstop?a.set(0,void 0):!a.has(c.index)&&c.children.length>0?a.set(c.index,c.children):s.push(c)),!0));for(let c of s){let l=a.get(c.index);if(l){let u=new it(c.index);u.transform=c.transform;for(let m of l)u.appendChild(m.clone());i.replace(c,[u])}}return n||(n=p>0&&r),!a.has(0)&&n&&i.appendChild(new it(0)),i}_accept(e,r){if(e===void 0||this._token.type===e){let n=r?this._scanner.tokenText(this._token):!0;return this._token=this._scanner.next(),n}return!1}_backTo(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1}_until(e){let r=this._token;for(;this._token.type!==e;){if(this._token.type===14)return!1;if(this._token.type===5){let i=this._scanner.next();if(i.type!==0&&i.type!==4&&i.type!==5)return!1}this._token=this._scanner.next()}let n=this._scanner.value.substring(r.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),n}_parse(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)}_parseEscaped(e){let r;return(r=this._accept(5,!0))?(r=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||r,e.appendChild(new Qe(r)),!0):!1}_parseTabstopOrVariableName(e){let r,n=this._token;return this._accept(0)&&(r=this._accept(9,!0)||this._accept(8,!0))?(e.appendChild(/^\d+$/.test(r)?new it(Number(r)):new Ar(r)),!0):this._backTo(n)}_parseComplexPlaceholder(e){let r,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(r=this._accept(8,!0))))return this._backTo(n);let a=new it(Number(r));if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(a),!0;if(!this._parse(a))return e.appendChild(new Qe("${"+r+":")),a.children.forEach(e.appendChild,e),!0}else if(a.index>0&&this._accept(7)){let s=new ol;for(;;){if(this._parseChoiceElement(s)){if(this._accept(2))continue;if(this._accept(7)&&(a.appendChild(s),this._accept(4)))return e.appendChild(a),!0}return this._backTo(n),!1}}else return this._accept(6)?this._parseTransform(a)?(e.appendChild(a),!0):(this._backTo(n),!1):this._accept(4)?(e.appendChild(a),!0):this._backTo(n)}_parseChoiceElement(e){let r=this._token,n=[];for(;!(this._token.type===2||this._token.type===7);){let i;if((i=this._accept(5,!0))?i=this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||i:i=this._accept(void 0,!0),!i)return this._backTo(r),!1;n.push(i)}return n.length===0?(this._backTo(r),!1):(e.appendChild(new Qe(n.join(""))),!0)}_parseComplexVariable(e){let r,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(r=this._accept(9,!0))))return this._backTo(n);let a=new Ar(r);if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(a),!0;if(!this._parse(a))return e.appendChild(new Qe("${"+r+":")),a.children.forEach(e.appendChild,e),!0}else return this._accept(6)?this._parseTransform(a)?(e.appendChild(a),!0):(this._backTo(n),!1):this._accept(4)?(e.appendChild(a),!0):this._backTo(n)}_parseTransform(e){let r=new _f,n="",i="";for(;!this._accept(6);){let a;if(a=this._accept(5,!0)){a=this._accept(6,!0)||a,n+=a;continue}if(this._token.type!==14){n+=this._accept(void 0,!0);continue}return!1}for(;!this._accept(6);){let a;if(a=this._accept(5,!0)){a=this._accept(5,!0)||this._accept(6,!0)||a,r.appendChild(new Qe(a));continue}if(!(this._parseFormatString(r)||this._parseAnything(r)))return!1}for(;!this._accept(4);){if(this._token.type!==14){i+=this._accept(void 0,!0);continue}return!1}try{r.regexp=new RegExp(n,i)}catch{return!1}return e.transform=r,!0}_parseFormatString(e){let r=this._token;if(!this._accept(0))return!1;let n=!1;this._accept(3)&&(n=!0);let i=this._accept(8,!0);if(i)if(n){if(this._accept(4))return e.appendChild(new _t(Number(i))),!0;if(!this._accept(1))return this._backTo(r),!1}else return e.appendChild(new _t(Number(i))),!0;else return this._backTo(r),!1;if(this._accept(6)){let a=this._accept(9,!0);return!a||!this._accept(4)?(this._backTo(r),!1):(e.appendChild(new _t(Number(i),a)),!0)}else if(this._accept(11)){let a=this._until(4);if(a)return e.appendChild(new _t(Number(i),void 0,a,void 0)),!0}else if(this._accept(12)){let a=this._until(4);if(a)return e.appendChild(new _t(Number(i),void 0,void 0,a)),!0}else if(this._accept(13)){let a=this._until(1);if(a){let s=this._until(4);if(s)return e.appendChild(new _t(Number(i),void 0,a,s)),!0}}else{let a=this._until(4);if(a)return e.appendChild(new _t(Number(i),void 0,void 0,a)),!0}return this._backTo(r),!1}_parseAnything(e){return this._token.type!==14?(e.appendChild(new Qe(this._scanner.tokenText(this._token))),this._accept(void 0),!0):!1}};var XS=Object.freeze({CURRENT_YEAR:!0,CURRENT_YEAR_SHORT:!0,CURRENT_MONTH:!0,CURRENT_DATE:!0,CURRENT_HOUR:!0,CURRENT_MINUTE:!0,CURRENT_SECOND:!0,CURRENT_DAY_NAME:!0,CURRENT_DAY_NAME_SHORT:!0,CURRENT_MONTH_NAME:!0,CURRENT_MONTH_NAME_SHORT:!0,CURRENT_SECONDS_UNIX:!0,SELECTION:!0,CLIPBOARD:!0,TM_SELECTED_TEXT:!0,TM_CURRENT_LINE:!0,TM_CURRENT_WORD:!0,TM_LINE_INDEX:!0,TM_LINE_NUMBER:!0,TM_FILENAME:!0,TM_FILENAME_BASE:!0,TM_DIRECTORY:!0,TM_FILEPATH:!0,RELATIVE_FILEPATH:!0,BLOCK_COMMENT_START:!0,BLOCK_COMMENT_END:!0,LINE_COMMENT:!0,WORKSPACE_NAME:!0,WORKSPACE_FOLDER:!0,RANDOM:!0,RANDOM_HEX:!0,UUID:!0});function sl(t,e,r){let n=AO(t)+1,i={};t.walk(a=>{if(a instanceof Ar){if(a.name===e)a.name="TM_SELECTED_TEXT";else if(r!=null&&Object.prototype.hasOwnProperty.call(r,a.name))a.parent.replace(a,[new Qe(r[a.name])]);else if(!XS[a.name]){let s;a.name in i?s=i[a.name]:(s=n++,i[a.name]=s);let p=new it(s);a.children.forEach(c=>p.appendChild(c)),a.parent.replace(a,[p])}}else a instanceof it&&a.index.toString()===e&&a.parent.replace(a,[new Ar("TM_SELECTED_TEXT")]);return!0})}o(sl,"transformSnippetVariables");function AO(t){let e=0;return t.walk(r=>(r instanceof it&&(e=Math.max(e,r.index)),!0)),e}o(AO,"getMaxPlaceholderIndex");function pl(t,e,r){let n=e.map(a=>FO(t,a,r)),i=n[0];if(!n.every(a=>a===i))throw new Error("Multiple snippet definitions match the given context");if(i===-1)throw new Error("Couldn't find matching snippet definition");return r[i]}o(pl,"findMatchingSnippetDefinitionStrict");function FO(t,e,r){let n=e.editor.document.languageId;return r.findIndex(({scope:i})=>{if(i==null)return!0;let{langIds:a,scopeTypes:s,excludeDescendantScopeTypes:p}=i;if(a!=null&&!a.includes(n))return!1;if(s!=null){let c=s.concat(p??[]),l,u;for(let m of c)try{let f=t.create({type:"containingScope",scopeType:{type:m}}).run(e)[0];e.contentRange.isRangeEqual(f.contentRange)&&(f=t.create({type:"containingScope",scopeType:{type:m},ancestorIndex:1}).run(e)[0]),(l==null||l.contentRange.contains(f.contentRange))&&(l=f,u=m)}catch{continue}return u==null?!1:l!=null&&!(p??[]).includes(u)}return!0})}o(FO,"findMatchingSnippetDefinitionForSingleTarget");var Lo=class{constructor(e,r,n,i){this.rangeUpdater=e;this.snippets=r;this.actions=n;this.modifierStageFactory=i;this.snippetParser=new _i;this.run=this.run.bind(this)}static{o(this,"InsertSnippet")}getFinalStages(e){let r=this.getScopeTypes(e);return r.length===0?[]:[new qp(this.modifierStageFactory,{type:"cascading",modifiers:r.map(n=>({type:"containingScope",scopeType:n}))})]}getScopeTypes(e){if(e.type==="named"){let{name:r}=e,i=this.snippets.getSnippetStrict(r).insertionScopeTypes;return i==null?[]:i.map(a=>({type:a}))}else return e.scopeTypes??[]}getSnippetInfo(e,r){if(e.type==="named"){let{name:n}=e,i=this.snippets.getSnippetStrict(n),a=pl(this.modifierStageFactory,r,i.definitions);return{body:a.body.join(`
`),formatSubstitutions(s){return s==null?void 0:IO(i,a,s)}}}else return{body:e.body,formatSubstitutions(n){return n}}}async run(e,r){let n=g().getEditableTextEditor(Ge(e));await this.actions.editNew.run(e);let{body:i,formatSubstitutions:a}=this.getSnippetInfo(r,n.selections.map(l=>new Re({editor:n,contentRange:l,isReversed:!1,hasExplicitRange:!0}))),s=this.snippetParser.parse(i);sl(s,null,a(r.substitutions));let p=s.toTextmateString(),{editorSelections:c}=await K({rangeUpdater:this.rangeUpdater,editor:n,callback:o(()=>n.insertSnippet(p),"callback"),preserveCursorSelections:!0,selections:{editorSelections:{selections:n.selections,behavior:0}}});return{thatSelections:c.map(l=>({editor:n,selection:l}))}}};function IO(t,e,r){return Object.fromEntries(Object.entries(r).map(([n,i])=>{let a=(e.variables??{})[n]?.formatter??(t.variables??{})[n]?.formatter;if(a==null)return[n,i];let s=yy[a];if(s==null)throw new Error(`Couldn't find formatter ${a} for variable ${n}`);return[n,s(i.split(" "))]}))}o(IO,"formatSubstitutions");var Uo=class{constructor(e,r){this.rangeUpdater=e;this.modifierStageFactory=r;this.run=this.run.bind(this)}static{o(this,"JoinLines")}getFinalStages(){return[this.modifierStageFactory.create(Ht)]}async run(e){return await Y(g(),e.map(({thatTarget:n})=>n),"pendingModification0"),{thatSelections:oe(await se(e,async(n,i)=>{let{thatRanges:a}=await K({rangeUpdater:this.rangeUpdater,editor:g().getEditableTextEditor(n),edits:OO(n,i),selections:{thatRanges:i.map(({contentRange:s})=>s)}});return Wr(i,a).map(([s,p])=>({editor:n,selection:p.toSelection(s.isReversed)}))}))}}};function OO(t,e){let r=[];for(let n of e){let i=n.joinAs==="line"?NO(n):CO(n);r.push(...i)}return r}o(OO,"getEdits");function CO(t){let{editor:e,contentRange:r}=t,n=$e(e.document.languageId).tokenMatcher,i=ut(n,e,r,"forward");return Array.from(Am(i)).map(([a,s])=>({range:new b(a.end,s.start),text:"",isReplace:!0}))}o(CO,"getTokenTargetEdits");function NO(t){let{document:e}=t.editor,r=t.contentRange,n=r.start.line,i=r.isSingleLine?Math.min(n+1,e.lineCount-1):r.end.line,a=Xn(zT(n,i+1),s=>e.lineAt(s));return Array.from(Am(a)).map(([s,p])=>({range:new b(s.rangeTrimmed?.end??s.range.end,p.rangeTrimmed?.start??p.range.start),text:p.isEmptyOrWhitespace?"":" ",isReplace:!0}))}o(NO,"getLineTargetEdits");var cl=class{constructor(e,r){this.rangeUpdater=e;this.actions=r;this.run=this.run.bind(this)}static{o(this,"PasteFromClipboardUsingCommand")}async run(e){let r=g().getEditableTextEditor(Ge(e)),n=g().activeEditableTextEditor,i=o(async()=>{await this.actions.editNew.run(e)},"callbackEdit"),{cursorSelections:a}=await K({rangeUpdater:this.rangeUpdater,editor:r,preserveCursorSelections:!0,callback:i,selections:{cursorSelections:r.selections}}),{originalCursorSelections:s,editorSelections:p}=await K({rangeUpdater:this.rangeUpdater,editor:r,callback:o(()=>r.clipboardPaste(),"callback"),selections:{originalCursorSelections:a,editorSelections:{selections:r.selections,behavior:0}}});return await r.setSelections(s),n!=null&&!n.isActive&&await n.focus(),await g().flashRanges(p.map(c=>({editor:r,range:Te(c),style:"justAdded"}))),{thatSelections:p.map(c=>({editor:r,selection:c}))}}};var ll=class{constructor(e){this.rangeUpdater=e;this.runForEditor=this.runForEditor.bind(this)}static{o(this,"PasteFromClipboardDirectly")}async run(e){let r=await g().clipboard.readText(),n=r.split(/\r?\n/g),i=e.length===n.length?Wr(e,n).map(([s,p])=>({destination:s,text:p})):e.map(s=>({destination:s,text:r}));return{thatSelections:oe(await er(i,({destination:s})=>s.editor,this.runForEditor))}}async runForEditor(e,r){let n=r.map(({destination:s,text:p})=>s.constructChangeEdit(p)),{editSelections:i}=await K({rangeUpdater:this.rangeUpdater,editor:g().getEditableTextEditor(e),edits:n,selections:{editSelections:{selections:n.map(({range:s})=>s),behavior:0}}}),a=Wr(n,i).map(([s,p])=>s.updateRange(p).toSelection(p.isReversed));return await g().flashRanges(a.map(s=>({editor:e,range:Te(s),style:"justAdded"}))),a.map(s=>({editor:e,selection:s}))}};var ul=class{static{o(this,"PasteFromClipboard")}constructor(e,r){this.run=this.run.bind(this),this.runner=g().capabilities.commands.clipboardPaste!=null?new cl(e,r):new ll(e)}run(e){return this.runner.run(e)}};var Ho=class{constructor(e){this.rangeUpdater=e;this.run=this.run.bind(this),this.runForEditor=this.runForEditor.bind(this)}static{o(this,"Delete")}async run(e,{showDecorations:r=!0}={}){return e=wc(e),r&&await Y(g(),e,"pendingDelete",i=>i.getRemovalHighlightRange()),{thatTargets:oe(await se(e,this.runForEditor))}}async runForEditor(e,r){let n=r.map(s=>s.constructRemovalEdit()),i=g().getEditableTextEditor(e),{editRanges:a}=await K({rangeUpdater:this.rangeUpdater,editor:i,edits:n,selections:{editRanges:n.map(({range:s})=>s)}});return ye(r,a).map(([s,p])=>new Sr({editor:s.editor,isReversed:s.isReversed,contentRange:p}))}};var Vo=class{constructor(e){this.rangeUpdater=e;this.run=this.run.bind(this)}static{o(this,"Replace")}getTexts(e,r){if(Array.isArray(r))return r.length===1?Array(e.length).fill(r[0]):r;let n=[];for(let i=0;i<e.length;++i)n[i]=(r.start+i).toString();return n}async run(e,r){await Y(g(),e.map(p=>p.target),"pendingModification0");let n=this.getTexts(e,r);if(e.length!==n.length)throw new Error("Targets and texts must have same length");let i=ye(e,n).map(([p,c])=>({editor:p.editor,target:p.target,edit:p.constructChangeEdit(c)})),a=[],s=[];return await er(i,p=>p.editor,async(p,c)=>{let l=c.map(({edit:f})=>f),{contentSelections:u,editRanges:m}=await K({rangeUpdater:this.rangeUpdater,editor:g().getEditableTextEditor(p),edits:l,selections:{contentSelections:c.map(({target:f})=>f.contentSelection),editRanges:{selections:l.map(({range:f})=>f),behavior:0}}});for(let[f,d]of ye(c,u))a.push(f.target.withContentRange(d));for(let[f,d]of ye(c,m))s.push({editor:p,selection:f.edit.updateRange(d).toSelection(!1)})}),{sourceTargets:a,thatSelections:s}}};var Bo=class{constructor(e,r){this.rangeUpdater=e;this.modifierStageFactory=r;this.getFinalStages=o(()=>[uf(this.modifierStageFactory)],"getFinalStages");this.run=this.run.bind(this)}static{o(this,"Rewrap")}async run(e,r,n){let i=e.flatMap(s=>{let p=s.getBoundary();if(p.length!==2)throw Error("Target must have an opening and closing delimiter");return p});await Y(g(),i,"pendingModification0");let a=await se(i,async(s,p)=>{let c=p.map((m,f)=>({editor:s,range:m.contentRange,text:f%2===0?r:n})),{sourceRanges:l,thatRanges:u}=await K({rangeUpdater:this.rangeUpdater,editor:g().getEditableTextEditor(s),edits:c,selections:{sourceRanges:e.map(m=>m.thatTarget.contentRange),thatRanges:e.map(m=>m.contentRange)}});return{sourceMark:ht(e,l),thatMark:ht(e,u)}});return{sourceSelections:a.flatMap(({sourceMark:s})=>s),thatSelections:a.flatMap(({thatMark:s})=>s)}}};var Wo=class{constructor(e){this.at=e;this.run=this.run.bind(this)}static{o(this,"Scroll")}async run(e){let r=ns(e,s=>s.editor),n=Array.from(r,([s,p])=>({lineNumber:LO(p,this.at),editor:s})),i=g().activeEditableTextEditor;for(let s of n)await g().getEditableTextEditor(s.editor).revealLine(s.lineNumber,this.at);i!=null&&!i.isActive&&await i.focus();let a=e.filter(s=>{let p=s.editor.visibleRanges,c=p[0].start.line,l=p[p.length-1].end.line;return s.contentRange.start.line>c||s.contentRange.end.line<l||s.contentRange.start.line===c&&s.contentRange.end.line===l});return await g().flashRanges(a.map(s=>({editor:s.editor,range:vt(s.contentRange),style:"referenced"}))),{thatTargets:e}}},ml=class extends Wo{static{o(this,"ScrollToTop")}constructor(){super("top")}},fl=class extends Wo{static{o(this,"ScrollToCenter")}constructor(){super("center")}},dl=class extends Wo{static{o(this,"ScrollToBottom")}constructor(){super("bottom")}};function LO(t,e){let r=Number.MAX_SAFE_INTEGER,n=0;return t.forEach(i=>{r=Math.min(r,i.contentRange.start.line),n=Math.max(n,i.contentRange.end.line)}),e==="top"?r:e==="bottom"?n:Math.floor((r+n)/2)}o(LO,"getLineNumber");var ki=class{static{o(this,"SetSelection")}constructor(){this.run=this.run.bind(this)}getSelection(e){return e.contentSelection}async run(e){let r=Ge(e),n=e.map(this.getSelection);return await g().getEditableTextEditor(r).setSelections(n,{focusEditor:!0}),{thatTargets:e}}},gl=class extends ki{static{o(this,"SetSelectionBefore")}getSelection(e){return new q(e.contentRange.start,e.contentRange.start)}},hl=class extends ki{static{o(this,"SetSelectionAfter")}getSelection(e){return new q(e.contentRange.end,e.contentRange.end)}};var jo=class{constructor(e){this.key=e;this.noAutomaticTokenExpansion=!0;this.run=this.run.bind(this)}static{o(this,"SetSpecialTarget")}async run(e){return{thatTargets:e,[`${this.key}Targets`]:e}}};var $o=class{constructor(e){this.treeSitter=e;this.run=this.run.bind(this)}static{o(this,"ShowParseTree")}async run(e){await Y(g(),e,"referenced");let r=["# Cursorless parse tree"];for(let n of e){let{editor:i,contentRange:a}=n,s=this.treeSitter.getTree(i.document);r.push(UO(i.document,s,a))}return g().openUntitledTextDocument({language:"markdown",content:r.join(`

`)}),{thatTargets:e}}};function UO(t,e,r){let n=[],i=[];return ev(n,i,r,e.walk(),0),[`## ${t.filename} [${r}]
`,`\`\`\`${t.languageId}`,t.getText(r),"```","","```scm",...i,"```","","```js",...n,"```",""].join(`
`)}o(UO,"parseTree");function ev(t,e,r,n,i){for(;;){let a=new b(n.startPosition.row,n.startPosition.column,n.endPosition.row,n.endPosition.column);if(r.intersection(a)!=null){let s="  ".repeat(i),p=HO(n),c=s+p;if(n.nodeIsNamed)t.push(`${c}${n.nodeType} [${a}]`),e.push(`${c}(${n.nodeType}`),n.gotoFirstChild()?(ev(t,e,r,n,i+1),n.gotoParent(),e.push(`${s})`)):e[e.length-1]+=")";else{let l=`"${n.nodeType}"`;t.push(`${c}${l} [${a}]`),e.push(`${c}${l}`)}}if(!n.gotoNextSibling())return}}o(ev,"parseCursor");function HO(t){let e=t.currentFieldName;return e!=null?`${e}: `:""}o(HO,"getFieldName");var yl=class{constructor(e,r){this.rangeUpdater=e;this.isIndent=r;this.run=this.run.bind(this),this.runForEditor=this.runForEditor.bind(this)}static{o(this,"IndentLineBase")}async run(e){return this.hasCapability()?this.runSimpleCommandAction(e):(await Y(g(),e,"pendingModification0"),{thatTargets:oe(await se(e,this.runForEditor))})}hasCapability(){return this.isIndent?g().capabilities.commands.indentLine!=null:g().capabilities.commands.outdentLine!=null}runSimpleCommandAction(e){return(this.isIndent?new Mc(this.rangeUpdater):new Ac(this.rangeUpdater)).run(e)}async runForEditor(e,r){let n=this.isIndent?VO(e,r):BO(e,r),{targetSelections:i}=await K({rangeUpdater:this.rangeUpdater,editor:g().getEditableTextEditor(e),edits:n,selections:{targetSelections:r.map(({contentSelection:a})=>a)}});return ye(r,i).map(([a,s])=>bi({editor:e,selection:s.toSelection(a.isReversed)}))}},Tl=class extends yl{static{o(this,"IndentLine")}constructor(e){super(e,!0)}},xl=class extends yl{static{o(this,"OutdentLine")}constructor(e){super(e,!1)}};function VO(t,e){let{document:r}=t,n=tv(e),i=WO(t);return n.map(a=>({range:r.lineAt(a).range.start.toEmptyRange(),text:i}))}o(VO,"getIndentEdits");function BO(t,e){let{document:r}=t,n=tv(e),i=jO(t);return n.map(a=>{let s=r.lineAt(a),p=s.text.match(i),{start:c}=s.range,l=c.translate(void 0,p?.[0].length);return{range:new b(c,l),text:""}})}o(BO,"getOutdentEdits");function tv(t){let e=new Set;for(let r of t){let{start:n,end:i}=r.contentRange;for(let a=n.line;a<=i.line;++a)e.add(a)}return[...e]}o(tv,"getLineNumbers");function WO(t){if(t.options.insertSpaces){let e=rv(t);return" ".repeat(e)}return"	"}o(WO,"getIndent");function jO(t){if(t.options.insertSpaces){let e=rv(t);return new RegExp(`^[ ]{1,${e}}`)}return/^\t/}o(jO,"getRegex");function rv(t){return typeof t.options.tabSize=="number"?t.options.tabSize:4}o(rv,"getTabSize");var qo=class{constructor(e){this.actions=e;this.run=this.run.bind(this)}static{o(this,"SortBase")}async run(e){e.length<2&&qi(g().messages,"tooFewTargets",'This action works on multiple targets, e.g. "sort every line block" instead of "sort block".');let r=e.slice().sort((s,p)=>s.contentRange.start.compareTo(p.contentRange.start)),{returnValue:n}=await this.actions.getText.run(r,{showDecorations:!1}),i=this.sortTexts(n),{thatSelections:a}=await this.actions.replace.run(r.map(s=>s.toDestination("to")),i);return{thatSelections:a}}},Sl=class extends qo{static{o(this,"Sort")}sortTexts(e){return e.sort((r,n)=>r.localeCompare(n,void 0,{numeric:!0,caseFirst:"upper"}))}},vl=class extends qo{static{o(this,"Reverse")}sortTexts(e){return e.reverse()}},bl=class extends qo{static{o(this,"Random")}sortTexts(e){return Su(e)}};var zo=class{constructor(e){this.modifierStageFactory=e;this.getFinalStages=o(()=>[this.modifierStageFactory.create(Ht)],"getFinalStages");this.run=this.run.bind(this)}static{o(this,"ToggleBreakpoint")}async run(e){let r=e.map(({thatTarget:n})=>n);return await Y(g(),r,"referenced"),await se(e,async(n,i)=>{let a=i.map(s=>{let p=s.contentRange;return s.isLine?{type:"line",startLine:p.start.line,endLine:p.end.line}:{type:"inline",range:p}});await g().getEditableTextEditor(n).toggleBreakpoint(a)}),{thatTargets:e}}};var Go=class{constructor(e){this.rangeUpdater=e;this.run=this.run.bind(this)}static{o(this,"Wrap")}async run(e,r,n){let i=await se(e,async(a,s)=>{let p=s.map(T=>({start:new q(T.contentRange.start,T.contentRange.start),end:new q(T.contentRange.end,T.contentRange.end)})),c=p.flatMap(({start:T,end:k})=>[{text:r,range:T},{text:n,range:k,isReplace:!0}]),l=s.map(T=>T.contentSelection),{boundariesStartSelections:u,boundariesEndSelections:m,sourceSelections:f,thatSelections:d}=await K({rangeUpdater:this.rangeUpdater,editor:g().getEditableTextEditor(a),edits:c,selections:{boundariesStartSelections:{selections:p.map(({start:T})=>T),behavior:2},boundariesEndSelections:{selections:p.map(({end:T})=>T),behavior:3},sourceSelections:{selections:l,behavior:1},thatSelections:{selections:l,behavior:0}}}),y=[...u,...m];return await g().flashRanges(y.map(T=>({editor:a,range:Te(T),style:"justAdded"}))),{sourceMark:f.map(T=>({editor:a,selection:T})),thatMark:d.map(T=>({editor:a,selection:T}))}});return{sourceSelections:i.flatMap(({sourceMark:a})=>a),thatSelections:i.flatMap(({thatMark:a})=>a)}}};var Ko=class{constructor(e,r,n){this.rangeUpdater=e;this.snippets=r;this.modifierStageFactory=n;this.snippetParser=new _i;this.run=this.run.bind(this)}static{o(this,"WrapWithSnippet")}getFinalStages(e){let r=this.getScopeType(e);return r==null?[]:[new fi(this.modifierStageFactory,{type:"modifyIfUntyped",modifier:{type:"containingScope",scopeType:r}})]}getScopeType(e){if(e.type==="named"){let{name:r,variableName:n}=e,s=(this.snippets.getSnippetStrict(r).variables??{})[n]?.wrapperScopeType;return s==null?void 0:{type:s}}else return e.scopeType}getBody(e,r){if(e.type==="named"){let{name:n}=e,i=this.snippets.getSnippetStrict(n);return pl(this.modifierStageFactory,r,i.definitions).body.join(`
`)}else return e.body}async run(e,r){let n=g().getEditableTextEditor(Ge(e)),i=this.getBody(r,e),a=this.snippetParser.parse(i);sl(a,r.variableName);let s=a.toTextmateString();await Y(g(),e,"pendingModification0");let p=e.map(u=>u.contentSelection),c=o(()=>n.insertSnippet(s,p),"callback"),{targetSelections:l}=await K({rangeUpdater:this.rangeUpdater,editor:n,callback:c,preserveCursorSelections:!0,selections:{targetSelections:p}});return{thatSelections:l.map(u=>({editor:n,selection:u}))}}};var $O=/-?\d+(\.\d+)?/g,Rl=class{constructor(e,r){this.actions=e;this.isIncrement=r;this.run=this.run.bind(this)}static{o(this,"IncrementDecrement")}async run(e){let r=[];return await er(e,n=>n.editor,async(n,i)=>{let a=await this.runOnEditor(n,i);r.push(...a)}),{thatSelections:r}}async runOnEditor(e,r){let{document:n}=e,i=[],a=[];for(let p of r){let c=n.offsetAt(p.contentRange.start),l=p.contentText,u=$i(l,$O);for(let m of u)i.push(qO(e,c,m)),a.push(zO(this.isIncrement,m.text))}let{thatSelections:s}=await this.actions.replace.run(i,a);return s}},wl=class extends Rl{static{o(this,"Increment")}constructor(e){super(e,!0)}},El=class extends Rl{static{o(this,"Decrement")}constructor(e){super(e,!1)}};function qO(t,e,r){return new ee({editor:t,isReversed:!1,contentRange:new b(t.document.positionAt(e+r.index),t.document.positionAt(e+r.index+r.text.length))}).toDestination("to")}o(qO,"createDestination");function zO(t,e){return e.includes(".")?KO(t,e).toString():GO(t,e).toString()}o(zO,"updateNumber");function GO(t,e){let r=parseInt(e),n=1;return r+(t?n:-n)}o(GO,"updateInteger");function KO(t,e){let r=parseFloat(e),i=Math.abs(r)<=1?.1:1,a=r+(t?i:-i);return parseFloat(a.toPrecision(15))/1}o(KO,"updateFloat");var _l=class{constructor(e,r,n,i){this.treeSitter=e;this.snippets=r;this.rangeUpdater=n;this.modifierStageFactory=i;this.callAsFunction=new Po(this);this.clearAndSetSelection=new Do(this);this.copyToClipboard=new Wc(this,this.rangeUpdater);this.cutToClipboard=new jc(this);this.decrement=new El(this);this.deselect=new Mo;this.editNew=new $c(this.rangeUpdater,this);this.editNewLineAfter=new Gc(this,this.modifierStageFactory);this.editNewLineBefore=new zc(this,this.modifierStageFactory);this.executeCommand=new Ao(this.rangeUpdater);this.extractVariable=new Bc(this.rangeUpdater);this.findInDocument=new Qc(this);this.findInWorkspace=new Zc(this);this.foldRegion=new Fc(this.rangeUpdater);this.followLink=new wi({openAside:!1});this.followLinkAside=new wi({openAside:!0});this.generateSnippet=new Ei(this.snippets);this.getText=new Oo;this.highlight=new Co;this.increment=new wl(this);this.indentLine=new Tl(this.rangeUpdater);this.insertCopyAfter=new Xc(this.rangeUpdater,this.modifierStageFactory);this.insertCopyBefore=new Jc(this.rangeUpdater,this.modifierStageFactory);this.insertEmptyLineAfter=new rl(this.rangeUpdater,this.modifierStageFactory);this.insertEmptyLineBefore=new tl(this.rangeUpdater,this.modifierStageFactory);this.insertEmptyLinesAround=new el(this.rangeUpdater,this.modifierStageFactory);this.insertSnippet=new Lo(this.rangeUpdater,this.snippets,this,this.modifierStageFactory);this.joinLines=new Uo(this.rangeUpdater,this.modifierStageFactory);this.breakLine=new Rc(this.rangeUpdater);this.moveToTarget=new _c(this.rangeUpdater);this.outdentLine=new xl(this.rangeUpdater);this.pasteFromClipboard=new ul(this.rangeUpdater,this);this.randomizeTargets=new bl(this);this.remove=new Ho(this.rangeUpdater);this.rename=new Oc(this.rangeUpdater);this.replace=new Vo(this.rangeUpdater);this.replaceWithTarget=new Ec(this.rangeUpdater);this.revealDefinition=new Lc(this.rangeUpdater);this.revealTypeDefinition=new Uc(this.rangeUpdater);this.reverseTargets=new vl(this);this.rewrapWithPairedDelimiter=new Bo(this.rangeUpdater,this.modifierStageFactory);this.scrollToBottom=new dl;this.scrollToCenter=new fl;this.scrollToTop=new ml;this["private.setKeyboardTarget"]=new jo("keyboard");this["experimental.setInstanceReference"]=new jo("instanceReference");this.setSelection=new ki;this.setSelectionAfter=new hl;this.setSelectionBefore=new gl;this.showDebugHover=new Vc(this.rangeUpdater);this.showHover=new Hc(this.rangeUpdater);this.showQuickFix=new Nc(this.rangeUpdater);this.showReferences=new Cc(this.rangeUpdater);this.sortTargets=new Sl(this);this.swapTargets=new kc(this.rangeUpdater);this.toggleLineBreakpoint=new zo(this.modifierStageFactory);this.toggleLineComment=new Dc(this.rangeUpdater);this.unfoldRegion=new Ic(this.rangeUpdater);this.wrapWithPairedDelimiter=new Go(this.rangeUpdater);this.wrapWithSnippet=new Ko(this.rangeUpdater,this.snippets,this.modifierStageFactory);this["private.showParseTree"]=new $o(this.treeSitter);this["private.getTargets"]=new Io}static{o(this,"Actions")}};async function nv(t,e,r){let n=await t.getFocusedElementType();if(n==null||n==="textEditor")return null;let i=r.action;switch(i.name){case"replace":return kl(i.destination)&&Array.isArray(i.replaceWith)?{action:"insert",modifiers:Pl(i.destination),text:i.replaceWith.join(`
`)}:null;case"replaceWithTarget":return kl(i.destination)?{action:"insert",modifiers:Pl(i.destination),text:await kf(e,i.source)}:null;case"moveToTarget":if(kl(i.destination)){let a=await kf(e,i.source);return await QO(e,i.source),{action:"insert",modifiers:Pl(i.destination),text:a}}return null;case"callAsFunction":return Dl(i.argument)?{action:i.name,modifiers:Ml(i.argument),callee:await kf(e,i.callee)}:null;case"wrapWithPairedDelimiter":case"rewrapWithPairedDelimiter":return Dl(i.target)?{action:i.name,modifiers:Ml(i.target),left:i.left,right:i.right}:null;case"pasteFromClipboard":return kl(i.destination)?{action:i.name,modifiers:Pl(i.destination)}:null;case"swapTargets":case"editNew":case"insertSnippet":case"generateSnippet":case"wrapWithSnippet":case"parsed":return null;default:return Dl(i.target)?{action:i.name,modifiers:Ml(i.target)}:null}}o(nv,"getCommandFallback");function kl(t){return t.type==="implicit"?!0:t.type==="primitive"?t.insertionMode==="to"&&Dl(t.target):!1}o(kl,"destinationIsSelection");function Dl(t){return t.type==="implicit"?!0:t.type==="primitive"?t.mark==null||t.mark.type==="cursor":!1}o(Dl,"targetIsSelection");function Pl(t){return t.type==="primitive"?Ml(t.target):[]}o(Pl,"getModifiersFromDestination");function Ml(t){if(t.type==="primitive"){if(t.modifiers!=null&&t.modifiers.length>0)return t.modifiers;if(t.mark?.type==="cursor")return[{type:"containingTokenIfEmpty"}]}return[]}o(Ml,"getModifiersFromTarget");async function kf(t,e){return(await t({name:"getText",target:e})).returnValue.join(`
`)}o(kf,"getText");async function QO(t,e){await t({name:"remove",target:e})}o(QO,"remove");function iv(t,e){let{anchor:r,rangeType:n,active:i}=t;if(r.type!=="primitive"||n!=="continuous")return t;let a=r.modifiers.map((s,p)=>[s,p]);for(let[s,p]of a.reverse())for(let c of ZO){let l=c.accept(s);if(l.accepted){let[u,m]=[r.modifiers.slice(0,p+1),r.modifiers.slice(p+1)],f={...t,anchor:m.length===0&&e?{type:"implicit"}:{type:"primitive",mark:r.mark,modifiers:m},active:ms(i,d=>{d.modifiers=d.modifiers.slice(Li(d.modifiers,y=>c.accept(y).accepted)+1)})};return f=l.transformTarget?.(f)??f,{type:"primitive",mark:{type:"target",target:f},modifiers:u}}}return t}o(iv,"handleHoistedModifiers");var ZO=[{accept(t){return t.type==="everyScope"&&t.scopeType.type!=="instance"?{accepted:!0,transformTarget(e){return{...e,exclusionScopeType:t.scopeType}}}:{accepted:!1}}},{accept(t){return{accepted:(t.type==="everyScope"||t.type==="relativeScope"||t.type==="ordinalScope")&&t.scopeType.type==="instance"}}}];function Df(t,e){switch(t.type){case"list":return YO(t,e);case"range":return ov(t,e);case"primitive":return Al(t,e);case"implicit":return t}}o(Df,"inferFullTargetDescriptor");function YO(t,e){return{...t,elements:t.elements.map((r,n)=>{let i=e.concat(t.elements.slice(0,n));switch(r.type){case"range":return ov(r,i);case"primitive":return Al(r,i)}})}}o(YO,"inferListTarget");function ov(t,e){let r=JO(t,e),n=t.anchor.type==="implicit"||t.anchor.mark==null;return iv(r,n)}o(ov,"inferRangeTargetWithHoist");function JO(t,e){return{type:"range",rangeType:t.rangeType??"continuous",excludeAnchor:t.excludeAnchor??!1,excludeActive:t.excludeActive??!1,anchor:t.anchor.type==="implicit"?t.anchor:Al(t.anchor,e),active:Al(t.active,e.concat(t.anchor))}}o(JO,"inferRangeTarget");function Al(t,e){let r=Pf(t.mark??(XO(t)?rC(e):null)??{type:"cursor"}),n=av(t)??nC(e)??iC(e)??[];return{type:t.type,mark:r,modifiers:n}}o(Al,"inferPrimitiveTarget");function XO(t){return t.modifiers?.some(e=>e.type==="inferPreviousMark")??!1}o(XO,"shouldInferPreviousMark");function av(t){let e=t.modifiers?.filter(r=>r.type!=="inferPreviousMark")??[];return e.length!==0?e:void 0}o(av,"getPreservedModifiers");function eC(t){if(tC(t))return[{type:"containingScope",scopeType:{type:"line"}}]}o(eC,"getLineNumberMarkModifiers");function tC(t){let e=o(r=>r?.type==="lineNumber","isLineNumber");return e(t.mark)?!0:t.mark?.type==="range"?e(t.mark.anchor)&&e(t.mark.active):!1}o(tC,"isLineNumberMark");function rC(t){return Qo(t,e=>e.mark)}o(rC,"getPreviousMark");function nC(t){return Qo(t,av)}o(nC,"getPreviousPreservedModifiers");function iC(t){return Qo(t,eC)}o(iC,"getPreviousLineNumberMarkModifiers");function Qo(t,e){for(let r=t.length-1;r>-1;--r){let n=t[r];switch(n.type){case"primitive":{let i=e(n);if(i!=null)return i;break}case"range":{let i=Qo([n.anchor],e);if(i!=null)return i;break}case"list":{let i=Qo(n.elements,e);if(i!=null)return i;break}}}}o(Qo,"getPreviousTargetAttribute");function Pf(t){switch(t.type){case"range":return{...t,anchor:Pf(t.anchor),active:Pf(t.active)};case"target":return{type:"target",target:Df(t.target,[])};default:return t}}o(Pf,"handleTargetMark");var Fl=class{constructor(e,r,n,i,a){this.commandServerApi=e;this.debug=r;this.storedTargets=n;this.pipelineRunner=i;this.actions=a;this.finalStages=[];this.runAction=this.runAction.bind(this),this.inferenceContext=new Mf(this.debug)}static{o(this,"CommandRunnerImpl")}async run(e){if(rs(e)){let l=await nv(this.commandServerApi,this.runAction,e);if(l!=null)return{fallback:l}}let{returnValue:r,thatSelections:n,thatTargets:i,sourceSelections:a,sourceTargets:s,instanceReferenceTargets:p,keyboardTargets:c}=await this.runAction(e.action);return this.storedTargets.set("that",sv(i,n)),this.storedTargets.set("source",sv(s,a)),this.storedTargets.set("instanceReference",p),this.storedTargets.set("keyboard",c,{history:!0}),{returnValue:r}}runAction(e){switch(this.inferenceContext.reset(),this.finalStages=[],e.name){case"replaceWithTarget":return this.actions.replaceWithTarget.run(this.getTargets(e.source),this.getDestinations(e.destination));case"moveToTarget":return this.actions.moveToTarget.run(this.getTargets(e.source),this.getDestinations(e.destination));case"swapTargets":return this.actions.swapTargets.run(this.getTargets(e.target1),this.getTargets(e.target2));case"callAsFunction":return this.actions.callAsFunction.run(this.getTargets(e.callee),this.getTargets(e.argument));case"wrapWithPairedDelimiter":return this.actions.wrapWithPairedDelimiter.run(this.getTargets(e.target),e.left,e.right);case"rewrapWithPairedDelimiter":return this.finalStages=this.actions.rewrapWithPairedDelimiter.getFinalStages(),this.actions.rewrapWithPairedDelimiter.run(this.getTargets(e.target),e.left,e.right);case"pasteFromClipboard":return this.actions.pasteFromClipboard.run(this.getDestinations(e.destination));case"executeCommand":return this.actions.executeCommand.run(this.getTargets(e.target),e.commandId,e.options);case"replace":return this.actions.replace.run(this.getDestinations(e.destination),e.replaceWith);case"highlight":return this.actions.highlight.run(this.getTargets(e.target),e.highlightId);case"generateSnippet":return this.actions.generateSnippet.run(this.getTargets(e.target),e.snippetName);case"insertSnippet":return this.finalStages=this.actions.insertSnippet.getFinalStages(e.snippetDescription),this.actions.insertSnippet.run(this.getDestinations(e.destination),e.snippetDescription);case"wrapWithSnippet":return this.finalStages=this.actions.wrapWithSnippet.getFinalStages(e.snippetDescription),this.actions.wrapWithSnippet.run(this.getTargets(e.target),e.snippetDescription);case"editNew":return this.actions.editNew.run(this.getDestinations(e.destination));case"getText":return this.actions.getText.run(this.getTargets(e.target),e.options);case"parsed":return this.runAction(vs(e.content,e.arguments));default:{let r=this.actions[e.name];return this.finalStages=r.getFinalStages?.()??[],this.noAutomaticTokenExpansion=r.noAutomaticTokenExpansion??!1,r.run(this.getTargets(e.target))}}}getTargets(e){let r=this.inferenceContext.run(e);return this.pipelineRunner.run(r,{actionFinalStages:this.finalStages,noAutomaticTokenExpansion:this.noAutomaticTokenExpansion})}getDestinations(e){switch(e.type){case"list":return e.destinations.flatMap(r=>this.getDestinations(r));case"primitive":return this.getTargets(e.target).map(r=>r.toDestination(e.insertionMode));case"implicit":return this.getTargets({type:"implicit"}).map(r=>r.toDestination("to"))}}},Mf=class{constructor(e){this.debug=e;this.previousTargets=[]}static{o(this,"InferenceContext")}run(e){let r=Df(e,this.previousTargets);return this.debug.active&&(this.debug.log("Full target:"),this.debug.log(JSON.stringify(r,null,2))),this.previousTargets.push(e),r}reset(){this.previousTargets=[]}};function sv(t,e){if(t!=null&&e!=null)throw Error("Actions may only return full targets or selections for that mark");return e!=null?e.map(bi):t}o(sv,"constructStoredTarget");var Il=class{constructor(e,r){this.readableHatMap=e;this.mark=r}static{o(this,"DecoratedSymbolStage")}run(){let e=this.readableHatMap.getToken(this.mark.symbolColor,this.mark.character);if(e==null)throw new Error(`Couldn't find mark ${this.mark.symbolColor} '${this.mark.character}'`);return[new Re({editor:e.editor,contentRange:e.range,isReversed:!1,hasExplicitRange:!1})]}};var Ol=class{constructor(e){this.mark=e}static{o(this,"ExplicitMarkStage")}run(){let{editorId:e,range:{start:r,end:n}}=this.mark,i=g().visibleTextEditors.find(s=>s.id===e);if(i==null)throw new Error(`Couldn't find editor '${e}'`);let a=new b(r.line,r.character,n.line,n.character);return[new Re({editor:i,contentRange:a,isReversed:!1,hasExplicitRange:!1})]}};var Cl=class{constructor(e){this.mark=e}static{o(this,"LineNumberStage")}run(){let e=g().activeTextEditor;if(e==null)return[];let r=oC(e,this.mark.lineNumberType,this.mark.lineNumber),n=e.document.lineAt(r).range;return[Fm(e,!1,n)]}},oC=o((t,e,r)=>{switch(e){case"absolute":return r;case"relative":return t.selections[0].active.line+r;case"modulo100":{let i=t.visibleRanges[0].start.line,a=t.visibleRanges[t.visibleRanges.length-1].end.line,s=Math.floor(i/100)*100,p=[],c=[],l=s+r;for(;l<=a;)l>=i&&(t.visibleRanges.find(m=>l>=m.start.line&&l<=m.end.line)?p.push(l):c.push(l)),l+=100;if(p.length===1)return p[0];if(p.length+c.length>1)throw new Error("Multiple lines matching");if(c.length===1)return c[0];throw new Error("Line is not in viewport")}}},"getLineNumber");var Nl=class{constructor(e){this.mark=e}static{o(this,"NothingStage")}run(){return[]}};var Ll=class{constructor(e,r){this.markStageFactory=e;this.mark=r}static{o(this,"RangeMarkStage")}run(){let e=this.markStageFactory.create(this.mark.anchor),r=this.markStageFactory.create(this.mark.active),n=e.run(),i=r.run();if(n.length!==1||i.length!==1)throw new Error("Expected single anchor and active target");return[kr(n[0],i[0],this.mark.excludeAnchor,this.mark.excludeActive)]}};var Ul=class{constructor(e,r){this.storedTargets=e;this.key=r}static{o(this,"StoredTargetStage")}run(){let e=this.storedTargets.get(this.key);if(e==null||e.length===0)throw Error(`No available ${this.key} marks`);return e}};var Hl=class{constructor(e,r){this.targetPipelineRunner=e;this.mark=r}static{o(this,"TargetMarkStage")}run(){return this.targetPipelineRunner.run(this.mark.target)}};var Vl=class{constructor(e,r){this.readableHatMap=e;this.storedTargets=r;this.create=this.create.bind(this)}static{o(this,"MarkStageFactoryImpl")}setPipelineRunner(e){this.targetPipelineRunner=e}create(e){switch(e.type){case"cursor":return new Yn;case"that":case"source":case"keyboard":return new Ul(this.storedTargets,e.type);case"decoratedSymbol":return new Il(this.readableHatMap,e);case"lineNumber":return new Cl(e);case"range":return new Ll(this,e);case"nothing":return new Nl(e);case"target":return new Hl(this.targetPipelineRunner,e);case"explicit":return new Ol(e)}}};async function pv(t,e,r,n,i,a,s,p,c,l){r.active&&(r.log("command:"),r.log(JSON.stringify(l,null,2)));let u=fm(l),m=await n.getReadableMap(u.usePrePhraseSnapshot),f=sC(t,e,s,r,a,m,i,p);for(let y of c)f=y.wrapCommandRunner(m,f);let d=await f.run(u);return await aC(l,d)}o(pv,"runCommand");async function aC(t,e){if(rs(t))return e;if("returnValue"in e)return e.returnValue}o(aC,"unwrapLegacyCommandResponse");function sC(t,e,r,n,i,a,s,p){let c=new vi(r,i,new ni(r)),l=new Vl(a,i),u=new Xp(c,l);return l.setPipelineRunner(u),new Fl(e,n,i,u,new _l(t,s,p,c))}o(sC,"createCommandRunner");var cv=["clojure","css","latex","ruby","rust","scala","scss"];async function lv(t,e){await pC(t,e)}o(lv,"runIntegrationTests");async function pC(t,e){let r=[];for(let n of cv)await t.loadLanguage(n),await e.loadLanguage(n),gr(_o[n]??{}).map(i=>{e.get(n)?.getScopeHandler({type:i})!=null&&r.push(`Scope '${i}' defined as both legacy and new for language ${n}`)});if(r.length>0)throw Error(r.join(`
`))}o(pC,"assertNoScopesBothLegacyAndNew");function uv(t){return ly(t)?Xi(t.type).replace("."," "):t.type==="surroundingPair"?`Matching pair of ${Xi(t.delimiter)}`:t.type==="customRegex"?`Regex \`${t.regex}\``:"Unknown scope type"}o(uv,"scopeTypeToString");var Bl=class{constructor(e){this.customSpokenFormGenerator=e;this.listeners=[];this.disposable=e.onDidChangeCustomSpokenForms(()=>this.onChange()),this.onDidChangeScopeInfo=this.onDidChangeScopeInfo.bind(this),this.getScopeTypeInfo=this.getScopeTypeInfo.bind(this),this.updateScopeTypeInfos()}static{o(this,"ScopeInfoProvider")}onDidChangeScopeInfo(e){return e(this.getScopeTypeInfos()),this.listeners.push(e),{dispose:o(()=>{we(this.listeners,e)},"dispose")}}async onChange(){this.updateScopeTypeInfos(),this.listeners.forEach(e=>e(this.scopeInfos))}updateScopeTypeInfos(){let e=[...Br.filter(r=>r!=="instance").map(r=>({type:r})),...es.map(r=>({type:"surroundingPair",delimiter:r})),...this.customSpokenFormGenerator.getCustomRegexScopeTypes()];this.scopeInfos=e.map(r=>this.getScopeTypeInfo(r))}getScopeTypeInfos(){return this.scopeInfos}getScopeTypeInfo(e){return{scopeType:e,spokenForm:this.customSpokenFormGenerator.scopeTypeToSpokenForm(e),humanReadableName:uv(e),isLanguageSpecific:cC(e)}}dispose(){this.disposable.dispose()}};function cC(t){switch(t.type){case"string":case"argumentOrParameter":case"anonymousFunction":case"attribute":case"branch":case"class":case"className":case"collectionItem":case"collectionKey":case"command":case"comment":case"private.fieldAccess":case"functionCall":case"functionCallee":case"functionName":case"ifStatement":case"instance":case"list":case"map":case"name":case"namedFunction":case"regularExpression":case"statement":case"type":case"value":case"condition":case"section":case"sectionLevelOne":case"sectionLevelTwo":case"sectionLevelThree":case"sectionLevelFour":case"sectionLevelFive":case"sectionLevelSix":case"selector":case"private.switchStatementSubject":case"unit":case"xmlBothTags":case"xmlElement":case"xmlEndTag":case"xmlStartTag":case"part":case"chapter":case"subSection":case"subSubSection":case"namedParagraph":case"subParagraph":case"environment":case"textFragment":case"disqualifyDelimiter":return!0;case"character":case"word":case"token":case"identifier":case"line":case"sentence":case"paragraph":case"boundedParagraph":case"document":case"nonWhitespaceSequence":case"boundedNonWhitespaceSequence":case"url":case"notebookCell":case"surroundingPair":case"surroundingPairInterior":case"customRegex":case"glyph":return!1;case"oneOf":throw Error(`Can't decide whether scope type ${JSON.stringify(t,void 0,3)} is language-specific`)}}o(cC,"isLanguageSpecific");function Af(t,e,r){if(!r)return t.document.range;let n=t.visibleRanges.reduce((s,p)=>s.union(p));n=t.document.range.intersection(n.with(n.start.translate(-10),n.end.translate(10)));let i=Oa(Array.from(e.generateScopes(t,n.start,"forward",{containment:"required"})))?.domain??n,a=Oa(Array.from(e.generateScopes(t,n.end,"forward",{containment:"required"})))?.domain??n;return i.union(a)}o(Af,"getIterationRange");function mn(t){return{contentRange:t.contentRange,removalRange:t.getRemovalRange(),removalHighlightRange:t.isLine?vt(t.getRemovalHighlightRange()):Te(t.getRemovalHighlightRange()),leadingDelimiter:mv(t.getLeadingDelimiterTarget()),trailingDelimiter:mv(t.getTrailingDelimiterTarget()),interior:t.getInterior()?.map(mn),boundary:t.getBoundary()?.map(mn),insertionDelimiter:t.insertionDelimiter}}o(mn,"getTargetRanges");function mv(t){return t!=null?mn(t):void 0}o(mv,"getOptionalTarget");function fv(t,e,r,n,i){return Xn(e.generateScopes(t,n.start,"forward",{includeDescendantScopes:!0,distalPosition:n.end}),a=>({domain:a.domain,ranges:a.getTargets(!1).map(s=>({range:s.contentRange,targets:i?lC(r,s).map(mn):void 0}))}))}o(fv,"getIterationScopeRanges");function lC(t,e){try{return t.run(e)}catch(r){if(r.name==="NoContainingScopeError")return[];throw r}}o(lC,"getEveryScopeLenient");function dv(t,e,r){return Xn(e.generateScopes(t,r.start,"forward",{includeDescendantScopes:!0,distalPosition:r.end}),n=>({domain:n.domain,targets:n.getTargets(!1).map(mn)}))}o(dv,"getScopeRanges");var Wl=class{constructor(e,r){this.scopeHandlerFactory=e;this.modifierStageFactory=r;this.provideScopeRanges=this.provideScopeRanges.bind(this),this.provideIterationScopeRanges=this.provideIterationScopeRanges.bind(this)}static{o(this,"ScopeRangeProvider")}provideScopeRanges(e,{scopeType:r,visibleOnly:n}){let i=this.scopeHandlerFactory.create(r,e.document.languageId);return i==null?[]:dv(e,i,Af(e,i,n))}provideIterationScopeRanges(e,{scopeType:r,visibleOnly:n,includeNestedTargets:i}){let{languageId:a}=e.document,s=this.scopeHandlerFactory.create(r,a);if(s==null)return[];let p=this.scopeHandlerFactory.create(s.iterationScopeType,a);return p==null?[]:fv(e,p,this.modifierStageFactory.create({type:"everyScope",scopeType:r}),Af(e,s,n),i)}};var jl=class{constructor(e,r){this.scopeRangeProvider=r;this.disposables=[];this.listeners=[];this.onChange=this.onChange.bind(this),this.onDidChangeScopeRanges=this.onDidChangeScopeRanges.bind(this),this.onDidChangeIterationScopeRanges=this.onDidChangeIterationScopeRanges.bind(this);let n=new It(g().configuration,()=>this.onChange());this.disposables.push(g().onDidChangeVisibleTextEditors(n.run),g().onDidOpenTextDocument(n.run),g().onDidCloseTextDocument(n.run),g().onDidChangeTextDocument(n.run),g().onDidChangeTextEditorVisibleRanges(n.run),e.onDidChangeDefinition(this.onChange),n)}static{o(this,"ScopeRangeWatcher")}onDidChangeScopeRanges(e,r){let n=o(()=>{g().visibleTextEditors.forEach(i=>{let a;try{a=this.scopeRangeProvider.provideScopeRanges(i,r)}catch(s){if(ce(g().messages,"ScopeRangeWatcher.provide",s.message),a=[],g().runMode==="test")throw s}e(i,a)})},"fn");return this.listeners.push(n),n(),{dispose:o(()=>{we(this.listeners,n)},"dispose")}}onDidChangeIterationScopeRanges(e,r){let n=o(()=>{g().visibleTextEditors.forEach(i=>{e(i,this.scopeRangeProvider.provideIterationScopeRanges(i,r))})},"fn");return this.listeners.push(n),n(),{dispose:o(()=>{we(this.listeners,n)},"dispose")}}onChange(){this.listeners.forEach(e=>e())}dispose(){this.disposables.forEach(({dispose:e})=>{try{e()}catch{}})}};var $l=class{constructor(e){this.scopeHandlerFactory=e;this.getScopeSupport=this.getScopeSupport.bind(this),this.getIterationScopeSupport=this.getIterationScopeSupport.bind(this)}static{o(this,"ScopeSupportChecker")}getScopeSupport(e,r){let{languageId:n}=e.document,i=this.scopeHandlerFactory.create(r,n);return i==null?hv(n,r):gv(e,i)?0:1}getIterationScopeSupport(e,r){let{languageId:n}=e.document,i=this.scopeHandlerFactory.create(r,n);if(i==null)return hv(n,r);let a=this.scopeHandlerFactory.create(i.iterationScopeType,n);return a==null?3:gv(e,a)?0:1}};function gv(t,e){return!dy(e.generateScopes(t,new B(0,0),"forward"))}o(gv,"editorContainsScope");function hv(t,e){switch(e.type){case"boundedNonWhitespaceSequence":case"surroundingPair":return 2;case"notebookCell":return 3;default:return _o[t]?.[e.type]!=null?2:3}}o(hv,"getLegacyScopeSupport");var ql=class{constructor(e,r,n){this.scopeSupportChecker=r;this.scopeInfoProvider=n;this.listeners=[];this.onChange=this.onChange.bind(this),this.onDidChangeScopeSupport=this.onDidChangeScopeSupport.bind(this);let i=new It(g().configuration,()=>this.onChange());this.disposable=my(g().onDidOpenTextDocument(i.run),g().onDidCloseTextDocument(i.run),g().onDidChangeActiveTextEditor(i.run),g().onDidChangeTextDocument(i.run),e.onDidChangeDefinition(i.run),this.scopeInfoProvider.onDidChangeScopeInfo(this.onChange),i)}static{o(this,"ScopeSupportWatcher")}onDidChangeScopeSupport(e){return e(this.getSupportLevels()),this.listeners.push(e),{dispose:o(()=>{we(this.listeners,e)},"dispose")}}onChange(){if(this.listeners.length===0)return;let e=this.getSupportLevels();this.listeners.forEach(r=>r(e))}getSupportLevels(){let e=g().activeTextEditor,r=e==null?()=>3:a=>this.scopeSupportChecker.getScopeSupport(e,a),n=e==null?()=>3:a=>this.scopeSupportChecker.getIterationScopeSupport(e,a);return this.scopeInfoProvider.getScopeTypeInfos().map(a=>({...a,support:r(a.scopeType),iterationScopeSupport:n(a.scopeType)}))}dispose(){this.disposable.dispose()}};async function yv({ide:t,hats:e,treeSitterQueryProvider:r,treeSitter:n=new np,commandServerApi:i=new Js,talonSpokenForms:a=new rp,snippets:s=new tp}){gm(t);let p=new $s(t),c=new Ys,l=new Ps,u=new js(t,l),m=new ap(a),f=e!=null?new Ks(c,p,e,i):new Xs;f.allocateHats();let d=r?await jp.create(t,n,r):new ep;t.disposeOnExit(c,d,f,p,u);let y=[],T,k=o(R=>(T=R,pv(n,i,p,f,s,l,d,c,y,R)),"runCommandClosure");return{commandApi:{runCommand(R){return k(R)},runCommandSafe(...R){return k(fy(R))},repeatPreviousCommand(){if(T==null)throw new Error("No previous command");return k(T)}},scopeProvider:mC(d,l,m),customSpokenFormGenerator:m,storedTargets:l,hatTokenMap:f,injectIde:gm,runIntegrationTests:o(()=>lv(n,d),"runIntegrationTests"),addCommandRunnerDecorator:o(R=>{y.push(R)},"addCommandRunnerDecorator")}}o(yv,"createCursorlessEngine");function mC(t,e,r){let n=new ni(t),i=new Wl(n,new vi(t,e,n)),a=new jl(t,i),s=new $l(n),p=new Bl(r),c=new ql(t,s,p);return{provideScopeRanges:i.provideScopeRanges,provideIterationScopeRanges:i.provideIterationScopeRanges,onDidChangeScopeRanges:a.onDidChangeScopeRanges,onDidChangeIterationScopeRanges:a.onDidChangeIterationScopeRanges,getScopeSupport:s.getScopeSupport,getIterationScopeSupport:s.getIterationScopeSupport,onDidChangeScopeSupport:c.onDidChangeScopeSupport,getScopeInfo:p.getScopeTypeInfo,onDidChangeScopeInfo:p.onDidChangeScopeInfo}}o(mC,"createScopeProvider");function Tv(t,e){switch(e.type){case"UntypedTarget":return new Re({editor:t,isReversed:e.isReversed,contentRange:za(e.contentRange),hasExplicitRange:e.hasExplicitRange});case"LineTarget":return new tt({editor:t,isReversed:e.isReversed,contentRange:za(e.contentRange)});default:throw Error(`Unsupported target type ${e.type}`)}}o(Tv,"plainObjectToTarget");var pSe=Symbol("unused");var Zo=class{constructor(e){this.position=e}static{o(this,"ArgPosition")}},cSe={$0:new Zo(0),$1:new Zo(1),$2:new Zo(2)};function xv({talonJsIDE:t,normalizedIde:e,injectIde:r,commandApi:n,hatTokenMap:i,commandServerApi:a,storedTargets:s}){return{talonJsIDE:t,ide:e,commandServerApi:a,hatTokenMap:i,storedTargets:s,injectIde:r,runCommand(p){return n.runCommand(p)},setStoredTarget(p,c,l){s.set(c,l?.map(u=>Tv(p,u)))}}}o(xv,"constructTestHelpers");var fC={clipboardCopy:void 0,clipboardPaste:void 0,toggleLineComment:void 0,rename:void 0,quickFix:void 0,revealDefinition:void 0,revealTypeDefinition:void 0,showHover:void 0,showDebugHover:void 0,extractVariable:void 0,fold:void 0,highlight:void 0,unfold:void 0,showReferences:void 0,insertLineAfter:void 0,indentLine:void 0,outdentLine:void 0},zl=class{static{o(this,"TalonJsCapabilities")}commands=fC};var Gl=class{constructor(e){this.talon=e}static{o(this,"TalonJsClipboard")}async readText(){return this.talon.actions.clip.text()}async writeText(e){this.talon.actions.clip.set_text(e)}};var dC={tokenHatSplittingMode:{preserveCase:!1,lettersToPreserve:[],symbolsToPreserve:[]},wordSeparators:["_"],decorationDebounceDelayMs:50,experimental:{snippetsDir:void 0,hatStability:"balanced",keyboardTargetFollowsSelection:!1},commandHistory:!1,debug:!1},Kl=class{static{o(this,"TalonJsConfiguration")}getOwnConfiguration(e,r){return Wt(dC,e)}onDidChangeConfiguration(e){return{dispose:o(()=>{},"dispose")}}};function Sv(t,e,r){let n=r.map(i=>({anchor:e.offsetAt(i.anchor),active:e.offsetAt(i.active)}));return t.actions.user.cursorless_everywhere_set_selections(n),Promise.resolve()}o(Sv,"setSelections");function vv(t,e,r,n){let i=r.edit(n),a={text:r.text,changes:i.map(s=>({rangeOffset:s.rangeOffset,rangeLength:s.rangeLength,text:s.text}))};t.actions.user.cursorless_everywhere_edit_text(a),e.emitDidChangeTextDocument({document:r,contentChanges:i})}o(vv,"talonJsPerformEdits");var Pi=class{constructor(e,r,n,i,a,s){this.talon=e;this.ide=r;this.id=n;this.document=i;this.visibleRanges=a;this.selections=s}static{o(this,"TalonJsEditor")}options={tabSize:4,insertSpaces:!0};isActive=!0;isEqual(e){return this.id===e.id}async setSelections(e,r){gy(this.selections,e)||(await Sv(this.talon,this.document,e),this.selections=e)}edit(e){return vv(this.talon,this.ide,this.document,e),Promise.resolve(!0)}async clipboardCopy(e){throw Error("clipboardCopy not implemented.")}async clipboardPaste(){throw Error("clipboardPaste not implemented.")}indentLine(e){throw Error("indentLine not implemented.")}outdentLine(e){throw Error("outdentLine not implemented.")}insertLineAfter(e){throw Error("insertLineAfter not implemented.")}focus(){throw new Error("focus not implemented.")}revealRange(e){return Promise.resolve()}revealLine(e,r){throw new Error("revealLine not implemented.")}openLink(e,r){throw new Error("openLink not implemented.")}fold(e){throw new Error("fold not implemented.")}unfold(e){throw new Error("unfold not implemented.")}toggleBreakpoint(e){throw new Error("toggleBreakpoint not implemented.")}toggleLineComment(e){throw new Error("toggleLineComment not implemented.")}insertSnippet(e,r){throw new Error("insertSnippet not implemented.")}rename(e){throw new Error("rename not implemented.")}showReferences(e){throw new Error("showReferences not implemented.")}quickFix(e){throw new Error("quickFix not implemented.")}revealDefinition(e){throw new Error("revealDefinition not implemented.")}revealTypeDefinition(e){throw new Error("revealTypeDefinition not implemented.")}showHover(e){throw new Error("showHover not implemented.")}showDebugHover(e){throw new Error("showDebugHover not implemented.")}extractVariable(e){throw new Error("extractVariable not implemented.")}editNewNotebookCellAbove(){throw new Error("editNewNotebookCellAbove not implemented.")}editNewNotebookCellBelow(){throw new Error("editNewNotebookCellBelow not implemented.")}};var Ql=class{constructor(e){this.talon=e}static{o(this,"TalonJsMessages")}async showMessage(e,r,n,...i){if(i.length>0)throw Error("Message options are not supported in TalonJsMessages.");switch(e){case"info":this.talon.actions.app.notify(n,"Cursorless");break;case"warning":this.talon.actions.app.notify(n,"[WARNING] Cursorless");break;case"error":this.talon.actions.app.notify(n,"[ERROR] Cursorless")}}};var bv;(()=>{"use strict";var t={470:i=>{function a(c){if(typeof c!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(c))}o(a,"e");function s(c,l){for(var u,m="",f=0,d=-1,y=0,T=0;T<=c.length;++T){if(T<c.length)u=c.charCodeAt(T);else{if(u===47)break;u=47}if(u===47){if(!(d===T-1||y===1))if(d!==T-1&&y===2){if(m.length<2||f!==2||m.charCodeAt(m.length-1)!==46||m.charCodeAt(m.length-2)!==46){if(m.length>2){var k=m.lastIndexOf("/");if(k!==m.length-1){k===-1?(m="",f=0):f=(m=m.slice(0,k)).length-1-m.lastIndexOf("/"),d=T,y=0;continue}}else if(m.length===2||m.length===1){m="",f=0,d=T,y=0;continue}}l&&(m.length>0?m+="/..":m="..",f=2)}else m.length>0?m+="/"+c.slice(d+1,T):m=c.slice(d+1,T),f=T-d-1;d=T,y=0}else u===46&&y!==-1?++y:y=-1}return m}o(s,"r");var p={resolve:o(function(){for(var c,l="",u=!1,m=arguments.length-1;m>=-1&&!u;m--){var f;m>=0?f=arguments[m]:(c===void 0&&(c=process.cwd()),f=c),a(f),f.length!==0&&(l=f+"/"+l,u=f.charCodeAt(0)===47)}return l=s(l,!u),u?l.length>0?"/"+l:"/":l.length>0?l:"."},"resolve"),normalize:o(function(c){if(a(c),c.length===0)return".";var l=c.charCodeAt(0)===47,u=c.charCodeAt(c.length-1)===47;return(c=s(c,!l)).length!==0||l||(c="."),c.length>0&&u&&(c+="/"),l?"/"+c:c},"normalize"),isAbsolute:o(function(c){return a(c),c.length>0&&c.charCodeAt(0)===47},"isAbsolute"),join:o(function(){if(arguments.length===0)return".";for(var c,l=0;l<arguments.length;++l){var u=arguments[l];a(u),u.length>0&&(c===void 0?c=u:c+="/"+u)}return c===void 0?".":p.normalize(c)},"join"),relative:o(function(c,l){if(a(c),a(l),c===l||(c=p.resolve(c))===(l=p.resolve(l)))return"";for(var u=1;u<c.length&&c.charCodeAt(u)===47;++u);for(var m=c.length,f=m-u,d=1;d<l.length&&l.charCodeAt(d)===47;++d);for(var y=l.length-d,T=f<y?f:y,k=-1,R=0;R<=T;++R){if(R===T){if(y>T){if(l.charCodeAt(d+R)===47)return l.slice(d+R+1);if(R===0)return l.slice(d+R)}else f>T&&(c.charCodeAt(u+R)===47?k=R:R===0&&(k=0));break}var A=c.charCodeAt(u+R);if(A!==l.charCodeAt(d+R))break;A===47&&(k=R)}var ne="";for(R=u+k+1;R<=m;++R)R!==m&&c.charCodeAt(R)!==47||(ne.length===0?ne+="..":ne+="/..");return ne.length>0?ne+l.slice(d+k):(d+=k,l.charCodeAt(d)===47&&++d,l.slice(d))},"relative"),_makeLong:o(function(c){return c},"_makeLong"),dirname:o(function(c){if(a(c),c.length===0)return".";for(var l=c.charCodeAt(0),u=l===47,m=-1,f=!0,d=c.length-1;d>=1;--d)if((l=c.charCodeAt(d))===47){if(!f){m=d;break}}else f=!1;return m===-1?u?"/":".":u&&m===1?"//":c.slice(0,m)},"dirname"),basename:o(function(c,l){if(l!==void 0&&typeof l!="string")throw new TypeError('"ext" argument must be a string');a(c);var u,m=0,f=-1,d=!0;if(l!==void 0&&l.length>0&&l.length<=c.length){if(l.length===c.length&&l===c)return"";var y=l.length-1,T=-1;for(u=c.length-1;u>=0;--u){var k=c.charCodeAt(u);if(k===47){if(!d){m=u+1;break}}else T===-1&&(d=!1,T=u+1),y>=0&&(k===l.charCodeAt(y)?--y==-1&&(f=u):(y=-1,f=T))}return m===f?f=T:f===-1&&(f=c.length),c.slice(m,f)}for(u=c.length-1;u>=0;--u)if(c.charCodeAt(u)===47){if(!d){m=u+1;break}}else f===-1&&(d=!1,f=u+1);return f===-1?"":c.slice(m,f)},"basename"),extname:o(function(c){a(c);for(var l=-1,u=0,m=-1,f=!0,d=0,y=c.length-1;y>=0;--y){var T=c.charCodeAt(y);if(T!==47)m===-1&&(f=!1,m=y+1),T===46?l===-1?l=y:d!==1&&(d=1):l!==-1&&(d=-1);else if(!f){u=y+1;break}}return l===-1||m===-1||d===0||d===1&&l===m-1&&l===u+1?"":c.slice(l,m)},"extname"),format:o(function(c){if(c===null||typeof c!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof c);return function(l,u){var m=u.dir||u.root,f=u.base||(u.name||"")+(u.ext||"");return m?m===u.root?m+f:m+"/"+f:f}(0,c)},"format"),parse:o(function(c){a(c);var l={root:"",dir:"",base:"",ext:"",name:""};if(c.length===0)return l;var u,m=c.charCodeAt(0),f=m===47;f?(l.root="/",u=1):u=0;for(var d=-1,y=0,T=-1,k=!0,R=c.length-1,A=0;R>=u;--R)if((m=c.charCodeAt(R))!==47)T===-1&&(k=!1,T=R+1),m===46?d===-1?d=R:A!==1&&(A=1):d!==-1&&(A=-1);else if(!k){y=R+1;break}return d===-1||T===-1||A===0||A===1&&d===T-1&&d===y+1?T!==-1&&(l.base=l.name=y===0&&f?c.slice(1,T):c.slice(y,T)):(y===0&&f?(l.name=c.slice(1,d),l.base=c.slice(1,T)):(l.name=c.slice(y,d),l.base=c.slice(y,T)),l.ext=c.slice(d,T)),y>0?l.dir=c.slice(0,y-1):f&&(l.dir="/"),l},"parse"),sep:"/",delimiter:":",win32:null,posix:null};p.posix=p,i.exports=p}},e={};function r(i){var a=e[i];if(a!==void 0)return a.exports;var s=e[i]={exports:{}};return t[i](s,s.exports,r),s.exports}o(r,"r"),r.d=(i,a)=>{for(var s in a)r.o(a,s)&&!r.o(i,s)&&Object.defineProperty(i,s,{enumerable:!0,get:a[s]})},r.o=(i,a)=>Object.prototype.hasOwnProperty.call(i,a),r.r=i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})};var n={};(()=>{let i;r.r(n),r.d(n,{URI:o(()=>f,"URI"),Utils:o(()=>S,"Utils")}),typeof process=="object"?i=process.platform==="win32":typeof navigator=="object"&&(i=navigator.userAgent.indexOf("Windows")>=0);let a=/^\w[\w\d+.-]*$/,s=/^\//,p=/^\/\//;function c(x,h){if(!x.scheme&&h)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${x.authority}", path: "${x.path}", query: "${x.query}", fragment: "${x.fragment}"}`);if(x.scheme&&!a.test(x.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(x.path){if(x.authority){if(!s.test(x.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(p.test(x.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}o(c,"s");let l="",u="/",m=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class f{static{o(this,"f")}static isUri(h){return h instanceof f||!!h&&typeof h.authority=="string"&&typeof h.fragment=="string"&&typeof h.path=="string"&&typeof h.query=="string"&&typeof h.scheme=="string"&&typeof h.fsPath=="string"&&typeof h.with=="function"&&typeof h.toString=="function"}scheme;authority;path;query;fragment;constructor(h,v,w,P,D,I=!1){typeof h=="object"?(this.scheme=h.scheme||l,this.authority=h.authority||l,this.path=h.path||l,this.query=h.query||l,this.fragment=h.fragment||l):(this.scheme=function(V,N){return V||N?V:"file"}(h,I),this.authority=v||l,this.path=function(V,N){switch(V){case"https":case"http":case"file":N?N[0]!==u&&(N=u+N):N=u}return N}(this.scheme,w||l),this.query=P||l,this.fragment=D||l,c(this,I))}get fsPath(){return A(this,!1)}with(h){if(!h)return this;let{scheme:v,authority:w,path:P,query:D,fragment:I}=h;return v===void 0?v=this.scheme:v===null&&(v=l),w===void 0?w=this.authority:w===null&&(w=l),P===void 0?P=this.path:P===null&&(P=l),D===void 0?D=this.query:D===null&&(D=l),I===void 0?I=this.fragment:I===null&&(I=l),v===this.scheme&&w===this.authority&&P===this.path&&D===this.query&&I===this.fragment?this:new y(v,w,P,D,I)}static parse(h,v=!1){let w=m.exec(h);return w?new y(w[2]||l,pe(w[4]||l),pe(w[5]||l),pe(w[7]||l),pe(w[9]||l),v):new y(l,l,l,l,l)}static file(h){let v=l;if(i&&(h=h.replace(/\\/g,u)),h[0]===u&&h[1]===u){let w=h.indexOf(u,2);w===-1?(v=h.substring(2),h=u):(v=h.substring(2,w),h=h.substring(w)||u)}return new y("file",v,h,l,l)}static from(h){let v=new y(h.scheme,h.authority,h.path,h.query,h.fragment);return c(v,!0),v}toString(h=!1){return ne(this,h)}toJSON(){return this}static revive(h){if(h){if(h instanceof f)return h;{let v=new y(h);return v._formatted=h.external,v._fsPath=h._sep===d?h.fsPath:null,v}}return h}}let d=i?1:void 0;class y extends f{static{o(this,"l")}_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=A(this,!1)),this._fsPath}toString(h=!1){return h?ne(this,!0):(this._formatted||(this._formatted=ne(this,!1)),this._formatted)}toJSON(){let h={$mid:1};return this._fsPath&&(h.fsPath=this._fsPath,h._sep=d),this._formatted&&(h.external=this._formatted),this.path&&(h.path=this.path),this.scheme&&(h.scheme=this.scheme),this.authority&&(h.authority=this.authority),this.query&&(h.query=this.query),this.fragment&&(h.fragment=this.fragment),h}}let T={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function k(x,h,v){let w,P=-1;for(let D=0;D<x.length;D++){let I=x.charCodeAt(D);if(I>=97&&I<=122||I>=65&&I<=90||I>=48&&I<=57||I===45||I===46||I===95||I===126||h&&I===47||v&&I===91||v&&I===93||v&&I===58)P!==-1&&(w+=encodeURIComponent(x.substring(P,D)),P=-1),w!==void 0&&(w+=x.charAt(D));else{w===void 0&&(w=x.substr(0,D));let V=T[I];V!==void 0?(P!==-1&&(w+=encodeURIComponent(x.substring(P,D)),P=-1),w+=V):P===-1&&(P=D)}}return P!==-1&&(w+=encodeURIComponent(x.substring(P))),w!==void 0?w:x}o(k,"d");function R(x){let h;for(let v=0;v<x.length;v++){let w=x.charCodeAt(v);w===35||w===63?(h===void 0&&(h=x.substr(0,v)),h+=T[w]):h!==void 0&&(h+=x[v])}return h!==void 0?h:x}o(R,"p");function A(x,h){let v;return v=x.authority&&x.path.length>1&&x.scheme==="file"?`//${x.authority}${x.path}`:x.path.charCodeAt(0)===47&&(x.path.charCodeAt(1)>=65&&x.path.charCodeAt(1)<=90||x.path.charCodeAt(1)>=97&&x.path.charCodeAt(1)<=122)&&x.path.charCodeAt(2)===58?h?x.path.substr(1):x.path[1].toLowerCase()+x.path.substr(2):x.path,i&&(v=v.replace(/\//g,"\\")),v}o(A,"m");function ne(x,h){let v=h?R:k,w="",{scheme:P,authority:D,path:I,query:V,fragment:N}=x;if(P&&(w+=P,w+=":"),(D||P==="file")&&(w+=u,w+=u),D){let z=D.indexOf("@");if(z!==-1){let ot=D.substr(0,z);D=D.substr(z+1),z=ot.lastIndexOf(":"),z===-1?w+=v(ot,!1,!1):(w+=v(ot.substr(0,z),!1,!1),w+=":",w+=v(ot.substr(z+1),!1,!0)),w+="@"}D=D.toLowerCase(),z=D.lastIndexOf(":"),z===-1?w+=v(D,!1,!0):(w+=v(D.substr(0,z),!1,!0),w+=D.substr(z))}if(I){if(I.length>=3&&I.charCodeAt(0)===47&&I.charCodeAt(2)===58){let z=I.charCodeAt(1);z>=65&&z<=90&&(I=`/${String.fromCharCode(z+32)}:${I.substr(3)}`)}else if(I.length>=2&&I.charCodeAt(1)===58){let z=I.charCodeAt(0);z>=65&&z<=90&&(I=`${String.fromCharCode(z+32)}:${I.substr(2)}`)}w+=v(I,!0,!1)}return V&&(w+="?",w+=v(V,!1,!1)),N&&(w+="#",w+=h?N:k(N,!1,!1)),w}o(ne,"y");function Fe(x){try{return decodeURIComponent(x)}catch{return x.length>3?x.substr(0,3)+Fe(x.substr(3)):x}}o(Fe,"v");let yt=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function pe(x){return x.match(yt)?x.replace(yt,h=>Fe(h)):x}o(pe,"C");var Yo=r(470);let Fr=Yo.posix||Yo,tr="/";var S;(function(x){x.joinPath=function(h,...v){return h.with({path:Fr.join(h.path,...v)})},x.resolvePath=function(h,...v){let w=h.path,P=!1;w[0]!==tr&&(w=tr+w,P=!0);let D=Fr.resolve(w,...v);return P&&D[0]===tr&&!h.authority&&(D=D.substring(1)),h.with({path:D})},x.dirname=function(h){if(h.path.length===0||h.path===tr)return h;let v=Fr.dirname(h.path);return v.length===1&&v.charCodeAt(0)===46&&(v=""),h.with({path:v})},x.basename=function(h){return Fr.basename(h.path)},x.extname=function(h){return Fr.extname(h.path)}})(S||(S={}))})(),bv=n})();var{URI:Rv,Utils:tve}=bv;var gC=0;function wv(t,e,r){let n=String(gC++),i=Rv.parse(`talon-js://${n}`),a=r.languageId??"plaintext",s=new $a(i,a,r.text),p=[s.range],c=r.selections.map(l=>hC(s,l));return new Pi(t,e,n,s,p,c)}o(wv,"createTextEditor");function hC(t,e){let r=t.positionAt(e.anchor),n=t.positionAt(e.active);return new q(r,n)}o(hC,"createSelection");var Zl=class{static{o(this,"TalonJsKeyValueStore")}get(e){throw new Error("state.get not implemented.")}async set(e,r){throw new Error("state.set not implemented.")}};var Yl=class{constructor(e,r){this.talon=e;this.runMode=r;this.configuration=new Kl,this.messages=new Ql(e),this.keyValueStore=new Zl,this.clipboard=new Gl(e),this.capabilities=new zl}static{o(this,"TalonJsIDE")}configuration;messages;keyValueStore;clipboard;capabilities;disposables=[];editors=[];onDidChangeTextDocumentNotifier=new He;get assetsRoot(){throw new Error("assetsRoot not implemented.")}get cursorlessVersion(){throw new Error("cursorlessVersion not implemented.")}get workspaceFolders(){throw new Error("workspaceFolders not implemented.")}get activeTextEditor(){return this.activeEditableTextEditor}get activeEditableTextEditor(){return this.editors[0]}get visibleTextEditors(){return this.editors}getEditableTextEditor(e){if(e instanceof Pi)return e;throw Error(`Unsupported text editor type: ${e}`)}updateTextEditors(e){this.editors=[wv(this.talon,this,e)]}async findInDocument(e,r){if(r!=null)throw new Error("findInDocument not implemented for other than active editor.");this.talon.actions.edit.find(e)}findInWorkspace(e){throw new Error("findInWorkspace not implemented.")}openTextDocument(e){throw new Error("openTextDocument not implemented.")}openUntitledTextDocument(e){throw new Error("openUntitledTextDocument not implemented.")}showInputBox(e){throw new Error("showInputBox not implemented.")}showQuickPick(e,r){throw new Error("showQuickPick not implemented.")}executeCommand(e,...r){throw new Error("executeCommand not implemented.")}flashRanges(e){return Promise.resolve()}setHighlightRanges(e,r,n){throw new Error("setHighlightRanges not implemented.")}onDidChangeTextDocument(e){return this.onDidChangeTextDocumentNotifier.registerListener(e)}emitDidChangeTextDocument(e){this.onDidChangeTextDocumentNotifier.notifyListeners(e)}onDidOpenTextDocument(e){return{dispose:o(()=>{},"dispose")}}onDidCloseTextDocument(e){return{dispose:o(()=>{},"dispose")}}onDidChangeActiveTextEditor(e){return{dispose:o(()=>{},"dispose")}}onDidChangeVisibleTextEditors(e){return{dispose:o(()=>{},"dispose")}}onDidChangeTextEditorSelection(e){return{dispose:o(()=>{},"dispose")}}onDidChangeTextEditorVisibleRanges(e){return{dispose:o(()=>{},"dispose")}}disposeOnExit(...e){return this.disposables.push(...e),()=>we(this.disposables,...e)}};var yC=["default","blue","green","red","pink","yellow"],Jl=class{static{o(this,"TalonJsTestHats")}isEnabled=!0;hatRanges=[];enabledHatStyles=Object.fromEntries(yC.map(e=>[e,{penalty:e==="default"?0:1}]));async setHatRanges(e){this.hatRanges=e}onDidChangeEnabledHatStyles(e){return{dispose:o(()=>{},"dispose")}}onDidChangeIsEnabled(e){return{dispose:o(()=>{},"dispose")}}};function Ev(t,e,r){let n=new t.Context;n.matches="tag: user.cursorless_everywhere_talon";let i=null;n.action_class("user",{async private_cursorless_talonjs_run_and_wait(s,p){i=await a(s,p)},private_cursorless_talonjs_run_no_wait(s,p){a(s,p),i=null},private_cursorless_talonjs_get_response_json(){return JSON.stringify(i)}});async function a(s,p){try{if(s!==Ff)throw Error(`Unknown command ID: ${s}`);let c=t.actions.user.cursorless_everywhere_get_editor_state();return e.updateTextEditors(c),await r.runCommandSafe(p)}catch(c){throw console.error(c),c}}o(a,"runCommand")}o(Ev,"registerCommands");async function _v(t,e){try{return await TC(t,e)}catch(r){throw console.error(r),r}}o(_v,"activate");async function TC(t,e){console.debug(`activate talon.js @ ${e}`);let r=e==="test",n=new Yl(t,e),i=r?new ia:void 0,a=r?new Jl:void 0,s=e==="production"?n:new qa(n,new Va,r),{commandApi:p,injectIde:c,hatTokenMap:l,storedTargets:u}=await yv({ide:s,commandServerApi:i,hats:a});Ev(t,n,p);let m=r?xv({talonJsIDE:n,normalizedIde:s,injectIde:c,commandApi:p,hatTokenMap:l,commandServerApi:i,storedTargets:u}):void 0;return console.debug("talon.js activated"),{testHelpers:m}}o(TC,"activateHelper");async function Wve(t){await _v(talon,t)}o(Wve,"activate");export{Wve as activate};
/*! Bundled license information:

lodash-es/lodash.js:
  (**
   * @license
   * Lodash (Custom Build) <https://lodash.com/>
   * Build: `lodash modularize exports="es" -o ./`
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)

itertools/dist/index.js:
  (* istanbul ignore else -- @preserve *)
  (* istanbul ignore if -- @preserve *)
*/
//# sourceMappingURL=talon.js.map
